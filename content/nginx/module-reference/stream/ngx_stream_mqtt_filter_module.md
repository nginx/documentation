---
title: ngx_stream_mqtt_filter_module
description: ngx_stream_mqtt_filter_module
toc: true
nd-org-source: stream/ngx_stream_mqtt_filter_module.xml
nd-commercial: true
nd-commercial-partial: false
---


<!--
      ********************************************************************************
      ðŸ›‘ WARNING: AUTOGENERATED FILE - DO NOT EDIT ðŸ›‘ This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_stream_mqtt_filter_module` module (1.23.4) provides
support for Message Queuing Telemetry Transport protocol (MQTT) versions
[3.1.1](https://docs.oasis-open.org/mqtt/mqtt/v3.1.1/mqtt-v3.1.1.html)
and
[5.0](https://docs.oasis-open.org/mqtt/mqtt/v5.0/mqtt-v5.0.html).

> This module is available as part of our commercial subscription .

## Example Configuration


```nginx 
listen            127.0.0.1:18883;
proxy_pass        backend;
proxy_buffer_size 16k;

mqtt             on;
mqtt_set_connect clientid "$client";
mqtt_set_connect username "$name";
 ```

## Directives

### mqtt

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>mqtt</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>mqtt off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Enables the MQTT protocol for the given virtual server.
### mqtt_buffers

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>mqtt_buffers</strong> <i>number</i> <i>size</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>mqtt_buffers 100 1k;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.25.1._


Sets the `number` and `size` of the buffers
used for handling MQTT messages,
for a single connection.
### mqtt_rewrite_buffer_size

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>mqtt_rewrite_buffer_size</strong> <i>size</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>mqtt_rewrite_buffer_size 4k|8k;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>server</code></td>
</tr>

{{< /ngx-directive >}}


> This directive is obsolete since version 1.25.1. The [mqtt_buffers](#mqtt_buffers) directive should be used instead.


Sets the `size` of the buffer
used for writing a modified message.
By default, the buffer size is equal to one memory page.
This is either 4K or 8K, depending on a platform.
It can be made smaller, however.
### mqtt_set_connect

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>mqtt_set_connect</strong> <i>field</i> <i>value</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      â€”
    </td>
</tr><tr>
<th>Context: </th>
<td><code>server</code></td>
</tr>

{{< /ngx-directive >}}


Sets the message `field`
to the given `value` for CONNECT message.
The following fields are supported:
`clientid`,
`username`, and
`password`.
The value can contain text, variables, and their combination.

Several `mqtt_set_connect` directives
can be specified on the same level:

```nginx 
mqtt_set_connect clientid "$client";
mqtt_set_connect username "$name";
 ```

