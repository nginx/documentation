---
title: ngx_stream_proxy_module
description: ngx_stream_proxy_module
toc: true
nd-org-source: stream/ngx_stream_proxy_module.xml
nd-commercial: false
nd-commercial-partial: true
---


<!--
      ********************************************************************************
      üõë WARNING: AUTOGENERATED FILE - DO NOT EDIT üõë This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_stream_proxy_module` module (1.9.0) allows proxying
data streams over TCP, UDP (1.9.13), and UNIX-domain sockets.
## Example Configuration


```nginx 
server {
    listen 127.0.0.1:12345;
    proxy_pass 127.0.0.1:8080;
}

server {
    listen 12345;
    proxy_connect_timeout 1s;
    proxy_timeout 1m;
    proxy_pass example.com:12345;
}

server {
    listen 53 udp reuseport;
    proxy_timeout 20s;
    proxy_pass dns.example.com:53;
}

server {
    listen [::1]:12345;
    proxy_pass unix:/tmp/stream.socket;
}
 ```

## Directives

### proxy_bind

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_bind</strong> <i>address</i> <i>[</i> <i>transparent</i> <i>] |</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.9.2._


Makes outgoing connections to a proxied server originate
from the specified local IP `address`.
Parameter value can contain variables (1.11.2).
The special value `off` cancels the effect
of the `proxy_bind` directive
inherited from the previous configuration level, which allows the
system to auto-assign the local IP address.

The `transparent` parameter (1.11.0) allows
outgoing connections to a proxied server originate
from a non-local IP address,
for example, from a real IP address of a client:

```nginx 
proxy_bind $remote_addr transparent;
 ```


In order for this parameter to work,
it is usually necessary to run nginx worker processes with the
[superuser]({{< relref "../ngx_core_module#user" >}}) privileges.
On Linux it is not required (1.13.8) as if
the `transparent` parameter is specified, worker processes
inherit the `CAP_NET_RAW` capability from the master process.
It is also necessary to configure kernel routing table
to intercept network traffic from the proxied server.
### proxy_buffer_size

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_buffer_size</strong> <i>size</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_buffer_size 16k;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.9.4._


Sets the `size` of the buffer used for reading data
from the proxied server.
Also sets the `size` of the buffer used for reading data
from the client.
### proxy_connect_timeout

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_connect_timeout</strong> <i>time</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_connect_timeout 60s;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Defines a timeout for establishing a connection with a proxied server.
### proxy_download_rate

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_download_rate</strong> <i>rate</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_download_rate 0;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.9.3._


Limits the speed of reading the data from the proxied server.
The `rate` is specified in bytes per second.
The zero value disables rate limiting.
The limit is set per a connection, so if nginx simultaneously opens
two connections to the proxied server,
the overall rate will be twice as much as the specified limit.

Parameter value can contain variables (1.17.0).
It may be useful in cases where rate should be limited
depending on a certain condition:

```nginx 
map $slow $rate {
    1     4k;
    2     8k;
}

proxy_download_rate $rate;
 ```

### proxy_half_close

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_half_close</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_half_close off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.21.4._


Enables or disables closing
each direction of a TCP connection independently (‚ÄúTCP half-close‚Äù).
If enabled, proxying over TCP will be kept
until both sides close the connection.
### proxy_next_upstream

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_next_upstream</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_next_upstream on;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


When a connection to the proxied server cannot be established, determines
whether a client connection will be passed to the next server.

Passing a connection to the next server can be limited by
[proxy_next_upstream_tries](#proxy_next_upstream_tries)
and by [proxy_next_upstream_timeout](#proxy_next_upstream_timeout).
### proxy_next_upstream_timeout

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_next_upstream_timeout</strong> <i>time</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_next_upstream_timeout 0;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Limits the time allowed to pass a connection to the
[proxy_next_upstream](#proxy_next_upstream).
The `0` value turns off this limitation.
### proxy_next_upstream_tries

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_next_upstream_tries</strong> <i>number</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_next_upstream_tries 0;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Limits the number of possible tries for passing a connection to the
[proxy_next_upstream](#proxy_next_upstream).
The `0` value turns off this limitation.
### proxy_pass

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_pass</strong> <i>address</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>server</code></td>
</tr>

{{< /ngx-directive >}}


Sets the address of a proxied server.
The address can be specified as a domain name or IP address,
and a port:

```nginx 
proxy_pass localhost:12345;
 ```


or as a UNIX-domain socket path:

```nginx 
proxy_pass unix:/tmp/stream.socket;
 ```


If a domain name resolves to several addresses, all of them will be
used in a round-robin fashion.
In addition, an address can be specified as a
[server group]({{< relref "ngx_stream_upstream_module" >}}).

The address can also be specified using variables (1.11.3):

```nginx 
proxy_pass $upstream;
 ```


In this case, the server name is searched among the described
[server groups]({{< relref "ngx_stream_upstream_module" >}}),
and, if not found, is determined using a
[resolver]({{< relref "ngx_stream_core_module#resolver" >}}).
### proxy_protocol

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_protocol</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_protocol off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.9.2._


Enables the
[PROXY
protocol](http://www.haproxy.org/download/1.8/doc/proxy-protocol.txt) for connections to a proxied server.
### proxy_requests

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_requests</strong> <i>number</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_requests 0;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.15.7._


Sets the number of client datagrams at which
binding between a client and existing UDP stream session is dropped.
After receiving the specified number of datagrams, next datagram
from the same client starts a new session.
The session terminates when all client datagrams are transmitted
to a proxied server and the expected number of
[proxy_responses](#proxy_responses) is received,
or when it reaches a [proxy_timeout](#proxy_timeout).
### proxy_responses

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_responses</strong> <i>number</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.9.13._


Sets the number of datagrams expected from the proxied server
in response to a client datagram
if the [UDP]({{< relref "ngx_stream_core_module#udp" >}})
protocol is used.
The number serves as a hint for session termination.
By default, the number of datagrams is not limited.

If zero value is specified, no response is expected.
However, if a response is received and the
session is still not finished, the response will be handled.
### proxy_session_drop ‚ú©

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_session_drop</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_session_drop off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.15.8._


Enables terminating all sessions to a proxied server
after it was removed from the group or marked as permanently unavailable.
This can occur because of
[re-resolve]({{< relref "ngx_stream_core_module#resolver" >}})
or with the API
[`DELETE`]({{< relref "../http/ngx_http_api_module#deleteStreamUpstreamServer" >}})
command.
A server can be marked as permanently unavailable if it is considered
[unhealthy]({{< relref "ngx_stream_upstream_hc_module#health_check" >}})
or with the API
[`PATCH`]({{< relref "../http/ngx_http_api_module#patchStreamUpstreamServer" >}})
command.
Each session is terminated when the next
read or write event is processed for the client or proxied server.

> This directive is available as part of our commercial subscription .

### proxy_socket_keepalive

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_socket_keepalive</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_socket_keepalive off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.15.6._


Configures the ‚ÄúTCP keepalive‚Äù behavior
for outgoing connections to a proxied server.
By default, the operating system‚Äôs settings are in effect for the socket.
If the directive is set to the value ‚Äú`on`‚Äù, the
SO_KEEPALIVE socket option is turned on for the socket.
### proxy_ssl

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_ssl off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Enables the SSL/TLS protocol for connections to a proxied server.
### proxy_ssl_certificate

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_certificate</strong> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Specifies a `file` with the certificate in the PEM format
used for authentication to a proxied server.

Since version 1.21.0, variables can be used in the `file` name.
### proxy_ssl_certificate_cache

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_certificate_cache</strong> <i>off</i>;</code><br/><code><strong>proxy_ssl_certificate_cache</strong> <i>max</i> <i>=</i> <i>N</i> <i>[</i> <i>inactive</i> <i>=</i> <i>time</i> <i>] [</i> <i>valid</i> <i>=</i> <i>time</i> <i>]</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_ssl_certificate_cache off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.27.4._


Defines a cache that stores
[proxy_ssl_certificate](#proxy_ssl_certificate) and
[proxy_ssl_certificate_key](#proxy_ssl_certificate_key)
specified with [proxy_ssl_certificate_key_variables](#proxy_ssl_certificate_key_variables).

The directive has the following parameters:

`max`


sets the maximum number of elements in the cache;
on cache overflow the least recently used (LRU) elements are removed;


`inactive`


defines a time after which an element is removed from the cache
if it has not been accessed during this time;
by default, it is 10 seconds;


`valid`


defines a time during which
an element in the cache is considered valid
and can be reused;
by default, it is 60 seconds.
Certificates that exceed this time will be reloaded or revalidated;


`off`


disables the cache.




Example:

```nginx 
proxy_ssl_certificate       $proxy_ssl_server_name.crt;
proxy_ssl_certificate_key   $proxy_ssl_server_name.key;
proxy_ssl_certificate_cache max=1000 inactive=20s valid=1m;
 ```

### proxy_ssl_certificate_key

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_certificate_key</strong> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


The value
`store`:`scheme`:`id`
can be specified instead of the `file` (1.29.0),
which is used to load a secret key with a specified `id`
and OpenSSL provider registered URI `scheme`, such as
[`pkcs11`](https://datatracker.ietf.org/doc/html/rfc7512).

Specifies a `file` with the secret key in the PEM format
used for authentication to a proxied server.

Since version 1.21.0, variables can be used in the `file` name.
### proxy_ssl_ciphers

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_ciphers</strong> <i>ciphers</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_ssl_ciphers DEFAULT;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Specifies the enabled ciphers for connections to a proxied server.
The ciphers are specified in the format understood by the OpenSSL library.

The full list can be viewed using the
‚Äú`openssl ciphers`‚Äù command.
### proxy_ssl_conf_command

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_conf_command</strong> <i>name</i> <i>value</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.19.4._


Sets arbitrary OpenSSL configuration
[commands](https://www.openssl.org/docs/man1.1.1/man3/SSL_CONF_cmd.html)
when establishing a connection with the proxied server.

> The directive is supported when using OpenSSL 1.0.2 or higher.


Several `proxy_ssl_conf_command` directives
can be specified on the same level.
These directives are inherited from the previous configuration level
if and only if there are
no `proxy_ssl_conf_command` directives
defined on the current level.

> Note that configuring OpenSSL directly might result in unexpected behavior.

### proxy_ssl_crl

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_crl</strong> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Specifies a `file` with revoked certificates (CRL)
in the PEM format used to [proxy_ssl_verify](#proxy_ssl_verify)
the certificate of the proxied server.
### proxy_ssl_key_log ‚ú©

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_key_log</strong> <i>path</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.27.2._


Enables logging of proxied server connection SSL keys
and specifies the path to the key log file.
Keys are logged in the
[SSLKEYLOGFILE](https://datatracker.ietf.org/doc/html/draft-ietf-tls-keylogfile)
format compatible with Wireshark.

> This directive is available as part of our commercial subscription .

### proxy_ssl_name

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_name</strong> <i>name</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_ssl_name host from proxy_pass;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Allows overriding the server name used to
[proxy_ssl_verify](#proxy_ssl_verify)
the certificate of the proxied server and to be
[proxy_ssl_server_name](#proxy_ssl_server_name)
when establishing a connection with the proxied server.
The server name can also be specified using variables (1.11.3).

By default, the host part of the [proxy_pass](#proxy_pass) address is used.
### proxy_ssl_password_file

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_password_file</strong> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Specifies a `file` with passphrases for
[proxy_ssl_certificate_key](#proxy_ssl_certificate_key)
where each passphrase is specified on a separate line.
Passphrases are tried in turn when loading the key.
### proxy_ssl_protocols

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_protocols</strong> <i>[</i> <i>SSLv2</i> <i>] [</i> <i>SSLv3</i> <i>] [</i> <i>TLSv1</i> <i>] [</i> <i>TLSv1.1</i> <i>] [</i> <i>TLSv1.2</i> <i>] [</i> <i>TLSv1.3</i> <i>]</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_ssl_protocols TLSv1.2 TLSv1.3;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Enables the specified protocols for connections to a proxied server.

> The `TLSv1.3` parameter is used by default since 1.23.4.

### proxy_ssl_server_name

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_server_name</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_ssl_server_name off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Enables or disables passing of the server name through
[TLS
Server Name Indication extension](http://en.wikipedia.org/wiki/Server_Name_Indication) (SNI, RFC 6066)
when establishing a connection with the proxied server.
### proxy_ssl_session_reuse

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_session_reuse</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_ssl_session_reuse on;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Determines whether SSL sessions can be reused when working with
the proxied server.
If the errors
‚Äú`digest check failed`‚Äù
appear in the logs, try disabling session reuse.
### proxy_ssl_trusted_certificate

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_trusted_certificate</strong> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Specifies a `file` with trusted CA certificates in the PEM format
used to [proxy_ssl_verify](#proxy_ssl_verify)
the certificate of the proxied server.
### proxy_ssl_verify

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_verify</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_ssl_verify off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Enables or disables verification of the proxied server certificate.
### proxy_ssl_verify_depth

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_ssl_verify_depth</strong> <i>number</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_ssl_verify_depth 1;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Sets the verification depth in the proxied server certificates chain.
### proxy_timeout

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_timeout</strong> <i>timeout</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_timeout 10m;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Sets the `timeout` between two successive
read or write operations on client or proxied server connections.
If no data is transmitted within this time, the connection is closed.
### proxy_upload_rate

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>proxy_upload_rate</strong> <i>rate</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>proxy_upload_rate 0;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>stream</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.9.3._


Limits the speed of reading the data from the client.
The `rate` is specified in bytes per second.
The zero value disables rate limiting.
The limit is set per a connection, so if the client simultaneously opens
two connections,
the overall rate will be twice as much as the specified limit.

Parameter value can contain variables (1.17.0).
It may be useful in cases where rate should be limited
depending on a certain condition:

```nginx 
map $slow $rate {
    1     4k;
    2     8k;
}

proxy_upload_rate $rate;
 ```

