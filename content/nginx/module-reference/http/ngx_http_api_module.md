---
title: ngx_http_api_module
description: ngx_http_api_module
toc: true
nd-api-reference: "./api/nginx_api.yaml"
nd-org-source: http/ngx_http_api_module.xml
nd-commercial: true
nd-commercial-partial: false
tags:
 - api
doctypes:
 - reference
---
<!--
      ********************************************************************************
      üõë WARNING: AUTOGENERATED FILE - DO NOT EDIT üõë This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_http_api_module` module (1.13.3) provides REST API
for accessing various status information,
configuring upstream server groups on-the-fly, and managing
[key-value pairs]({{< relref "ngx_http_keyval_module" >}})
without the need of reconfiguring nginx.

> The module supersedes the [ngx_http_status_module]({{< relref "ngx_http_status_module" >}}) and [ngx_http_upstream_conf_module]({{< relref "ngx_http_upstream_conf_module" >}}) modules.


When using the `PATCH` or `POST` methods,
make sure that the payload does not exceed the
[buffer size]({{< relref "ngx_http_core_module#client_body_buffer_size" >}})
for reading the client request body, otherwise, the

error may be returned.

> This module is available as part of our commercial subscription .

## Example Configuration


```nginx 
http {
    upstream backend {
        zone http_backend 64k;

        server backend1.example.com weight=5;
        server backend2.example.com;
    }

    proxy_cache_path /data/nginx/cache_backend keys_zone=cache_backend:10m;

    server {
        server_name backend.example.com;

        location / {
            proxy_pass  http://backend;
            proxy_cache cache_backend;

            health_check;
        }

        status_zone server_backend;
    }

    keyval_zone zone=one:32k state=one.keyval;
    keyval $arg_text $text zone=one;

    server {
        listen 127.0.0.1;

        location /api {
            api write=on;
            allow 127.0.0.1;
            deny all;
        }
    }
}

stream {
    upstream backend {
        zone stream_backend 64k;

        server backend1.example.com:12345 weight=5;
        server backend2.example.com:12345;
    }

    server {
        listen      127.0.0.1:12345;
        proxy_pass  backend;
        status_zone server_backend;
        health_check;
    }
}
 ```


All API requests include
a supported API [api_version](#api_version) in the URI.
Examples of API requests with this configuration:

```nginx 
http://127.0.0.1/api/9/
http://127.0.0.1/api/9/nginx
http://127.0.0.1/api/9/connections
http://127.0.0.1/api/9/workers
http://127.0.0.1/api/9/http/requests
http://127.0.0.1/api/9/http/server_zones/server_backend
http://127.0.0.1/api/9/http/caches/cache_backend
http://127.0.0.1/api/9/http/upstreams/backend
http://127.0.0.1/api/9/http/upstreams/backend/servers/
http://127.0.0.1/api/9/http/upstreams/backend/servers/1
http://127.0.0.1/api/9/http/keyvals/one?key=arg1
http://127.0.0.1/api/9/stream/
http://127.0.0.1/api/9/stream/server_zones/server_backend
http://127.0.0.1/api/9/stream/upstreams/
http://127.0.0.1/api/9/stream/upstreams/backend
http://127.0.0.1/api/9/stream/upstreams/backend/servers/1
 ```

## Directives

### api

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>api</strong> <i>[</i> <i>write</i> <i>=</i> <i>on</i> <i>|</i> <i>off</i> <i>]</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>location</code></td>
</tr>

{{< /ngx-directive >}}


Turns on the REST API interface in the surrounding location.
Access to this location should be
[limited]({{< relref "ngx_http_core_module#satisfy" >}}).

The `write` parameter determines whether the API
is read-only or read-write.
By default, the API is read-only.

All API requests should contain a supported API version in the URI.
If the request URI equals the location prefix,
the list of supported API versions is returned.
The current API version is ‚Äú`9`‚Äù.

The optional ‚Äú`fields`‚Äù argument in the request line
specifies which fields of the requested objects will be output:

```nginx 
http://127.0.0.1/api/9/nginx?fields=version,build
 ```

### status_zone

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>status_zone</strong> <i>zone</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>server</code>, <code>location</code>, <code>if in location</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.13.12._


Enables collection of virtual
[http]({{< relref "ngx_http_core_module#server" >}})
or
[stream]({{< relref "../stream/ngx_stream_core_module#server" >}})
server status information in the specified `zone`.
Several servers may share the same zone.

Starting from 1.17.0, status information can be collected
per [location]({{< relref "ngx_http_core_module#location" >}}).
The special value `off` disables statistics collection
in nested location blocks.
Note that the statistics is collected
in the context of a location where processing ends.
It may be different from the original location, if an
[internal
redirect]({{< relref "ngx_http_core_module#internal" >}}) happens during request processing.
## Compatibility


- The ‚Äú `uuid` ‚Äù field was added to the [license](#license) data in [api_version](#api_version) 9 (1.29.0).
- The [license](#license) data were added in [api_version](#api_version) 9 (1.27.2).
- The [workers_](#workers_) data were added in [api_version](#api_version) 9.
- Detailed failure counters were added to SSL statistics in [api_version](#api_version) 8 (1.23.2).
- The `ssl` data for each HTTP [def_nginx_http_upstream](#def_nginx_http_upstream) , [def_nginx_http_server_zone](#def_nginx_http_server_zone) , and stream [def_nginx_stream_upstream](#def_nginx_stream_upstream) , [def_nginx_stream_server_zone](#def_nginx_stream_server_zone) , were added in [api_version](#api_version) 8 (1.21.6).
- The `codes` data in `responses` for each HTTP [def_nginx_http_upstream](#def_nginx_http_upstream) , [def_nginx_http_server_zone](#def_nginx_http_server_zone) , and [def_nginx_http_location_zone](#def_nginx_http_location_zone) were added in [api_version](#api_version) 7.
- The [stream_limit_conns_](#stream_limit_conns_) data were added in [api_version](#api_version) 6.
- The [http_limit_conns_](#http_limit_conns_) data were added in [api_version](#api_version) 6.
- The [http_limit_reqs_](#http_limit_reqs_) data were added in [api_version](#api_version) 6.
- The ‚Äú `expire` ‚Äù parameter of a [key-value]({{< relref "ngx_http_keyval_module" >}}) pair can be [postHttpKeyvalZoneData](#postHttpKeyvalZoneData) or [patchHttpKeyvalZoneKeyValue](#patchHttpKeyvalZoneKeyValue) since [api_version](#api_version) 5.
- The [resolvers_](#resolvers_) data were added in [api_version](#api_version) 5.
- The [http_location_zones_](#http_location_zones_) data were added in [api_version](#api_version) 5.
- The `path` and `method` fields of [def_nginx_error](#def_nginx_error) were removed in [api_version](#api_version) 4. These fields continue to exist in earlier api versions, but show an empty value.
- The [stream_zone_sync_](#stream_zone_sync_) data were added in [api_version](#api_version) 3.
- The [def_nginx_http_upstream_conf_server](#def_nginx_http_upstream_conf_server) parameter was added in [api_version](#api_version) 2.
- The [stream_keyvals_](#stream_keyvals_) data were added in [api_version](#api_version) 2.

