---
title: ngx_http_image_filter_module
description: ngx_http_image_filter_module
toc: true
nd-org-source: http/ngx_http_image_filter_module.xml
nd-commercial: false
nd-commercial-partial: false
---


<!--
      ********************************************************************************
      üõë WARNING: AUTOGENERATED FILE - DO NOT EDIT üõë This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_http_image_filter_module` module (0.7.54+) is a filter
that transforms images in JPEG, GIF, PNG, and WebP formats.

This module is not built by default, it should be enabled with the
`--with-http_image_filter_module`
configuration parameter.

> This module utilizes the [libgd](http://libgd.org) library. It is recommended to use the latest available version of the library.


> The WebP format support appeared in version 1.11.6. To transform images in this format, the `libgd` library must be compiled with the WebP support.

## Example Configuration


```nginx 
location /img/ {
    proxy_pass   http://backend;
    image_filter resize 150 100;
    image_filter rotate 90;
    error_page   415 = /empty;
}

location = /empty {
    empty_gif;
}
 ```

## Directives

### image_filter

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>image_filter</strong> <i>off</i>;</code><br/><code><strong>image_filter</strong> <i>test</i>;</code><br/><code><strong>image_filter</strong> <i>size</i>;</code><br/><code><strong>image_filter</strong> <i>rotate</i> <i>90</i> <i>|</i> <i>180</i> <i>|</i> <i>270</i>;</code><br/><code><strong>image_filter</strong> <i>resize</i> <i>width</i> <i>height</i>;</code><br/><code><strong>image_filter</strong> <i>crop</i> <i>width</i> <i>height</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>image_filter off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>location</code></td>
</tr>

{{< /ngx-directive >}}


Sets the type of transformation to perform on images:

`off`


turns off module processing in a surrounding location.


`test`


ensures that responses are images in either JPEG, GIF, PNG, or WebP format.
Otherwise, the

error is returned.


`size`


outputs information about images in a JSON format, e.g.:

```nginx 
{ "img" : { "width": 100, "height": 100, "type": "gif" } }
 ```


In case of an error, the output is as follows:

```nginx 
{}
 ```



`rotate``90`|`180`|`270`


rotates images counter-clockwise by the specified number of degrees.
Parameter value can contain variables.
This mode can be used either alone or along with the
`resize` and `crop` transformations.


`resize``width``height`


proportionally reduces an image to the specified sizes.
To reduce by only one dimension, another dimension can be specified as
‚Äú`-`‚Äù.
In case of an error, the server will return code
.
Parameter values can contain variables.
When used along with the `rotate` parameter,
the rotation happens *after* reduction.


`crop``width``height`


proportionally reduces an image to the larger side size
and crops extraneous edges by another side.
To reduce by only one dimension, another dimension can be specified as
‚Äú`-`‚Äù.
In case of an error, the server will return code
.
Parameter values can contain variables.
When used along with the `rotate` parameter,
the rotation happens *before* reduction.



### image_filter_buffer

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>image_filter_buffer</strong> <i>size</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>image_filter_buffer 1M;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}


Sets the maximum size of the buffer used for reading images.
When the size is exceeded the server returns error
.
### image_filter_interlace

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>image_filter_interlace</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>image_filter_interlace off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.3.15._


If enabled, final images will be interlaced.
For JPEG, final images will be in ‚Äúprogressive JPEG‚Äù format.
### image_filter_jpeg_quality

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>image_filter_jpeg_quality</strong> <i>quality</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>image_filter_jpeg_quality 75;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}


Sets the desired `quality` of the transformed JPEG images.
Acceptable values are in the range from 1 to 100.
Lesser values usually imply both lower image quality and less data to transfer.
The maximum recommended value is 95.
Parameter value can contain variables.
### image_filter_sharpen

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>image_filter_sharpen</strong> <i>percent</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>image_filter_sharpen 0;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}


Increases sharpness of the final image.
The sharpness percentage can exceed 100.
The zero value disables sharpening.
Parameter value can contain variables.
### image_filter_transparency

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>image_filter_transparency</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>image_filter_transparency on;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}


Defines whether transparency should be preserved when transforming
GIF images or PNG images with colors specified by a palette.
The loss of transparency results in images of a better quality.
The alpha channel transparency in PNG is always preserved.
### image_filter_webp_quality

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>image_filter_webp_quality</strong> <i>quality</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>image_filter_webp_quality 80;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.11.6._


Sets the desired `quality` of the transformed WebP images.
Acceptable values are in the range from 1 to 100.
Lesser values usually imply both lower image quality and less data to transfer.
Parameter value can contain variables.
