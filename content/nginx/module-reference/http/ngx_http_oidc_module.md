---
title: ngx_http_oidc_module
description: ngx_http_oidc_module
toc: true
nd-org-source: http/ngx_http_oidc_module.xml
nd-commercial: true
nd-commercial-partial: false
---


<!--
      ********************************************************************************
      üõë WARNING: AUTOGENERATED FILE - DO NOT EDIT üõë This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_http_oidc_module` module (1.27.4)
implements authentication as a Relying Party in OpenID Connect using the
[
Authorization Code Flow](https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth).

The module expects the OpenID Provider's configuration to be available via
[
metadata](https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderConfig) and requires dynamic
[resolver]({{< relref "ngx_http_core_module#resolver" >}}).

The module can be combined with other access modules
via the [satisfy]({{< relref "ngx_http_core_module#satisfy" >}}) directive.
Note that the module may still block requests even with
`satisfy any;`
as an OpenID Provider might not redirect the user back to nginx.

> This module is available as part of our commercial subscription .

## Example Configuration


```nginx 
http {
    resolver 10.0.0.1;

    oidc_provider my_idp {
        issuer        "https://provider.domain";
        client_id     "unique_id";
        client_secret "unique_secret";
    }

    server {
        location / {
            auth_oidc my_idp;

            proxy_set_header username $oidc_claim_sub;
            proxy_pass       http://backend;
        }
    }
}
 ```


The example assumes that the
‚Äú`https://<nginx-host>/oidc_callback`‚Äù
Redirection URI is configured on the OpenID Provider's side.
The path can be customized with the [redirect_uri](#redirect_uri) directive.
## Directives

### oidc_provider

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>oidc_provider</strong> <i>name</i> { ... }</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>http</code></td>
</tr>

{{< /ngx-directive >}}


Defines an OpenID Provider for use with the [auth_oidc](#auth_oidc) directive.
### auth_oidc

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>auth_oidc</strong> <i>name</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>auth_oidc off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}


Enables end user authentication with the
[oidc_provider](#oidc_provider) OpenID Provider.

Parameter value can contain variables (1.29.0).

The special value `off` cancels the effect
of the `auth_oidc` directive
inherited from the previous configuration level.
### issuer

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>issuer</strong> <i>URL</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Sets the Issuer Identifier URL of the OpenID Provider;
required directive.
The URL must exactly match the value of ‚Äú`issuer`‚Äù
in the OpenID Provider metadata
and requires the ‚Äú`https`‚Äù scheme.
### client_id

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>client_id</strong> <i>string</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Specifies the client ID of the Relying Party;
required directive.
### client_secret

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>client_secret</strong> <i>string</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Specifies a secret value
used to authenticate the Relying Party with the OpenID Provider.
### config_url

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>config_url</strong> <i>URL</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>config_url <issuer>/.well-known/openid-configuration;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Sets a custom URL to retrieve the OpenID Provider metadata.
### cookie_name

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>cookie_name</strong> <i>name</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>cookie_name NGX_OIDC_SESSION;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Sets the name of a session cookie.
### extra_auth_args

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>extra_auth_args</strong> <i>string</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Sets additional query arguments for the
[authentication
request](https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest) URL.

```nginx 
extra_auth_args "display=page&prompt=login";
 ```

### redirect_uri

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>redirect_uri</strong> <i>uri</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>redirect_uri /oidc_callback;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Defines the Redirection URI path for post-authentication redirects
expected by the module from the OpenID Provider.
The `uri` must match the configuration on the Provider's side.

Absolute ‚Äú`https`‚Äù URIs are supported since 1.29.0.
### logout_uri

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>logout_uri</strong> <i>uri</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.29.0._


Defines the URI path for initiating session logout.
Upon session termination, the user is redirected to
[Provider's
Logout Endpoint](https://openid.net/specs/openid-connect-rpinitiated-1_0.html#OPMetadata)
or to the [post_logout_uri](#post_logout_uri).
If neither is configured, the built-in post logout page is displayed.
### post_logout_uri

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>post_logout_uri</strong> <i>uri</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.29.0._


Defines the path or absolute URI
to redirect the user to after the logout.
The `uri` must match the configuration on the Provider's side.
If the post logout page is served by NGINX,
the OIDC module shouldn't be enabled for this location:

```nginx 
http {
    oidc_provider my_idp {
        ...

        logout_uri      /logout;
        post_logout_uri /logged_out_page.html;
    }

    server {
        auth_oidc my_idp;

        location /logged_out_page.html {
            auth_oidc off;
        }
    }
}
 ```

### logout_token_hint

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>logout_token_hint</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>logout_token_hint off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.29.0._


Adds the
[`id_token_hint`](https://openid.net/specs/openid-connect-rpinitiated-1_0.html#RPLogout)
argument to the
[Provider's
Logout Endpoint](https://openid.net/specs/openid-connect-rpinitiated-1_0.html#OPMetadata)
when redirecting user during logout.
This argument can be required by some OpenID Providers.
### scope

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>scope</strong> <i>scope</i> <i>...</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>scope openid;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Sets requested scopes.
The `openid` scope is always required by OIDC.
### session_store

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>session_store</strong> <i>name</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Specifies a custom
[key-value database]({{< relref "ngx_http_keyval_module#keyval_zone" >}})
that stores session data.
By default, an 8-megabyte key-value database named 
`oidc_default_store_<provider name>`
is created automatically.

> A separate key-value database should be configured for each Provider to prevent session reuse across providers.

### session_timeout

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>session_timeout</strong> <i>time</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>session_timeout 8h;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Sets a timeout after which the session is deleted, unless it was
[refreshed](https://openid.net/specs/openid-connect-core-1_0.html#RefreshTokens).
### ssl_crl

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>ssl_crl</strong> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Specifies a `file` with revoked certificates (CRL)
in the PEM format used to verify
the certificates of the OpenID Provider endpoints.
### ssl_trusted_certificate

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>ssl_trusted_certificate</strong> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>ssl_trusted_certificate system CA bundle;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}


Specifies a `file` with trusted CA certificates in the PEM format
used to verify
the certificates of the OpenID Provider endpoints.
### userinfo

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>userinfo</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>userinfo off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>oidc_provider</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.29.0._


Enables downloading of the
[UserInfo](https://openid.net/specs/openid-connect-core-1_0.html#UserInfo)
data and makes UserInfo claims available via the 
[var_oidc_claim_](#var_oidc_claim_) variables.
## Embedded Variables


The `ngx_http_oidc_module` module supports embedded variables:


### `$oidc_id_token`


ID token



### `$oidc_access_token`


access token



### `$oidc_claim_<name>`


top-level ID token or UserInfo claim

Nested claims can be fetched with the
[auth_jwt]({{< relref "ngx_http_auth_jwt_module" >}}) module:

```nginx 
http {
    auth_jwt_claim_set $postal_code address postal_code;

    server {
        location / {
            auth_oidc my_idp;
            auth_jwt  off token=$oidc_id_token;

            proxy_set_header x-postal_code $postal_code;
            proxy_pass       http://backend;
        }
    }
}
 ```




### `$oidc_userinfo`


UserInfo data in the JSON format (1.29.0)



