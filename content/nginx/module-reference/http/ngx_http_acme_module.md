---
title: ngx_http_acme_module
description: ngx_http_acme_module
toc: true
nd-org-source: http/ngx_http_acme_module.xml
nd-commercial: false
nd-commercial-partial: false
---


<!--
      ********************************************************************************
      ðŸ›‘ WARNING: AUTOGENERATED FILE - DO NOT EDIT ðŸ›‘ This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_http_acme_module` module implements
the automatic certificate management
([ACMEv2](https://www.rfc-editor.org/rfc/rfc8555.html))
protocol.

The source code of the module is available
[here](https://github.com/nginx/nginx-acme).
Download and install instructions are available
[here](https://github.com/nginx/nginx-acme/blob/main/README.md).

The module is also available in a prebuilt
`nginx-module-acme`[package]({{< relref "../../linux_packages#dynmodules" >}})
and in `nginx-plus-module-acme` package
as part of our
commercial subscription since 1.29.0.
## Example Configuration


```nginx 
resolver 127.0.0.1:53;

acme_issuer example {
    uri         https://acme.example.com/directory;
    contact     admin@example.test;
    state_path  /var/cache/nginx/acme-example;
    accept_terms_of_service;
}

acme_shared_zone zone=ngx_acme_shared:1M;

server {
    listen 443 ssl;
    server_name  .example.test;

    acme_certificate example;

    ssl_certificate       $acme_certificate;
    ssl_certificate_key   $acme_certificate_key;

    # do not parse the certificate on each request
    ssl_certificate_cache max=2;
}

server {
    # listener on port 80 is required to process ACME HTTP-01 challenges
    listen 80;

    location / {
        return 404;
    }
}
 ```

## Directives

### acme_issuer

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>acme_issuer</strong> <i>name</i> { ... }</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      â€”
    </td>
</tr><tr>
<th>Context: </th>
<td><code>http</code></td>
</tr>

{{< /ngx-directive >}}


Defines an ACME certificate issuer object.
### uri

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>uri</strong> <i>uri</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      â€”
    </td>
</tr><tr>
<th>Context: </th>
<td><code>acme_issuer</code></td>
</tr>

{{< /ngx-directive >}}


The
[directory URL](https://www.rfc-editor.org/rfc/rfc8555#section-7.1.1)
of the ACME server.
This directive is mandatory.
### account_key

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>account_key</strong> <i>alg</i> <i>[:</i> <i>size</i> <i>] |</i> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      â€”
    </td>
</tr><tr>
<th>Context: </th>
<td><code>acme_issuer</code></td>
</tr>

{{< /ngx-directive >}}


The account's private key used for request authentication.

Accepted values:

- `ecdsa` : `256` / `384` / `521` for ES256, ES384, or ES512 JSON Web Signature algorithms
- `rsa` : `2048` / `3072` / `4096` for RS256.
- File path for an existing key, using one of the algorithms above.


The generated account keys are preserved across reloads,
but will be lost on restart unless [state_path](#state_path) is configured.
### contact

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>contact</strong> <i>URL</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      â€”
    </td>
</tr><tr>
<th>Context: </th>
<td><code>acme_issuer</code></td>
</tr>

{{< /ngx-directive >}}


Sets an array of URLs that the ACME server can use
to contact the client regarding account issues.
The `mailto:` scheme will be used
unless specified explicitly.
### ssl_trusted_certificate

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>ssl_trusted_certificate</strong> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      â€”
    </td>
</tr><tr>
<th>Context: </th>
<td><code>acme_issuer</code></td>
</tr>

{{< /ngx-directive >}}


Specifies a `file` with trusted CA certificates in the PEM format
used to [ssl_verify](#ssl_verify) the certificate
of the ACME server.
### ssl_verify

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>ssl_verify</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>ssl_verify on;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>acme_issuer</code></td>
</tr>

{{< /ngx-directive >}}


Enables or disables verification of the ACME server certificate.
### state_path

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>state_path</strong> <i>path</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      â€”
    </td>
</tr><tr>
<th>Context: </th>
<td><code>acme_issuer</code></td>
</tr>

{{< /ngx-directive >}}


Defines a directory for storing the module data
that can be persisted across restarts.
This can improve the load time by skipping some requests on startup,
and avoid hitting request rate limits on the ACME server.

The directory contains sensitive content, such as
the account key, issued certificates, and private keys.
### accept_terms_of_service

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>accept_terms_of_service</strong>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      â€”
    </td>
</tr><tr>
<th>Context: </th>
<td><code>acme_issuer</code></td>
</tr>

{{< /ngx-directive >}}


Agrees to the terms of service under which the ACME server will be used.
Some servers require accepting the terms of service
before account registration.
The terms are usually available on the ACME server's website,
and the URL will be printed to the error log if necessary.
### acme_shared_zone

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>acme_shared_zone</strong> <i>zone</i> <i>=</i> <i>name</i> <i>:</i> <i>size</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>acme_shared_zone zone=ngx_acme_shared:256k;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code></td>
</tr>

{{< /ngx-directive >}}


Allows increasing the size of in-memory storage of the module.
The shared memory zone will be used to store the issued certificates,
keys and challenge data for all the configured certificate issuers.

The default zone size is sufficient to hold approximately
50 ECDSA prime256v1 keys or 35 RSA 2048 keys.
### acme_certificate

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>acme_certificate</strong> <i>issuer</i> <i>[</i> <i>identifier</i> <i>...] [</i> <i>key</i> <i>=</i> <i>alg</i> <i>[:</i> <i>size</i> <i>]]</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      â€”
    </td>
</tr><tr>
<th>Context: </th>
<td><code>server</code></td>
</tr>

{{< /ngx-directive >}}


Defines a certificate with the list of `identifiers`
requested from issuer `issuer`.

The explicit list of identifiers can be omitted.
In this case, the identifiers will be taken from the
[server_name]({{< relref "ngx_http_core_module#server_name" >}}) directive
in the same [server]({{< relref "ngx_http_core_module#server" >}}) block.
Not all values accepted in the `server_name`
are valid certificate identifiers:
regular expressions and wildcards are not supported.

The key parameter sets the type of a generated private key.
Supported key algorithms and sizes:
`ecdsa:256` (default),
`ecdsa:384`,
`ecdsa:521`,
`rsa:2048`,
`rsa:3072`,
`rsa:4096`.
## Embedded Variables


The `ngx_http_acme_module` module supports embedded variables,
valid in the
[server]({{< relref "ngx_http_core_module#server" >}}) block with the
[acme_certificate](#acme_certificate) directive:


### `$acme_certificate`


SSL certificate that can be passed to the
[ssl_certificate]({{< relref "ngx_http_ssl_module#ssl_certificate" >}})


### `$acme_certificate_key`


SSL certificate private key that can be passed to
[ssl_certificate_key]({{< relref "ngx_http_ssl_module#ssl_certificate_key" >}})


