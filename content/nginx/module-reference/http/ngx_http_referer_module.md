---
title: ngx_http_referer_module
description: ngx_http_referer_module
toc: true
nd-org-source: http/ngx_http_referer_module.xml
nd-commercial: false
nd-commercial-partial: false
---


<!--
      ********************************************************************************
      🛑 WARNING: AUTOGENERATED FILE - DO NOT EDIT 🛑 This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_http_referer_module` module is used to block
access to a site for requests with invalid values in the
`Referer` header field.
It should be kept in mind that fabricating a request with an appropriate
`Referer` field value is quite easy, and so the intended
purpose of this module is not to block such requests thoroughly but to block
the mass flow of requests sent by regular browsers.
It should also be taken into consideration that regular browsers may
not send the `Referer` field even for valid requests.
## Example Configuration


```nginx 
valid_referers none blocked server_names
               *.example.com example.* www.example.org/galleries/
               ~\.google\.;

if ($invalid_referer) {
    return 403;
}
 ```

## Directives

### referer_hash_bucket_size

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>referer_hash_bucket_size</strong> <i>size</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>referer_hash_bucket_size 64;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.0.5._


Sets the bucket size for the valid referers hash tables.
The details of setting up hash tables are provided in a separate
[document]({{< relref "../hash" >}}).
### referer_hash_max_size

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>referer_hash_max_size</strong> <i>size</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>referer_hash_max_size 2048;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}

_This directive appeared in version 1.0.5._


Sets the maximum `size` of the valid referers hash tables.
The details of setting up hash tables are provided in a separate
[document]({{< relref "../hash" >}}).
### valid_referers

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>valid_referers</strong> <i>none</i> <i>|</i> <i>blocked</i> <i>|</i> <i>server_names</i> <i>|</i> <i>string</i> <i>...</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      —
    </td>
</tr><tr>
<th>Context: </th>
<td><code>server</code>, <code>location</code></td>
</tr>

{{< /ngx-directive >}}


Specifies the `Referer` request header field values
that will cause the embedded `$invalid_referer` variable to
be set to an empty string.
Otherwise, the variable will be set to “`1`”.
Search for a match is case-insensitive.

Parameters can be as follows:

`none`


the `Referer` field is missing in the request header;


`blocked`


the `Referer` field is present in the request header,
but its value has been deleted by a firewall or proxy server;
such values are strings that do not start with
“`http://`” or “`https://`”;


`server_names`


the `Referer` request header field contains
one of the server names;


arbitrary string


defines a server name and an optional URI prefix.
A server name can have an “`*`” at the beginning or end.
During the checking, the server’s port in the `Referer` field
is ignored;


regular expression


the first symbol should be a “`~`”.
It should be noted that an expression will be matched against
the text starting after the “`http://`”
or “`https://`”.




Example:

```nginx 
valid_referers none blocked server_names
               *.example.com example.* www.example.org/galleries/
               ~\.google\.;
 ```

## Embedded Variables



### `$invalid_referer`


Empty string, if the `Referer` request header field
value is considered
[valid_referers](#valid_referers), otherwise “`1`”.



