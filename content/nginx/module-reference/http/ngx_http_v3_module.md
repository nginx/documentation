---
title: ngx_http_v3_module
description: ngx_http_v3_module
toc: true
nd-org-source: http/ngx_http_v3_module.xml
nd-commercial: false
nd-commercial-partial: false
---


<!--
      ********************************************************************************
      üõë WARNING: AUTOGENERATED FILE - DO NOT EDIT üõë This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_http_v3_module` module (1.25.0) provides
experimental support for
[HTTP/3](https://datatracker.ietf.org/doc/html/rfc9114).

This module is not built by default, it should be enabled with the
`--with-http_v3_module`
configuration parameter.

> This module requires the [OpenSSL](http://www.openssl.org) library version 1.1.1 or higher.


> 0-RTT support requires the [OpenSSL](http://www.openssl.org) library version 3.5.1 or higher. Alternatively, [BoringSSL](https://boringssl.googlesource.com/boringssl) , [LibreSSL](https://www.libressl.org) , or [QuicTLS](https://github.com/quictls/openssl) libraries can be used to build and run this module.

## Known Issues


The module is experimental, caveat emptor applies.

Before version 1.29.1,
0-RTT support could not be enabled with OpenSSL
regardless of the
[ssl_early_data]({{< relref "ngx_http_ssl_module#ssl_early_data" >}})
directive value.

The module cannot be built on the Win32 platform.
## Example Configuration


```nginx 
http {
    log_format quic '$remote_addr - $remote_user [$time_local] '
                    '"$request" $status $body_bytes_sent '
                    '"$http_referer" "$http_user_agent" "$http3"';

    access_log logs/access.log quic;

    server {
        # for better compatibility it's recommended
        # to use the same port for http/3 and https
        listen 8443 quic reuseport;
        listen 8443 ssl;

        ssl_certificate     certs/example.com.crt;
        ssl_certificate_key certs/example.com.key;

        location / {
            # used to advertise the availability of HTTP/3
            add_header Alt-Svc 'h3=":8443"; ma=86400';
        }
    }
}
 ```

## Directives

### http3

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>http3</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>http3 on;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Enables
[HTTP/3](https://datatracker.ietf.org/doc/html/rfc9114)
protocol negotiation.
### http3_hq

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>http3_hq</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>http3_hq off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Enables HTTP/0.9 protocol negotiation
used in
[QUIC
interoperability tests](https://github.com/marten-seemann/quic-interop-runner).
### http3_max_concurrent_streams

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>http3_max_concurrent_streams</strong> <i>number</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>http3_max_concurrent_streams 128;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Sets the maximum number of concurrent HTTP/3 request streams
in a connection.
### http3_stream_buffer_size

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>http3_stream_buffer_size</strong> <i>size</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>http3_stream_buffer_size 64k;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Sets the size of the buffer used for reading and writing of the
QUIC streams.
### quic_active_connection_id_limit

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>quic_active_connection_id_limit</strong> <i>number</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>quic_active_connection_id_limit 2;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Sets the
QUIC `active_connection_id_limit` transport parameter value.
This is the maximum number of client connection IDs
which can be stored on the server.
### quic_bpf

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>quic_bpf</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>quic_bpf off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>main</code></td>
</tr>

{{< /ngx-directive >}}


Enables routing of QUIC packets using
[eBPF](https://ebpf.io/).
When enabled, this allows supporting QUIC connection migration.

> The directive is only supported on Linux 5.7+.

### quic_gso

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>quic_gso</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>quic_gso off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Enables sending in optimized batch mode
using segmentation offloading.

> Optimized sending is supported only on Linux featuring `UDP_SEGMENT` .

### quic_host_key

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>quic_host_key</strong> <i>file</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td>
      ‚Äî
    </td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Sets a `file` with the secret key used to encrypt
stateless reset and address validation tokens.
By default, a random key is generated on each reload.
Tokens generated with old keys are not accepted.
### quic_retry

{{< ngx-directive >}}

<tr>
<th>Syntax: </th>
<td><code><strong>quic_retry</strong> <i>on</i> <i>|</i> <i>off</i>;</code><br/></td>
</tr><tr>
<th>Default: </th>
<td><pre>quic_retry off;</pre></td>
</tr><tr>
<th>Context: </th>
<td><code>http</code>, <code>server</code></td>
</tr>

{{< /ngx-directive >}}


Enables the
[QUIC
Address Validation](https://datatracker.ietf.org/doc/html/rfc9000#name-address-validation) feature.
This includes sending a new token in a `Retry` packet
or a `NEW_TOKEN` frame
and
validating a token received in the `Initial` packet.
## Embedded Variables


The `ngx_http_v3_module` module
supports the following embedded variables:


### `$http3`


negotiated protocol identifier:
‚Äú`h3`‚Äù for HTTP/3 connections,
‚Äú`hq`‚Äù for hq connections,
or an empty string otherwise.



