<!DOCTYPE html>
<html lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>  
  <style>
    body {
       
      visibility: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
  </style>
  
  <noscript>
    <style>
       
      body {
        visibility: visible;
      }
    </style>
  </noscript>
  


  <script>

    const setTheme = (isNewTheme) => {
      localStorage.setItem("useNewTheme", `${isNewTheme}`);
      
      const v1cssIds = [
        "cssFA1",
        "cssFA2",
        "cssFA3",
        "cssBootstrap",
        "css1",
        "css2",
        "css3",
        "css4",
        "css5",
        "css6",
      ];

      v1cssIds.forEach((cssId) => {
        const element = document.getElementById(cssId);
        if (element !== null) {
          element.disabled = isNewTheme;
        }
      });

      const v2cssIds = ["css7", "css9"];
      v2cssIds.forEach((cssId) => {
        const element = document.getElementById(cssId);
        if (element !== null) {
          element.disabled = !isNewTheme;
        }
      });

      
      const v1ElementIds = ["sidebar", "footer", "toc", "api", "search-v1", "breadcrumb-v1", "list-v1"]

      v1ElementIds.forEach((elementId) => {
        const element = document.getElementById(elementId);
        if (element !== null) {
          element.style.display = isNewTheme ? "none" : "";
        }

        const trustarc = document.getElementById("teconsent-v1");
        if (trustarc) {
          trustarc.id = isNewTheme ? "teconsent-v1" : "teconsent";
        }
      });

      document.querySelectorAll(".table-v1").forEach((table) => {
        table.style.display = isNewTheme ? "none" : "";
      });

      const notMfElements = ['[data-mf="false"]'];
      notMfElements.forEach((elementId) => {
        document.querySelectorAll(elementId).forEach((element) => {
          element.style.display = isNewTheme ? "none" : "";
        });
      })

      const mfElements = ['[data-mf="true"]'];
      mfElements.forEach((elementId) => {
        document.querySelectorAll(elementId).forEach((element) => {
          element.style.display = isNewTheme ? "" : "none";

          const trustarc = document.getElementById("teconsent-v2");
          if (trustarc) {
            trustarc.id = isNewTheme ? "teconsent" : "teconsent-v2";
          }
        });
      });

      document.getElementById("body").style.visibility = "visible";
    };

    const toggleTheme = () => {
      setTheme(!(localStorage.getItem("useNewTheme") === "true"));
    };

    
    const mf = toggleTheme;
    const useNewTheme = toggleTheme;

    document.addEventListener("DOMContentLoaded", () => {
      setTheme(localStorage.getItem("useNewTheme") === "true");
    });

    function gameCode(callback) {
      let kkeys = [];
      
      const code = "38,38,40,40,37,39,37,39,66,65";
      return (event) => {
        kkeys.push(event.keyCode);
        if (kkeys.toString().indexOf(code) >= 0) {
          callback(event);
          kkeys = [];
        }
      };
    }
    const handler = gameCode(() => {
      mf();
    });
    window.addEventListener("keydown", handler);

  </script>

  

  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>NGINX App Protect DoS Directives and Policy | DEV -- docs-nginx-com</title>






<link rel="canonical" href="http://localhost:1313/nginx-app-protect-dos/directives-and-policy/learn-about-directives-and-policy/">







<meta property="article:publisher" content="https://www.facebook.com/nginxinc" />
<meta property="og:image" content="http://localhost:1313/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta property="og:image:width" content="500" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="" />
<meta name="twitter:title" content="NGINX App Protect DoS Directives and Policy" />
<meta name="twitter:site" content="@nginx" />
<meta name="twitter:image" content="http://localhost:1313/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta name="twitter:creator" content="@nginx" />

<meta http-equiv="last-modified" content="19/05/2025" />




<meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline'
    https://consent.trustarc.com/ https://mktg.tags.f5.com/basic/prod/utag.sync.js https://static.cloud.coveo.com/ https://*.f5.com/
    https://*.netlify.app https://gist.github.com
    https://tag.demandbase.com/pscSDsz4.min.js
    https://munchkin.brightfunnel.com/js/build/bf-munchkin.min.js
    https://www.googletagmanager.com/gtm.js
    https://www.google-analytics.com/
    https://www.google-analytics.com/analytics.js
    https://www.google-analytics.com/plugins/ua/linkid.js
    https://cdn.bizible.com/scripts/bizible.js
    https://cdn.bizible.com/xdc.js
    https://f5networksglobalprod.122.2o7.net/
    https://f5networksnginxdocs.122.2o7.net/
    https://*.siteintercept.qualtrics.com/SIE/?Q_ZID=*
    https://siteintercept.qualtrics.com/
    ;
    worker-src 'self' blob:">



<meta property="environment" type="development" />
<meta property="buildtype" type="webdocs" />
<meta property="isServer" type="true" />


<meta name="product" content="DEV -- docs-nginx-com">
<meta name="version" content="">
<meta name="doc_type" content="Manual">
  
  <link rel="shortcut icon" type="image/x-icon" href="http://localhost:1313/images/favicon-48x48.ico">

  
  










<link href="/css/v2/style.css" integrity="" rel="stylesheet" type="text/css" id="css7"
  disabled>


<link href="/css/inter/inter.987d1be34797653eabce3627efb116c263d4045fd5badfe003ff283c5a5da435d83a3fad6bfe524e3ce3cf8a41168a30e7aa42507961257eeb275024def0f9b9.css" integrity="sha512-mH0b40eXZT6rzjYn77EWwmPUBF/Vut/gA/8oPFpdpDXYOj&#43;ta/5STjzjz4pBFoow56pCUHlhJX7rJ1Ak3vD5uQ==" rel="stylesheet" type="text/css"
  id="cssInter">


<link href="/css/v2/highlight.min.9ef7c7ad221175216abc8a5827f967bcd7c0e035bfa91180acd26a2c36d54242ae5f485986c260d70b1bbdf225ad76cdbba3179afa7e4335282cc3080a17e337.css" rel="stylesheet" type="text/css" id="css9">





<link href="/fontawesome/css/all.min.4a71f958af9b67180f1ece38b96217f8b2c9009f7fd8f90f299e508808fa4daf3ac3e7ec6f64e47267d1c955f7a419cc15c57ba103c9925f507af4825abdd6e8.css" integrity="sha512-SnH5WK&#43;bZxgPHs44uWIX&#43;LLJAJ9/2PkPKZ5QiAj6Ta86w&#43;fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" rel="stylesheet" type="text/css"
  id="cssFA1">


<link href="/fontawesome/css/v4-font-face.min.5870089ba06cf03e9721f87919eaf15c961a65e071845949ed2da58c5bfbd18a714c5dab2c155f0455ebcd2f45bfd598a5e47ae19976e7aa3a51e22914eac1b6.css" integrity="sha512-WHAIm6Bs8D6XIfh5GerxXJYaZeBxhFlJ7S2ljFv70YpxTF2rLBVfBFXrzS9Fv9WYpeR64Zl256o6UeIpFOrBtg==" rel="stylesheet" type="text/css"
  id="cssFA2">


<link href="/fontawesome/css/v5-font-face.min.81bdf1c9f8ff16b1eda613d52d868a059f16c8c6045c3d7e0a0b771622a11666cdd94b8ea62b5edb0d4b826c3a3737ec3663065fe05b56b6b871e57de73f556b.css" integrity="sha512-gb3xyfj/FrHtphPVLYaKBZ8WyMYEXD1&#43;Cgt3FiKhFmbN2UuOpite2w1Lgmw6NzfsNmMGX&#43;BbVra4ceV95z9Vaw==" rel="stylesheet" type="text/css"
  id="cssFA3">



<link href="/css/bootstrap.min.3f9320327d6304dd356ac060534cfad10938431897a3cebec2515a84aaec41fdfb73d72ba39d7b5b35523cf575b432b3864bb6889d855602faef01b4dd21a734.css" integrity="sha512-P5MgMn1jBN01asBgU0z60Qk4QxiXo86&#43;wlFahKrsQf37c9cro517WzVSPPV1tDKzhku2iJ2FVgL67wG03SGnNA==" rel="stylesheet"
  type="text/css" id="cssBootstrap">



<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.10104/0/css/CoveoFullSearch.min.css"
  integrity="sha512-9/A9yVCU4GS6/iIwTRJKnan4Hf8gDKj3anwItN9QCsU8SixaT5xkjjWsZ/iq0TWaizhtqOLacadXJfxHlwYCcA=="
  crossorigin="anonymous" />


<link
  rel="stylesheet"
  href="https://static.cloud.coveo.com/atomic/v3.19.0/themes/coveo.css"
  integrity="sha512-m2BufPi8Tc6H2jcQfDj/PIl5H57C9jeqhbDFgFXKTtOhoC4S7ULXmx74FseZ8WXpfdT9uyccMHDBJDrIZlrUUQ=="
  crossorigin="anonymous"/>


<link href="/css/docs-nginx-com/nginx-site-header.min.80b10ed49ecfad93607ee771acca88d13dc958e6eecc642af3aa2b170c86b8dcce442e7b86c3e5298c95b0ab2b053a71074c2f15c28266c3a2c502275415b3a7.css" rel="stylesheet" type="text/css" id="css1">


<link href="/css/docs-nginx-com/style.min.2cd4748c438c49d012a5fdc6b98770223c4875fe0f89517b17423b6a5328af4d93d9d772207bfc51d9449781281e1eb8707dcc2f7467e6e24330c9b8c7c5f734.css" rel="stylesheet" type="text/css" id="css2">


<link href="/css/bootstrap-docs.min.8a70c94c72e3783cecd631bc1705c7843b2fdef99f1549f0bf7f774a4083173ee25974413a8206c2340c0fee9bb7a07acd41d41c78ae2280c96a2ce0faca2847.css" rel="stylesheet" type="text/css" id="css3">



<link href="/css/coveo.min.fce7d4df31de99e4f86510a90915820f236b8dcd02be030b27529af7ff10189f807c78cedacb91afa9d07f310a172c6046b1921832f199b9158898a7f74fa117.css" rel="stylesheet" type="text/css" id="css6">



<link href="/css/f5-hugo.min.42feae8b135e9380a66db9c3cb2803221888524a29f41cbc55790b5cb5a309ac7e6dd80e70ed0260370fd93c04b7aa8a5c3d6aca0964804341fad51cfcec963f.css" rel="stylesheet" type="text/css" id="css4">


<link href="/css/inline-overrides.min.495e6889d9955581580c654bad961bb33af6344b283af7e9a34648c5e8d5f1fe90efb8aac33359c4178efd36cd7cb92c7c6458d4175caff9c284b14bd9d2b97a.css" rel="stylesheet" type="text/css" id="css8">





<link href="/css/highlight.min.fe5647c4b67f4b3fcf0ea60b483479d567ba1b05ee6e816439207edfa3d310dbee79536278c67d89c1db5da275bde962a10163da375f05bd19743e2a80e1ad02.css" rel="stylesheet" type="text/css" id="css5">
  
  
  
  
  
  
        
  <script async="async" src="https://consent.trustarc.com/notice?domain=f5.com&c=teconsent&js=nj&noticeType=bb&text=true&gtm=1" crossorigin=""></script>
  
  

<script src="https://mktg.tags.f5.com/basic/prod/utag.sync.js"></script> 


  
  
  
  
  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-K5HG9JT');</script>
  
  </head>
  
  <body id="body">
    
   
<script type="text/javascript"> 
    (function(a,b,c,d) { 
        a='//mktg.tags.f5.com/basic/prod/utag.js'; 
        b=document;c='script';d=b.createElement(c);d.src=a; 
        d.type='text/java'+c;d.async=true; 
        a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})(); 
</script> 
    
  
    <header>
      
<div class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar navbar-fixed-top">
  <div class="container-fluid flex-md-row flex-column header-container">
    <a class="navbar-brand mr-0 mr-md-2" href="/" aria-label="NGINX Docs">
      <img class="navbar-img" src="http://localhost:1313/images/icons/NGINX-Docs-horiz-white-type.svg" alt="NGINX Docs">
    </a>
    
      <div class="navbar navbar-nav">
        
        <div id="searchbox">
          
          <div class="CoveoSearchbox" data-placeholder='Search NGINX Docs...'></div>
        </div>
        <atomic-search-interface id="search-standalone-header" data-mf="true" style="display:none;">
          <atomic-search-box redirection-url="/search.html">
          </atomic-search-box>
        </atomic-search-interface>
      </div>
    
    
    
    
    <ul class="navbar navbar-nav">
        <li class="nav-item-explore active">
          <button id="navbar-sites-button" class="button navbar-button">
              F5 Sites
              <i id="navbar-sites-button-icon" class="link-chevron-icon fa-solid fa-chevron-down"></i>
          </button>
          <div class="dropdown-content" id="dropdown-content">
            <ul>
              
                <li>
                  <a href="https://community.f5.com/" target="_blank" >DevCentral</a>
                  <p>Connect &amp; learn in our hosted community</p>
                </li>
              
                <li>
                  <a href="https://my.f5.com/" target="_blank" >MyF5</a>
                  <p>Your key to everything F5, including support, registration keys, and subscriptions</p>
                </li>
              
                <li>
                  <a href="https://nginx.org/" target="_blank" >NGINX</a>
                  <p>Learn more about NGINX Open Source and read the community blog</p>
                </li>
              
            </ul>
          </div>
        </li>
    </ul>
  </div>
</div>


    </header>
  
    <section class="base-layout" data-testid="base-layout">
      <section id="breadcrumb-v1">
        
          
          <nav aria-label="breadcrumb" class="breadcrumb navbar">
    <div class="nav flex-md-row">
        <ol class="breadcrumb">
            
            
            
            
                
            
            
                
            
            
                
            
            
                
            
            
            
                <li><a href="/">Home</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-dos/">F5 NGINX App Protect DoS</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-dos/directives-and-policy/">Directives and Policy</a><i class="fas fa-chevron-right"></i></li>
                
            
                NGINX App Protect DoS Directives and Policy
        </ol>
    </div>
</nav>
  
          
        
      </section>
  
      <div class="main container-fluid min-page-height" data-menu-id="/nginx-app-protect-dos/directives-and-policy/learn-about-directives-and-policy/">
        
<div class="docs-container row override-sidebar-collapse">
<div class="docs-container row override-sidebar-collapse">
  <nav id="sidebar" class="sidenav overflow-auto col-md-3 d-none d-xl-block d-print-none align-top">
    

<div id="sidebar-wrapper">
     <div id="sidebar" class="sidebar" aria-label="Sidebar navigation">
        <button id="sidebar-toggle-button" title="Toggle sidebar navigation" role="button" aria-controls="sidebar-content">
           <i class="fa fa-chevron-right sidebar-visible-collapsed"></i>
           <i class="fa fa-chevron-left sidebar-visible-expanded"></i>
        </button>
        <div id="sidebar-content">
            <h3>
                <a class="sidebar-title" href="http://localhost:1313/nginx-app-protect-dos/" alt="F5 NGINX App Protect DoS"><img
                        class="card-img-top" src="http://localhost:1313//images/icons/NGINX-App-Protect-DoS-product-icon.svg"
                        alt="F5 NGINX App Protect DoS">
                    F5 NGINX App Protect DoS</a>
            </h3>
            <ul>
            
            
                
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                    <a data-menu-id="/nginx-app-protect-dos/deployment-guide/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#nap-dos--deployment-guide" aria-controls="nap-dos--deployment-guide">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Deployment Guide</a>
                            </li>
                        </div>
                        <div id="nap-dos--deployment-guide" class="accordion-body collapse">
                            <div class="accordion-inner">
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/deployment-guide/learn-about-deployment/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/deployment-guide/learn-about-deployment/">NGINX App Protect DoS Deployment</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/deployment-guide/installing-nginx-plus-with-dos-and-waf-on-amazon-web-services/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/deployment-guide/installing-nginx-plus-with-dos-and-waf-on-amazon-web-services/">NGINX App Protect WAF &#43; DoS AMIs on Amazon EC2</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                            </div>
                        </div>
                    </div>
                </div>

                

            
                
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                    <a data-menu-id="/nginx-app-protect-dos/directives-and-policy/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#nap-dos--directives-and-policy" aria-controls="nap-dos--directives-and-policy">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Directives and Policy</a>
                            </li>
                        </div>
                        <div id="nap-dos--directives-and-policy" class="accordion-body collapse">
                            <div class="accordion-inner">
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/directives-and-policy/learn-about-directives-and-policy/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/directives-and-policy/learn-about-directives-and-policy/">NGINX App Protect DoS Directives and Policy</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                            </div>
                        </div>
                    </div>
                </div>

                

            
                
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                    <a data-menu-id="/nginx-app-protect-dos/monitoring/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#nap-dos--monitoring" aria-controls="nap-dos--monitoring">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Monitoring</a>
                            </li>
                        </div>
                        <div id="nap-dos--monitoring" class="accordion-body collapse">
                            <div class="accordion-inner">
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/monitoring/types-of-logs/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/monitoring/types-of-logs/">NGINX App Protect DoS Logs Overview</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/monitoring/live-activity-monitoring/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/monitoring/live-activity-monitoring/">NGINX App Protect DoS Live Activity Monitoring</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/monitoring/security-log/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/monitoring/security-log/">NGINX App Protect DoS Security Log</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/monitoring/access-log/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/monitoring/access-log/">NGINX App Protect DoS Access Log Request Mechanism</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/monitoring/operation-log/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/monitoring/operation-log/">NGINX App Protect DoS Operation Log</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                            </div>
                        </div>
                    </div>
                </div>

                

            
                
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                    <a data-menu-id="/nginx-app-protect-dos/troubleshooting-guide/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#nap-dos--troubleshooting-guide" aria-controls="nap-dos--troubleshooting-guide">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Troubleshooting Guide</a>
                            </li>
                        </div>
                        <div id="nap-dos--troubleshooting-guide" class="accordion-body collapse">
                            <div class="accordion-inner">
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/troubleshooting-guide/how-to-troubleshoot/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/troubleshooting-guide/how-to-troubleshoot/">NGINX App Protect DoS Troubleshooting Guide</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                            </div>
                        </div>
                    </div>
                </div>

                

            
                
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                    <a data-menu-id="/nginx-app-protect-dos/releases/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#nap-dos--releases" aria-controls="nap-dos--releases">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Releases</a>
                            </li>
                        </div>
                        <div id="nap-dos--releases" class="accordion-body collapse">
                            <div class="accordion-inner">
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-4.6/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.6/">NGINX App Protect DoS 4.6</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-1.2.0/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-1.2.0/">NGINX App Protect DoS Arbitrator 1.2.0</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-4.5/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.5/">NGINX App Protect DoS 4.5</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-4.4/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.4/">NGINX App Protect DoS 4.4</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-4.3/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.3/">NGINX App Protect DoS 4.3</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-4.2/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.2/">NGINX App Protect DoS 4.2</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-4.1/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.1/">NGINX App Protect DoS 4.1</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-1.1.1/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-1.1.1/">NGINX App Protect DoS Arbitrator 1.1.1</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-4.0/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.0/">NGINX App Protect DoS 4.0</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-3.1/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-3.1/">NGINX App Protect DoS 3.1</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-3.0/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-3.0/">NGINX App Protect DoS 3.0</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-2.4/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.4/">NGINX App Protect DoS 2.4</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-2.3/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.3/">NGINX App Protect DoS 2.3</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-2.2/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.2/">NGINX App Protect DoS 2.2</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-2.1/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.1/">NGINX App Protect DoS 2.1</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-2.0/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.0/">NGINX App Protect DoS 2.0</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-1.1.0/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-1.1.0/">NGINX App Protect DoS Arbitrator 1.1.0</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-dos/releases/about-1.0/"
                                                                href="http://localhost:1313/nginx-app-protect-dos/releases/about-1.0/">NGINX App Protect 1.0</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                            </div>
                        </div>
                    </div>
                </div>

                

            

            </ul>
        
        </div>
    </div>
</div>

  </nav>

  
  
  <main class="content col d-block align-top content-has-toc" role="main">
  
    
  <section class="main-layout">
    <div class="sidebar-layout" id="sidebar-layout">
      <nav data-mf="true" id="sidebar-v2" class="sidebar" style="display:none;">
        


    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    





<atomic-search-interface id="search-standalone-sidebar" data-mf="true" style="display:none;">
    <atomic-search-box redirection-url="/search.html">
    </atomic-search-box>
</atomic-search-interface>
<button class="product-selector-button" id="product-selector-button">
    
    <div class="product-selector-name" id="product-selector-name">NGINX App Protect DoS</div>
    <div class="product-selector-button-icon" id="product-selector-button-icon">
        <svg width="8" height="14" viewBox="0 0 8 14" fill="none" xmlns="http://www.w3.org/2000/svg" id="product-selector-chevron-icon">
            <path d="M1 13L7 7L0.999999 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="product-selector-chevron-icon"/>
        </svg>     
    </div>
</button>
<div class="product-selector" id="product-selector">
    
    
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX ONE</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-one">NGINX One Console</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx">NGINX Plus</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-instance-manager">NGINX Instance Manager</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-ingress-controller">NGINX Ingress Controller</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-gateway-fabric">NGINX Gateway Fabric</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="https://nginx.org/en/docs/">NGINX Open Source</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/solutions/">Subscription Licensing &amp; Solutions</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-agent">NGINX Agent</a>
                </li>
            
            </ul>
        </div>
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX APP PROTECT</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-app-protect-waf">NGINX App Protect WAF</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-app-protect-dos">NGINX App Protect DoS</a>
                </li>
            
            </ul>
        </div>
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX AS A SERVICE</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginxaas/azure/">NGINX as a Service for Azure</a>
                </li>
            
            </ul>
        </div>
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX OTHER</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="https://unit.nginx.org/">NGINX Unit</a>
                </li>
            
            </ul>
        </div>
    
</div>
<div class="scrollbar-container">
    <div class="sidebar-navigation">
        <ul class="parent-collapsible-content">
        
            <li class="parent-collapsible-content-item">
                
                    <input type="checkbox" id="toggle-bb05dd6e4ddf4f22e1dacc04329b3f0e" class="toggle-checkbox" style="display: none;">
                    <label for="toggle-bb05dd6e4ddf4f22e1dacc04329b3f0e" class="collapsible-header">
                        
                            <span class="parent-box expand"></span>
                            <span class="parent-box opened"></span>
                        
                        Deployment Guide 
                    </label>
                    

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/deployment-guide/learn-about-deployment/" style="">NGINX App Protect DoS Deployment </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/deployment-guide/installing-nginx-plus-with-dos-and-waf-on-amazon-web-services/" style="">NGINX App Protect WAF &#43; DoS AMIs on Amazon EC2 </a>
            
        
    </li>
    
</ul>
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                    <input type="checkbox" id="toggle-d105093aff487b4ad26b216f671385cc" class="toggle-checkbox" style="display: none;">
                    <label for="toggle-d105093aff487b4ad26b216f671385cc" class="collapsible-header">
                        
                            <span class="parent-box expand"></span>
                            <span class="parent-box opened"></span>
                        
                        Directives and Policy 
                    </label>
                    

<ul class="collapsible-content">
    
    <li>
        
                                  
                <span class="box current partial" id="current-page"></span>                 
            
            <a href="http://localhost:1313/nginx-app-protect-dos/directives-and-policy/learn-about-directives-and-policy/" style="font-weight: bold;">NGINX App Protect DoS Directives and Policy </a>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#directives-table">Directives table</a></li>
    <li><a href="#directives-info">Directives Info</a>
      <ul>
        <li><a href="#enable-directive-app_protect_dos_enable">Enable directive (<code>app_protect_dos_enable</code>)</a></li>
        <li><a href="#policy-directive-app_protect_dos_policy_file">Policy directive (<code>app_protect_dos_policy_file</code>)</a></li>
        <li><a href="#service-name-directive-app_protect_dos_name">Service Name directive (<code>app_protect_dos_name</code>)</a></li>
        <li><a href="#monitor-directive-app_protect_dos_monitor">Monitor directive (<code>app_protect_dos_monitor</code>)</a></li>
        <li><a href="#security-log-enable-directive-app_protect_dos_security_log_enable">Security log enable directive (<code>app_protect_dos_security_log_enable</code>)</a></li>
        <li><a href="#security-log-directive-app_protect_dos_security_log">Security log directive (<code>app_protect_dos_security_log</code>)</a></li>
        <li><a href="#liveness-probe-directive-app_protect_dos_liveness">Liveness probe directive (<code>app_protect_dos_liveness</code>)</a></li>
        <li><a href="#readiness-probe-directive-app_protect_dos_readiness">Readiness probe directive (<code>app_protect_dos_readiness</code>)</a></li>
        <li><a href="#arbitrator-fqdn-directive-app_protect_dos_arb_fqdn">Arbitrator FQDN directive (<code>app_protect_dos_arb_fqdn</code>)</a></li>
        <li><a href="#api-directive-app_protect_dos_api">API directive (<code>app_protect_dos_api</code>)</a></li>
        <li><a href="#accelerated-mitigation-directive-app_protect_dos_accelerated_mitigation">Accelerated mitigation directive (<code>app_protect_dos_accelerated_mitigation</code>)</a></li>
        <li><a href="#access-file-directive-app_protect_dos_access_file">Access File directive (<code>app_protect_dos_access_file</code>)</a></li>
      </ul>
    </li>
  </ul>
</nav>
        
    </li>
    
</ul>
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                    <input type="checkbox" id="toggle-8109714a0ef8a6b3add865e2b8808038" class="toggle-checkbox" style="display: none;">
                    <label for="toggle-8109714a0ef8a6b3add865e2b8808038" class="collapsible-header">
                        
                            <span class="parent-box expand"></span>
                            <span class="parent-box opened"></span>
                        
                        Monitoring 
                    </label>
                    

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/monitoring/types-of-logs/" style="">NGINX App Protect DoS Logs Overview </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/monitoring/live-activity-monitoring/" style="">NGINX App Protect DoS Live Activity Monitoring </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/monitoring/security-log/" style="">NGINX App Protect DoS Security Log </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/monitoring/access-log/" style="">NGINX App Protect DoS Access Log Request Mechanism </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/monitoring/operation-log/" style="">NGINX App Protect DoS Operation Log </a>
            
        
    </li>
    
</ul>
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                    <input type="checkbox" id="toggle-98c0dacb8900b200ffba95b2dcadc2ab" class="toggle-checkbox" style="display: none;">
                    <label for="toggle-98c0dacb8900b200ffba95b2dcadc2ab" class="collapsible-header">
                        
                            <span class="parent-box expand"></span>
                            <span class="parent-box opened"></span>
                        
                        Troubleshooting Guide 
                    </label>
                    

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/troubleshooting-guide/how-to-troubleshoot/" style="">NGINX App Protect DoS Troubleshooting Guide </a>
            
        
    </li>
    
</ul>
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                    <input type="checkbox" id="toggle-92a77a520c2734c2579833949be71871" class="toggle-checkbox" style="display: none;">
                    <label for="toggle-92a77a520c2734c2579833949be71871" class="collapsible-header">
                        
                            <span class="parent-box expand"></span>
                            <span class="parent-box opened"></span>
                        
                        Releases 
                    </label>
                    

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.6/" style="">NGINX App Protect DoS 4.6 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-1.2.0/" style="">NGINX App Protect DoS Arbitrator 1.2.0 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.5/" style="">NGINX App Protect DoS 4.5 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.4/" style="">NGINX App Protect DoS 4.4 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.3/" style="">NGINX App Protect DoS 4.3 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.2/" style="">NGINX App Protect DoS 4.2 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.1/" style="">NGINX App Protect DoS 4.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-1.1.1/" style="">NGINX App Protect DoS Arbitrator 1.1.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-4.0/" style="">NGINX App Protect DoS 4.0 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-3.1/" style="">NGINX App Protect DoS 3.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-3.0/" style="">NGINX App Protect DoS 3.0 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.4/" style="">NGINX App Protect DoS 2.4 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.3/" style="">NGINX App Protect DoS 2.3 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.2/" style="">NGINX App Protect DoS 2.2 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.1/" style="">NGINX App Protect DoS 2.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-2.0/" style="">NGINX App Protect DoS 2.0 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-1.1.0/" style="">NGINX App Protect DoS Arbitrator 1.1.0 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-dos/releases/about-1.0/" style="">NGINX App Protect 1.0 </a>
            
        
    </li>
    
</ul>
                
            </li>
        
        </ul>
    </div>
</div>
      </nav>
    </div>

    <section class="content-layout">
      <div data-cms-edit="content" class="text-content">
        <section class="breadcrumb-layout" data-mf="true" style="display: none;">
          
            
            <nav aria-label="breadcrumb" class="breadcrumb navbar">
    <div class="nav flex-md-row">
        <ol class="breadcrumb">
            
            
            
            
                
            
            
                
            
            
                
            
            
                
            
            
            
                <li><a href="/">Home</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-dos/">F5 NGINX App Protect DoS</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-dos/directives-and-policy/">Directives and Policy</a><i class="fas fa-chevron-right"></i></li>
                
            
                NGINX App Protect DoS Directives and Policy
        </ol>
    </div>
</nav>
  
            
          
        </section>
        <h1>NGINX App Protect DoS Directives and Policy</h1>
        <h2 
id="introduction">Introduction  <a class="headerlink float-right" href="#introduction" title="Introduction"><i class="fas fa-link fa-xs"></i></a>
</h2><p>NGINX directives are specified in the <code>nginx.conf</code> file and are used to configure various modules of NGINX.<br>
F5 NGINX App Protect DoS has its own set of directives, which follow the same rules as other NGINX directives, and are used to enable and configure its features.<br></p>
<p>The table below provides a summary of all the F5 NGINX App Protect DoS directives.<br></p>
<p>While only the first directive is mandatory for enabling NGINX App Protect DoS, it is recommended to use as many directives as possible to leverage the product’s full range of monitoring and application health detection capabilities. After adding these directives, ensure you reload NGINX and check the error log for any errors or warnings.<br></p>
<h2 
id="directives-table">Directives table  <a class="headerlink float-right" href="#directives-table" title="Directives table"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Below is a summary of all NGINX App Protect DoS directives. Detailed descriptions of each directive can be found in the following sections.</p>





<table class="table table-bordered table-striped table-responsive table-sm table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Directive syntax</th>
          <th style="text-align: left">Options</th>
          <th style="text-align: left">Context</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Mandatory</th>
          <th style="text-align: left">Default</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><a href="#enable-directive-app_protect_dos_enable">app_protect_dos_enable</a></td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Enable/Disable DoS protection</td>
          <td style="text-align: left">Yes</td>
          <td style="text-align: left">off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#policy-directive-app_protect_dos_policy_file">app_protect_dos_policy_file</a></td>
          <td style="text-align: left">[FILE-PATH]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Load DoS configuration from a policy file</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>/etc/app_protect_dos/BADOSDefaultPolicy.json</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#service-name-directive-app_protect_dos_name">app_protect_dos_name</a></td>
          <td style="text-align: left">[SERVICE-NAME]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Name of protected object</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><strong>line_num-server_name</strong>:<em>seq</em>-location_name <br> <br> (i.e. <code>30-backend:1-/abc</code>)</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#monitor-directive-app_protect_dos_monitor">app_protect_dos_monitor</a></td>
          <td style="text-align: left">[uri=X]  [protocol=Y]  [timeout=Z] [proxy_protocol | proxy_protocol=on|off]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">URI to monitor server&rsquo;s stress. Protocol and timeout are optional</td>
          <td style="text-align: left">Yes, unless its regular http1 traffic</td>
          <td style="text-align: left">uri - None <br> protocol - http1 <br> timeout - 10 seconds for http1/websocket ; 5 seconds for http2/grpc <br> proxy_protocol - off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#security-log-enable-directive-app_protect_dos_security_log_enable">app_protect_dos_security_log_enable</a></td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Enable/Disable security logger</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left">off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#security-log-directive-app_protect_dos_security_log">app_protect_dos_security_log</a></td>
          <td style="text-align: left">[LOG-CONFIG-FILE] [DESTINATION]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Security logger configuration. Second argument: <br>&ldquo;syslog:server={ip}:{port}&rdquo;  or <br>&ldquo;stderr&rdquo; or  <br>  &ldquo;{absolute_file_path}&rdquo;</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>/etc/app_protect_dos/log-default.json stderr</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#liveness-probe-directive-app_protect_dos_liveness">app_protect_dos_liveness</a></td>
          <td style="text-align: left">[on|off] [uri:URI] [port:PORT]</td>
          <td style="text-align: left">http</td>
          <td style="text-align: left">Liveness prob. Second and third arguments are optional</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>off uri:/app_protect_dos_liveness port:8090</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#readiness-probe-directive-app_protect_dos_readiness">app_protect_dos_readiness</a></td>
          <td style="text-align: left">[on|off] [uri:URI] [port:PORT]</td>
          <td style="text-align: left">http</td>
          <td style="text-align: left">Readiness prob. Second and third arguments are optional</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>off  uri:/app_protect_dos_readiness port:8090</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#arbitrator-fqdn-directive-app_protect_dos_arb_fqdn">app_protect_dos_arb_fqdn</a></td>
          <td style="text-align: left">[FQDN|IP address]</td>
          <td style="text-align: left">http</td>
          <td style="text-align: left">Arbitrator FQDN/IP address</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>svc-appprotect-dos-arb</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#api-directive-app_protect_dos_api">app_protect_dos_api</a></td>
          <td style="text-align: left">No arguments</td>
          <td style="text-align: left">location</td>
          <td style="text-align: left">Monitoring via Rest API (also includes the dashboard)</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left">off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#api-directive-app_protect_dos_api">app_protect_dos_accelerated_mitigation</a></td>
          <td style="text-align: left">[on|off] [syn_drop=on|off]</td>
          <td style="text-align: left">http</td>
          <td style="text-align: left">Enable/Disable L4 accelerated mitigation. Second argument is optional</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left">off syn_drop=off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#access-file-directive-app_protect_dos_access_file">app_protect_dos_access_file</a></td>
          <td style="text-align: left">[FILE-PATH]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Define allowlist policy from a file</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left">None / disabled</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-bordered table-striped table-responsive table-sm narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Directive syntax</th>
          <th style="text-align: left">Options</th>
          <th style="text-align: left">Context</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Mandatory</th>
          <th style="text-align: left">Default</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><a href="#enable-directive-app_protect_dos_enable">app_protect_dos_enable</a></td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Enable/Disable DoS protection</td>
          <td style="text-align: left">Yes</td>
          <td style="text-align: left">off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#policy-directive-app_protect_dos_policy_file">app_protect_dos_policy_file</a></td>
          <td style="text-align: left">[FILE-PATH]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Load DoS configuration from a policy file</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>/etc/app_protect_dos/BADOSDefaultPolicy.json</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#service-name-directive-app_protect_dos_name">app_protect_dos_name</a></td>
          <td style="text-align: left">[SERVICE-NAME]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Name of protected object</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><strong>line_num-server_name</strong>:<em>seq</em>-location_name <br> <br> (i.e. <code>30-backend:1-/abc</code>)</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#monitor-directive-app_protect_dos_monitor">app_protect_dos_monitor</a></td>
          <td style="text-align: left">[uri=X]  [protocol=Y]  [timeout=Z] [proxy_protocol | proxy_protocol=on|off]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">URI to monitor server&rsquo;s stress. Protocol and timeout are optional</td>
          <td style="text-align: left">Yes, unless its regular http1 traffic</td>
          <td style="text-align: left">uri - None <br> protocol - http1 <br> timeout - 10 seconds for http1/websocket ; 5 seconds for http2/grpc <br> proxy_protocol - off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#security-log-enable-directive-app_protect_dos_security_log_enable">app_protect_dos_security_log_enable</a></td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Enable/Disable security logger</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left">off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#security-log-directive-app_protect_dos_security_log">app_protect_dos_security_log</a></td>
          <td style="text-align: left">[LOG-CONFIG-FILE] [DESTINATION]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Security logger configuration. Second argument: <br>&ldquo;syslog:server={ip}:{port}&rdquo;  or <br>&ldquo;stderr&rdquo; or  <br>  &ldquo;{absolute_file_path}&rdquo;</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>/etc/app_protect_dos/log-default.json stderr</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#liveness-probe-directive-app_protect_dos_liveness">app_protect_dos_liveness</a></td>
          <td style="text-align: left">[on|off] [uri:URI] [port:PORT]</td>
          <td style="text-align: left">http</td>
          <td style="text-align: left">Liveness prob. Second and third arguments are optional</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>off uri:/app_protect_dos_liveness port:8090</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#readiness-probe-directive-app_protect_dos_readiness">app_protect_dos_readiness</a></td>
          <td style="text-align: left">[on|off] [uri:URI] [port:PORT]</td>
          <td style="text-align: left">http</td>
          <td style="text-align: left">Readiness prob. Second and third arguments are optional</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>off  uri:/app_protect_dos_readiness port:8090</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#arbitrator-fqdn-directive-app_protect_dos_arb_fqdn">app_protect_dos_arb_fqdn</a></td>
          <td style="text-align: left">[FQDN|IP address]</td>
          <td style="text-align: left">http</td>
          <td style="text-align: left">Arbitrator FQDN/IP address</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left"><code>svc-appprotect-dos-arb</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#api-directive-app_protect_dos_api">app_protect_dos_api</a></td>
          <td style="text-align: left">No arguments</td>
          <td style="text-align: left">location</td>
          <td style="text-align: left">Monitoring via Rest API (also includes the dashboard)</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left">off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#api-directive-app_protect_dos_api">app_protect_dos_accelerated_mitigation</a></td>
          <td style="text-align: left">[on|off] [syn_drop=on|off]</td>
          <td style="text-align: left">http</td>
          <td style="text-align: left">Enable/Disable L4 accelerated mitigation. Second argument is optional</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left">off syn_drop=off</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#access-file-directive-app_protect_dos_access_file">app_protect_dos_access_file</a></td>
          <td style="text-align: left">[FILE-PATH]</td>
          <td style="text-align: left">http, <br> server, <br> location</td>
          <td style="text-align: left">Define allowlist policy from a file</td>
          <td style="text-align: left">No</td>
          <td style="text-align: left">None / disabled</td>
      </tr>
  </tbody>
</table>

</div>
<h2 
id="directives-info">Directives Info  <a class="headerlink float-right" href="#directives-info" title="Directives Info"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="enable-directive-app_protect_dos_enable">Enable directive (<code>app_protect_dos_enable</code>)  <a class="headerlink float-right" href="#enable-directive-app_protect_dos_enable" title="Enable directive (app_protect_dos_enable)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Enables/disables App Protect DoS module in the relevant block/s. <br>
It can be written in the following contexts: <code>location/server/http</code>.</p>
<p>The derived blocks/contexts also inherit the directive.
<strong>For example:</strong> A directive written in <code>http</code> context will be considered as if written also in all of the http&rsquo;s server blocks and their location blocks.</p>
<p>In case of multiple directives in different contexts, the derived overwrites the base&rsquo;s directive.</p>





<table class="table table-bordered table-striped table-responsive table-sm table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Config</th>
          <th style="text-align: left">Expected</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Http block: directive is <strong>on</strong> <br> Server block: none is written <br> Location-1 block: none is written <br> Location-2 block: none is written</td>
          <td style="text-align: left">VS1: the server block <br> VS2: location-1 block <br> VS3: location-2 block</td>
      </tr>
      <tr>
          <td style="text-align: left">Server block: directive is <strong>on</strong> <br> Location-1 block: directive is <strong>off</strong> <br> Location-2 block: none is written</td>
          <td style="text-align: left">VS1: the server block <br> VS2: location-2 block</td>
      </tr>
      <tr>
          <td style="text-align: left">Http block: directive is <strong>on</strong> <br> Server block: directive is <strong>off</strong> <br> Location-1 block: directive is <strong>on</strong> <br> Location-2 block: none is written</td>
          <td style="text-align: left">VS1: location-1 block</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-bordered table-striped table-responsive table-sm narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Config</th>
          <th style="text-align: left">Expected</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Http block: directive is <strong>on</strong> <br> Server block: none is written <br> Location-1 block: none is written <br> Location-2 block: none is written</td>
          <td style="text-align: left">VS1: the server block <br> VS2: location-1 block <br> VS3: location-2 block</td>
      </tr>
      <tr>
          <td style="text-align: left">Server block: directive is <strong>on</strong> <br> Location-1 block: directive is <strong>off</strong> <br> Location-2 block: none is written</td>
          <td style="text-align: left">VS1: the server block <br> VS2: location-2 block</td>
      </tr>
      <tr>
          <td style="text-align: left">Http block: directive is <strong>on</strong> <br> Server block: directive is <strong>off</strong> <br> Location-1 block: directive is <strong>on</strong> <br> Location-2 block: none is written</td>
          <td style="text-align: left">VS1: location-1 block</td>
      </tr>
  </tbody>
</table>

</div>
<p><strong>Example:</strong></p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50551498&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f50551498">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_enable</span> <span class="no">on</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_enable</span> <span class="no">on</span><span class="p">;</span></span></span></code></pre></div>
</div><h3 
id="policy-directive-app_protect_dos_policy_file">Policy directive (<code>app_protect_dos_policy_file</code>)  <a class="headerlink float-right" href="#policy-directive-app_protect_dos_policy_file" title="Policy directive (app_protect_dos_policy_file)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>This is the path to the JSON policy file which includes the product&rsquo;s configuration parameters. It can be written in the following contexts: <code>location/server/http</code>.</p>
<p>The directive is optional. If not inserted then default path will be used, which is <code>/etc/app_protect_dos/BADOSDefaultPolicy.json</code>.</p>
<p>If the configuration file doesn&rsquo;t exist or its attributes are invalid, default values will be used.</p>
<p><code>BADOSDefaultPolicy.json</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50588b50&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f50588b50">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;mitigation_mode&#34;</span><span class="p">:</span> <span class="s2">&#34;standard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="s2">&#34;on&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;bad_actors&#34;</span><span class="p">:</span> <span class="s2">&#34;on&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;automation_tools_detection&#34;</span><span class="p">:</span> <span class="s2">&#34;on&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tls_fingerprint&#34;</span> <span class="p">:</span> <span class="s2">&#34;on&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;mitigation_mode&#34;</span><span class="p">:</span> <span class="s2">&#34;standard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="s2">&#34;on&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;bad_actors&#34;</span><span class="p">:</span> <span class="s2">&#34;on&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;automation_tools_detection&#34;</span><span class="p">:</span> <span class="s2">&#34;on&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tls_fingerprint&#34;</span> <span class="p">:</span> <span class="s2">&#34;on&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>




<table class="table table-bordered table-striped table-responsive table-sm table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Parameter name</th>
          <th style="text-align: left">Values</th>
          <th style="text-align: left">Default</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">mitigation_mode</td>
          <td style="text-align: left">standard / conservative / none</td>
          <td style="text-align: left">standard</td>
          <td style="text-align: left"><strong>Standard</strong> - module allowed to use global rate mitigation <br> <strong>Conservative</strong> - module is not allowed to use global rate but only Signatures/Bad Actors mitigation <br> <strong>None</strong> - module is not allowed to mitigate. Only to learn and report.</td>
      </tr>
      <tr>
          <td style="text-align: left">signatures</td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">on</td>
          <td style="text-align: left">Enable Signatures mechanism</td>
      </tr>
      <tr>
          <td style="text-align: left">bad_actors</td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">on</td>
          <td style="text-align: left">Enable Bad Actors mechanism</td>
      </tr>
      <tr>
          <td style="text-align: left">automation_tools_detection</td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">on</td>
          <td style="text-align: left">Enable the usage of automation tools detection (via cookies and redirect)</td>
      </tr>
      <tr>
          <td style="text-align: left">tls_fingerprint</td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">on</td>
          <td style="text-align: left">Enable source identification using TLS fingerprinting</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-bordered table-striped table-responsive table-sm narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Parameter name</th>
          <th style="text-align: left">Values</th>
          <th style="text-align: left">Default</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">mitigation_mode</td>
          <td style="text-align: left">standard / conservative / none</td>
          <td style="text-align: left">standard</td>
          <td style="text-align: left"><strong>Standard</strong> - module allowed to use global rate mitigation <br> <strong>Conservative</strong> - module is not allowed to use global rate but only Signatures/Bad Actors mitigation <br> <strong>None</strong> - module is not allowed to mitigate. Only to learn and report.</td>
      </tr>
      <tr>
          <td style="text-align: left">signatures</td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">on</td>
          <td style="text-align: left">Enable Signatures mechanism</td>
      </tr>
      <tr>
          <td style="text-align: left">bad_actors</td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">on</td>
          <td style="text-align: left">Enable Bad Actors mechanism</td>
      </tr>
      <tr>
          <td style="text-align: left">automation_tools_detection</td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">on</td>
          <td style="text-align: left">Enable the usage of automation tools detection (via cookies and redirect)</td>
      </tr>
      <tr>
          <td style="text-align: left">tls_fingerprint</td>
          <td style="text-align: left">[on|off]</td>
          <td style="text-align: left">on</td>
          <td style="text-align: left">Enable source identification using TLS fingerprinting</td>
      </tr>
  </tbody>
</table>

</div>





<table class="table table-bordered table-striped table-responsive table-sm table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Scenario</th>
          <th style="text-align: left">Result</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Directive is not written</td>
          <td style="text-align: left">Default path is used: &ldquo;/etc/app_protect_dos/BADOSDefaultPolicy.json&rdquo;</td>
      </tr>
      <tr>
          <td style="text-align: left">Directive is written</td>
          <td style="text-align: left">Path from the directive is used</td>
      </tr>
      <tr>
          <td style="text-align: left">File not found / file syntax is invalid</td>
          <td style="text-align: left">Default values are used</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-bordered table-striped table-responsive table-sm narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Scenario</th>
          <th style="text-align: left">Result</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Directive is not written</td>
          <td style="text-align: left">Default path is used: &ldquo;/etc/app_protect_dos/BADOSDefaultPolicy.json&rdquo;</td>
      </tr>
      <tr>
          <td style="text-align: left">Directive is written</td>
          <td style="text-align: left">Path from the directive is used</td>
      </tr>
      <tr>
          <td style="text-align: left">File not found / file syntax is invalid</td>
          <td style="text-align: left">Default values are used</td>
      </tr>
  </tbody>
</table>

</div>
<p><strong>Example:</strong></p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f5059e310&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f5059e310">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_policy_file</span> <span class="s">/etc/app_protect_dos/BADOSPolicy.json</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_policy_file</span> <span class="s">/etc/app_protect_dos/BADOSPolicy.json</span><span class="p">;</span></span></span></code></pre></div>
</div><h3 
id="service-name-directive-app_protect_dos_name">Service Name directive (<code>app_protect_dos_name</code>)  <a class="headerlink float-right" href="#service-name-directive-app_protect_dos_name" title="Service Name directive (app_protect_dos_name)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>This is the Protected Object (VS) name, which should be unique and is used to identify the Protected Object in the logs.<br>
It can be utilized within <code>location</code>, <code>server</code>, and <code>http</code> blocks.<br>
<br>
Directive is optional. If not written, then each protected object (VS) will have an auto-generated name according to the following syntax:</p>
<p><code>line_number-server_name:seq-location_name</code></p>
<p><strong>For example:</strong>
<code>30-backend:1-/abc</code></p>
<ul>
<li><code>line number:</code> the line number of the server block (<code>server {</code>) in the <code>nginx.conf</code> file (i.e. <code>30</code>)<br></li>
<li><code>server name:</code> taken from directive <code>server_name</code> (i.e. <code>backend</code>) <br>
seq: 0 for server block, increments for each location block. i.e. VS created from server block will have 0 and VS&rsquo;s from location blocks will be 1,2,3,&hellip; (i.e. <code>1</code>)</li>
<li><code>location name:</code> the name of the location (i.e. <code>/abc</code>)</li>
</ul>
<p>NGINX App Protect DoS supports up to 300 Protected Objects for versions up to 4.3, and 1,000 Protected Objects in version 4.4 and above.<br>
<br>
<strong>Example:</strong></p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f505e2100&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f505e2100">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_name</span> <span class="s">po-example</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_name</span> <span class="s">po-example</span><span class="p">;</span></span></span></code></pre></div>
</div><h3 
id="monitor-directive-app_protect_dos_monitor">Monitor directive (<code>app_protect_dos_monitor</code>)  <a class="headerlink float-right" href="#monitor-directive-app_protect_dos_monitor" title="Monitor directive (app_protect_dos_monitor)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The <code>app_protect_dos_monitor</code> directive is used to monitor the stress level of the Protected Object.<br>
Requests for this monitoring are sent from localhost (127.0.0.1) and pass through the NGINX configuration to simulate regular client traffic.<br>
This directive is mandatory, except when using the <code>http1</code> protocol, where it is still strongly recommended for optimal performance.<br></p>
<p><strong>Syntax:</strong><br>
app_protect_dos_monitor uri=path [protocol=http1|http2|grpc|websocket] [timeout=number] [proxy_protocol=on|off];</p>
<p><strong>Arguments</strong><br>
Monitor directive has four arguments - <strong>uri</strong>, <strong>protocol</strong>, <strong>timeout</strong> and <strong>proxy_protocol</strong>. The first is mandatory and the rest are optional.</p>
<ul>
<li>
<p><strong>URI</strong> - The URI of the Protected Object as defined in the <code>nginx.conf</code>. This must point to a location block that proxies traffic to the backend (upstream) to ensure accurate monitoring.<br>
Format: <strong>scheme://server_name:port/location</strong>.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> For gRPC, the URI must specify a valid gRPC method (for example, /RouteGuide/GetFeature).<br>
The health check is not a true gRPC client, so its requests do not conform to the gRPC wire protocol. As a result, the backend responds with grpc-status: 12 (UNIMPLEMENTED), which is expected and treated as a successful health check. Regular gRPC client traffic is unaffected by this behavior.</div>
</blockquote>

</li>
<li>
<p><strong>Protocol</strong> -  determines the protocol type of the service. Options are <code>http1 / http2 / grpc / websocket</code>.<br>Default: <code>http1</code>.<br></p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> HTTP2 and gRPC are supported from NGINX App Protect DoS v2, while WebSocket is supported from NGINX App Protect DoS v4.</div>
</blockquote>

</li>
<li>
<p><strong>Timeout</strong> - determines how long (in seconds) should NGINX App Protect DoS wait for a response. <br>Default: 10 seconds for <code>http1/http2/websocket</code> and 5 seconds for <code>grpc</code>.<br></p>
</li>
<li>
<p><strong>Proxy Protocol</strong> -  Should be used when the listen directive of the corresponding server block contains the proxy_protocol parameter.
It adds an HAProxy PROXY protocol header to the monitor request.
<br>Format is <strong>proxy_protocol | proxy_protocol=on</strong>.<br>
Default: off.<br></p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> The proxy_protocol is supported from NGINX App Protect DoS v3.1.</div>
</blockquote>

</li>
</ul>
<h4 
id="for-older-versions-nginx-app-protect-dos-v1">For Older Versions (NGINX App Protect DoS v1)  <a class="headerlink float-right" href="#for-older-versions-nginx-app-protect-dos-v1" title="For Older Versions (NGINX App Protect DoS v1)"><i class="fas fa-link fa-xs"></i></a>
</h4><p>In NGINX App Protect DoS v1, the app_protect_dos_monitor directive has only one argument: uri.
Only HTTP1 is supported.</p>
<p><br><br>
<strong>Examples:</strong></p>
<ol>
<li>HTTP/1 on Port 80:</li>
</ol>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f5061ca80&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f5061ca80">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">serv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=http://serv:80/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">serv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=http://serv:80/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> For NGINX App Protect DoS v1, use: app_protect_dos_monitor <a href="http://serv:80/" target="_blank" rel="noopener">http://serv:80/</a>;</div>
</blockquote>

<ol start="2">
<li>HTTP/2 Over SSL</li>
</ol>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f5068c790&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f5068c790">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">443</span> <span class="s">http2</span> <span class="s">reuseport</span> <span class="s">ssl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">serv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=https://serv:443/</span> <span class="s">protocol=http2</span> <span class="s">timeout=5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">443</span> <span class="s">http2</span> <span class="s">reuseport</span> <span class="s">ssl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">serv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=https://serv:443/</span> <span class="s">protocol=http2</span> <span class="s">timeout=5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><ol start="3">
<li>gRPC Service on Port 50051</li>
</ol>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f507663f0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f507663f0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">50051</span> <span class="s">http2</span> <span class="s">reuseport</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">my_grpc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/routeguide.</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1"># Note: The URI must include a valid gRPC method (for example, /routeguide.RouteGuide/GetFeature).
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1"># The health check will expect a grpc-status of 12 (UNIMPLEMENTED) because it is not a true gRPC client.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=http://my_grpc:50051/routeguide.RouteGuide/GetFeature</span> <span class="s">protocol=grpc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">50051</span> <span class="s">http2</span> <span class="s">reuseport</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">my_grpc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/routeguide.</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1"># Note: The URI must include a valid gRPC method (for example, /routeguide.RouteGuide/GetFeature).
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1"># The health check will expect a grpc-status of 12 (UNIMPLEMENTED) because it is not a true gRPC client.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=http://my_grpc:50051/routeguide.RouteGuide/GetFeature</span> <span class="s">protocol=grpc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><ol start="4">
<li>Server with Proxy Protocol</li>
</ol>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f507e9980&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f507e9980">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">443</span> <span class="s">ssl</span> <span class="s">http2</span> <span class="s">proxy_protocol</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">serv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1"># Note: Use proxy_protocol=on if the listen directive includes the &#34;proxy_protocol&#34; parameter.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=https://serv:443/</span> <span class="s">protocol=http2</span> <span class="s">timeout=5</span> <span class="s">proxy_protocol=on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/abc</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=https://serv:443/abc</span> <span class="s">protocol=http2</span> <span class="s">timeout=5</span> <span class="s">proxy_protocol</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">443</span> <span class="s">ssl</span> <span class="s">http2</span> <span class="s">proxy_protocol</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">serv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1"># Note: Use proxy_protocol=on if the listen directive includes the &#34;proxy_protocol&#34; parameter.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=https://serv:443/</span> <span class="s">protocol=http2</span> <span class="s">timeout=5</span> <span class="s">proxy_protocol=on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/abc</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=https://serv:443/abc</span> <span class="s">protocol=http2</span> <span class="s">timeout=5</span> <span class="s">proxy_protocol</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><ol start="5">
<li>WebSocket service</li>
</ol>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50888c60&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f50888c60">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">wsserv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/app/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># WebSocket configuration required by NGINX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_set_header</span> <span class="s">Upgrade</span> <span class="nv">$http_upgrade</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_set_header</span> <span class="s">Connection</span> <span class="s">&#34;Upgrade&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=http://wsserv:80/app/</span> <span class="s">protocol=websocket</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">server_name</span> <span class="s">wsserv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/app/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># WebSocket configuration required by NGINX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_set_header</span> <span class="s">Upgrade</span> <span class="nv">$http_upgrade</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_set_header</span> <span class="s">Connection</span> <span class="s">&#34;Upgrade&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Protected Object is defined here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_dos_monitor</span> <span class="s">uri=http://wsserv:80/app/</span> <span class="s">protocol=websocket</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h3 
id="security-log-enable-directive-app_protect_dos_security_log_enable">Security log enable directive (<code>app_protect_dos_security_log_enable</code>)  <a class="headerlink float-right" href="#security-log-enable-directive-app_protect_dos_security_log_enable" title="Security log enable directive (app_protect_dos_security_log_enable)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Enable/Disable App Protect DoS security logger. It can be used in <code>location/server/http</code> blocks.</p>
<p>Directive is optional. If not written, then logger is disabled.</p>
<p><br><strong>Example:</strong></p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f508c8018&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f508c8018">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_security_log_enable</span> <span class="no">on</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_security_log_enable</span> <span class="no">on</span><span class="p">;</span></span></span></code></pre></div>
</div><h3 
id="security-log-directive-app_protect_dos_security_log">Security log directive (<code>app_protect_dos_security_log</code>)  <a class="headerlink float-right" href="#security-log-directive-app_protect_dos_security_log" title="Security log directive (app_protect_dos_security_log)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>This directive has two string arguments.</p>
<p>First argument is the configuration file path, i.e. <code>/etc/app_protect_dos/log-default.json</code>.</p>
<p>Second argument is the destination (the location which the events will be sent to). The destination can be one of three options:</p>
<ul>
<li><code>syslog:server={ip}:{port}</code>, i.e. <code>syslog:server=1.2.3.4:3000</code></li>
<li><code>stderr</code> (<strong>default</strong>)</li>
<li><code>{absolute_file_path}</code>, i.e. <code>/shared/dos_sec_logger.log</code></li>
</ul>
<p>Implemented according to: <a href="http://localhost:1313/nginx-app-protect-dos/monitoring/security-log/">NGINX App Protect DoS Security Log</a></p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> <ul>
<li>When using stderr, make sure that the process <code>admd</code> is not redirecting the stderr output to file.</li>
<li>When using the Docker <code>entrypoint.sh</code> startup script from the admin guide, make sure that it doesn’t redirect stderr.</li>
</ul>
</div>
</blockquote>

<p><strong>Examples:</strong></p>
<ul>
<li><strong>Syslog:</strong></li>
</ul>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f508ef118&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f508ef118">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_security_log</span> <span class="s">&#34;/etc/app_protect_dos/log-default.json&#34;</span> <span class="s">syslog:server=1.2.3.4:5000</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_security_log</span> <span class="s">&#34;/etc/app_protect_dos/log-default.json&#34;</span> <span class="s">syslog:server=1.2.3.4:5000</span><span class="p">;</span></span></span></code></pre></div>
</div><ul>
<li><strong>File:</strong></li>
</ul>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50908758&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f50908758">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_security_log</span> <span class="s">&#34;/etc/app_protect_dos/log-default.json&#34;</span> <span class="s">/shared/logger.log</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_security_log</span> <span class="s">&#34;/etc/app_protect_dos/log-default.json&#34;</span> <span class="s">/shared/logger.log</span><span class="p">;</span></span></span></code></pre></div>
</div><ul>
<li><strong>Stderr:</strong></li>
</ul>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50920628&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f50920628">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_security_log</span> <span class="s">&#34;/etc/app_protect_dos/log-default.json&#34;</span> <span class="s">stderr</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_security_log</span> <span class="s">&#34;/etc/app_protect_dos/log-default.json&#34;</span> <span class="s">stderr</span><span class="p">;</span></span></span></code></pre></div>
</div><p>While <code>/etc/app_protect_dos/log-default.json</code> is:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f5094c930&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f5094c930">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;traffic-mitigation-stats&#34;</span><span class="p">:</span> <span class="s2">&#34;all&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bad-actors&#34;</span><span class="p">:</span> <span class="s2">&#34;top 10&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;attack-signatures&#34;</span><span class="p">:</span> <span class="s2">&#34;top 10&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;traffic-mitigation-stats&#34;</span><span class="p">:</span> <span class="s2">&#34;all&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bad-actors&#34;</span><span class="p">:</span> <span class="s2">&#34;top 10&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;attack-signatures&#34;</span><span class="p">:</span> <span class="s2">&#34;top 10&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h3 
id="liveness-probe-directive-app_protect_dos_liveness">Liveness probe directive (<code>app_protect_dos_liveness</code>)  <a class="headerlink float-right" href="#liveness-probe-directive-app_protect_dos_liveness" title="Liveness probe directive (app_protect_dos_liveness)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>This directive has 3 arguments.</p>





<table class="table table-bordered table-striped table-sm table-v1">
  <thead>
      <tr>
          <th style="text-align: left">First argument</th>
          <th style="text-align: left">Second argument</th>
          <th style="text-align: left">Third argument</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">[on|off] depending if this feature should be enabled or disabled.</td>
          <td style="text-align: left">URI Syntax is: <code>uri:___</code></td>
          <td style="text-align: left">Port Syntax is: <code>port:____</code></td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-bordered table-striped table-sm narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">First argument</th>
          <th style="text-align: left">Second argument</th>
          <th style="text-align: left">Third argument</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">[on|off] depending if this feature should be enabled or disabled.</td>
          <td style="text-align: left">URI Syntax is: <code>uri:___</code></td>
          <td style="text-align: left">Port Syntax is: <code>port:____</code></td>
      </tr>
  </tbody>
</table>

</div>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Second and Third arguments are optional; if one or more is not written, the default will take place.</div>
</blockquote>

<p>If liveness is enabled, a request with URI and PORT that matches the probe configuration (i.e. <code>/app_protect_dos_liveness:8090</code>) will be answered with RC 200 &ldquo;Alive&rdquo; by our NGINX module, without being counted or pass to other handlers nor the backend server.</p>
<p>Any other response will indicate that our NGINX module (NGINX App Protect DoS) has not received the request (possibly means that NGINX is down).</p>
<p><strong>Example:</strong></p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f5096d888&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f5096d888">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_liveness</span> <span class="no">on</span> <span class="s">uri:/liveness</span> <span class="n">port</span><span class="p">:</span><span class="mi">8090</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_liveness</span> <span class="no">on</span> <span class="s">uri:/liveness</span> <span class="n">port</span><span class="p">:</span><span class="mi">8090</span><span class="p">;</span></span></span></code></pre></div>
</div><h3 
id="readiness-probe-directive-app_protect_dos_readiness">Readiness probe directive (<code>app_protect_dos_readiness</code>)  <a class="headerlink float-right" href="#readiness-probe-directive-app_protect_dos_readiness" title="Readiness probe directive (app_protect_dos_readiness)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>This directive has 3 arguments.</p>





<table class="table table-bordered table-striped table-sm table-v1">
  <thead>
      <tr>
          <th style="text-align: left">First argument</th>
          <th style="text-align: left">Second argument</th>
          <th style="text-align: left">Third argument</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">[on|off] depending if this feature should be enabled or disabled.</td>
          <td style="text-align: left">URI Syntax is: <code>uri:___</code></td>
          <td style="text-align: left">Port Syntax is: <code>port:____</code></td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-bordered table-striped table-sm narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">First argument</th>
          <th style="text-align: left">Second argument</th>
          <th style="text-align: left">Third argument</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">[on|off] depending if this feature should be enabled or disabled.</td>
          <td style="text-align: left">URI Syntax is: <code>uri:___</code></td>
          <td style="text-align: left">Port Syntax is: <code>port:____</code></td>
      </tr>
  </tbody>
</table>

</div>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Second and Third arguments are optional; if one or more is not written, the default will take place.</div>
</blockquote>

<p>If readiness is enabled, a request with URI and PORT that matches the probe configuration (i.e. <code>/app_protect_dos_readiness:8090</code>) will be answered with RC 200 &ldquo;Ready&rdquo; or RC 503 &ldquo;Not Ready&rdquo; by our NGINX module, without being counted or pass to other handlers nor the backend server.</p>
<p>Any other response will indicate that our NGINX module (NGINX App Protect DoS) has not received the request (possibly means that NGINX is down).</p>
<p>RC 200 &ldquo;Ready&rdquo; will occur if two conditions are met:</p>
<ol>
<li>NGINX worker successfully connected to the global shared memory block</li>
<li>ADMD process is running (and not stuck)</li>
</ol>
<p><strong>Example:</strong></p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50995540&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f50995540">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_readiness</span> <span class="no">on</span> <span class="s">uri:/readiness</span> <span class="n">port</span><span class="p">:</span><span class="mi">8090</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_readiness</span> <span class="no">on</span> <span class="s">uri:/readiness</span> <span class="n">port</span><span class="p">:</span><span class="mi">8090</span><span class="p">;</span></span></span></code></pre></div>
</div><h3 
id="arbitrator-fqdn-directive-app_protect_dos_arb_fqdn">Arbitrator FQDN directive (<code>app_protect_dos_arb_fqdn</code>)  <a class="headerlink float-right" href="#arbitrator-fqdn-directive-app_protect_dos_arb_fqdn" title="Arbitrator FQDN directive (app_protect_dos_arb_fqdn)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Arbitrator FQDN directive has one argument which is the <code>FQDN/IP</code>.</p>
<p>The argument is the FQDN to the desired Arbitrator.</p>
<p><strong>Examples:</strong></p>
<p>FQDN:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f509c1460&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f509c1460">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_arb_fqdn</span> <span class="s">svc-appprotect-dos-arb.arb.svc.cluster.local</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_arb_fqdn</span> <span class="s">svc-appprotect-dos-arb.arb.svc.cluster.local</span><span class="p">;</span></span></span></code></pre></div>
</div><p>IP address:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f509f0e18&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f509f0e18">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_arb_fqdn</span> <span class="mi">192</span><span class="s">.168.1.10</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_arb_fqdn</span> <span class="mi">192</span><span class="s">.168.1.10</span><span class="p">;</span></span></span></code></pre></div>
</div><h3 
id="api-directive-app_protect_dos_api">API directive (<code>app_protect_dos_api</code>)  <a class="headerlink float-right" href="#api-directive-app_protect_dos_api" title="API directive (app_protect_dos_api)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>This directive is used to enable the App Protect DoS monitoring capability via REST API.<br>
The REST API interface provides extended metrics information of the Protected Objects.
It can be used by sending REST API requests manually or by using the App Protect DoS dashboard page.</p>
<p>For more information refer to <a href="http://localhost:1313/nginx-app-protect-dos/monitoring/live-activity-monitoring/">NGINX App Protect DoS Live Activity Monitoring</a></p>
<p><strong>Example:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50ac0668&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f50ac0668">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span> <span class="mi">192</span><span class="s">.168.1.23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kn">location</span> <span class="s">/api</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_dos_api</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">allow</span> <span class="mi">192</span><span class="s">.168.1.0/24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">deny</span>  <span class="s">all</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="p">=</span> <span class="s">/dashboard-dos.html</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">root</span>   <span class="s">/usr/share/nginx/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span> <span class="mi">192</span><span class="s">.168.1.23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kn">location</span> <span class="s">/api</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_dos_api</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">allow</span> <span class="mi">192</span><span class="s">.168.1.0/24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">deny</span>  <span class="s">all</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="p">=</span> <span class="s">/dashboard-dos.html</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">root</span>   <span class="s">/usr/share/nginx/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h3 
id="accelerated-mitigation-directive-app_protect_dos_accelerated_mitigation">Accelerated mitigation directive (<code>app_protect_dos_accelerated_mitigation</code>)  <a class="headerlink float-right" href="#accelerated-mitigation-directive-app_protect_dos_accelerated_mitigation" title="Accelerated mitigation directive (app_protect_dos_accelerated_mitigation)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>This directive is used to enable or disable App Protect DoS L4 accelerated mitigation.<br></p>
<p>syn_drop is an optional parameter; the default value is &ldquo;off&rdquo;.<br>
syn_drop=on mode is applicable for plane HTTP services or HTTPS when the <code>tls_fingerprint</code> feature is disabled. Refer to policy parameter &ldquo;tls_fingerprint&rdquo; in <a href="#policy-directive-app_protect_dos_policy_file">Policy directive</a>.
In syn_drop mode, the SYN packet of detected bad actors will be dropped.</p>
<p>syn_drop mode is recommended for the deployments of NGINX App Protect DoS at the perimeter network or behind L3 load balancer.
Using this mode when NGINX App Protect DoS is deployed behind L4/L7 load balancer may result in the load balancer’s starvation during an attack.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> <p>To use this directive you need to install the eBPF package.</p>
<p>For more information about eBPF, you can read the <a href="https://www.f5.com/company/blog/nginx/accelerating-ddos-mitigation-with-ebpf-in-f5-nginx-app-protect-dos" target="_blank" rel="noopener">Accelerating DDoS Mitigation with eBPF in F5 NGINX App Protect DoS</a> article.</p>
</div>
</blockquote>

<p><strong>Example:</strong></p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50b1a000&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f50b1a000">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_accelerated_mitigation</span> <span class="no">on</span> <span class="s">syn_drop=on</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_accelerated_mitigation</span> <span class="no">on</span> <span class="s">syn_drop=on</span><span class="p">;</span></span></span></code></pre></div>
</div><h3 
id="access-file-directive-app_protect_dos_access_file">Access File directive (<code>app_protect_dos_access_file</code>)  <a class="headerlink float-right" href="#access-file-directive-app_protect_dos_access_file" title="Access File directive (app_protect_dos_access_file)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The <code>app_protect_dos_access_file</code> directive defines an allowlist policy from a specified file.<br>
This enables specifying IP addresses or ranges that should never be blocked.<br>
The format of the file is the same as used in NGINX App Protect WAF, making it easy to reuse existing WAF policies with defined allowlist IPs.<br>
<br>
The directive is optional. If not written, then the allowlist feature is disabled.<br>
<br>
The file should include a list of IP addresses or ranges in JSON format. Both IPv4 and IPv6 addresses are supported.<br></p>
<p>IPv4 addresses are in the format &ldquo;a.b.c.d&rdquo; where each component is a decimal number in the range 0-255.<br>
IPv6 addresses are in the format &ldquo;h1:h2:h3:h4:h5:h6:h7:h8&rdquo; where each component is a hex number in the range 0x0-0xffff. Any contiguous range of zero elements can be omitted and replaced by &ldquo;::&rdquo;.<br>
IPv4 and IPv6 masks are written in the format &ldquo;IP/xxx&rdquo; (for example: /24), indicating the number of significant bits.<br>
<br>
The JSON file should include the ipAddress field for specifying IP addresses or ranges, and the blockRequests field set to &ldquo;transparent&rdquo;. The file can also include $ref to reference additional files containing more IP addresses.<br>
<br>
Additionally, a second format is supported where the mask is specified in a dedicated field <code>ipMask</code>. The mask should be written in the standard subnet notation for IPv4 and IPv6 addresses. In this format, the <code>blockRequests</code> field should have a value of &ldquo;never&rdquo; instead of &ldquo;transparent&rdquo;.<br>
<br></p>
<p><strong>Example:</strong></p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50b5c680&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f50b5c680">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_access_file</span> <span class="s">&#34;/etc/app_protect_dos/allowlist.json&#34;</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">app_protect_dos_access_file</span> <span class="s">&#34;/etc/app_protect_dos/allowlist.json&#34;</span><span class="p">;</span></span></span></code></pre></div>
</div><p><strong>Example content of /etc/app_protect_dos/allowlist.json:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50bddcd0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f50bddcd0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;policy&#34;:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">&#34;ip-address-lists&#34;:</span> <span class="s">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kn">&#34;ipAddresses&#34;:</span> <span class="s">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;1.1.1.1&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;1.1.1.1/32&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;3.3.3.0/24&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;2023::4ef3/128&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;2034::2300/120&#34;</span> <span class="err">}</span>
</span></span><span class="line"><span class="cl">                <span class="s">],</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;blockRequests&#34;:</span> <span class="s">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kn">&#34;$ref&#34;:</span> <span class="s">&#34;/etc/app_protect_dos/additional_ips.json&#34;,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;blockRequests&#34;:</span> <span class="s">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="err">}</span>
</span></span><span class="line"><span class="cl">        <span class="s">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;policy&#34;:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">&#34;ip-address-lists&#34;:</span> <span class="s">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kn">&#34;ipAddresses&#34;:</span> <span class="s">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;1.1.1.1&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;1.1.1.1/32&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;3.3.3.0/24&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;2023::4ef3/128&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;2034::2300/120&#34;</span> <span class="err">}</span>
</span></span><span class="line"><span class="cl">                <span class="s">],</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;blockRequests&#34;:</span> <span class="s">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kn">&#34;$ref&#34;:</span> <span class="s">&#34;/etc/app_protect_dos/additional_ips.json&#34;,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;blockRequests&#34;:</span> <span class="s">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="err">}</span>
</span></span><span class="line"><span class="cl">        <span class="s">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div>
</div><p><strong>Example content of /etc/app_protect_dos/additional_ips.json:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50c0de58&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f50c0de58">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;ipAddresses&#34;:</span> <span class="s">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;2.2.2.2/32&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;4.4.4.0/24&#34;</span> <span class="err">}</span>
</span></span><span class="line"><span class="cl">    <span class="s">]</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;ipAddresses&#34;:</span> <span class="s">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;2.2.2.2/32&#34;</span> <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span> <span class="kn">&#34;ipAddress&#34;:</span> <span class="s">&#34;4.4.4.0/24&#34;</span> <span class="err">}</span>
</span></span><span class="line"><span class="cl">    <span class="s">]</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div>
</div><p><strong>Example content with second format:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f50c7f6c0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f50c7f6c0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">{</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;policy&#34;:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kn">&#34;whitelist-ips&#34;:[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">&#34;ipAddress&#34;:&#34;2034::2300&#34;,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;ipMask&#34;:&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ff00&#34;,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;blockRequests&#34;:&#34;never&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">&#34;blockRequests&#34;:&#34;never&#34;,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;ipAddress&#34;:&#34;4.4.4.0&#34;,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;ipMask&#34;:&#34;255.255.255.0&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="err">}</span>
</span></span><span class="line"><span class="cl">      <span class="s">]</span>
</span></span><span class="line"><span class="cl">   <span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">{</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34;policy&#34;:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kn">&#34;whitelist-ips&#34;:[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">&#34;ipAddress&#34;:&#34;2034::2300&#34;,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;ipMask&#34;:&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ff00&#34;,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;blockRequests&#34;:&#34;never&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="err">}</span><span class="s">,</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">&#34;blockRequests&#34;:&#34;never&#34;,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;ipAddress&#34;:&#34;4.4.4.0&#34;,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;ipMask&#34;:&#34;255.255.255.0&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="err">}</span>
</span></span><span class="line"><span class="cl">      <span class="s">]</span>
</span></span><span class="line"><span class="cl">   <span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div>
</div>
        
        

        <hr>
  
        
        <div class="last-modified">
          
<div>
    <a href="https://github.com/nginx/documentation//tree/main/content/nap-dos/directives-and-policy/learn-about-directives-and-policy.md" class="" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> View source</a>
  </div>
  <div>
    <a href="https://github.com/nginx/documentation//edit/main/content/nap-dos/directives-and-policy/learn-about-directives-and-policy.md" class="" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
  </div>
  <div>
    <a href="https://github.com/nginx/documentation//issues/new?title=NGINX%20App%20Protect%20DoS%20Directives%20and%20Policy&amp;template=2-bug_report.md" class="" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create a new issue</a>
  </div>



        </div>
        

        
         
<script type='text/javascript'> 
    (function(){var g=function(e,h,f,g){ 
        this.get=function(a){
            for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){
                for(var d=c[b];" "==d.charAt(0);)
                    d=d.substring(1,d.length);
                    if(0==d.indexOf(a))
                        return d.substring(a.length,d.length)
            }
            return null
        }; 
        
        this.set=function(a,c){
            var b="",b=new Date;
            b.setTime(b.getTime()+6048E5);
            b="; expires="+b.toGMTString();
            document.cookie=a+"="+c+b+"; path=/; "
        }; 
        
        this.check=function(){
            var a=this.get(f);
            if(a)
                a=a.split(":");
            else if(100!=e)
                "v"==h&&(e=Math.random()>=e/100?0:100),
                a=[h,e,0],
                this.set(f,a.join(":"));
            else 
                return!0;
            var c=a[1];
            if(100==c)
                return!0;
            switch(a[0]){
                case "v":
                    return!1;
                case "r":
                    return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c
            }
            return!0
        }; 

        this.go=function(){
            if(this.check()){
                var a=document.createElement("script");
                a.type="text/javascript";
                a.src=g;
                document.body&&document.body.appendChild(a)
            }
        };

        this.start=function(){
            var t=this;
            "complete"!==document.readyState?window.addEventListener ?
                window.addEventListener("load",function(){t.go()},!1) : 
                window.attachEvent&&window.attachEvent("onload",function(){t.go()}):t.go()};
    }; 

    try{
        const project_id = window.location.hostname.includes("staging") ? "QSI_S_ZN_2YG73ads2zp5bN0" : "QSI_S_ZN_2QSTn2r41YlXrYk";
        const endpoint = window.location.hostname.includes("staging") ? "https://zn2yg73ads2zp5bn0-f5.siteintercept.qualtrics.com/SIE/?Q_ZID=ZN_2YG73ads2zp5bN0" : "https://zn2qstn2r41ylxryk-f5.siteintercept.qualtrics.com/SIE/?Q_ZID=ZN_2QSTn2r41YlXrYk";
        (new g(100,"r", project_id, endpoint)).start()
    }
    catch(i){}})();

    document.addEventListener("DOMContentLoaded", function () {
        document.querySelector(".qualtrics-feedback").id = window.location.hostname.includes("staging") ? "ZN_2YG73ads2zp5bN0" : "ZN_2QSTn2r41YlXrYk"
    });
</script>
<hr>
<div style="height: 60px;"></div>
<div class="qualtrics-feedback" id='ZN_2QSTn2r41YlXrYk'></div>


        
        </main>
        
          
            <div id="toc" class="col-md-3 d-none d-xl-block d-print-none nginx-toc align-top">
            <nav class="bd-links" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <h3 class="bd-toc-link">What's on This Page</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#directives-table">Directives table</a></li>
    <li><a href="#directives-info">Directives Info</a>
      <ul>
        <li><a href="#enable-directive-app_protect_dos_enable">Enable directive (<code>app_protect_dos_enable</code>)</a></li>
        <li><a href="#policy-directive-app_protect_dos_policy_file">Policy directive (<code>app_protect_dos_policy_file</code>)</a></li>
        <li><a href="#service-name-directive-app_protect_dos_name">Service Name directive (<code>app_protect_dos_name</code>)</a></li>
        <li><a href="#monitor-directive-app_protect_dos_monitor">Monitor directive (<code>app_protect_dos_monitor</code>)</a></li>
        <li><a href="#security-log-enable-directive-app_protect_dos_security_log_enable">Security log enable directive (<code>app_protect_dos_security_log_enable</code>)</a></li>
        <li><a href="#security-log-directive-app_protect_dos_security_log">Security log directive (<code>app_protect_dos_security_log</code>)</a></li>
        <li><a href="#liveness-probe-directive-app_protect_dos_liveness">Liveness probe directive (<code>app_protect_dos_liveness</code>)</a></li>
        <li><a href="#readiness-probe-directive-app_protect_dos_readiness">Readiness probe directive (<code>app_protect_dos_readiness</code>)</a></li>
        <li><a href="#arbitrator-fqdn-directive-app_protect_dos_arb_fqdn">Arbitrator FQDN directive (<code>app_protect_dos_arb_fqdn</code>)</a></li>
        <li><a href="#api-directive-app_protect_dos_api">API directive (<code>app_protect_dos_api</code>)</a></li>
        <li><a href="#accelerated-mitigation-directive-app_protect_dos_accelerated_mitigation">Accelerated mitigation directive (<code>app_protect_dos_accelerated_mitigation</code>)</a></li>
        <li><a href="#access-file-directive-app_protect_dos_access_file">Access File directive (<code>app_protect_dos_access_file</code>)</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</nav>
            </div>
          
        
        
      </div>
    </section>
  </section>
</div>




      </div>
  </section>

    <footer id="footer">
      
      <footer id="footer">
  <div class="container-fluid">
    <div class="row align-items-center">
      <div class="col-md-6 d-md-flex">
        <img class="nginx-logo-footer" src="http://localhost:1313/images/icons/NGINX-Part-of-F5-horiz-all-white-525x208@2x.png"/>
      </div>
    </div>

    
    <div class="row d-print-none d-none d-md-flex">
      <div class="col-md-3 d-none d-md-block">
        <span class="footer-head">Company</span>
        <ul class="footer-text">
          <li>
            <a
              href="https://www.f5.com/go/product/welcome-to-nginx"
              target="_blank"
              alt="Select to learn about F5 NGINX"
              >About F5 NGINX</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/company/events"
              target="_blank"
              alt="Select to learn about F5 events"
              >Events</a
            >
          </li>
        </ul>
        <br />
        <span class="footer-head">Resources</span>
        <ul class="footer-text">
          <li>
            <a
              href="https://www.f5.com/company/blog/nginx"
              target="_blank"
              alt="Select to visit the F5 NGINX blog"
              >Blog</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/go/faq/nginx-faq"
              target="_blank"
              alt="Select to visit the F5 NGINX frequently asked questions page"
              >FAQ</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/services"
              target="_blank"
              alt="Select to learn about F5 NGINX Support"
              >Professional Services</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/learn/training"
              target="_blank"
              alt="Select to learn about F5 training offerings"
              >Training</a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-3 d-none d-md-block">
        <span class="footer-head">Products</span>
        <ul class="footer-text">
          <li>
            <a
              title="F5 NGINX One"
              aria-label="F5 NGINX One"
              href="https://www.f5.com/products/nginx/one"
              >F5 NGINX One</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Plus"
              aria-label="F5 NGINX Plus"
              href="https://www.f5.com/products/nginx/nginx-plus"
              >F5 NGINX Plus</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX App Protect"
              aria-label="F5 NGINX App Protect"
              href="https://www.f5.com/products/nginx/nginx-app-protect"
              >F5 NGINX App Protect</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Instance Manager"
              aria-label="F5 NGINX Instance Manager"
              href="https://www.f5.com/products/nginx/instance-manager"
              >F5 NGINX Instance Manager</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Ingress Controller"
              aria-label="F5 NGINX Ingress Controller"
              href="https://www.f5.com/products/nginx/nginx-ingress-controller"
              >F5 NGINX Ingress Controller</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Gateway Fabric"
              aria-label="F5 NGINX Gateway Fabric"
              href="https://www.f5.com/products/nginx/nginx-gateway-fabric"
              >F5 NGINX Gateway Fabric</a
            >
          </li>
          <li>
            <a
              title="F5 NGINXaaS for Azure"
              aria-label="F5 NGINXaaS for Azure"
              href="https://www.f5.com/products/nginx/f5-nginxaas-for-azure"
              >F5 NGINXaaS for Azure</a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-3 d-none d-md-block">
        <span class="footer-head">NGINX on GitHub</span>
        <ul class="footer-text">
          <li>
            <a
              title="NGINX Open Source"
              aria-label="NGINX Open Source"
              href="https://github.com/nginx/nginx"
              ><span class="inner">NGINX Open Source</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Unit"
              aria-label="NGINX Unit"
              href="https://github.com/nginx/unit"
              ><span class="inner">NGINX Unit</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Amplify"
              aria-label="NGINX Amplify"
              href="https://github.com/nginxinc/nginx-amplify-agent"
              ><span class="inner">NGINX Amplify</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Agent"
              aria-label="NGINX Agent"
              href="https://github.com/nginx/Agent"
              ><span class="inner">NGINX Agent</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Kubernetes Ingress Controller"
              aria-label="NGINX Kubernetes Ingress Controller"
              href="https://github.com/nginxinc/kubernetes-ingress"
              ><span class="inner">NGINX Kubernetes Ingress Controller</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Gateway Fabric"
              aria-label="NGINX Gateway Fabric"
              href="https://github.com/nginxinc/nginx-gateway-fabric"
              ><span class="inner">NGINX Gateway Fabric</span></a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-2 d-none d-md-block">
        <span class="footer-head">Social</span>
        <ul class="footer-social">
          <li>
            <a
              href="https://www.facebook.com/nginxinc"
              title="facebook"
              aria-label="facebook"
              target="_blank"
              rel="noreferrer"
              ><i class="fa-brands fa-facebook" aria-hidden="true"></i>
            </a>
          </li>
          <li>
            <a
              href="https://twitter.com/nginx"
              title="X"
              aria-label="x"
              target="_blank"
              rel="noreferrer"
              ><i class="fa-brands fa-x-twitter" aria-hidden="true"></i
            ></a>
          </li>
          <li>
            <a
              href="https://www.linkedin.com/company/nginx"
              title="linkedin"
              aria-label="linkedin"
              target="_blank"
              rel="noreferrer"
              ><i class="fa-brands fa-linkedin" aria-hidden="true"></i>
            </a>
          </li>
          <li>
            <a
              href="https://www.youtube.com/user/NginxInc"
              title="youtube"
              aria-label="youtube"
              target="_blank"
              rel="noreferrer"
              alt="NGINX Youtube Channel"
              ><i class="fa-brands fa-square-youtube" aria-hidden="true"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
    
    <div class="site-info footer-text">
      <div class="text-center">
        <p>
          <a href="https://www.f5.com/"
            ><img class="f5-logo-footer" src="http://localhost:1313/images/icons/Logo_F5.svg" alt="F5 logo"></a
          >
          ©2025 F5, Inc. All rights reserved.
        </p>
        <p>
          <a
            href="https://www.f5.com/company/policies/trademarks"
            rel="noopener"
            target="_blank"
            >Trademarks</a
          >
          <a
            href="https://www.f5.com/company/policies"
            rel="noopener"
            target="_blank"
            >Policies</a
          >
          <a href="https://docs.nginx.com/ossc">Open Source Components</a>
          <a
            href="https://www.f5.com/company/policies/privacy-notice"
            rel="noopener"
            target="_blank"
            >Privacy</a
          >
          <a
            href="https://www.f5.com/company/policies/F5-California-privacy-summary"
            rel="noopener"
            target="_blank"
            >California Privacy</a
          >
          <a
            href="https://www.f5.com/company/policies/privacy-notice#no-sell"
            rel="noopener"
            target="_blank"
            >Do Not Sell My Personal Information</a
          >
          <span id="teconsent-v1"></span>
        </p>
      </div>
    </div>
    
  </div>
  
</footer>

      
    </footer>

    <footer data-mf="true" id="footer-v2" style="display:none;">
      
      <div class="footer-layout">
    <div class="footer-f5-trademark">
        <img class="f5-logo-footer" src="http://localhost:1313/images/icons/Logo_F5.svg" alt="F5 logo">
        <p>©2025 F5, Inc. All rights reserved. NGINX is a registered trademark of F5, Inc.</p>
    </div>
    <div class="footer-useful-links">
        <a
            href="https://www.f5.com/company/policies/trademarks"
            rel="noopener"
            target="_blank"
            >Trademarks
        </a>
        <a
            href="https://www.f5.com/company/policies"
            rel="noopener"
            target="_blank"
            >Policies
        </a>
        <a
            href="https://www.f5.com/company/policies/privacy-notice"
            rel="noopener"
            target="_blank"
            >Privacy
        </a>
        <a
            href="https://www.f5.com/company/policies/F5-California-privacy-summary"
            rel="noopener"
            target="_blank"
            >California Privacy
        </a>
        <a
            href="https://www.f5.com/company/policies/privacy-notice#no-sell"
            rel="noopener"
            target="_blank"
            >Do Not Sell My Personal Information
        </a>
        <span id="teconsent-v2"></span>
    </div>
</div>

      
    </footer>
  
<script src="/js/jquery-3-6-4.min.js" type="text/javascript" integrity=""></script>


<script src="/js/kube.min.a3a07cceb64989e2f0bf41653ab4d8346ba4312270eb5cc80d6afad3bf30a0ca9768aaa2559cb582e663332c541edab6a4068ef2e88b739fa425e2e870eb0aff.js" type="text/javascript" integrity="sha512-o6B8zrZJieLwv0FlOrTYNGukMSJw61zIDWr6078woMqXaKqiVZy1guZjMyxUHtq2pAaO8uiLc5&#43;kJeLocOsK/w=="></script>



<script src="/js/bootstrap.bundle.min.c15ed88f56a52190ea645094409cbce5537eaaf108972f777c840037b8aa0c508f12e70b09e345cf8af7e450a8f6ce96ae974340f8bcd316e58d707c063b6f72.js" type="text/javascript"
  integrity="sha512-wV7Yj1alIZDqZFCUQJy85VN&#43;qvEIly93fIQAN7iqDFCPEucLCeNFz4r35FCo9s6WrpdDQPi80xbljXB8Bjtvcg=="></script>



<script src="/js/code-copy.bb21b72280613039f1fabb11acc6a901c07caaee454933031066fbda6b5406fd31077a80ec913ba32261224d138bcbb4a34d27c51efae571c68d59282943b9a4.js" type="text/javascript"></script>



<script src="/js/code-copy-v2.71bcaee23ab00cb45dc944f321264e21d25bc1ec1ae76f9596286cb408ea5654b4ee016e7914cc2554b237114eeb467d39df18735311f2d28480b3ccd2feb4ad.js" type="text/javascript"></script>





<script
  type="module"
  src="https://static.cloud.coveo.com/atomic/v3.19.0/atomic.esm.js"
  integrity="sha512-VA9k6iDWhwxl8bwKUYPD63l93lGX7daV60k3yFxEt9EuEq4iWvsu5COq1mZ8OXKl0KCOFlUSDXS32Cy+YwbufQ=="
  crossorigin="anonymous">
</script>


<script class="coveo-script" src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/CoveoJsSearch.Lazy.min.js"
  integrity="sha512-HxdDBIp5snbqtu1TPkBnXLKEvN9IPz3PeZW8zT9KfsflV9Ck822XDroDlpVbfCfXeiu8C0RDVn0fdu7aGy/H1g=="
  crossorigin="anonymous"></script>

<script src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/templates/templates.js"
  integrity="sha512-CR0Yk/LIwgh1MsKqjecDp/r6F9ipKc6gA+4+E1pplT3N3r1pk+la/HaqyDiKtjOFwrwIIbIYBFrUJgPql93QHw=="
  crossorigin="anonymous"></script>






<script src="/js/coveo.min.4acfd205930e2d31230100f345e0463332eb3e3af1b4aa9a6e3131b0b2bac53566ae4d18b390066fce94c0c75d39b5e121d1291f81e5accc1a82d93da9f11b7f.js" integrity="sha512-Ss/SBZMOLTEjAQDzReBGMzLrPjrxtKqabjExsLK6xTVmrk0Ys5AGb86UwMddObXhIdEpH4HlrMwagtk9qfEbfw=="
  type="text/javascript"></script>


















<script src="/js/sidebar.min.6fed0180a23d01103c68ffb054a183fba5e7ba673de8c56d85857af964dcc0c11623ee09f6185207a373127cb2547ff9247ae3516ed47c67e1b58dbe71e9d576.js" type="text/javascript" integrity="sha512-b&#43;0BgKI9ARA8aP&#43;wVKGD&#43;6Xnumc96MVthYV6&#43;WTcwMEWI&#43;4J9hhSB6NzEnyyVH/5JHrjUW7UfGfhtY2&#43;cenVdg=="></script>
  


<script src="/js/site-dropdown.min.3bb49b6f7d25bcd4a2b008525bb8538d84237348bf618b40970ff6eca87119d68c326ca7ba04854ad102be36495fe1d70f1cb239916555b67dd17683dc283333.js" type="text/javascript" integrity="sha512-O7Sbb30lvNSisAhSW7hTjYQjc0i/YYtAlw/27KhxGdaMMmynugSFStECvjZJX&#43;HXDxyyOZFlVbZ90XaD3CgzMw=="></script>



<script src="/js/product-selector.min.b588249327fb12c7602fa08eb618560171f54e7348d6c1bacfdbf541f5e13023493f64f78fb6d4b9014892e5e4f0aaaee95b859bb37aa53bbe8c0e27e65167d1.js" type="text/javascript" integrity="sha512-tYgkkyf7EsdgL6COthhWAXH1TnNI1sG6z9v1QfXhMCNJP2T3j7bUuQFIkuXk8Kqu6VuFm7N6pTu&#43;jA4n5lFn0Q=="></script>



<script src="/js/sidebar-v2.min.3f906631e696b2c88883bfcfc62371165359130cfd118ceb49893ae0d8760dc38177ee3bb94a61dee45023115de8445f0b9fe48f933618ef7ba7b3180a05adbd.js" type="text/javascript" integrity="sha512-P5BmMeaWssiIg7/PxiNxFlNZEwz9EYzrSYk64Nh2DcOBd&#43;47uUph3uRQIxFd6ERfC5/kj5M2GO97p7MYCgWtvQ=="></script> 
  <div id="consent_blackbar"></div>
</body>
</html>


