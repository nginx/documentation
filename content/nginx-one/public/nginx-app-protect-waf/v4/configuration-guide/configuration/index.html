<!DOCTYPE html>
<html lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>  
  <style>
    body {
       
      visibility: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
  </style>
  
  <noscript>
    <style>
       
      body {
        visibility: visible;
      }
    </style>
  </noscript>
  


  <script>

    const setTheme = (isNewTheme) => {
      localStorage.setItem("useNewTheme", `${isNewTheme}`);
      
      const v1cssIds = [
        "cssFA1",
        "cssFA2",
        "cssFA3",
        "cssBootstrap",
        "css1",
        "css2",
        "css3",
        "css4",
        "css5",
        "css6",
      ];

      v1cssIds.forEach((cssId) => {
        const element = document.getElementById(cssId);
        if (element !== null) {
          element.disabled = isNewTheme;
        }
      });

      const v2cssIds = ["css7", "css9"];
      v2cssIds.forEach((cssId) => {
        const element = document.getElementById(cssId);
        if (element !== null) {
          element.disabled = !isNewTheme;
        }
      });

      
      const v1ElementIds = ["sidebar", "footer", "toc", "api", "search-v1", "breadcrumb-v1", "list-v1"]

      v1ElementIds.forEach((elementId) => {
        const element = document.getElementById(elementId);
        if (element !== null) {
          element.style.display = isNewTheme ? "none" : "";
        }

        const trustarc = document.getElementById("teconsent-v1");
        if (trustarc) {
          trustarc.id = isNewTheme ? "teconsent-v1" : "teconsent";
        }
      });

      document.querySelectorAll(".table-v1").forEach((table) => {
        table.style.display = isNewTheme ? "none" : "";
      });

      const notMfElements = ['[data-mf="false"]'];
      notMfElements.forEach((elementId) => {
        document.querySelectorAll(elementId).forEach((element) => {
          element.style.display = isNewTheme ? "none" : "";
        });
      })

      const mfElements = ['[data-mf="true"]'];
      mfElements.forEach((elementId) => {
        document.querySelectorAll(elementId).forEach((element) => {
          element.style.display = isNewTheme ? "" : "none";

          const trustarc = document.getElementById("teconsent-v2");
          if (trustarc) {
            trustarc.id = isNewTheme ? "teconsent" : "teconsent-v2";
          }
        });
      });

      document.getElementById("body").style.visibility = "visible";
    };

    const toggleTheme = () => {
      setTheme(!(localStorage.getItem("useNewTheme") === "true"));
    };

    
    const mf = toggleTheme;
    const useNewTheme = toggleTheme;

    document.addEventListener("DOMContentLoaded", () => {
      setTheme(localStorage.getItem("useNewTheme") === "true");
    });

    function gameCode(callback) {
      let kkeys = [];
      
      const code = "38,38,40,40,37,39,37,39,66,65";
      return (event) => {
        kkeys.push(event.keyCode);
        if (kkeys.toString().indexOf(code) >= 0) {
          callback(event);
          kkeys = [];
        }
      };
    }
    const handler = gameCode(() => {
      mf();
    });
    window.addEventListener("keydown", handler);

  </script>

  

  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>NGINX App Protect WAF Configuration Guide | DEV -- docs-nginx-com</title>


<meta name="description" content="F5 NGINX App Protect WAF security features.">





<link rel="canonical" href="http://localhost:1313/nginx-app-protect-waf/v4/configuration-guide/configuration/">







<meta property="article:publisher" content="https://www.facebook.com/nginxinc" />
<meta property="og:image" content="http://localhost:1313/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta property="og:image:width" content="500" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="F5 NGINX App Protect WAF security features." />
<meta name="twitter:title" content="NGINX App Protect WAF Configuration Guide" />
<meta name="twitter:site" content="@nginx" />
<meta name="twitter:image" content="http://localhost:1313/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta name="twitter:creator" content="@nginx" />

<meta http-equiv="last-modified" content="20/05/2025" />




<meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline'
    https://consent.trustarc.com/ https://mktg.tags.f5.com/basic/prod/utag.sync.js https://static.cloud.coveo.com/ https://*.f5.com/
    https://*.netlify.app https://gist.github.com
    https://tag.demandbase.com/pscSDsz4.min.js
    https://munchkin.brightfunnel.com/js/build/bf-munchkin.min.js
    https://www.googletagmanager.com/gtm.js
    https://www.google-analytics.com/
    https://www.google-analytics.com/analytics.js
    https://www.google-analytics.com/plugins/ua/linkid.js
    https://cdn.bizible.com/scripts/bizible.js
    https://cdn.bizible.com/xdc.js
    https://f5networksglobalprod.122.2o7.net/
    https://f5networksnginxdocs.122.2o7.net/
    https://*.siteintercept.qualtrics.com/SIE/?Q_ZID=*
    https://siteintercept.qualtrics.com/
    ;
    worker-src 'self' blob:">



<meta property="environment" type="development" />
<meta property="buildtype" type="webdocs" />
<meta property="isServer" type="true" />


<meta name="product" content="DEV -- docs-nginx-com">
<meta name="version" content="">
<meta name="doc_type" content="Manual">
  
  <link rel="shortcut icon" type="image/x-icon" href="http://localhost:1313/images/favicon-48x48.ico">

  
  










<link href="/css/v2/style.css" integrity="" rel="stylesheet" type="text/css" id="css7"
  disabled>


<link href="/css/inter/inter.987d1be34797653eabce3627efb116c263d4045fd5badfe003ff283c5a5da435d83a3fad6bfe524e3ce3cf8a41168a30e7aa42507961257eeb275024def0f9b9.css" integrity="sha512-mH0b40eXZT6rzjYn77EWwmPUBF/Vut/gA/8oPFpdpDXYOj&#43;ta/5STjzjz4pBFoow56pCUHlhJX7rJ1Ak3vD5uQ==" rel="stylesheet" type="text/css"
  id="cssInter">


<link href="/css/v2/highlight.min.9ef7c7ad221175216abc8a5827f967bcd7c0e035bfa91180acd26a2c36d54242ae5f485986c260d70b1bbdf225ad76cdbba3179afa7e4335282cc3080a17e337.css" rel="stylesheet" type="text/css" id="css9">





<link href="/fontawesome/css/all.min.4a71f958af9b67180f1ece38b96217f8b2c9009f7fd8f90f299e508808fa4daf3ac3e7ec6f64e47267d1c955f7a419cc15c57ba103c9925f507af4825abdd6e8.css" integrity="sha512-SnH5WK&#43;bZxgPHs44uWIX&#43;LLJAJ9/2PkPKZ5QiAj6Ta86w&#43;fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" rel="stylesheet" type="text/css"
  id="cssFA1">


<link href="/fontawesome/css/v4-font-face.min.5870089ba06cf03e9721f87919eaf15c961a65e071845949ed2da58c5bfbd18a714c5dab2c155f0455ebcd2f45bfd598a5e47ae19976e7aa3a51e22914eac1b6.css" integrity="sha512-WHAIm6Bs8D6XIfh5GerxXJYaZeBxhFlJ7S2ljFv70YpxTF2rLBVfBFXrzS9Fv9WYpeR64Zl256o6UeIpFOrBtg==" rel="stylesheet" type="text/css"
  id="cssFA2">


<link href="/fontawesome/css/v5-font-face.min.81bdf1c9f8ff16b1eda613d52d868a059f16c8c6045c3d7e0a0b771622a11666cdd94b8ea62b5edb0d4b826c3a3737ec3663065fe05b56b6b871e57de73f556b.css" integrity="sha512-gb3xyfj/FrHtphPVLYaKBZ8WyMYEXD1&#43;Cgt3FiKhFmbN2UuOpite2w1Lgmw6NzfsNmMGX&#43;BbVra4ceV95z9Vaw==" rel="stylesheet" type="text/css"
  id="cssFA3">



<link href="/css/bootstrap.min.3f9320327d6304dd356ac060534cfad10938431897a3cebec2515a84aaec41fdfb73d72ba39d7b5b35523cf575b432b3864bb6889d855602faef01b4dd21a734.css" integrity="sha512-P5MgMn1jBN01asBgU0z60Qk4QxiXo86&#43;wlFahKrsQf37c9cro517WzVSPPV1tDKzhku2iJ2FVgL67wG03SGnNA==" rel="stylesheet"
  type="text/css" id="cssBootstrap">



<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.10104/0/css/CoveoFullSearch.min.css"
  integrity="sha512-9/A9yVCU4GS6/iIwTRJKnan4Hf8gDKj3anwItN9QCsU8SixaT5xkjjWsZ/iq0TWaizhtqOLacadXJfxHlwYCcA=="
  crossorigin="anonymous" />


<link
  rel="stylesheet"
  href="https://static.cloud.coveo.com/atomic/v3.19.0/themes/coveo.css"
  integrity="sha512-m2BufPi8Tc6H2jcQfDj/PIl5H57C9jeqhbDFgFXKTtOhoC4S7ULXmx74FseZ8WXpfdT9uyccMHDBJDrIZlrUUQ=="
  crossorigin="anonymous"/>


<link href="/css/docs-nginx-com/nginx-site-header.min.80b10ed49ecfad93607ee771acca88d13dc958e6eecc642af3aa2b170c86b8dcce442e7b86c3e5298c95b0ab2b053a71074c2f15c28266c3a2c502275415b3a7.css" rel="stylesheet" type="text/css" id="css1">


<link href="/css/docs-nginx-com/style.min.2cd4748c438c49d012a5fdc6b98770223c4875fe0f89517b17423b6a5328af4d93d9d772207bfc51d9449781281e1eb8707dcc2f7467e6e24330c9b8c7c5f734.css" rel="stylesheet" type="text/css" id="css2">


<link href="/css/bootstrap-docs.min.8a70c94c72e3783cecd631bc1705c7843b2fdef99f1549f0bf7f774a4083173ee25974413a8206c2340c0fee9bb7a07acd41d41c78ae2280c96a2ce0faca2847.css" rel="stylesheet" type="text/css" id="css3">



<link href="/css/coveo.min.fce7d4df31de99e4f86510a90915820f236b8dcd02be030b27529af7ff10189f807c78cedacb91afa9d07f310a172c6046b1921832f199b9158898a7f74fa117.css" rel="stylesheet" type="text/css" id="css6">



<link href="/css/f5-hugo.min.42feae8b135e9380a66db9c3cb2803221888524a29f41cbc55790b5cb5a309ac7e6dd80e70ed0260370fd93c04b7aa8a5c3d6aca0964804341fad51cfcec963f.css" rel="stylesheet" type="text/css" id="css4">


<link href="/css/inline-overrides.min.495e6889d9955581580c654bad961bb33af6344b283af7e9a34648c5e8d5f1fe90efb8aac33359c4178efd36cd7cb92c7c6458d4175caff9c284b14bd9d2b97a.css" rel="stylesheet" type="text/css" id="css8">





<link href="/css/highlight.min.fe5647c4b67f4b3fcf0ea60b483479d567ba1b05ee6e816439207edfa3d310dbee79536278c67d89c1db5da275bde962a10163da375f05bd19743e2a80e1ad02.css" rel="stylesheet" type="text/css" id="css5">
  
  
  
  
  
  
        
  <script async="async" src="https://consent.trustarc.com/notice?domain=f5.com&c=teconsent&js=nj&noticeType=bb&text=true&gtm=1" crossorigin=""></script>
  
  

<script src="https://mktg.tags.f5.com/basic/prod/utag.sync.js"></script> 


  
  
  
  
  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-K5HG9JT');</script>
  
  </head>
  
  <body id="body">
    
   
<script type="text/javascript"> 
    (function(a,b,c,d) { 
        a='//mktg.tags.f5.com/basic/prod/utag.js'; 
        b=document;c='script';d=b.createElement(c);d.src=a; 
        d.type='text/java'+c;d.async=true; 
        a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})(); 
</script> 
    
  
    <header>
      
<div class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar navbar-fixed-top">
  <div class="container-fluid flex-md-row flex-column header-container">
    <a class="navbar-brand mr-0 mr-md-2" href="/" aria-label="NGINX Docs">
      <img class="navbar-img" src="http://localhost:1313/images/icons/NGINX-Docs-horiz-white-type.svg" alt="NGINX Docs">
    </a>
    
      <div class="navbar navbar-nav">
        
        <div id="searchbox">
          
          <div class="CoveoSearchbox" data-placeholder='Search NGINX Docs...'></div>
        </div>
        <atomic-search-interface id="search-standalone-header" data-mf="true" style="display:none;">
          <atomic-search-box redirection-url="/search.html">
          </atomic-search-box>
        </atomic-search-interface>
      </div>
    
    
    
    
    <ul class="navbar navbar-nav">
        <li class="nav-item-explore active">
          <button id="navbar-sites-button" class="button navbar-button">
              F5 Sites
              <i id="navbar-sites-button-icon" class="link-chevron-icon fa-solid fa-chevron-down"></i>
          </button>
          <div class="dropdown-content" id="dropdown-content">
            <ul>
              
                <li>
                  <a href="https://community.f5.com/" target="_blank" >DevCentral</a>
                  <p>Connect &amp; learn in our hosted community</p>
                </li>
              
                <li>
                  <a href="https://my.f5.com/" target="_blank" >MyF5</a>
                  <p>Your key to everything F5, including support, registration keys, and subscriptions</p>
                </li>
              
                <li>
                  <a href="https://nginx.org/" target="_blank" >NGINX</a>
                  <p>Learn more about NGINX Open Source and read the community blog</p>
                </li>
              
            </ul>
          </div>
        </li>
    </ul>
  </div>
</div>


    </header>
  
    <section class="base-layout" data-testid="base-layout">
      <section id="breadcrumb-v1">
        
          
          <nav aria-label="breadcrumb" class="breadcrumb navbar">
    <div class="nav flex-md-row">
        <ol class="breadcrumb">
            
            
            
            
                
            
            
                
            
            
                
            
            
                
            
            
                
            
            
            
                <li><a href="/">Home</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-waf/">F5 NGINX App Protect WAF</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-waf/v4/">Version 4 and Earlier</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-waf/v4/configuration-guide/">Configuration Guides</a><i class="fas fa-chevron-right"></i></li>
                
            
                NGINX App Protect WAF Configuration Guide
        </ol>
    </div>
</nav>
  
          
        
      </section>
  
      <div class="main container-fluid min-page-height" data-menu-id="/nginx-app-protect-waf/v4/configuration-guide/configuration/">
        
<div class="docs-container row override-sidebar-collapse">
<div class="docs-container row override-sidebar-collapse">
  <nav id="sidebar" class="sidenav overflow-auto col-md-3 d-none d-xl-block d-print-none align-top">
    

<div id="sidebar-wrapper">
     <div id="sidebar" class="sidebar" aria-label="Sidebar navigation">
        <button id="sidebar-toggle-button" title="Toggle sidebar navigation" role="button" aria-controls="sidebar-content">
           <i class="fa fa-chevron-right sidebar-visible-collapsed"></i>
           <i class="fa fa-chevron-left sidebar-visible-expanded"></i>
        </button>
        <div id="sidebar-content">
            <h3>
                <a class="sidebar-title" href="http://localhost:1313/nginx-app-protect-waf/" alt="F5 NGINX App Protect WAF"><img
                        class="card-img-top" src="http://localhost:1313//images/icons/NGINX-App-Protect-WAF-product-icon.svg"
                        alt="F5 NGINX App Protect WAF">
                    F5 NGINX App Protect WAF</a>
            </h3>
            <ul>
            
            
                
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                    <a data-menu-id="/nginx-app-protect-waf/v4/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#nap-waf--version-4-and-earlier" aria-controls="nap-waf--version-4-and-earlier">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Version 4 and Earlier</a>
                            </li>
                        </div>
                        <div id="nap-waf--version-4-and-earlier" class="accordion-body collapse">
                            <div class="accordion-inner">
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v4/admin-guide/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v4--administration-guides">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Administration Guides</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v4--administration-guides" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/admin-guide/install/" href="http://localhost:1313/nginx-app-protect-waf/v4/admin-guide/install/">NGINX App Protect WAF Administration Guide</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/admin-guide/install-nms/" href="http://localhost:1313/nginx-app-protect-waf/v4/admin-guide/install-nms/">Using NGINX App Protect WAF with NGINX Management Suite</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/admin-guide/upgrade-nap-waf/" href="http://localhost:1313/nginx-app-protect-waf/v4/admin-guide/upgrade-nap-waf/">Upgrade NGINX App Protect WAF on Managed Instances</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v4/configuration-guide/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v4--configuration-guides">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Configuration Guides</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v4--configuration-guides" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/configuration-guide/configuration/" href="http://localhost:1313/nginx-app-protect-waf/v4/configuration-guide/configuration/">NGINX App Protect WAF Configuration Guide</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v4/declarative-policy/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v4--declarative-policy">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Declarative Policy</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v4--declarative-policy" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/declarative-policy/policy/" href="http://localhost:1313/nginx-app-protect-waf/v4/declarative-policy/policy/">NGINX App Protect WAF Declarative Policy</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v4/logging-overview/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v4--logging-overview">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Logging Overview</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v4--logging-overview" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/logging-overview/logs-overview/" href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/logs-overview/">NGINX App Protect WAF Logs Overview</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/logging-overview/security-log/" href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/security-log/">NGINX App Protect WAF Security Log</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/logging-overview/operation-logs/" href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/operation-logs/">NGINX App Protect WAF Operation Log</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/logging-overview/debug-logs/" href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/debug-logs/">NGINX App Protect WAF Debug Log</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/logging-overview/access-log/" href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/access-log/">NGINX App Protect WAF Access Log</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v5/troubleshooting-guide/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v4--troubleshooting-guide">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Troubleshooting Guide</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v4--troubleshooting-guide" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/troubleshooting-guide/troubleshooting/" href="http://localhost:1313/nginx-app-protect-waf/v4/troubleshooting-guide/troubleshooting/">NGINX App Protect WAF Troubleshooting Guide</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v4/releases/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v4--releases">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Releases</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v4--releases" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.14/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.14/">NGINX App Protect WAF 4.14</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.13/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.13/">NGINX App Protect WAF 4.13</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.12/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.12/">NGINX App Protect WAF 4.12</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.11/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.11/">NGINX App Protect WAF 4.11</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.10/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.10/">NGINX App Protect WAF 4.10</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.9/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.9/">NGINX App Protect WAF 4.9</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.8.1/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.8.1/">NGINX App Protect WAF 4.8.1</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.8/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.8/">NGINX App Protect WAF 4.8</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.7/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.7/">NGINX App Protect WAF 4.7</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.6/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.6/">NGINX App Protect WAF 4.6</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.5/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.5/">NGINX App Protect WAF 4.5</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.4/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.4/">NGINX App Protect WAF 4.4</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.3/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.3/">NGINX App Protect WAF 4.3</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.2/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.2/">NGINX App Protect WAF 4.2</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.1/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.1/">NGINX App Protect WAF 4.1</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-4.0/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.0/">NGINX App Protect WAF 4.0</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.12.2/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.12.2/">NGINX App Protect WAF 3.12.2</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.12/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.12/">NGINX App Protect WAF 3.12</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.11/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.11/">NGINX App Protect WAF 3.11</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.10/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.10/">NGINX App Protect WAF 3.10</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.9.1/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.9.1/">NGINX App Protect WAF 3.9.1</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.9/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.9/">NGINX App Protect WAF 3.9</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.8/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.8/">NGINX App Protect WAF 3.8</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.7/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.7/">NGINX App Protect WAF 3.7</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.6/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.6/">NGINX App Protect WAF 3.6</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.5/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.5/">NGINX App Protect WAF 3.5</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.4/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.4/">NGINX App Protect WAF 3.4</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.3/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.3/">NGINX App Protect WAF 3.3</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.2/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.2/">NGINX App Protect WAF 3.2</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.1/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.1/">NGINX App Protect WAF 3.1</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-3.0/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.0/">NGINX App Protect WAF 3.0</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-2.3/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-2.3/">NGINX App Protect WAF 2.3</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-2.2/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-2.2/">NGINX App Protect WAF 2.2</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-2.1/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-2.1/">NGINX App Protect WAF 2.1</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-2.0/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-2.0/">NGINX App Protect WAF 2.0</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-1.3/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-1.3/">NGINX App Protect WAF 1.3</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-1.2/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-1.2/">NGINX App Protect WAF 1.2</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-1.1/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-1.1/">NGINX App Protect WAF 1.1</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v4/releases/about-1.0/" href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-1.0/">NGINX App Protect WAF 1.0</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                            </div>
                        </div>
                    </div>
                </div>

                

            
                
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                    <a data-menu-id="/nginx-app-protect-waf/v5/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#nap-waf--version-5" aria-controls="nap-waf--version-5">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Version 5</a>
                            </li>
                        </div>
                        <div id="nap-waf--version-5" class="accordion-body collapse">
                            <div class="accordion-inner">
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v5/admin-guide/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v5--administration-guides">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Administration Guides</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v5--administration-guides" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/admin-guide/overview/" href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/overview/">NGINX App Protect WAF Administration Guide</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/admin-guide/install/" href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/install/">Installing NGINX App Protect WAF</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/admin-guide/deploy-with-helm/" href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/deploy-with-helm/">Deploy NGINX App Protect WAF with Helm</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/admin-guide/deploy-with-manifests/" href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/deploy-with-manifests/">Deploy NGINX App Protect WAF with Manifests</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/admin-guide/deploy-on-docker/" href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/deploy-on-docker/">Deploy NGINX App Protect WAF with Docker</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/admin-guide/compiler/" href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/compiler/">NGINX App Protect WAF Compiler</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/admin-guide/upgrade-nap-waf/" href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/upgrade-nap-waf/">Upgrade NGINX App Protect WAF on Managed Instances</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v5/configuration-guide/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v5--configuration-guides">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Configuration Guides</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v5--configuration-guides" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/configuration-guide/configuration/" href="http://localhost:1313/nginx-app-protect-waf/v5/configuration-guide/configuration/">NGINX App Protect WAF Configuration Guide</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v5/declarative-policy/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v5--declarative-policy">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Declarative Policy</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v5--declarative-policy" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/declarative-policy/policy/" href="http://localhost:1313/nginx-app-protect-waf/v5/declarative-policy/policy/">NGINX App Protect WAF Declarative Policy</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v5/logging-overview/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v5--logging-overview">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Logging Overview</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v5--logging-overview" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/logging-overview/security-log/" href="http://localhost:1313/nginx-app-protect-waf/v5/logging-overview/security-log/">NGINX App Protect WAF Security Log</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/logging-overview/access-log/" href="http://localhost:1313/nginx-app-protect-waf/v5/logging-overview/access-log/">NGINX App Protect WAF Access Log</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/logging-overview/logs-overview/" href="http://localhost:1313/nginx-app-protect-waf/v5/logging-overview/logs-overview/">NGINX App Protect WAF Logs Overview</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v5/troubleshooting-guide/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v5--troubleshooting">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Troubleshooting</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v5--troubleshooting" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/troubleshooting-guide/troubleshooting/" href="http://localhost:1313/nginx-app-protect-waf/v5/troubleshooting-guide/troubleshooting/">NGINX App Protect WAF Troubleshooting Guide</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-app-protect-waf/v5/releases/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#nap-waf--v5--releases">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Releases</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="nap-waf--v5--releases" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/releases/about-5.6/" href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.6/">NGINX App Protect WAF 5.6</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/releases/about-5.5/" href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.5/">NGINX App Protect WAF 5.5</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/releases/about-5.4/" href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.4/">NGINX App Protect WAF 5.4</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/releases/about-5.3/" href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.3/">NGINX App Protect WAF 5.3</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/releases/about-5.2/" href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.2/">NGINX App Protect WAF 5.2</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/releases/about-5.1/" href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.1/">NGINX App Protect WAF 5.1</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-app-protect-waf/v5/releases/about-5.0/" href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.0/">NGINX App Protect WAF 5.0</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                            </div>
                        </div>
                    </div>
                </div>

                

            

            </ul>
        
        </div>
    </div>
</div>

  </nav>

  
  
  <main class="content col d-block align-top content-has-toc" role="main">
  
    
  <section class="main-layout">
    <div class="sidebar-layout" id="sidebar-layout">
      <nav data-mf="true" id="sidebar-v2" class="sidebar" style="display:none;">
        


    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    





<atomic-search-interface id="search-standalone-sidebar" data-mf="true" style="display:none;">
    <atomic-search-box redirection-url="/search.html">
    </atomic-search-box>
</atomic-search-interface>
<button class="product-selector-button" id="product-selector-button">
    
    <div class="product-selector-name" id="product-selector-name">NGINX App Protect WAF</div>
    <div class="product-selector-button-icon" id="product-selector-button-icon">
        <svg width="8" height="14" viewBox="0 0 8 14" fill="none" xmlns="http://www.w3.org/2000/svg" id="product-selector-chevron-icon">
            <path d="M1 13L7 7L0.999999 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="product-selector-chevron-icon"/>
        </svg>     
    </div>
</button>
<div class="product-selector" id="product-selector">
    
    
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX ONE</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-one">NGINX One Console</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx">NGINX Plus</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-instance-manager">NGINX Instance Manager</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-ingress-controller">NGINX Ingress Controller</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-gateway-fabric">NGINX Gateway Fabric</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="https://nginx.org/en/docs/">NGINX Open Source</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/solutions/">Subscription Licensing &amp; Solutions</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-agent">NGINX Agent</a>
                </li>
            
            </ul>
        </div>
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX APP PROTECT</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-app-protect-waf">NGINX App Protect WAF</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-app-protect-dos">NGINX App Protect DoS</a>
                </li>
            
            </ul>
        </div>
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX AS A SERVICE</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginxaas/azure/">NGINX as a Service for Azure</a>
                </li>
            
            </ul>
        </div>
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX OTHER</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="https://unit.nginx.org/">NGINX Unit</a>
                </li>
            
            </ul>
        </div>
    
</div>
<div class="scrollbar-container">
    <div class="sidebar-navigation">
        <ul class="parent-collapsible-content">
        
            <li class="parent-collapsible-content-item">
                
                    <input type="checkbox" id="toggle-7f7c14e5eb8150745de8410de59a0b22" class="toggle-checkbox" style="display: none;">
                    <label for="toggle-7f7c14e5eb8150745de8410de59a0b22" class="collapsible-header">
                        
                            <span class="parent-box expand"></span>
                            <span class="parent-box opened"></span>
                        
                        Version 4 and Earlier 
                    </label>
                    

<ul class="collapsible-content">
    
    <li>
        
            <input type="checkbox" id="toggle-2d3851ebcca023e8402ffbd425902942" class="toggle-checkbox" style="display: none;">
            <label for="toggle-2d3851ebcca023e8402ffbd425902942" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Administration Guides 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/admin-guide/install/" style="">NGINX App Protect WAF Administration Guide </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/admin-guide/install-nms/" style="">Using NGINX App Protect WAF with NGINX Management Suite </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/admin-guide/upgrade-nap-waf/" style="">Upgrade NGINX App Protect WAF on Managed Instances </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-d8399080ca68c88dee77f413d6c6eb8b" class="toggle-checkbox" style="display: none;">
            <label for="toggle-d8399080ca68c88dee77f413d6c6eb8b" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Configuration Guides 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                  
                <span class="box current partial" id="current-page"></span>                 
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/configuration-guide/configuration/" style="font-weight: bold;">NGINX App Protect WAF Configuration Guide </a>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#supported-security-policy-features">Supported Security Policy Features</a>
      <ul>
        <li><a href="#disallowed-file-types">Disallowed File Types</a></li>
      </ul>
    </li>
    <li><a href="#additional-policy-features">Additional Policy Features</a></li>
    <li><a href="#attack-signatures-overview">Attack Signatures Overview</a>
      <ul>
        <li><a href="#signature-settings">Signature Settings</a></li>
        <li><a href="#signature-sets-in-default-policy">Signature Sets in Default Policy</a></li>
        <li><a href="#basic-signature-sets-included-in-app-protect">Basic Signature Sets Included in App Protect</a></li>
      </ul>
    </li>
    <li><a href="#policy-configuration">Policy Configuration</a>
      <ul>
        <li><a href="#policy-configuration-overview">Policy Configuration Overview</a></li>
        <li><a href="#basic-configuration-and-the-default-policy">Basic Configuration and the Default Policy</a></li>
        <li><a href="#the-strict-policy">The Strict Policy</a></li>
        <li><a href="#policy-authoring-and-tuning">Policy Authoring and Tuning</a></li>
        <li><a href="#anti-automation-bot-mitigation">Anti Automation (Bot Mitigation)</a></li>
        <li><a href="#signature-sets">Signature Sets</a></li>
        <li><a href="#partial-masking-of-data-using-data-guard">Partial Masking of Data using Data Guard</a></li>
        <li><a href="#detect-base64">Detect Base64</a></li>
        <li><a href="#handling-xml-and-json-content">Handling XML and JSON Content</a></li>
        <li><a href="#enforcer-cookie-settings">Enforcer Cookie Settings</a></li>
        <li><a href="#additional-configuration-options">Additional Configuration Options</a></li>
        <li><a href="#modifying-configurations">Modifying Configurations</a></li>
      </ul>
    </li>
    <li><a href="#nginx-app-protect-waf-standalone-configuration">NGINX App Protect WAF Standalone Configuration</a>
      <ul>
        <li><a href="#apreload">apreload</a></li>
        <li><a href="#apreload-events">apreload Events</a></li>
        <li><a href="#modification-to-nginxconf-file-and-app-protect-configurations">Modification to nginx.conf file and App Protect Configurations</a></li>
        <li><a href="#handling-concurrent-invocations-of-apreload">Handling Concurrent Invocations of Apreload</a></li>
        <li><a href="#limitation-on-http-header-and-xff-modification">Limitation on HTTP Header and XFF Modification</a></li>
      </ul>
    </li>
    <li><a href="#external-references">External References</a>
      <ul>
        <li><a href="#types-of-references">Types of References</a></li>
      </ul>
    </li>
    <li><a href="#openapi-specification-file-reference">OpenAPI Specification File Reference</a>
      <ul>
        <li><a href="#types-of-openapi-references">Types of OpenAPI References</a></li>
      </ul>
    </li>
    <li><a href="#grpc-protection-for-unary-traffic">gRPC Protection for Unary Traffic</a>
      <ul>
        <li><a href="#grpc-content-profiles">gRPC Content Profiles</a></li>
        <li><a href="#associating-profiles-with-urls">Associating Profiles with URLs</a></li>
        <li><a href="#grpc-response-pages">gRPC Response Pages</a></li>
        <li><a href="#detect-base64-in-string-values">Detect Base64 in String Values</a></li>
        <li><a href="#protocol-buffers-supported-version">Protocol Buffers Supported Version</a></li>
        <li><a href="#grpc-server-reflection">gRPC Server Reflection</a></li>
      </ul>
    </li>
    <li><a href="#grpc-protection-for-bidirectional-streaming">gRPC Protection for Bidirectional Streaming</a>
      <ul>
        <li><a href="#bidirectional-streaming-overview">Bidirectional Streaming Overview</a></li>
        <li><a href="#configuration">Configuration</a></li>
        <li><a href="#grpc-bidirectional-streaming-enforcement">gRPC Bidirectional Streaming Enforcement</a></li>
        <li><a href="#size-limits">Size Limits</a></li>
        <li><a href="#message-compression">Message Compression</a></li>
        <li><a href="#slow-post-attacks">Slow POST Attacks</a></li>
        <li><a href="#handling-slow-post-attacks">Handling Slow POST Attacks</a></li>
      </ul>
    </li>
    <li><a href="#other-grpc-references">Other gRPC References</a>
      <ul>
        <li><a href="#grpc-violations">gRPC Violations</a></li>
        <li><a href="#grpc-logging">gRPC Logging</a></li>
      </ul>
    </li>
    <li><a href="#securing-graphql-apis-with-nginx-app-protect-waf">Securing GraphQL APIs with NGINX App protect WAF</a>
      <ul>
        <li><a href="#graphql-overview">GraphQL Overview</a></li>
        <li><a href="#graphql-security">GraphQL Security</a></li>
      </ul>
    </li>
    <li><a href="#enabling-graphql-with-basic-configuration">Enabling GraphQL with Basic Configuration</a></li>
    <li><a href="#graphql-advanced-configuration">GraphQL Advanced Configuration</a>
      <ul>
        <li><a href="#graphql-violations">GraphQL Violations</a></li>
        <li><a href="#graphql-profile">GraphQL Profile</a></li>
        <li><a href="#define-url-settings">Define URL settings</a></li>
        <li><a href="#associating-graphql-profiles-with-url">Associating GraphQL Profiles with URL</a></li>
        <li><a href="#graphql-response-pages">GraphQL Response Pages</a></li>
      </ul>
    </li>
    <li><a href="#override-rules">Override Rules</a>
      <ul>
        <li><a href="#override-rules-overview">Override Rules Overview</a></li>
        <li><a href="#condition-syntax-usage">Condition Syntax Usage</a></li>
        <li><a href="#first-match-principle">First Match Principle</a></li>
        <li><a href="#important-things-to-remember-about-override-rules">Important Things to Remember About Override Rules</a></li>
        <li><a href="#override-rules-logging--reporting">Override Rules Logging &amp; Reporting</a></li>
        <li><a href="#errors-and-warnings">Errors and Warnings</a></li>
      </ul>
    </li>
    <li><a href="#geolocation">Geolocation</a>
      <ul>
        <li><a href="#overview-1">Overview</a></li>
        <li><a href="#disallowing-application-use-in-certain-geolocations">Disallowing Application Use in Certain Geolocations</a></li>
        <li><a href="#geolocation-in-policy-override-rules-conditions">Geolocation in Policy Override Rules Conditions</a></li>
      </ul>
    </li>
    <li><a href="#json-web-token-protection">JSON Web Token Protection</a>
      <ul>
        <li><a href="#overview-2">Overview</a></li>
        <li><a href="#configuring-nginx-app-protect-waf-to-authenticate-json-web-token">Configuring NGINX App Protect WAF to Authenticate JSON Web Token</a></li>
        <li><a href="#authorization-rules-in-urls">Authorization Rules in URLs</a></li>
        <li><a href="#attack-signatures">Attack Signatures</a></li>
        <li><a href="#json-web-token-violations">JSON Web Token Violations</a></li>
        <li><a href="#violation-rating-calculation">Violation Rating Calculation</a></li>
        <li><a href="#other-references">Other References</a></li>
      </ul>
    </li>
    <li><a href="#brute-force-attack-preventions">Brute Force Attack Preventions</a>
      <ul>
        <li><a href="#overview-3">Overview</a></li>
        <li><a href="#login-page-policy-example">Login page policy example</a></li>
        <li><a href="#brute-force-policy-example">Brute force policy example</a></li>
      </ul>
    </li>
    <li><a href="#custom-dimensions-log-entries">Custom Dimensions Log Entries</a>
      <ul>
        <li><a href="#overview-4">Overview</a></li>
        <li><a href="#configuration-1">Configuration</a></li>
        <li><a href="#things-to-remember-while-configuring-the-custom-dimensions-log-entries">Things to Remember While Configuring the Custom Dimensions Log Entries</a></li>
        <li><a href="#errors-and-warnings-1">Errors and Warnings</a></li>
        <li><a href="#logging-and-reporting">Logging and Reporting</a></li>
      </ul>
    </li>
    <li><a href="#time-based-signature-staging">Time-Based Signature Staging</a>
      <ul>
        <li><a href="#latest-signature-certification-time">Latest Signature Certification Time</a></li>
        <li><a href="#new-policy">New Policy</a></li>
        <li><a href="#signature-update">Signature Update</a></li>
        <li><a href="#configuration-2">Configuration</a></li>
        <li><a href="#enforcing-the-modified-signatures-after-testing-them">Enforcing the Modified Signatures After Testing Them</a></li>
        <li><a href="#logging-and-reporting-1">Logging and Reporting</a></li>
      </ul>
    </li>
    <li><a href="#directives">Directives</a>
      <ul>
        <li><a href="#global-directives">Global Directives</a></li>
        <li><a href="#app-protect-specific-directives">App Protect Specific Directives</a></li>
      </ul>
    </li>
    <li><a href="#violations">Violations</a>
      <ul>
        <li><a href="#supported-violations">Supported Violations</a></li>
        <li><a href="#http-compliance-sub-violations">HTTP Compliance Sub-Violations</a></li>
        <li><a href="#evasion-techniques-sub-violations">Evasion Techniques Sub-Violations</a></li>
      </ul>
    </li>
    <li><a href="#attack-types">Attack Types</a></li>
    <li><a href="#converter-tools">Converter Tools</a>
      <ul>
        <li><a href="#policy-converter">Policy Converter</a></li>
        <li><a href="#user-defined-signatures-converter">User Defined Signatures Converter</a></li>
      </ul>
    </li>
    <li><a href="#attack-signature-report-tool">Attack Signature Report Tool</a></li>
    <li><a href="#security-logs">Security Logs</a></li>
    <li><a href="#nginx-app-protect-waf-terminology">NGINX App Protect WAF Terminology</a></li>
    <li><a href="#interaction-with-nginx-features">Interaction with NGINX Features</a>
      <ul>
        <li><a href="#configure-static-location">Configure Static Location</a></li>
        <li><a href="#configure-ranges">Configure Ranges</a></li>
        <li><a href="#configure-slice">Configure Slice</a></li>
        <li><a href="#configure-nginx-mirror">Configure NGINX mirror</a></li>
        <li><a href="#configure-njs">Configure njs</a></li>
        <li><a href="#configure-client-authorization">Configure Client Authorization</a></li>
        <li><a href="#unsupported-configuration">Unsupported Configuration</a></li>
      </ul>
    </li>
  </ul>
</nav>
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-f2ecd5f5767c08c757f1f5db3fc8034e" class="toggle-checkbox" style="display: none;">
            <label for="toggle-f2ecd5f5767c08c757f1f5db3fc8034e" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Declarative Policy 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/declarative-policy/policy/" style="">NGINX App Protect WAF Declarative Policy </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-a84be0ddf4e66485eba4d708591c4721" class="toggle-checkbox" style="display: none;">
            <label for="toggle-a84be0ddf4e66485eba4d708591c4721" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Logging Overview 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/logs-overview/" style="">NGINX App Protect WAF Logs Overview </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/security-log/" style="">NGINX App Protect WAF Security Log </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/operation-logs/" style="">NGINX App Protect WAF Operation Log </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/debug-logs/" style="">NGINX App Protect WAF Debug Log </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/access-log/" style="">NGINX App Protect WAF Access Log </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-785457d0d85be3768066ec502a32c93e" class="toggle-checkbox" style="display: none;">
            <label for="toggle-785457d0d85be3768066ec502a32c93e" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Troubleshooting Guide 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/troubleshooting-guide/troubleshooting/" style="">NGINX App Protect WAF Troubleshooting Guide </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-32e6e6a300adaf7bc875f71de9e14393" class="toggle-checkbox" style="display: none;">
            <label for="toggle-32e6e6a300adaf7bc875f71de9e14393" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Releases 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.14/" style="">NGINX App Protect WAF 4.14 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.13/" style="">NGINX App Protect WAF 4.13 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.12/" style="">NGINX App Protect WAF 4.12 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.11/" style="">NGINX App Protect WAF 4.11 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.10/" style="">NGINX App Protect WAF 4.10 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.9/" style="">NGINX App Protect WAF 4.9 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.8.1/" style="">NGINX App Protect WAF 4.8.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.8/" style="">NGINX App Protect WAF 4.8 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.7/" style="">NGINX App Protect WAF 4.7 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.6/" style="">NGINX App Protect WAF 4.6 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.5/" style="">NGINX App Protect WAF 4.5 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.4/" style="">NGINX App Protect WAF 4.4 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.3/" style="">NGINX App Protect WAF 4.3 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.2/" style="">NGINX App Protect WAF 4.2 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.1/" style="">NGINX App Protect WAF 4.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-4.0/" style="">NGINX App Protect WAF 4.0 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.12.2/" style="">NGINX App Protect WAF 3.12.2 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.12/" style="">NGINX App Protect WAF 3.12 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.11/" style="">NGINX App Protect WAF 3.11 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.10/" style="">NGINX App Protect WAF 3.10 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.9.1/" style="">NGINX App Protect WAF 3.9.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.9/" style="">NGINX App Protect WAF 3.9 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.8/" style="">NGINX App Protect WAF 3.8 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.7/" style="">NGINX App Protect WAF 3.7 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.6/" style="">NGINX App Protect WAF 3.6 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.5/" style="">NGINX App Protect WAF 3.5 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.4/" style="">NGINX App Protect WAF 3.4 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.3/" style="">NGINX App Protect WAF 3.3 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.2/" style="">NGINX App Protect WAF 3.2 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.1/" style="">NGINX App Protect WAF 3.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-3.0/" style="">NGINX App Protect WAF 3.0 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-2.3/" style="">NGINX App Protect WAF 2.3 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-2.2/" style="">NGINX App Protect WAF 2.2 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-2.1/" style="">NGINX App Protect WAF 2.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-2.0/" style="">NGINX App Protect WAF 2.0 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-1.3/" style="">NGINX App Protect WAF 1.3 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-1.2/" style="">NGINX App Protect WAF 1.2 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-1.1/" style="">NGINX App Protect WAF 1.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v4/releases/about-1.0/" style="">NGINX App Protect WAF 1.0 </a>
            
        
    </li>
    
</ul>
        
    </li>
    
</ul>
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                    <input type="checkbox" id="toggle-b15959597292934ffe771956f825d77b" class="toggle-checkbox" style="display: none;">
                    <label for="toggle-b15959597292934ffe771956f825d77b" class="collapsible-header">
                        
                            <span class="parent-box expand"></span>
                            <span class="parent-box opened"></span>
                        
                        Version 5 
                    </label>
                    

<ul class="collapsible-content">
    
    <li>
        
            <input type="checkbox" id="toggle-f569a7fa0e4d3de9c70dae244b27b695" class="toggle-checkbox" style="display: none;">
            <label for="toggle-f569a7fa0e4d3de9c70dae244b27b695" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Administration Guides 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/overview/" style="">NGINX App Protect WAF Administration Guide </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/install/" style="">Installing NGINX App Protect WAF </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/deploy-with-helm/" style="">Deploy NGINX App Protect WAF with Helm </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/deploy-with-manifests/" style="">Deploy NGINX App Protect WAF with Manifests </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/deploy-on-docker/" style="">Deploy NGINX App Protect WAF with Docker </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/compiler/" style="">NGINX App Protect WAF Compiler </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/upgrade-nap-waf/" style="">Upgrade NGINX App Protect WAF on Managed Instances </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-ba5280a2dc88e2ef839cbdf99dd63718" class="toggle-checkbox" style="display: none;">
            <label for="toggle-ba5280a2dc88e2ef839cbdf99dd63718" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Configuration Guides 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/configuration-guide/configuration/" style="">NGINX App Protect WAF Configuration Guide </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-32298ec202b6ded814ea2044cb7b2329" class="toggle-checkbox" style="display: none;">
            <label for="toggle-32298ec202b6ded814ea2044cb7b2329" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Declarative Policy 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/declarative-policy/policy/" style="">NGINX App Protect WAF Declarative Policy </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-44f8e13744a3277f9d094e0ab4e169e0" class="toggle-checkbox" style="display: none;">
            <label for="toggle-44f8e13744a3277f9d094e0ab4e169e0" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Logging Overview 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/logging-overview/security-log/" style="">NGINX App Protect WAF Security Log </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/logging-overview/access-log/" style="">NGINX App Protect WAF Access Log </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/logging-overview/logs-overview/" style="">NGINX App Protect WAF Logs Overview </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-aceec0e2fe4ec190c9b41c79e11e4032" class="toggle-checkbox" style="display: none;">
            <label for="toggle-aceec0e2fe4ec190c9b41c79e11e4032" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Troubleshooting 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/troubleshooting-guide/troubleshooting/" style="">NGINX App Protect WAF Troubleshooting Guide </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-0e34ddcd46826354bb34b18a381baf59" class="toggle-checkbox" style="display: none;">
            <label for="toggle-0e34ddcd46826354bb34b18a381baf59" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Releases 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.6/" style="">NGINX App Protect WAF 5.6 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.5/" style="">NGINX App Protect WAF 5.5 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.4/" style="">NGINX App Protect WAF 5.4 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.3/" style="">NGINX App Protect WAF 5.3 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.2/" style="">NGINX App Protect WAF 5.2 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.1/" style="">NGINX App Protect WAF 5.1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-app-protect-waf/v5/releases/about-5.0/" style="">NGINX App Protect WAF 5.0 </a>
            
        
    </li>
    
</ul>
        
    </li>
    
</ul>
                
            </li>
        
        </ul>
    </div>
</div>
      </nav>
    </div>

    <section class="content-layout">
      <div data-cms-edit="content" class="text-content">
        <section class="breadcrumb-layout" data-mf="true" style="display: none;">
          
            
            <nav aria-label="breadcrumb" class="breadcrumb navbar">
    <div class="nav flex-md-row">
        <ol class="breadcrumb">
            
            
            
            
                
            
            
                
            
            
                
            
            
                
            
            
                
            
            
            
                <li><a href="/">Home</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-waf/">F5 NGINX App Protect WAF</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-waf/v4/">Version 4 and Earlier</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-app-protect-waf/v4/configuration-guide/">Configuration Guides</a><i class="fas fa-chevron-right"></i></li>
                
            
                NGINX App Protect WAF Configuration Guide
        </ol>
    </div>
</nav>
  
            
          
        </section>
        <h1>NGINX App Protect WAF Configuration Guide</h1>
        <h2 
id="overview">Overview  <a class="headerlink float-right" href="#overview" title="Overview"><i class="fas fa-link fa-xs"></i></a>
</h2><p>This guide explains the F5 NGINX App Protect WAF security features and how to use them. This guide also assumes that you have some familiarity with various Layer 7 (L7) Hypertext Transfer Protocol (HTTP) concepts, such as Uniform Resource Identifier (URI)/Uniform Resource Locator (URL), method, header, cookie, status code, request, response, and parameters.</p>
<p>For more information on the NGINX App Protect WAF security features, see <a href="#nginx-app-protect-waf-terminology">NGINX App Protect WAF Terminology</a>.</p>
<blockquote class="important call-out">
  <div><strong class="call-out-type">Important</strong><br/> When configuring NGINX App Protect WAF, <code>app_protect_enable</code> should always be enabled in a <code>proxy_pass</code> location. If configuration returns static content, the user must add a location which enables App Protect, and proxies the request via <code>proxy_pass</code> to the internal static content location. An example can be found in <a href="#configure-static-location">Configure Static Location</a>.</div>
</blockquote>

<h2 
id="supported-security-policy-features">Supported Security Policy Features  <a class="headerlink float-right" href="#supported-security-policy-features" title="Supported Security Policy Features"><i class="fas fa-link fa-xs"></i></a>
</h2><table>
  <thead>
      <tr>
          <th style="text-align: left">Protection Mechanism</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><a href="#attack-signatures-overview">Attack Signatures</a></td>
          <td style="text-align: left">Default policy covers all the OWASP top 10 attack patterns enabling signature sets detailed in a section below. The user can disable any of them or add other sets.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#server-technologies">Signature attack for Server Technologies</a></td>
          <td style="text-align: left">Support adding signatures per added server technology.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#threat-campaigns">Threat Campaigns</a></td>
          <td style="text-align: left">These are patterns that detect all the known attack campaigns. They are very accurate and have almost no false positives, but are very specific and do not detect malicious traffic that is not part of those campaigns. The default policy enables threat campaigns but it is possible to disable it through the respective violation.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#http-compliance">HTTP Compliance</a></td>
          <td style="text-align: left">All HTTP protocol compliance checks are enabled by default except for GET with body and POST without body. It is possible to enable any of these two. Some of the checks enabled by default can be disabled, but others, such as bad HTTP version and null in request are performed by the NGINX parser and NGINX App Protect WAF only reports them. These checks cannot be disabled.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#evasion-techniques">Evasion Techniques</a></td>
          <td style="text-align: left">All evasion techniques are enabled by default and each can be disabled. These include directory traversal, bad escaped character and more.</td>
      </tr>
      <tr>
          <td style="text-align: left">Data Guard</td>
          <td style="text-align: left"><a href="#data-guard---blocking">Detects</a> and <a href="#data-guard---masking">masks</a> Credit Card Number (CCN) and/or U.S. Social Security Number (SSN) and/or <a href="#partial-masking-of-data-using-data-guard">custom patterns</a> in HTTP responses. Disabled by default but can be enabled.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#http-compliance">Parameter parsing</a></td>
          <td style="text-align: left">Support only auto-detect parameter value type and acts according to the result: plain alphanumeric string, XML or JSON.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#disallowed-file-types">Disallowed file type extension</a></td>
          <td style="text-align: left">Support any file type. Default includes a predefined list of file types.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="##enforcer-cookie-settings">Cookie enforcement</a></td>
          <td style="text-align: left">By default all cookies are allowed and not enforced for integrity. The user can add <a href="##user---defined-http-headers">specific cookies</a>, wildcards or explicit, that will be enforced for integrity. It is also possible to set the cookie attributes: HttpOnly, Secure and SameSite for cookies found in the response.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#Parameters">Sensitive Parameters</a></td>
          <td style="text-align: left">Default policy masks the &ldquo;password&rdquo; parameter in the security log. It is possible to add more such parameters. See also Data Guard <a href="#data-guard---blocking">detecting</a>, <a href="#partial-masking-of-data-using-data-guard">partial blocking</a> and <a href="#data-guard---masking">masking</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#handling-xml-and-json-content">JSON Content</a></td>
          <td style="text-align: left">JSON content profile detects malformed content and detects signatures and metacharacters in the property values. Default policy checks maximum structure depth. It is possible to enforce a provided JSON schema and/or enable more size restrictions: maximum total length Of JSON data;  maximum value length; maximum array length; tolerate JSON parsing errors.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#handling-xml-and-json-content">XML Content</a></td>
          <td style="text-align: left">XML content profile detects malformed content and detects signatures in the element values. Default policy checks maximum structure depth. It is possible to enable more size restrictions: maximum total length of XML data, maximum number of elements are more. SOAP, Web Services and XML schema features are not supported.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#allowed-methods">Allowed methods</a></td>
          <td style="text-align: left">Check HTTP allowed methods. By default all the standard HTTP methods are allowed.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#deny-and-allow-ip-lists">Deny and Allow IP lists</a></td>
          <td style="text-align: left">Manually define denied &amp; allowed IP addresses as well as IP addresses to never log.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#xff-headers-and-trust">XFF headers &amp; trust</a></td>
          <td style="text-align: left">Disabled by default. User can enable it and optionally add a list of custom XFF headers.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#grpc-protection-for-unary-traffic">gRPC Protection</a></td>
          <td style="text-align: left">gRPC content profile detects malformed content, parses well-formed content, and extracts the text fields for detecting attack signatures and disallowed meta-characters. In addition, it enforces size restrictions and prohibition of unknown fields. The Interface Definition Language (IDL) files for the gRPC API must be attached to the profile. gRPC protection can be on <a href="#grpc-protection-for-unary-traffic">unary</a> or <a href="#grpc-protection-for-bidirectional-streaming">bidirectional</a> traffic.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="#brute-force-attack-preventions">Brute Force Attack Preventions</a></td>
          <td style="text-align: left">Configure brute-force-attack-preventions parameters to secured areas of a web application from brute force attacks.</td>
      </tr>
  </tbody>
</table>
<h3 
id="disallowed-file-types">Disallowed File Types  <a class="headerlink float-right" href="#disallowed-file-types" title="Disallowed File Types"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The following file types are disallowed by default:</p>
<ul>
<li>bak, bat, bck, bkp, cfg, conf, config, ini, log, old, sav, save, temp, tmp</li>
<li>bin, cgi, cmd, com, dll, exe, msi, sys, shtm, shtml, stm</li>
<li>cer, crt, der, key, p12, p7b, p7c, pem, pfx</li>
<li>dat, eml, hta, htr, htw, ida, idc, idq, nws, pol, printer, reg, wmz</li>
</ul>

<h2 
id="additional-policy-features">Additional Policy Features  <a class="headerlink float-right" href="#additional-policy-features" title="Additional Policy Features"><i class="fas fa-link fa-xs"></i></a>
</h2>




<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Feature</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Enforcement by Violation Rating</td>
          <td style="text-align: left">By default block requests that are declared as threats, that is, their Violation Rating is 4 or 5. It is possible to change this behavior: either disable enforcement by Violation Rating or block also request with Violation Rating 3 - needs examination. See section on <a href="#policy-configuration">basic configuration</a> below.</td>
      </tr>
      <tr>
          <td style="text-align: left">Large Request Blocking</td>
          <td style="text-align: left">To increase the protection of resources at both the NGINX Plus and upstream application tiers, all requests that are larger than 10 MB in size are blocked.  When these requests are blocked, a <code>VIOL_REQUEST_MAX_LENGTH</code> violation will be logged.</td>
      </tr>
      <tr>
          <td style="text-align: left">Request size checks</td>
          <td style="text-align: left">Upper limit of request size as dictated by the maximum buffer size of 10 MB;  Size checks for: URL, header, Query String, whole request (when smaller than the maximum buffer), cookie, POST data. By default all the checks are enabled with the exception of POST data and whole request. The user can enable or disable every check and customize the size limits.</td>
      </tr>
      <tr>
          <td style="text-align: left">Malformed cookie</td>
          <td style="text-align: left">Requests with cookies that are not RFC compliant are blocked by default. This can be disabled.</td>
      </tr>
      <tr>
          <td style="text-align: left">Status code restriction</td>
          <td style="text-align: left">Illegal status code in the range of 4xx and 5xx. By default only these are allowed: 400, 401, 404, 407, 417, 503. The user can modify this list or disable the check altogether.</td>
      </tr>
      <tr>
          <td style="text-align: left">Blocking pages</td>
          <td style="text-align: left">The user can customize all blocking pages. By default the AJAX response pages are disabled, but the user can enable them.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Feature</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Enforcement by Violation Rating</td>
          <td style="text-align: left">By default block requests that are declared as threats, that is, their Violation Rating is 4 or 5. It is possible to change this behavior: either disable enforcement by Violation Rating or block also request with Violation Rating 3 - needs examination. See section on <a href="#policy-configuration">basic configuration</a> below.</td>
      </tr>
      <tr>
          <td style="text-align: left">Large Request Blocking</td>
          <td style="text-align: left">To increase the protection of resources at both the NGINX Plus and upstream application tiers, all requests that are larger than 10 MB in size are blocked.  When these requests are blocked, a <code>VIOL_REQUEST_MAX_LENGTH</code> violation will be logged.</td>
      </tr>
      <tr>
          <td style="text-align: left">Request size checks</td>
          <td style="text-align: left">Upper limit of request size as dictated by the maximum buffer size of 10 MB;  Size checks for: URL, header, Query String, whole request (when smaller than the maximum buffer), cookie, POST data. By default all the checks are enabled with the exception of POST data and whole request. The user can enable or disable every check and customize the size limits.</td>
      </tr>
      <tr>
          <td style="text-align: left">Malformed cookie</td>
          <td style="text-align: left">Requests with cookies that are not RFC compliant are blocked by default. This can be disabled.</td>
      </tr>
      <tr>
          <td style="text-align: left">Status code restriction</td>
          <td style="text-align: left">Illegal status code in the range of 4xx and 5xx. By default only these are allowed: 400, 401, 404, 407, 417, 503. The user can modify this list or disable the check altogether.</td>
      </tr>
      <tr>
          <td style="text-align: left">Blocking pages</td>
          <td style="text-align: left">The user can customize all blocking pages. By default the AJAX response pages are disabled, but the user can enable them.</td>
      </tr>
  </tbody>
</table>

</div>

<h2 
id="attack-signatures-overview">Attack Signatures Overview  <a class="headerlink float-right" href="#attack-signatures-overview" title="Attack Signatures Overview"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Attack signatures are rules or patterns that identify attack sequences or classes of attacks on a web application and its components. You can apply attack signatures to both requests and responses. App Protect includes predefined attack signatures to protect your application against all attack types identified by the system.</p>

<p>As new attack signatures are identified, they will become available for <a href="http://localhost:1313/nginx-app-protect-waf/v4/admin-guide/install/#updating-app-protect-attack-signatures">download and installation</a> so that your system will always have the most up-to-date protection. You can update the attack signatures without updating the App Protect release, and conversely, you can update App Protect without changing the attack signature package, unless you upgrade to a new NGINX Plus release.</p>
<h3 
id="signature-settings">Signature Settings  <a class="headerlink float-right" href="#signature-settings" title="Signature Settings"><i class="fas fa-link fa-xs"></i></a>
</h3>




<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">JSON Property in Policy</th>
          <th style="text-align: left">Support in NGINX App Protect WAF</th>
          <th style="text-align: left">Value in Default Profile</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Signature Sets</td>
          <td style="text-align: left">signature-sets</td>
          <td style="text-align: left">All available sets.</td>
          <td style="text-align: left">See signature set list below</td>
      </tr>
      <tr>
          <td style="text-align: left">Signatures</td>
          <td style="text-align: left">signatures</td>
          <td style="text-align: left">&ldquo;Enabled&rdquo; flag can be modified.</td>
          <td style="text-align: left">All signatures in the included sets are enabled.</td>
      </tr>
      <tr>
          <td style="text-align: left">Auto-Added signature accuracy</td>
          <td style="text-align: left">minimumAccuracyForAutoAddedSignatures</td>
          <td style="text-align: left">Editable</td>
          <td style="text-align: left">Medium</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">JSON Property in Policy</th>
          <th style="text-align: left">Support in NGINX App Protect WAF</th>
          <th style="text-align: left">Value in Default Profile</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Signature Sets</td>
          <td style="text-align: left">signature-sets</td>
          <td style="text-align: left">All available sets.</td>
          <td style="text-align: left">See signature set list below</td>
      </tr>
      <tr>
          <td style="text-align: left">Signatures</td>
          <td style="text-align: left">signatures</td>
          <td style="text-align: left">&ldquo;Enabled&rdquo; flag can be modified.</td>
          <td style="text-align: left">All signatures in the included sets are enabled.</td>
      </tr>
      <tr>
          <td style="text-align: left">Auto-Added signature accuracy</td>
          <td style="text-align: left">minimumAccuracyForAutoAddedSignatures</td>
          <td style="text-align: left">Editable</td>
          <td style="text-align: left">Medium</td>
      </tr>
  </tbody>
</table>

</div>

<h3 
id="signature-sets-in-default-policy">Signature Sets in Default Policy  <a class="headerlink float-right" href="#signature-sets-in-default-policy" title="Signature Sets in Default Policy"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The following signature sets are included in the default policy. Most of the sets are defined by the Attack Type they protect from. In all sets the <strong>Alarm</strong> flag is enabled and <strong>Block</strong> disabled except High Accuracy Signatures, which are set to <strong>blocked</strong> (<code>block</code> parameter is enabled).</p>
<ul>
<li>Command Execution Signatures</li>
<li>Cross Site Scripting Signatures</li>
<li>Directory Indexing Signatures</li>
<li>Information Leakage Signatures</li>
<li>OS Command Injection Signatures</li>
<li>Path Traversal Signatures</li>
<li>Predictable Resource Location Signatures</li>
<li>Remote File Include Signatures</li>
<li>SQL Injection Signatures</li>
<li>Authentication/Authorization Attack Signatures</li>
<li>XML External Entities (XXE) Signatures</li>
<li>XPath Injection Signatures</li>
<li>Buffer Overflow Signatures</li>
<li>Denial of Service Signatures</li>
<li>Vulnerability Scan Signatures</li>
<li>High Accuracy Signatures</li>
<li>Server Side Code Injection Signatures</li>
<li>CVE Signatures</li>
</ul>

<h3 
id="basic-signature-sets-included-in-app-protect">Basic Signature Sets Included in App Protect  <a class="headerlink float-right" href="#basic-signature-sets-included-in-app-protect" title="Basic Signature Sets Included in App Protect"><i class="fas fa-link fa-xs"></i></a>
</h3><p>These signatures sets are included but are not part of the default template.</p>
<ul>
<li>All Response Signatures</li>
<li>All Signatures</li>
<li>Generic Detection Signatures</li>
<li>Generic Detection Signatures (High Accuracy)</li>
<li>Generic Detection Signatures (High/Medium Accuracy)</li>
<li>High Accuracy Signatures</li>
<li>Low Accuracy Signatures</li>
<li>Medium Accuracy Signatures</li>
<li>OWA Signatures</li>
<li>WebSphere signatures</li>
<li>HTTP Response Splitting Signatures</li>
<li>Other Application Attacks Signatures</li>
<li>High Accuracy Detection Evasion Signatures</li>
</ul>

<p>See <a href="#signature-sets">signature sets</a> for configuring the signature sets included in your policy.</p>
<h2 
id="policy-configuration">Policy Configuration  <a class="headerlink float-right" href="#policy-configuration" title="Policy Configuration"><i class="fas fa-link fa-xs"></i></a>
</h2><p>The NGINX App Protect WAF ships with two reference policies, both with a default enforcement mode set to Blocking:</p>
<ul>
<li>The <strong>default</strong> policy which is identical to the base template and provides OWASP Top 10 and Bot security protection out of the box.</li>
<li>The <strong>strict</strong> policy contains more restrictive criteria for blocking traffic than the default policy. It is meant to be used for protecting sensitive applications that require more security but with higher risk of false positives.
You can use those policies as is, but usually you will use them as starting points and further customize them to the needs of the applications they protect.</li>
</ul>

<h3 
id="policy-configuration-overview">Policy Configuration Overview  <a class="headerlink float-right" href="#policy-configuration-overview" title="Policy Configuration Overview"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The NGINX App Protect WAF security policy configuration uses the declarative format based on a pre-defined base template. The policy is represented in a JSON file which you can edit to add, modify and remove security capabilities with respect to the base template. The way the policy is integrated into the NGINX configuration is via referencing the JSON file (using the full path) in the <code>nginx.conf</code> file.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> NGINX App Protect WAF provides a <a href="https://json-schema.org/" target="_blank" rel="noopener">JSON Schema</a> which can be used to validate a JSON policy file to ensure file format compliance. The schema file can be generated using a script once NGINX App Protect WAF is installed: <code>sudo /opt/app_protect/bin/generate_json_schema.pl</code>. This script will output the schema to a file named <code>policy.json</code> into the current working directory. Once the schema file is generated, you can use validation tools such as <a href="https://ajv.js.org/standalone.html" target="_blank" rel="noopener">AJV</a> to validate a JSON policy file.</div>
</blockquote>

<p>In the following example, the NGINX configuration file with App Protect enabled in the HTTP context and the policy /etc/app_protect/conf/NginxDefaultPolicy.json is used:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f5fcc7240&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f5fcc7240">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_processes</span>  <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">65536</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">sendfile</span>        <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">keepalive_timeout</span>  <span class="mi">65</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span> <span class="c1"># This is how you enable NGINX App Protect WAF in the relevant context/block
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/NginxDefaultPolicy.json&#34;</span><span class="p">;</span> <span class="c1"># This is a reference to the policy file to use. If not defined, the default policy is used
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span> <span class="c1"># This section enables the logging capability
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_security_log</span> <span class="s">&#34;/etc/app_protect/conf/log_default.json&#34;</span> <span class="s">syslog:server=127.0.0.1:514</span><span class="p">;</span> <span class="c1"># This is where the remote logger is defined in terms of: logging options (defined in the referenced file), log server IP, log server port
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://172.29.38.211:80</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_processes</span>  <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">65536</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">sendfile</span>        <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">keepalive_timeout</span>  <span class="mi">65</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span> <span class="c1"># This is how you enable NGINX App Protect WAF in the relevant context/block
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/NginxDefaultPolicy.json&#34;</span><span class="p">;</span> <span class="c1"># This is a reference to the policy file to use. If not defined, the default policy is used
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span> <span class="c1"># This section enables the logging capability
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_security_log</span> <span class="s">&#34;/etc/app_protect/conf/log_default.json&#34;</span> <span class="s">syslog:server=127.0.0.1:514</span><span class="p">;</span> <span class="c1"># This is where the remote logger is defined in terms of: logging options (defined in the referenced file), log server IP, log server port
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://172.29.38.211:80</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h3 
id="basic-configuration-and-the-default-policy">Basic Configuration and the Default Policy  <a class="headerlink float-right" href="#basic-configuration-and-the-default-policy" title="Basic Configuration and the Default Policy"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The base template is the common starting point to any policy you write. The default policy just reflects that template without any further modifications, thus we use the terms <strong>base template</strong> and <strong>default policy</strong> interchangeably. The default policy appears as follows</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f616a7a70&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f616a7a70">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;app_protect_default_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;app_protect_default_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The default policy enforces violations by <strong>Violation Rating</strong>, the App Protect computed assessment of the risk of the request based on the triggered violations.</p>
<ul>
<li>0: No violation</li>
<li>1-2: False positive</li>
<li>3: Needs examination</li>
<li>4-5: Threat</li>
</ul>
<p>The default policy enables most of the violations and signature sets with Alarm turned ON, but not Block. These violations and signatures, when detected in a request, affect the violation rating. By default, if the violation rating is calculated to be malicious (4-5) the request will be blocked by the <code>VIOL_RATING_THREAT</code> violation. This is true even if the other violations and signatures detected in that request had the Block flag turned OFF. It is the <code>VIOL_RATING_THREAT</code> violation having the Block flag turned ON that caused the blocking, but indirectly the combination of all the other violations and signatures in Alarm caused the request to be blocked. By default, other requests which have a lower violation rating are not blocked, except for some specific violations described below. This is to minimize false positives. However, you can change the default behavior. For example, if you want to add blocking on a violation rating of 3 as well, enable blocking for the <code>VIOL_RATING_NEED_EXAMINATION</code> violation.</p>
<p>The following violations and signature sets have a low chance of being false positives and are, therefore, configured by default to block the request regardless of its Violation Rating:</p>
<ul>
<li>High accuracy attack signatures</li>
<li>Threat campaigns</li>
<li>Malformed request: unparsable header, malformed cookie and malformed body (JSON or XML).</li>
</ul>

<h3 
id="the-strict-policy">The Strict Policy  <a class="headerlink float-right" href="#the-strict-policy" title="The Strict Policy"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The Strict Policy is recommended as a starting point for applications requiring a higher level of security. Just like all other policies it is based on the base template, so it detects and blocks everything the default policy does.
To obtain the Strict Policy, execute the following command:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f617075b0&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f617075b0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo docker run --rm -v <span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:<span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span> --entrypoint<span class="o">=</span><span class="s1">&#39;&#39;</span> private-registry.nginx.com/nap/waf-compiler:1.0.0 cat /etc/app_protect/conf/NginxStrictPolicy.json</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo docker run --rm -v <span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:<span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span> --entrypoint<span class="o">=</span><span class="s1">&#39;&#39;</span> private-registry.nginx.com/nap/waf-compiler:1.0.0 cat /etc/app_protect/conf/NginxStrictPolicy.json</span></span></code></pre></div>
</div><p>Replace the <code>1.0.0</code> with the actual release version.</p>
<p>In addition the Strict Policy also <strong>blocks</strong> the following:</p>
<ul>
<li>Requests that have a Violation Rating of 3, &ldquo;Needs examination&rdquo;. This occurs because the <code>VIOL_RATING_NEED_EXAMINATION</code> violation&rsquo;s block flag is enabled in the strict policy.</li>
<li>Requests with the <code>VIOL_EVASION</code> violation (evasion techniques).</li>
<li>Requests with violations that restrict options in the request and response: HTTP method, response status code and disallowed file types.</li>
</ul>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Other violations, specifically attack signatures and metacharacters, which are more prone to false positives, still have only Alarm turned on, without blocking, contributing to the Violation Rating as in the Default policy.</div>
</blockquote>

<p>In addition, the Strict policy also enables the following features in <strong>alarm only</strong> mode:</p>
<ul>
<li>
<p><strong>Data Guard</strong>: masking Credit Card Number (CCN), US Social Security Number (SSN) and custom patterns found in HTTP responses.</p>
</li>
<li>
<p><strong>HTTP response data leakage signatures</strong>: preventing exfiltration of sensitive information from the servers.</p>
</li>
<li>
<p><strong>More restrictive limitations</strong>: mainly sizing and parsing of JSON and XML payloads.</p>
</li>
<li>
<p><strong>Cookie attribute insertion</strong>: the Strict policy adds the <strong>Secure</strong> and <strong>SameSite=lax</strong> attributes to every cookie set by the application server. These attributes are enforced by the browsers and protect against session hijacking and CSRF attacks respectively.</p>
</li>
</ul>

<h3 
id="policy-authoring-and-tuning">Policy Authoring and Tuning  <a class="headerlink float-right" href="#policy-authoring-and-tuning" title="Policy Authoring and Tuning"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The policy JSON file specifies the settings that are different from the base template, such as enabling more signatures, disabling some violations, adding server technologies, etc. These will be shown in the next sections.</p>
<p>There are two ways to tune those settings:</p>
<ul>
<li>Within the <code>policy</code> structure property, the organic structure of the policy.</li>
<li>Within the <code>modifications</code> structure property that contains a list of changes expressed in a generic manner.</li>
</ul>
<p>Both options are equivalent in their semantic expression power, but different syntactically and are designated for different use cases. But before that, let&rsquo;s look at an example - disabling a specific attack signature.</p>
<p>Signature 200001834 disabled in the <code>policy</code> property:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6180bda8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6180bda8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signature_exclude_1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signature_exclude_1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>As you can see, this is expressed using the <code>signatures</code> property that contains configuration of individual signatures in a policy. If you want to modify other parts of the policy, you would use different JSON properties.</p>
<p>The same configuration in the <code>modifications</code> array looks like this:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61864f70&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61864f70">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signature_exclude_2&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signature_exclude_2&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Note the generic schema that can express manipulation in any policy element: <code>entity</code>, <code>entityType</code>, <code>action</code> etc. The <code>modifications</code> array is a flat list of individual changes applied to the policy after evaluating the <code>policy</code> block.</p>
<p>So when to use <code>policy</code> and when to use <code>modifications</code>? There are some recommended practice guidelines for that:</p>
<ul>
<li>Use <code>policy</code> to express the security policy as you intended it to be: the features you want to enable, disable, the signature sets, server technologies and other related configuration attributes. This part of the policy is usually determined when the application is deployed and changes at a relatively slow pace.</li>
<li>Use <code>modifications</code> to express <strong>exceptions</strong> to the intended policy. These exceptions are usually the result of fixing false positive incidents and failures in tests applied to those policies. Usually these are granular modifications, typically disabling checks of individual signatures, metacharacters and sub-violations. These changes are more frequent.</li>
<li>Use <code>modifications</code> also for <strong>removing</strong> individual collection elements from the base template, for example disallowed file types.</li>
</ul>
<p>It is a good practice to separate the <code>modifications</code> to a different file and have the main policy file reference the former, as the two parts have different lifecycles.</p>
<p>The sections just below review the common policy feature configurations using examples. For the full reference of the <code>policy</code> JSON properties see the Declarative Policy guide.</p>
<h4 
id="policy-enforcement-modes">Policy Enforcement Modes  <a class="headerlink float-right" href="#policy-enforcement-modes" title="Policy Enforcement Modes"><i class="fas fa-link fa-xs"></i></a>
</h4><p>A policy&rsquo;s enforcement mode can be:</p>
<ul>
<li><strong>Blocking:</strong> Any illegal or suspicious requests are logged and blocked.  This is the default enforcement mode for the default policy and any added policy unless changed to Transparent.</li>
<li><strong>Transparent:</strong> Any illegal or suspicious requests are logged but not blocked.</li>
</ul>
<p>Specific security features can be defined as blocked or transparent in the policy.</p>
<p>Blocking Mode example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f618c1018&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f618c1018">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Transparent Mode example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61902310&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61902310">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="enabling-violations">Enabling Violations  <a class="headerlink float-right" href="#enabling-violations" title="Enabling Violations"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Adding and enabling additional security features to the policy can be done by specifying the violation name and the <code>alarm</code> block state to &ldquo;true&rdquo;. To set different states to sub-violations within the violation, enable the violation first, then specifying and enable the sub-violations. Also, a violation may have its own section that provides additional configuration granularity for a specific violation/sub-violation.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> The attack signature violation <code>VIOL_ATTACK_SIGNATURE</code> cannot be configured by the user. Rather, the violation is determined by the combination of the <a href="#signature-sets">signature sets</a> on the policy.</div>
</blockquote>

<p>The examples below show how to enable a violation and sub-violation in a declarative format.</p>
<h5 
id="configuration-details-example">Configuration Details Example  <a class="headerlink float-right" href="#configuration-details-example" title="Configuration Details Example"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In this example, we enable 2 violations: <code>VIOL_JSON_FORMAT</code> and <code>VIOL_PARAMETER_VALUE_METACHAR</code>.</p>
<p>Note that the example defines the blocking and alarm setting for each violation. These settings override the default configuration set above in the <code>enforcementMode</code> directive.  Be aware, however, that in a transparent policy no violations are blocked, even if specific violations are set to <strong>block: true</strong> in the configuration.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61983578&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61983578">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_JSON_FORMAT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_JSON_FORMAT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="http-compliance">HTTP Compliance  <a class="headerlink float-right" href="#http-compliance" title="HTTP Compliance"><i class="fas fa-link fa-xs"></i></a>
</h4><p>HTTP compliance is one of the basic application security violations. It validates the request itself and also prevents the use of the HTTP protocol as an entry point to the application.</p>
<p>In this example, we enable the HTTP compliance violation with the blocking as true. We also configure (enabled or disabled) all of its sub-violations in the relevant HTTP section.  Note that you can add/remove sub-violations to match your desired configurations. However, not listing a violation does not mean it will be disabled.  Rather, it would actually mean that the default configuration would not be overridden for that specific sub-violation.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61a54150&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61a54150">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_HTTP_PROTOCOL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;http-protocols&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Header name with no header value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Chunked request with Content-Length header&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Check maximum number of parameters&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maxParams&#34;</span><span class="p">:</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Check maximum number of headers&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maxHeaders&#34;</span><span class="p">:</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Body in GET or HEAD requests&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Bad multipart/form-data request parsing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Bad multipart parameters parsing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Unescaped space in URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_HTTP_PROTOCOL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;http-protocols&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Header name with no header value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Chunked request with Content-Length header&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Check maximum number of parameters&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maxParams&#34;</span><span class="p">:</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Check maximum number of headers&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maxHeaders&#34;</span><span class="p">:</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Body in GET or HEAD requests&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Bad multipart/form-data request parsing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Bad multipart parameters parsing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Unescaped space in URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="rfc-checks-on-the-referer-header">RFC Checks on the Referer Header  <a class="headerlink float-right" href="#rfc-checks-on-the-referer-header" title="RFC Checks on the Referer Header"><i class="fas fa-link fa-xs"></i></a>
</h4><p>This feature introduces RFC checks on the URL referer header.</p>
<p>If a request contains a referer header with a URL that doesn&rsquo;t comply with RFC standards as per RFC-3986, it will trigger the <code>VIOL_HTTP_PROTOCOL</code> violation along with its associated sub-violations. If this violation is reported, the user should inspect both the request and referer URLs to identify and address the underlying issue.</p>
<p>For example, in the below URL in Referer header in &ldquo;Example 1&rdquo; there is NULL used in Referer value and in &ldquo;Example 2&rdquo; unescaped space is used. Since these requests are non-RFC compliant, it will trigger the <code>VIOL_HTTP_PROTOCOL</code> violation.</p>



<div class="code-block" data-mf="true" style="display: none;"><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61a911e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61a911e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Example 1
</span></span><span class="line"><span class="cl">...  Referer: http://example.com/hello%2500world\r\n</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Example 1
</span></span><span class="line"><span class="cl">...  Referer: http://example.com/hello%2500world\r\n</span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61ab9280&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61ab9280">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Example 2
</span></span><span class="line"><span class="cl">...  Referer: http://example.com/hello world\r\n</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Example 2
</span></span><span class="line"><span class="cl">...  Referer: http://example.com/hello world\r\n</span></span></code></pre></div>
</div><h4 
id="evasion-techniques">Evasion Techniques  <a class="headerlink float-right" href="#evasion-techniques" title="Evasion Techniques"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Evasion techniques refers to techniques usually used by hackers to attempt to access resources or evade what would otherwise be identified as an attack. Like HTTP compliance, evasion techniques have a list of sub-violations that can be configured for additional granularity and to reduce false positives.</p>
<p>In this example, we enable the evasion technique violation with the blocking as true. We also configure (enabled or disabled) all of its sub-violations in the relevant section. Note that you can add/remove sub-violations to match your desired configurations. However, not listing a violation does not mean it will be disabled.  Rather, it would actually mean that the default configuration would not be overridden for that specific sub-violation.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61b7c398&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61b7c398">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;evasions_enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_EVASION&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;evasions&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Bad unescape&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Directory traversals&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Bare byte decoding&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Apache whitespace&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Multiple decoding&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maxDecodingPasses&#34;</span><span class="p">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS Unicode codepoints&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS backslashes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;%u decoding&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;evasions_enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_EVASION&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;evasions&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Bad unescape&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Directory traversals&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Bare byte decoding&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Apache whitespace&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Multiple decoding&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maxDecodingPasses&#34;</span><span class="p">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS Unicode codepoints&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS backslashes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;%u decoding&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="user-defined-http-headers">User-defined HTTP Headers  <a class="headerlink float-right" href="#user-defined-http-headers" title="User-defined HTTP Headers"><i class="fas fa-link fa-xs"></i></a>
</h4><p>HTTP header enforcement refers to the handling of the headers section as a special part of the request. These header elements are parsed and enforced based on header specific criteria. However, it is important to distinguish between 2 distinct types of enforcement for HTTP headers:</p>
<ul>
<li>The first type of header enforcement is global enforcement for all header content, regardless of the header field name or value. This type of enforcement enables/disables violations that are effective for all contents of the header section of the request. Examples of this are <code>VIOL_HEADER_LENGTH</code> and <code>VIOL_HEADER_METACHAR</code>. These violations can be configured in the <code>blocking-settings</code> section under the <code>violations</code> list in the declarative policy.</li>
<li>The second type of header enforcement is the ability to configure certain violations that are relevant only to specific header fields. Examples of this are allowing repeated instances of the same header field and enabling/disabling Attack Signature checks for an HTTP header field. These violations are configured in the <code>headers</code> section where we configure each HTTP header element separately as an object in the list. Additionally, the corresponding violations need to be enabled in the <code>blocking-settings</code> section under the <code>violations</code> list for them to be enforced.</li>
</ul>
<p>As far as the header field enforcement is concerned, the following violations are enabled by default:</p>
<ul>
<li><code>VIOL_HEADER_REPEATED</code> (in Block mode)</li>
<li><code>VIOL_MANDATORY_HEADER</code> (in Alarm mode)</li>
</ul>
<p>There are 3 additional violations that are part of the header enforcement but are specific to the Cookie header alone:</p>
<ul>
<li><code>VIOL_COOKIE_LENGTH</code> (in Alarm mode)</li>
<li><code>VIOL_COOKIE_MALFORMED</code> (in Block mode)</li>
<li><code>VIOL_COOKIE_MODIFIED</code> (in Alarm mode)</li>
</ul>
<p>In the base template, there are 4 header objects configured by default:</p>
<ul>
<li><code>* (wildcard)</code> - This entity represents the default action taken for all the header fields that have not been explicitly defined in the headers section.</li>
<li><code>Cookie</code> - This entity handles the <code>Cookie</code> header field; this object is just a placeholder and does not affect configuration (See the cookie note below).</li>
<li><code>Referer</code> - This entity handles the <code>Referer</code> header field.</li>
<li><code>Authorization</code> - This entity handles the <code>Authorization</code> header field.</li>
<li><code>Transfer-Encoding</code> - This entity handles the <code>Transfer-Encoding</code> header field.</li>
</ul>
<p>It is important to emphasize that the Cookie header field is a special case because its behavior is determined by and configured in the <code>cookie</code> policy entity rather than the <code>header</code> entity. The <code>Cookie</code> HTTP header entity is only a placeholder in that it is read-only and does not affect the way cookies are enforced. To modify the configuration of the cookie header field behavior, modify the respective <code>cookie</code> entity in the declarative policy.</p>
<p>It is possible to customize the policy configuration using different enforcement modes of the above two violations, as well as configuring custom header elements. For example, we can add a new header <code>Myheader</code> and exclude this header from attack signature checks. Alternatively, we can specify a mandatory header that should be present in all requests being sent to our application.</p>
<p>Following is an example configuration where we enable Header violations in blocking mode, create a custom header <code>MyHeader</code>, and configure this custom header to allow multiple occurrences of the same header, disable checking attack signatures for the header, and mark it as optional (not mandatory):</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61c04f18&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61c04f18">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_headers_blocking_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_MANDATORY_HEADER&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;MyHeader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;disabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;htmlNormalization&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedOccurrences&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkSignatures&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_headers_blocking_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_MANDATORY_HEADER&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;MyHeader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;disabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;htmlNormalization&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedOccurrences&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkSignatures&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="anti-automation-bot-mitigation">Anti Automation (Bot Mitigation)  <a class="headerlink float-right" href="#anti-automation-bot-mitigation" title="Anti Automation (Bot Mitigation)"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Anti Automation provides basic bot protection by detecting bot signatures and clients that falsely claim to be browsers or search engines. The <code>bot-defense</code> section in the policy is enabled by default. Anti Automation encompasses both Bot Signatures and Header Anomalies, each of which can be disabled separately.</p>
<p>As new bot signatures are identified, they will be accessible for <a href="http://localhost:1313/nginx-app-protect-waf/v4/admin-guide/install/#updating-app-protect-bot-signatures">download and installation</a> so that your system will always have the most up-to-date protection. You can update the bot signatures without updating the App Protect release. Similarly, you can update App Protect without altering the bot signature package, unless you upgrade to a new NGINX Plus release.</p>
<h4 
id="bot-signatures">Bot Signatures  <a class="headerlink float-right" href="#bot-signatures" title="Bot Signatures"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Bot Signatures provide basic bot protection by detecting bot signatures in the User-Agent header and URI.
Each bot signature belongs to a bot class. Search engine signatures such as <code>googlebot</code> are under the trusted_bots class, but App Protect performs additional checks of the trusted bot&rsquo;s authenticity. If these checks fail, it means that the respective client impersonated the search engine in the signature and it will be classified as class - <code>malicous_bot</code>, anomaly - <code>Search engine verification failed</code>, and the request will be blocked, irrespective of the class&rsquo;s mitigation actions configuration.
An action can be configured for each bot class, or may also be configured per each bot signature individually:</p>
<ul>
<li><code>ignore</code>    - bot signature is ignored (disabled)</li>
<li><code>detect</code>    - only report without raising the violation - <code>VIOL_BOT_CLIENT</code>. The request is considered <code>legal</code> unless another violation is triggered.</li>
<li><code>alarm</code>     - report, raise the violation, but pass the request. The request is marked as <code>illegal</code>.</li>
<li><code>block</code>     - report, raise the violation, and block the request</li>
</ul>
<p>In this example we show how to enable bot signatures using the default bot configuration:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61cea6f8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61cea6f8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bot_defense_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bot_defense_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The default actions for classes are: <code>detect</code> for <code>trusted-bot</code>, <code>alarm</code> for <code>untrusted-bot</code>, and <code>block</code> for <code>malicious-bot</code>. In this example, we enabled bot defense and specified that we want to raise a violation for <code>trusted-bot</code>, and block for <code>untrusted-bot</code>.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61d60d80&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61d60d80">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bot_defense_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;classes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;trusted-bot&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;alarm&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;untrusted-bot&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;malicious-bot&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bot_defense_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;classes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;trusted-bot&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;alarm&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;untrusted-bot&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;malicious-bot&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In this example, we override the action for a specific signature (python-requests)</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61dc56e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61dc56e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bot_defense_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;python-requests&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bot_defense_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;python-requests&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="bot-signatures-update-file">Bot Signatures Update File  <a class="headerlink float-right" href="#bot-signatures-update-file" title="Bot Signatures Update File"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Starting with NGINX App Protect WAF release 4.7, the bot signature file <code>included_bot_signatures</code>, is located at the following path: <code>/opt/app-protect/var/update_files/bot_signatures/included_bot_signatures</code>. This will be part of the <strong>app-protect-bot-signatures</strong> package.</p>
<p>This file contains an up-to-date list of all bot signatures that have been updated with the new bot signature package. This list is automatically generated as a part of the <strong>app-protect-bot-signatures</strong> package and follows a format similar to the README-style text file found in the attack signature. This file contains essential information which includes:</p>
<ul>
<li>Bot name</li>
<li>Bot type</li>
<li>Bot classification/category</li>
</ul>
<h4 
id="list-of-trusted-bots">List of Trusted Bots  <a class="headerlink float-right" href="#list-of-trusted-bots" title="List of Trusted Bots"><i class="fas fa-link fa-xs"></i></a>
</h4><p>This is a list of the trusted bots that are currently part of the bot signatures. As the title suggests, these bot signatures belong to the <code>trusted-bot</code> class and currently all are search engines.</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Bot Name</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Ask</td>
          <td style="text-align: left"><a href="https://www.ask.com" target="_blank" rel="noopener">Ask.com engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Baidu</td>
          <td style="text-align: left"><a href="https://www.baidu.com/" target="_blank" rel="noopener">Baidu search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Baidu Image Spider</td>
          <td style="text-align: left"><a href="https://image.baidu.com/" target="_blank" rel="noopener">Baidu search engine for images</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Bing</td>
          <td style="text-align: left"><a href="https://www.bing.com/" target="_blank" rel="noopener">Microsoft Bing search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">BingPreview</td>
          <td style="text-align: left"><a href="https://www.bing.com/" target="_blank" rel="noopener">Microsoft Bing page snapshot generation engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Daum</td>
          <td style="text-align: left"><a href="https://www.daum.net/" target="_blank" rel="noopener">Daum search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">DuckDuckGo Bot</td>
          <td style="text-align: left"><a href="https://duckduckgo.com/" target="_blank" rel="noopener">DuckDuckGo search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">fastbot</td>
          <td style="text-align: left"><a href="https://www.fastbot.de/" target="_blank" rel="noopener">fastbot search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Google</td>
          <td style="text-align: left"><a href="https://www.google.com/" target="_blank" rel="noopener">Google search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">MojeekBot</td>
          <td style="text-align: left"><a href="https://www.mojeek.com/" target="_blank" rel="noopener">Mojeek search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Yahoo! Slurp</td>
          <td style="text-align: left"><a href="https://www.yahoo.com/" target="_blank" rel="noopener">Yahoo search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Yandex</td>
          <td style="text-align: left"><a href="https://yandex.com/" target="_blank" rel="noopener">Yandex search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">YioopBot</td>
          <td style="text-align: left">Yioop search engine</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Bot Name</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Ask</td>
          <td style="text-align: left"><a href="https://www.ask.com" target="_blank" rel="noopener">Ask.com engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Baidu</td>
          <td style="text-align: left"><a href="https://www.baidu.com/" target="_blank" rel="noopener">Baidu search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Baidu Image Spider</td>
          <td style="text-align: left"><a href="https://image.baidu.com/" target="_blank" rel="noopener">Baidu search engine for images</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Bing</td>
          <td style="text-align: left"><a href="https://www.bing.com/" target="_blank" rel="noopener">Microsoft Bing search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">BingPreview</td>
          <td style="text-align: left"><a href="https://www.bing.com/" target="_blank" rel="noopener">Microsoft Bing page snapshot generation engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Daum</td>
          <td style="text-align: left"><a href="https://www.daum.net/" target="_blank" rel="noopener">Daum search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">DuckDuckGo Bot</td>
          <td style="text-align: left"><a href="https://duckduckgo.com/" target="_blank" rel="noopener">DuckDuckGo search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">fastbot</td>
          <td style="text-align: left"><a href="https://www.fastbot.de/" target="_blank" rel="noopener">fastbot search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Google</td>
          <td style="text-align: left"><a href="https://www.google.com/" target="_blank" rel="noopener">Google search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">MojeekBot</td>
          <td style="text-align: left"><a href="https://www.mojeek.com/" target="_blank" rel="noopener">Mojeek search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Yahoo! Slurp</td>
          <td style="text-align: left"><a href="https://www.yahoo.com/" target="_blank" rel="noopener">Yahoo search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Yandex</td>
          <td style="text-align: left"><a href="https://yandex.com/" target="_blank" rel="noopener">Yandex search engine</a></td>
      </tr>
      <tr>
          <td style="text-align: left">YioopBot</td>
          <td style="text-align: left">Yioop search engine</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="header-anomalies">Header Anomalies  <a class="headerlink float-right" href="#header-anomalies" title="Header Anomalies"><i class="fas fa-link fa-xs"></i></a>
</h4><p>In addition to detecting Bot Signatures, by default NGINX App Protect WAF verifies that a client claiming to be a browser is indeed one by inspecting the HTTP headers.
Each request receives a score, is categorized by anomaly, and is enforced according to the default configured anomaly action:</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Range</th>
          <th style="text-align: left">Anomaly</th>
          <th style="text-align: left">Action</th>
          <th style="text-align: left">Class</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">0-49</td>
          <td style="text-align: left">None</td>
          <td style="text-align: left">None</td>
          <td style="text-align: left">Browser</td>
      </tr>
      <tr>
          <td style="text-align: left">50-99</td>
          <td style="text-align: left">Suspicious HTTP Headers Presence or Order</td>
          <td style="text-align: left">Alarm</td>
          <td style="text-align: left">Suspicious Browser</td>
      </tr>
      <tr>
          <td style="text-align: left">100 and above</td>
          <td style="text-align: left">Invalid HTTP Headers Presence or Order</td>
          <td style="text-align: left">Block</td>
          <td style="text-align: left">Malicious Bot</td>
      </tr>
      <tr>
          <td style="text-align: left">Non Applicable</td>
          <td style="text-align: left">SEARCH_ENGINE_VERIFICATION_FAILED</td>
          <td style="text-align: left">Block</td>
          <td style="text-align: left">Malicious Bot</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Range</th>
          <th style="text-align: left">Anomaly</th>
          <th style="text-align: left">Action</th>
          <th style="text-align: left">Class</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">0-49</td>
          <td style="text-align: left">None</td>
          <td style="text-align: left">None</td>
          <td style="text-align: left">Browser</td>
      </tr>
      <tr>
          <td style="text-align: left">50-99</td>
          <td style="text-align: left">Suspicious HTTP Headers Presence or Order</td>
          <td style="text-align: left">Alarm</td>
          <td style="text-align: left">Suspicious Browser</td>
      </tr>
      <tr>
          <td style="text-align: left">100 and above</td>
          <td style="text-align: left">Invalid HTTP Headers Presence or Order</td>
          <td style="text-align: left">Block</td>
          <td style="text-align: left">Malicious Bot</td>
      </tr>
      <tr>
          <td style="text-align: left">Non Applicable</td>
          <td style="text-align: left">SEARCH_ENGINE_VERIFICATION_FAILED</td>
          <td style="text-align: left">Block</td>
          <td style="text-align: left">Malicious Bot</td>
      </tr>
  </tbody>
</table>

</div>
<p>Notice that the default scores for each anomaly can be changed. In this example, we override the score and action of the default bot configuration:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61e15050&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61e15050">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bot_anomalies_and_signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;anomalies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Suspicious HTTP Headers&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;scoreThreshold&#34;</span><span class="p">:</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Invalid HTTP Headers&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;scoreThreshold&#34;</span><span class="p">:</span> <span class="mi">99</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bot_anomalies_and_signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;anomalies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Suspicious HTTP Headers&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;scoreThreshold&#34;</span><span class="p">:</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Invalid HTTP Headers&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;scoreThreshold&#34;</span><span class="p">:</span> <span class="mi">99</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="signature-sets">Signature Sets  <a class="headerlink float-right" href="#signature-sets" title="Signature Sets"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The default and strict policies include and enable common signature sets, which are categorized groups of <a href="#attack-signatures-overview">signatures</a> applied to the policy. However, you may wish to modify the list of signature sets and their logging and enforcement settings via the <code>signature-sets</code> array property. There are several ways to configure the enforced signature sets.</p>
<p>One way is by use of the <code>All Signatures</code> signature set, which is simply a predefined signature set that includes all signatures known to NGINX App Protect WAF.</p>
<p>In this example, the <code>All Signatures</code> set (and therefore the signatures included within) are configured to be enforced and logged respectively, by setting their <code>block</code> and <code>alarm</code> properties:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61f9c608&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61f9c608">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;attack_sigs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;attack_sigs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In this example, only high accuracy signatures are configured to be enforced, but SQL Injection signatures are detected and reported:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61fcf288&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61fcf288">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;attack_sigs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;High Accuracy Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;SQL Injection Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;attack_sigs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;High Accuracy Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;SQL Injection Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Since the &ldquo;All Signatures&rdquo; set is not included in the default policy, turning OFF both alarm and block has no effect because all the other sets with alarm turned ON (and high accuracy signatures with block enabled) are still in place and a signature that is a member of multiple sets behaves in accordance with the strict settings of all sets it belongs to. The only way to remove signature sets is to remove or disable sets that are part of the <a href="#signature-sets-in-default-policy">default policy</a>.</p>
<p>For example, in the below default policy, even though All Signature&rsquo;s Alarm/Block settings are set to false, we cannot ignore all attack signatures enforcement as some of the signature sets will be enabled in their strict policy. If the end users want to remove a specific signature set then they must explicitly mention it under the <a href="#the-strict-policy">strict policy</a>.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62007cc8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62007cc8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signatures_block&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;caseInsensitive&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Generic Detection Signatures (High/Medium Accuracy)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signatures_block&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;caseInsensitive&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Generic Detection Signatures (High/Medium Accuracy)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>A signature may belong to more than one set in the policy. Its behavior is determined by the most severe action across all the sets that contain it. In the above example, a high accuracy SQL injection signature will both alarm and block, because the <code>High Accuracy Signatures</code> set is blocking and both sets trigger alarm.</p>
<p>The default policy already includes many signature sets, most of which are determined by the attack type these signatures protect from, for example <code>Cross-Site Scripting Signatures</code> or <code>SQL Injection Signatures</code>. See <a href="#signature-sets-in-default-policy">the full list</a> above. In some cases you may want to exclude individual signatures.</p>
<p>In this example, signature ID 200001834 is excluded from enforcement:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62041a90&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62041a90">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signature_exclude&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signature_exclude&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Another way to exclude signature ID 200001834 is by using the <code>modifications</code> section instead of the <code>signatures</code> section used in the example above:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f620c6b78&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f620c6b78">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signature_modification_entitytype&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;signature_modification_entitytype&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>To exclude multiple attack signatures, each signature ID needs to be added as a separate entity under the <code>modifications</code> list:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f621072b8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f621072b8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200004461</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200004461</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In the above examples, the signatures were disabled for all the requests that are inspected by the respective policy. You can also exclude signatures for specific URLs or parameters, while still enable them for the other URLs and parameters. See the sections on <a href="#user-defined-urls">User-Defined URLs</a> and <a href="#user-defined-parameters">User-Defined Parameters</a> for details.</p>
<p>In some cases, you may want to remove a whole signature set that was included in the default policy. For example, suppose your protected application does not use XML and hence is not exposed to XPath injection. You would like to remove the set <code>XPath Injection Signatures</code>. There are two ways to do that. The first is to set the <code>alarm</code> and <code>block</code> flags to <code>false</code> for this signature set overriding the settings in the base template:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6212ff10&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6212ff10">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;no_xpath_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;XPath Injection Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;no_xpath_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;XPath Injection Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The second way is to remove this set totally from the policy using the <code>$action</code> meta-property.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6214fec8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6214fec8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;no_xpath_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;XPath Injection Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;no_xpath_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;XPath Injection Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Although the two methods are functionally equivalent, the second one is preferable for performance reasons.</p>
<h4 
id="server-technologies">Server Technologies  <a class="headerlink float-right" href="#server-technologies" title="Server Technologies"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Another way to configure attack signature sets is by applying server technologies. Server technologies applies sets of signatures that would be relevant to attacks targeted to a specific OS, application, or server type. The Server technologies are represented in attack signatures as <code>systems</code> using the same name, for example <code>SharePoint</code>. Note, however, that the overlap between Server technologies and signature systems is not complete: there are server technologies that cannot be represented as signature systems, and also a few generic signature systems that are not represented as server technologies. The exact details will follow in the sections just below. Server technologies that are not signature systems will not bring in new signatures when added to the policy. However, associating them with the policy still has declarational value, and in one of the future signature updates they may be associated with new signatures.</p>
<p>In this example, we enable the attack signature violation, and enabled the <strong>Apache/NCSA HTTP Server</strong> server technology, which in turn enables attack signatures specific to this type of technology. We also enabled signatures with minimum accuracy of low. This would include low, medium, and high accuracy attack signatures.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6217d170&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6217d170">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;minimumAccuracyForAutoAddedSignatures&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;server-technologies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span> <span class="nt">&#34;serverTechnologyName&#34;</span><span class="p">:</span> <span class="s2">&#34;Apache/NCSA HTTP Server&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;minimumAccuracyForAutoAddedSignatures&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;server-technologies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span> <span class="nt">&#34;serverTechnologyName&#34;</span><span class="p">:</span> <span class="s2">&#34;Apache/NCSA HTTP Server&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h5 
id="available-server-technologies">Available Server Technologies  <a class="headerlink float-right" href="#available-server-technologies" title="Available Server Technologies"><i class="fas fa-link fa-xs"></i></a>
</h5><p>The table below lists all the available Server Technologies. Some of them are built on top others on the stack and including them implies the inclusion of the latter. For example: ASP.NET implies both IIS and Microsoft Windows. This is indicated in the &ldquo;implied technologies&rdquo; column when applicable. We also denote the server technologies that currently have a signature system counterpart.</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Server Technology Name</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Implied Technologies</th>
          <th style="text-align: left">Signature System?</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Jenkins</td>
          <td style="text-align: left">Jenkins is an open source automation server written in Java. Jenkins helps to automate the non-human part of the software development process, with continuous integration and facilitating technical aspects of continuous delivery. It is a server-based system that runs in servlet containers such as Apache Tomcat.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">SharePoint</td>
          <td style="text-align: left">SharePoint is a web-based collaborative platform that integrates with Microsoft Office. Launched in 2001, SharePoint is primarily sold as a document management and storage system, but the product is highly configurable and usage varies substantially among organizations.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Oracle Application Server</td>
          <td style="text-align: left">Oracle Internet Application Server provides a single integrated packaged solution of for middleware infrastructure including Oracle Containers for J2EE, Oracle Web Cache, Oracle HTTP Server, Oracle Forms, Oracle Reports, Oracle Portal and Oracle Discoverer.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Python</td>
          <td style="text-align: left">Python is an interpreted, high-level, general-purpose programming language. Created by Guido van Rossum and first released in 1991, Python has a design philosophy that emphasizes code readability, notably using significant whitespace. It provides constructs that enable clear programming on both small and large scales.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Oracle Identity Manager</td>
          <td style="text-align: left">Oracle Identity Manager (OIM) enables enterprises to manage the entire user lifecycle across all enterprise resources both within and beyond a firewall. Within Oracle Identity Management it provides a mechanism for implementing the user-management aspects of a corporate policy.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Spring Boot</td>
          <td style="text-align: left">Spring Boot makes it easy to create Spring-powered, production-grade applications and services with absolute minimum fuss. It takes an opinionated view of the Spring platform so that new and existing users can quickly get to the bits they need.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">CouchDB</td>
          <td style="text-align: left">Apache CouchDB is open source database software that focuses on ease of use and having a scalable architecture.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">SQLite</td>
          <td style="text-align: left">SQLite is a relational database management system contained in a C programming library. In contrast to many other database management systems, SQLite is not a client-server database engine. Rather, it is embedded into the end program.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Handlebars</td>
          <td style="text-align: left">Handlebars provides the power necessary to let you build semantic templates effectively with no frustration.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Mustache</td>
          <td style="text-align: left">Mustache is a simple web template system.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Prototype</td>
          <td style="text-align: left">Prototype takes the complexity out of client-side web programming. Built to solve real-world problems, it adds useful extensions to the browser scripting environment and provides elegant APIs around the clumsy interfaces of Ajax and the Document Object Model.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Zend</td>
          <td style="text-align: left">Zend Server is a complete and certified PHP distribution stack fully maintained and supported by Zend Technologies. It ships with an updated set of advanced value-add features designed to optimize productivity, performance, scalability and reliability.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Redis</td>
          <td style="text-align: left">Redis is an open source in-memory data structure project implementing a distributed, in-memory key-value database with optional durability. Redis supports different kinds of abstract data structures, such as strings, lists, maps, sets, sorted sets, hyperloglogs, bitmaps, streams and spatial indexes.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Underscore.js</td>
          <td style="text-align: left">Underscore.js is a JavaScript library which provides utility functions for common programming tasks. It is comparable to features provided by Prototype.js and the Ruby language, but opts for a functional programming design instead of extending object prototypes</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Ember.js</td>
          <td style="text-align: left">Ember.js is an open source JavaScript web framework, based on the Model-view-viewmodel pattern. It allows developers to create scalable single-page web applications by incorporating common idioms and best practices into the framework.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">ZURB Foundation</td>
          <td style="text-align: left">Foundation is a responsive front-end framework. Foundation provides a responsive grid and HTML and CSS UI components, templates, and code snippets, including typography, forms, buttons, navigation and other interface elements, as well as optional functionality provided by JavaScript extensions. Foundation is maintained by ZURB and is an open source project.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">ef.js</td>
          <td style="text-align: left">ef.js is an elegant HTML template engine &amp; basic framework.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Vue.js</td>
          <td style="text-align: left">Vue.js is an open source JavaScript framework for building user interfaces and single-page applications.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">UIKit</td>
          <td style="text-align: left">UIkit is a lightweight and modular front-end framework for developing fast and powerful web interfaces.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">TYPO3 CMS</td>
          <td style="text-align: left">TYPO3 is a free and open source web content management system written in PHP. It is released under the GNU General Public License. It can run on several web servers, such as Apache or IIS, on top of many operating systems, among them Linux, Microsoft Windows, FreeBSD, macOS and OS/2.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">RequireJS</td>
          <td style="text-align: left">RequireJS is a JavaScript library and file loader which manages the dependencies between JavaScript files and in modular programming. It also helps to improve the speed and quality of the code.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">React</td>
          <td style="text-align: left">React is a JavaScript library for building user interfaces. It is maintained by Facebook and a community of individual developers and companies. React can be used as a base in the development of single-page or mobile applications.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">MooTools</td>
          <td style="text-align: left">MooTools is a lightweight, object-oriented JavaScript framework. It is released under the free, open source MIT License.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Laravel</td>
          <td style="text-align: left">Laravel is a free, open source PHP web framework, created by Taylor Otwell and intended for the development of web applications following the model-view-controller architectural pattern and based on Symfony.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Google Web Toolkit</td>
          <td style="text-align: left">Google Web Toolkit, or GWT Web Toolkit, is an open source set of tools that allows web developers to create and maintain complex JavaScript front-end applications in Java. Other than a few native libraries, everything is Java source that can be built on any supported platform with the included GWT Ant build files.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Express.js</td>
          <td style="text-align: left">Express.js, or simply Express, is a web application framework for Node.js, released as free and open source software under the MIT License. It is designed for building web applications and APIs. It has been called the de facto standard server framework for Node.js.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">CodeIgniter</td>
          <td style="text-align: left">CodeIgniter is an open source software rapid development web framework, for use in building dynamic web sites with PHP.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Backbone.js</td>
          <td style="text-align: left">Backbone.js is a JavaScript library with a RESTful JSON interface and is based on the Model-view-presenter application design paradigm. Backbone is known for being lightweight, as its only hard dependency is on one JavaScript library, Underscore.js, plus jQuery for use of the full library.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">AngularJS</td>
          <td style="text-align: left">AngularJS is a JavaScript-based open source front-end web application framework mainly maintained by Google and by a community of individuals and corporations to address many of the challenges encountered in developing single-page applications.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">JavaScript</td>
          <td style="text-align: left">JavaScript, often abbreviated as JS, is a high-level, interpreted programming language that conforms to the ECMAScript specification. It is a language which is also characterized as dynamic, weakly typed, prototype-based and multi-paradigm.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">NGINX is a web server which can also be used as a reverse proxy, load balancer, mail proxy and HTTP cache.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Jetty</td>
          <td style="text-align: left">Jetty is a Java HTTP (Web) server and Java Servlet container</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Joomla</td>
          <td style="text-align: left">Joomla is a free and open source content management system (CMS) for publishing web content.</td>
          <td style="text-align: left">PHP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">JavaServer Faces (JSF)</td>
          <td style="text-align: left">JavaServer Faces (JSF) is a Java specification for building component-based user interfaces for web applications.</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Ruby</td>
          <td style="text-align: left">Ruby is a dynamic, reflective, object-oriented, general-purpose programming language.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">MongoDB</td>
          <td style="text-align: left">MongoDB is a free and open source cross-platform document-oriented database program.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Django</td>
          <td style="text-align: left">Django is a free and open source web framework, written in Python, which follows the model-view-template (MVT) architectural pattern.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Node.js</td>
          <td style="text-align: left">Node.js is an open source, cross-platform JavaScript runtime environment for developing a diverse variety of tools and applications.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Citrix</td>
          <td style="text-align: left">Citrix Systems, Inc. is an American multinational software company that provides server, application and desktop virtualization, networking, software as a service (SaaS), and cloud computing technologies.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">JBoss</td>
          <td style="text-align: left">The JBoss Enterprise Application Platform (or JBoss EAP) is a subscription-based/open source Java EE-based application server runtime platform used for building, deploying, and hosting highly-transactional Java applications and services.</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Elasticsearch</td>
          <td style="text-align: left">Elasticsearch is a search engine based on Lucene.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Apache Struts</td>
          <td style="text-align: left">Apache Struts is an open source web application framework for developing Java EE web applications.</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">XML</td>
          <td style="text-align: left">Extensible Markup Language (XML) is a markup language that defines a set of rules for encoding documents in a format that is both human-readable and machine-readable.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">PostgreSQL</td>
          <td style="text-align: left">PostgreSQL, often simply Postgres, is an object-relational database (ORDBMS) - that is, an RDBMS, with additional (optional use) &quot;object&quot; features - with an emphasis on extensibility and standards-compliance.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">IBM DB2</td>
          <td style="text-align: left">IBM DB2 contains database server products developed by IBM.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Sybase/ASE</td>
          <td style="text-align: left">SAP ASE (Adaptive Server Enterprise), originally known as Sybase SQL Server, and also commonly known as Sybase DB or ASE, is a relational model database server product for businesses developed by Sybase Corporation which became part of SAP AG.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">CGI</td>
          <td style="text-align: left">Common Gateway Interface (CGI) offers a standard protocol for web servers to interface with executable programs running on a server that generate web pages dynamically.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Proxy Servers</td>
          <td style="text-align: left">A proxy server is a server (a computer system or an application) that acts as an intermediary for requests from clients seeking resources from other servers.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">SSI (Server Side Includes)</td>
          <td style="text-align: left">Server Side Includes (SSI) is a simple interpreted server-side scripting language used almost exclusively for the Web.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Cisco</td>
          <td style="text-align: left">Cisco Systems, Inc. is an American multinational corporation technology company headquartered in San Jose, California, that designs, manufactures and sells networking equipment worldwide.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Novell</td>
          <td style="text-align: left">Novell Directory Services (NDS) is a popular software product for managing access to computer resources and keeping track of the users of a network, such as a company&rsquo;s intranet, from a single point of administration.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Macromedia JRun</td>
          <td style="text-align: left">JRun is a J2EE application server, originally developed in 1997 as a Java Servlet engine by Live Software and subsequently purchased by Allaire, who brought out the first J2EE compliant version.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">BEA Systems WebLogic Server</td>
          <td style="text-align: left">Oracle WebLogic Server is a Java EE application server currently developed by Oracle Corporation.</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Lotus Domino</td>
          <td style="text-align: left">IBM Notes and IBM Domino are the client and server, respectively, of a collaborative client-server software platform sold by IBM.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">MySQL</td>
          <td style="text-align: left">MySQL is an open source relational database management system (RDBMS).</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Oracle</td>
          <td style="text-align: left">Oracle Database (commonly referred to as Oracle RDBMS or simply as Oracle) is an object-relational database management system produced and marketed by Oracle Corporation.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Microsoft SQL Server</td>
          <td style="text-align: left">Microsoft SQL Server is a relational database management system developed by Microsoft.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">PHP</td>
          <td style="text-align: left">PHP is a server-side scripting language designed primarily for web development but is also used as a general-purpose programming language.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Outlook Web Access</td>
          <td style="text-align: left">Outlook on the web (previously called Exchange Web Connect, Outlook Web Access, and Outlook Web App in Office 365 and Exchange Server 2013) is a personal information manager web app from Microsoft.</td>
          <td style="text-align: left">ASP.NET, IIS, Microsoft Windows</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Apache/NCSA HTTP Server</td>
          <td style="text-align: left">The Apache HTTP Server, colloquially called Apache, is the world&rsquo;s most used web server software.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Apache Tomcat</td>
          <td style="text-align: left">Apache Tomcat, often referred to as Tomcat, is an open source Java Servlet Container developed by the Apache Software Foundation (ASF).</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">WordPress</td>
          <td style="text-align: left">WordPress is a free and open source content management system (CMS) based on PHP and MySQL.</td>
          <td style="text-align: left">XML, PHP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Macromedia ColdFusion</td>
          <td style="text-align: left">Adobe ColdFusion is a commercial rapid web application development platform created by JJ Allaire in 1995.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Unix/Linux</td>
          <td style="text-align: left">Unix is a family of multitasking, multiuser computer operating systems that derive from the original AT&amp;T Unix, developed in the 1970s at the Bell Labs research center by Ken Thompson, Dennis Ritchie, and others.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Microsoft Windows</td>
          <td style="text-align: left">Microsoft Windows (or simply Windows) is a meta-family of graphical operating systems developed, marketed, and sold by Microsoft.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">ASP.NET</td>
          <td style="text-align: left">ASP.NET is an open source server-side web application framework designed for web development to produce dynamic web pages.</td>
          <td style="text-align: left">IIS, Microsoft Windows</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Front Page Server Extensions (FPSE)</td>
          <td style="text-align: left">FrontPage Server Extensions are a software technology that allows Microsoft FrontPage clients to communicate with web servers, and provide additional functionality intended for websites.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">IIS</td>
          <td style="text-align: left">Internet Information Services (IIS, formerly Internet Information Server) is an extensible web server created by Microsoft for use with Windows NT family.</td>
          <td style="text-align: left">Microsoft Windows</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">WebDAV</td>
          <td style="text-align: left">Web Distributed Authoring and Versioning (WebDAV) is an extension of the Hypertext Transfer Protocol (HTTP) that allows clients to perform remote Web content authoring operations.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">ASP</td>
          <td style="text-align: left">Active Server Pages (ASP), later known as Classic ASP or ASP Classic, is Microsoft&rsquo;s first server-side script engine for dynamically generated web pages.</td>
          <td style="text-align: left">IIS, Microsoft Windows</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">A Java servlet is a Java program that extends the capabilities of a server.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">jQuery</td>
          <td style="text-align: left">jQuery is a cross-platform JavaScript library designed to simplify the client-side scripting of HTML.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Server Technology Name</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Implied Technologies</th>
          <th style="text-align: left">Signature System?</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Jenkins</td>
          <td style="text-align: left">Jenkins is an open source automation server written in Java. Jenkins helps to automate the non-human part of the software development process, with continuous integration and facilitating technical aspects of continuous delivery. It is a server-based system that runs in servlet containers such as Apache Tomcat.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">SharePoint</td>
          <td style="text-align: left">SharePoint is a web-based collaborative platform that integrates with Microsoft Office. Launched in 2001, SharePoint is primarily sold as a document management and storage system, but the product is highly configurable and usage varies substantially among organizations.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Oracle Application Server</td>
          <td style="text-align: left">Oracle Internet Application Server provides a single integrated packaged solution of for middleware infrastructure including Oracle Containers for J2EE, Oracle Web Cache, Oracle HTTP Server, Oracle Forms, Oracle Reports, Oracle Portal and Oracle Discoverer.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Python</td>
          <td style="text-align: left">Python is an interpreted, high-level, general-purpose programming language. Created by Guido van Rossum and first released in 1991, Python has a design philosophy that emphasizes code readability, notably using significant whitespace. It provides constructs that enable clear programming on both small and large scales.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Oracle Identity Manager</td>
          <td style="text-align: left">Oracle Identity Manager (OIM) enables enterprises to manage the entire user lifecycle across all enterprise resources both within and beyond a firewall. Within Oracle Identity Management it provides a mechanism for implementing the user-management aspects of a corporate policy.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Spring Boot</td>
          <td style="text-align: left">Spring Boot makes it easy to create Spring-powered, production-grade applications and services with absolute minimum fuss. It takes an opinionated view of the Spring platform so that new and existing users can quickly get to the bits they need.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">CouchDB</td>
          <td style="text-align: left">Apache CouchDB is open source database software that focuses on ease of use and having a scalable architecture.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">SQLite</td>
          <td style="text-align: left">SQLite is a relational database management system contained in a C programming library. In contrast to many other database management systems, SQLite is not a client-server database engine. Rather, it is embedded into the end program.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Handlebars</td>
          <td style="text-align: left">Handlebars provides the power necessary to let you build semantic templates effectively with no frustration.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Mustache</td>
          <td style="text-align: left">Mustache is a simple web template system.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Prototype</td>
          <td style="text-align: left">Prototype takes the complexity out of client-side web programming. Built to solve real-world problems, it adds useful extensions to the browser scripting environment and provides elegant APIs around the clumsy interfaces of Ajax and the Document Object Model.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Zend</td>
          <td style="text-align: left">Zend Server is a complete and certified PHP distribution stack fully maintained and supported by Zend Technologies. It ships with an updated set of advanced value-add features designed to optimize productivity, performance, scalability and reliability.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Redis</td>
          <td style="text-align: left">Redis is an open source in-memory data structure project implementing a distributed, in-memory key-value database with optional durability. Redis supports different kinds of abstract data structures, such as strings, lists, maps, sets, sorted sets, hyperloglogs, bitmaps, streams and spatial indexes.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Underscore.js</td>
          <td style="text-align: left">Underscore.js is a JavaScript library which provides utility functions for common programming tasks. It is comparable to features provided by Prototype.js and the Ruby language, but opts for a functional programming design instead of extending object prototypes</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Ember.js</td>
          <td style="text-align: left">Ember.js is an open source JavaScript web framework, based on the Model-view-viewmodel pattern. It allows developers to create scalable single-page web applications by incorporating common idioms and best practices into the framework.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">ZURB Foundation</td>
          <td style="text-align: left">Foundation is a responsive front-end framework. Foundation provides a responsive grid and HTML and CSS UI components, templates, and code snippets, including typography, forms, buttons, navigation and other interface elements, as well as optional functionality provided by JavaScript extensions. Foundation is maintained by ZURB and is an open source project.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">ef.js</td>
          <td style="text-align: left">ef.js is an elegant HTML template engine &amp; basic framework.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Vue.js</td>
          <td style="text-align: left">Vue.js is an open source JavaScript framework for building user interfaces and single-page applications.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">UIKit</td>
          <td style="text-align: left">UIkit is a lightweight and modular front-end framework for developing fast and powerful web interfaces.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">TYPO3 CMS</td>
          <td style="text-align: left">TYPO3 is a free and open source web content management system written in PHP. It is released under the GNU General Public License. It can run on several web servers, such as Apache or IIS, on top of many operating systems, among them Linux, Microsoft Windows, FreeBSD, macOS and OS/2.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">RequireJS</td>
          <td style="text-align: left">RequireJS is a JavaScript library and file loader which manages the dependencies between JavaScript files and in modular programming. It also helps to improve the speed and quality of the code.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">React</td>
          <td style="text-align: left">React is a JavaScript library for building user interfaces. It is maintained by Facebook and a community of individual developers and companies. React can be used as a base in the development of single-page or mobile applications.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">MooTools</td>
          <td style="text-align: left">MooTools is a lightweight, object-oriented JavaScript framework. It is released under the free, open source MIT License.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Laravel</td>
          <td style="text-align: left">Laravel is a free, open source PHP web framework, created by Taylor Otwell and intended for the development of web applications following the model-view-controller architectural pattern and based on Symfony.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Google Web Toolkit</td>
          <td style="text-align: left">Google Web Toolkit, or GWT Web Toolkit, is an open source set of tools that allows web developers to create and maintain complex JavaScript front-end applications in Java. Other than a few native libraries, everything is Java source that can be built on any supported platform with the included GWT Ant build files.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Express.js</td>
          <td style="text-align: left">Express.js, or simply Express, is a web application framework for Node.js, released as free and open source software under the MIT License. It is designed for building web applications and APIs. It has been called the de facto standard server framework for Node.js.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">CodeIgniter</td>
          <td style="text-align: left">CodeIgniter is an open source software rapid development web framework, for use in building dynamic web sites with PHP.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">Backbone.js</td>
          <td style="text-align: left">Backbone.js is a JavaScript library with a RESTful JSON interface and is based on the Model-view-presenter application design paradigm. Backbone is known for being lightweight, as its only hard dependency is on one JavaScript library, Underscore.js, plus jQuery for use of the full library.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left">AngularJS</td>
          <td style="text-align: left">AngularJS is a JavaScript-based open source front-end web application framework mainly maintained by Google and by a community of individuals and corporations to address many of the challenges encountered in developing single-page applications.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">JavaScript</td>
          <td style="text-align: left">JavaScript, often abbreviated as JS, is a high-level, interpreted programming language that conforms to the ECMAScript specification. It is a language which is also characterized as dynamic, weakly typed, prototype-based and multi-paradigm.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">NGINX is a web server which can also be used as a reverse proxy, load balancer, mail proxy and HTTP cache.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Jetty</td>
          <td style="text-align: left">Jetty is a Java HTTP (Web) server and Java Servlet container</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Joomla</td>
          <td style="text-align: left">Joomla is a free and open source content management system (CMS) for publishing web content.</td>
          <td style="text-align: left">PHP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">JavaServer Faces (JSF)</td>
          <td style="text-align: left">JavaServer Faces (JSF) is a Java specification for building component-based user interfaces for web applications.</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Ruby</td>
          <td style="text-align: left">Ruby is a dynamic, reflective, object-oriented, general-purpose programming language.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">MongoDB</td>
          <td style="text-align: left">MongoDB is a free and open source cross-platform document-oriented database program.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Django</td>
          <td style="text-align: left">Django is a free and open source web framework, written in Python, which follows the model-view-template (MVT) architectural pattern.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Node.js</td>
          <td style="text-align: left">Node.js is an open source, cross-platform JavaScript runtime environment for developing a diverse variety of tools and applications.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Citrix</td>
          <td style="text-align: left">Citrix Systems, Inc. is an American multinational software company that provides server, application and desktop virtualization, networking, software as a service (SaaS), and cloud computing technologies.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">JBoss</td>
          <td style="text-align: left">The JBoss Enterprise Application Platform (or JBoss EAP) is a subscription-based/open source Java EE-based application server runtime platform used for building, deploying, and hosting highly-transactional Java applications and services.</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Elasticsearch</td>
          <td style="text-align: left">Elasticsearch is a search engine based on Lucene.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Apache Struts</td>
          <td style="text-align: left">Apache Struts is an open source web application framework for developing Java EE web applications.</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">XML</td>
          <td style="text-align: left">Extensible Markup Language (XML) is a markup language that defines a set of rules for encoding documents in a format that is both human-readable and machine-readable.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">PostgreSQL</td>
          <td style="text-align: left">PostgreSQL, often simply Postgres, is an object-relational database (ORDBMS) - that is, an RDBMS, with additional (optional use) &quot;object&quot; features - with an emphasis on extensibility and standards-compliance.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">IBM DB2</td>
          <td style="text-align: left">IBM DB2 contains database server products developed by IBM.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Sybase/ASE</td>
          <td style="text-align: left">SAP ASE (Adaptive Server Enterprise), originally known as Sybase SQL Server, and also commonly known as Sybase DB or ASE, is a relational model database server product for businesses developed by Sybase Corporation which became part of SAP AG.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">CGI</td>
          <td style="text-align: left">Common Gateway Interface (CGI) offers a standard protocol for web servers to interface with executable programs running on a server that generate web pages dynamically.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Proxy Servers</td>
          <td style="text-align: left">A proxy server is a server (a computer system or an application) that acts as an intermediary for requests from clients seeking resources from other servers.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">SSI (Server Side Includes)</td>
          <td style="text-align: left">Server Side Includes (SSI) is a simple interpreted server-side scripting language used almost exclusively for the Web.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Cisco</td>
          <td style="text-align: left">Cisco Systems, Inc. is an American multinational corporation technology company headquartered in San Jose, California, that designs, manufactures and sells networking equipment worldwide.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Novell</td>
          <td style="text-align: left">Novell Directory Services (NDS) is a popular software product for managing access to computer resources and keeping track of the users of a network, such as a company&rsquo;s intranet, from a single point of administration.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Macromedia JRun</td>
          <td style="text-align: left">JRun is a J2EE application server, originally developed in 1997 as a Java Servlet engine by Live Software and subsequently purchased by Allaire, who brought out the first J2EE compliant version.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">BEA Systems WebLogic Server</td>
          <td style="text-align: left">Oracle WebLogic Server is a Java EE application server currently developed by Oracle Corporation.</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Lotus Domino</td>
          <td style="text-align: left">IBM Notes and IBM Domino are the client and server, respectively, of a collaborative client-server software platform sold by IBM.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">MySQL</td>
          <td style="text-align: left">MySQL is an open source relational database management system (RDBMS).</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Oracle</td>
          <td style="text-align: left">Oracle Database (commonly referred to as Oracle RDBMS or simply as Oracle) is an object-relational database management system produced and marketed by Oracle Corporation.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Microsoft SQL Server</td>
          <td style="text-align: left">Microsoft SQL Server is a relational database management system developed by Microsoft.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">PHP</td>
          <td style="text-align: left">PHP is a server-side scripting language designed primarily for web development but is also used as a general-purpose programming language.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Outlook Web Access</td>
          <td style="text-align: left">Outlook on the web (previously called Exchange Web Connect, Outlook Web Access, and Outlook Web App in Office 365 and Exchange Server 2013) is a personal information manager web app from Microsoft.</td>
          <td style="text-align: left">ASP.NET, IIS, Microsoft Windows</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Apache/NCSA HTTP Server</td>
          <td style="text-align: left">The Apache HTTP Server, colloquially called Apache, is the world&rsquo;s most used web server software.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Apache Tomcat</td>
          <td style="text-align: left">Apache Tomcat, often referred to as Tomcat, is an open source Java Servlet Container developed by the Apache Software Foundation (ASF).</td>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">WordPress</td>
          <td style="text-align: left">WordPress is a free and open source content management system (CMS) based on PHP and MySQL.</td>
          <td style="text-align: left">XML, PHP</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Macromedia ColdFusion</td>
          <td style="text-align: left">Adobe ColdFusion is a commercial rapid web application development platform created by JJ Allaire in 1995.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Unix/Linux</td>
          <td style="text-align: left">Unix is a family of multitasking, multiuser computer operating systems that derive from the original AT&amp;T Unix, developed in the 1970s at the Bell Labs research center by Ken Thompson, Dennis Ritchie, and others.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Microsoft Windows</td>
          <td style="text-align: left">Microsoft Windows (or simply Windows) is a meta-family of graphical operating systems developed, marketed, and sold by Microsoft.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">ASP.NET</td>
          <td style="text-align: left">ASP.NET is an open source server-side web application framework designed for web development to produce dynamic web pages.</td>
          <td style="text-align: left">IIS, Microsoft Windows</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Front Page Server Extensions (FPSE)</td>
          <td style="text-align: left">FrontPage Server Extensions are a software technology that allows Microsoft FrontPage clients to communicate with web servers, and provide additional functionality intended for websites.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">IIS</td>
          <td style="text-align: left">Internet Information Services (IIS, formerly Internet Information Server) is an extensible web server created by Microsoft for use with Windows NT family.</td>
          <td style="text-align: left">Microsoft Windows</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">WebDAV</td>
          <td style="text-align: left">Web Distributed Authoring and Versioning (WebDAV) is an extension of the Hypertext Transfer Protocol (HTTP) that allows clients to perform remote Web content authoring operations.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">ASP</td>
          <td style="text-align: left">Active Server Pages (ASP), later known as Classic ASP or ASP Classic, is Microsoft&rsquo;s first server-side script engine for dynamically generated web pages.</td>
          <td style="text-align: left">IIS, Microsoft Windows</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">Java Servlets/JSP</td>
          <td style="text-align: left">A Java servlet is a Java program that extends the capabilities of a server.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left">jQuery</td>
          <td style="text-align: left">jQuery is a cross-platform JavaScript library designed to simplify the client-side scripting of HTML.</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>

</div>
<h5 
id="generic-signature-systems">Generic Signature Systems  <a class="headerlink float-right" href="#generic-signature-systems" title="Generic Signature Systems"><i class="fas fa-link fa-xs"></i></a>
</h5><p>These signature systems are generic and do not represent a particular technology, therefore do not have a server technology counterpart. Yet, there are signatures associated with them. The <code>Generic Detection Signatures</code> factory signature set includes most of these signatures. You can define your own signature sets using one or more of those systems.</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">System Name</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Other Web Server</td>
          <td style="text-align: left">Web Servers that are not covered by any of the specific server technologies</td>
      </tr>
      <tr>
          <td style="text-align: left">System Independent</td>
          <td style="text-align: left">Used to denote signatures that apply to any server technology</td>
      </tr>
      <tr>
          <td style="text-align: left">Various Systems</td>
          <td style="text-align: left">Server-side systems not covered by any of the existing server technologies or the other systems here</td>
      </tr>
      <tr>
          <td style="text-align: left">Generic Database</td>
          <td style="text-align: left">Database systems that are not covered by any of the specific server technologies</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">System Name</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Other Web Server</td>
          <td style="text-align: left">Web Servers that are not covered by any of the specific server technologies</td>
      </tr>
      <tr>
          <td style="text-align: left">System Independent</td>
          <td style="text-align: left">Used to denote signatures that apply to any server technology</td>
      </tr>
      <tr>
          <td style="text-align: left">Various Systems</td>
          <td style="text-align: left">Server-side systems not covered by any of the existing server technologies or the other systems here</td>
      </tr>
      <tr>
          <td style="text-align: left">Generic Database</td>
          <td style="text-align: left">Database systems that are not covered by any of the specific server technologies</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="threat-campaigns">Threat Campaigns  <a class="headerlink float-right" href="#threat-campaigns" title="Threat Campaigns"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Threat Campaigns is a threat intelligence feature included in an NGINX App Protect WAF subscription. The feature includes frequent update feeds containing contextual information about active attack campaigns currently being observed by F5 Threat Labs that NGINX App Protect WAF can provide protection against. As an example, without threat campaign updates NGINX App Protect WAF (and any WAF in general) may detect an attack pattern in a web application form parameter, but it cannot correlate the singular attack incident as part of a more extensive and sophisticated threat campaign. Threat Campaigns&rsquo; contextual information is very specific to current attack campaigns, allowing false positives to be virtually non-existent.</p>
<p>Just like attack signatures, the Threat Campaign patterns, i.e. <code>app-protect-attack-signatures</code> and <code>app-protect-threat-campaigns</code> are installed as a dependency chain of our main package <code>app-protect</code>. Then, these two package dependencies should be updated periodically to get the latest security updates. Due to the highly dynamic nature of threat campaigns the updates are issued far more frequently than the attack signatures. You need to install those updates close to the time they are issued in order to get the most effective protection.</p>
<p>The default policy enables the mechanism with all available Threat Campaigns and blocks when detecting one. Since the risk of false positive is very low, you do not need to enable or disable specific Threat Campaigns. Rather, you can disable the whole mechanism or decide to only alarm rather than block. You can do that by modifying the properties of the Threat Campaign Violation - <code>VIOL_THREAT_CAMPAIGN</code>.</p>
<p>In this example we disable both alarm and blocking.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f621acf10&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f621acf10">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="p">{</span>
</span></span><span class="line"><span class="cl">                   <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_THREAT_CAMPAIGN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">               <span class="p">}</span>
</span></span><span class="line"><span class="cl">           <span class="p">]</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="p">{</span>
</span></span><span class="line"><span class="cl">                   <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_THREAT_CAMPAIGN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">               <span class="p">}</span>
</span></span><span class="line"><span class="cl">           <span class="p">]</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="data-guard---blocking">Data Guard - Blocking  <a class="headerlink float-right" href="#data-guard---blocking" title="Data Guard - Blocking"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Data Guard is a security feature that can be used to prevent the leakage of sensitive information from an application. This could be credit card numbers (CCN) or Social Security numbers (SSN) or custom patterns. Once this feature is enabled, sensitive data is either blocked or masked, depending on the configuration.</p>
<p>In this example, we enable the data guard violation in blocking mode. In the detailed configuration, we enable enforcement of data guard and specify which items are being protected against information leakage. Note that if blocking is enabled, data masking will have no effect in this case.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f621e68f0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f621e68f0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;dataguard_blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_DATA_GUARD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;data-guard&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;maskData&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;creditCardNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;usSocialSecurityNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore-urls-in-list&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementUrls&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;dataguard_blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_DATA_GUARD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;data-guard&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;maskData&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;creditCardNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;usSocialSecurityNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore-urls-in-list&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementUrls&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="data-guard---masking">Data Guard - Masking  <a class="headerlink float-right" href="#data-guard---masking" title="Data Guard - Masking"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Masking is used when we do not want to block the page entirely but want to mask all sensitive data in the response.</p>
<p>In this example, we enable data guard in alarm mode. In the detailed configuration, we enable enforcement of data guard and specify which items are being protected against information leakage.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6221e778&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6221e778">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;nginx_default_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_DATA_GUARD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;data-guard&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;maskData&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;creditCardNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;usSocialSecurityNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore-urls-in-list&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementUrls&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;nginx_default_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_DATA_GUARD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;data-guard&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;maskData&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;creditCardNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;usSocialSecurityNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore-urls-in-list&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementUrls&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="partial-masking-of-data-using-data-guard">Partial Masking of Data using Data Guard  <a class="headerlink float-right" href="#partial-masking-of-data-using-data-guard" title="Partial Masking of Data using Data Guard"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Here is an example showing partial masking on custom patterns. Custom patterns are specified in <code>customPatternsList</code>, number of unmasked leading and trailing characters are defined in <code>firstCustomCharactersToExpose</code> and <code>lastCustomCharactersToExpose</code> parameters.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f628bec18&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f628bec18">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;custom_pattern_mask_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_DATA_GUARD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;data-guard&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;maskData&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;creditCardNumbers&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;usSocialSecurityNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore-urls-in-list&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementUrls&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;customPatterns&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;firstCustomCharactersToExpose&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;lastCustomCharactersToExpose&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;customPatternsList&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;....-....-....-....&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;siteTk_[0-9]+&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;custom_pattern_mask_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_DATA_GUARD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;data-guard&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;maskData&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;creditCardNumbers&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;usSocialSecurityNumbers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore-urls-in-list&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcementUrls&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;customPatterns&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;firstCustomCharactersToExpose&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;lastCustomCharactersToExpose&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;customPatternsList&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;....-....-....-....&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;siteTk_[0-9]+&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 
id="file-types">File Types  <a class="headerlink float-right" href="#file-types" title="File Types"><i class="fas fa-link fa-xs"></i></a>
</h4><p>A user can enable/disable specific file types in the policy.</p>
<p>In this example, we enable the file type violation in blocking mode. In the detailed configuration, we allow the * wildcard entity which would allow all file types by default. In the last section, we explicitly disable the <code>bat</code> file type. This is an example of allowing all, but specifically blocking (via deny list) certain items.  You may add as many file types as you wish, each declared in its own curly brackets, along with the <code>&quot;allowed&quot;: false</code> directive.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6299f9c0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6299f9c0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_FILETYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;filetypes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkPostDataLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;postDataLength&#34;</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkRequestLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;requestLength&#34;</span><span class="p">:</span> <span class="mi">8192</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkUrlLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlLength&#34;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkQueryStringLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;queryStringLength&#34;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responseCheck&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;policy1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_FILETYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;filetypes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkPostDataLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;postDataLength&#34;</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkRequestLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;requestLength&#34;</span><span class="p">:</span> <span class="mi">8192</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkUrlLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlLength&#34;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkQueryStringLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;queryStringLength&#34;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responseCheck&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="response-signatures">Response Signatures  <a class="headerlink float-right" href="#response-signatures" title="Response Signatures"><i class="fas fa-link fa-xs"></i></a>
</h4><p>All Response Signatures are attack signatures detected on the response side, in contrast to the request side.</p>
<h4 
id="restrict-response-signatures">Restrict Response Signatures  <a class="headerlink float-right" href="#restrict-response-signatures" title="Restrict Response Signatures"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Restrict Response Signatures enhancement assists the users in saving time by limiting the search for response signatures to a specified amount. You can enable the signature verification in the response by setting the <code>responseCheck</code> parameter to true. However, the restriction of certain signatures is set in the policy and then enforced by the App Protect.</p>
<p>In the policy base template under the &ldquo;filetypes&rdquo; section, make sure you enable the <code>responseCheck</code> attribute for <code>responseCheckLength</code> to work properly. The default value of <code>responseCheck</code> parameter is set to false.</p>
<p>The <code>responseCheckLength</code> parameter refers to the number of uncompressed bytes in the response body prefix that are examined for signatures. The <code>responseCheckLength</code> field will be added with the default value of <strong>20000</strong> bytes which means that the first 20,000 bytes of the response body will undergo signature verification.</p>
<p>Restrict Response Signature example:</p>
<p>In the below policy example, in the &ldquo;filetypes&rdquo; section, the <code>responseCheck</code> parameter is set to true, indicating that response check will be enabled.
When enforcing signatures on the response, we have the flexibility to restrict the portion of the response body that requires validation. In this case, the policy is configured with <code>responseCheckLength</code> set to 1000, signifying that only the initial 1000 bytes of the response body will undergo signature verification.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62a19ec8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62a19ec8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;response_signatures_block&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;filetypes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">           <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;responseCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		    <span class="nt">&#34;responseCheckLength&#34;</span><span class="p">:</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">           <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Response Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">           <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;response_signatures_block&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;filetypes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">           <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;responseCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		    <span class="nt">&#34;responseCheckLength&#34;</span><span class="p">:</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">           <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Response Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">           <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="how-does-restrict-response-signature-check-work">How Does Restrict Response Signature Check Work?  <a class="headerlink float-right" href="#how-does-restrict-response-signature-check-work" title="How Does Restrict Response Signature Check Work?"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The response signature check is always done on the configured <code>responseCheckLength</code> as described above. Usually NGINX App Protect WAF will buffer only that part of the response saving memory and CPU, but in some conditions the whole response may have to be buffered, such as when the response body is compressed.</p>
<h4 
id="allowed-methods">Allowed Methods  <a class="headerlink float-right" href="#allowed-methods" title="Allowed Methods"><i class="fas fa-link fa-xs"></i></a>
</h4><p>In the policy, you can specify what methods to allow or disallow.</p>
<p>In this example, we enable the illegal method violation in blocking mode. In the methods configuration, we define which of the methods are allowed. If a method is allowed by default, it can be disallowed via <code>&quot;$action&quot;: &quot;delete&quot;</code>. In the following example we disallow the default allowed method <code>PUT</code> by removing it from the default enforcement. For illustrative purposes this example also has all the other methods that are allowed by default defined in the configuration, but in practicality they do not actually need to be included explicitly to be allowed:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62ab37d0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62ab37d0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_METHOD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;methods&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;GET&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;HEAD&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;PUT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;PATCH&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;DELETE&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;OPTIONS&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_METHOD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;methods&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;GET&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;HEAD&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;PUT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;PATCH&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;DELETE&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;OPTIONS&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="custom-method-enforcement">Custom Method Enforcement  <a class="headerlink float-right" href="#custom-method-enforcement" title="Custom Method Enforcement"><i class="fas fa-link fa-xs"></i></a>
</h4><p>To enable any custom method other than the above mentioned HTTP standard methods, the user must configure the specific modules that allow those methods. NGINX will reject any custom method other than the standard allowed HTTP methods GET, POST, PUT, DELETE, HEAD, and OPTIONS.</p>
<p>For example, see currently supported <a href="https://nginx.org/en/docs/http/ngx_http_dav_module.html" target="_blank" rel="noopener">WebDAV Methods</a>.</p>
<h4 
id="response-codes">Response Codes  <a class="headerlink float-right" href="#response-codes" title="Response Codes"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Response codes are a general setting that defines which response codes are acceptable, while all others will be blocked.</p>
<p>In this example, we enable the response status codes violation in blocking mode. In the general configuration, we define which of the response codes are allowed. This would mean that all others will be considered as illegal response codes and will be blocked. In this configuration, you specify a list of comma-separated response codes that are allowed.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62b36978&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62b36978">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;allowed_response&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_HTTP_RESPONSE_STATUS&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;general&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;allowedResponseCodes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="mi">400</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">401</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">403</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">404</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">502</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">499</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;allowed_response&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_HTTP_RESPONSE_STATUS&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;general&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;allowedResponseCodes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="mi">400</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">401</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">403</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">404</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">502</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">499</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 
id="parameters">Parameters  <a class="headerlink float-right" href="#parameters" title="Parameters"><i class="fas fa-link fa-xs"></i></a>
</h4><p>When configuring handling of parameters, it is a bit different from other configurations we have dealt with earlier, where we enable a violation and configure its details. With parameters, there are a number of independent violations that need to be enabled on their own, as well as a parameter section to define further customization. The full list of parameter violations can be extracted from the above violation list.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62bca0d8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62bca0d8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;parameters_blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_MULTIPART_NULL_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NAME_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMetachars&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharsOnParameterValueCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;parameters_blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_MULTIPART_NULL_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NAME_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMetachars&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharsOnParameterValueCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In this example we configure allowed meta-characters in parameter name and value.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62c426a0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62c426a0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;parameters_allowed_metachars&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_MULTIPART_NULL_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NAME_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMetachars&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;nameMetacharOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3c&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3e&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharsOnParameterValueCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValueLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueMetacharOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3c&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3e&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;level&#34;</span><span class="p">:</span> <span class="s2">&#34;global&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureOverrides&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;parameters_allowed_metachars&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_MULTIPART_NULL_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NAME_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMetachars&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;nameMetacharOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3c&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3e&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharsOnParameterValueCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValueLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueMetacharOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3c&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3e&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;level&#34;</span><span class="p">:</span> <span class="s2">&#34;global&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureOverrides&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In this example, we define a sensitive parameter <code>mypass</code> configuration.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62c84938&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62c84938">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;parameters_sensitive&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_MULTIPART_NULL_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NAME_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;sensitive-parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mypass&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;parameters_sensitive&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_MULTIPART_NULL_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NAME_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;sensitive-parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mypass&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="user-defined-urls">User-Defined URLs  <a class="headerlink float-right" href="#user-defined-urls" title="User-Defined URLs"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The user-defined URL feature allows the user to configure the URL while supporting the following options:</p>
<ul>
<li>Define a protected URL configuration both explicitly and by wildcards.</li>
<li>Define a per-URL list of allowed/disallowed methods that will override the list defined in the policy level.</li>
<li>Define a content-type: json/xml/form-data on a user-defined URL.</li>
<li>Define an Allowed/Disallowed user-defined URL.</li>
<li>Add a user-defined URL to the Signature/Metacharacters override list.</li>
</ul>
<p>For <code>urlContentProfiles</code> default values, see NGINX App Protect WAF <a href="http://localhost:1313/nginx-app-protect-waf/v4/declarative-policy/policy/">Declarative Policy guide.</a></p>
<p>In this example we configure allowed meta-characters in a user-defined URL:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62cdb008&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62cdb008">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/Common/user_defined_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/meta*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharsOnUrlCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3c&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x28&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;wildcardOrder&#34;</span><span class="p">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/Common/user_defined_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL_METACHAR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/meta*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharsOnUrlCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x3c&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;metachar&#34;</span><span class="p">:</span> <span class="s2">&#34;0x28&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;wildcardOrder&#34;</span><span class="p">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In this example, we disable the detection of a specific signature, <code>200010093</code> and enable another one, <code>200010008</code>, both in a user-defined URL <code>/Common/user_defined_URL</code>. These signature settings take effect only in requests to that URL. In other requests, the signature behavior is determined by the signature sets these signatures belong to. See <a href="#signature-sets">Signature Sets</a> for more details.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62d25b58&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62d25b58">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/Common/user_defined_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/test*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;wildcardOrder&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200010008</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200010093</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/Common/user_defined_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/test*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;wildcardOrder&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200010008</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200010093</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In this example, we configure Wildcard/Explicit URLs, where the first URL is permitted for all methods, and the second is permitted only for GET:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62d69d30&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62d69d30">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/Common/user_defined_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/test*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;wildcardOrder&#34;</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;GET&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/index.html&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/Common/user_defined_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/test*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;wildcardOrder&#34;</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;GET&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/index.html&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In this example, we configure json/xml/form-data content types for a specific user-defined URL:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62e31c68&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62e31c68">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/Common/user_defined_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_METHOD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_JSON_MALFORMED&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_JSON_FORMAT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_XML_FORMAT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;handleJsonValuesAsParameters&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumTotalLengthOfJSONData&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumArrayLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumStructureDepth&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;xml-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumAttributesPerElement&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumDocumentDepth&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumAttributeValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumChildrenPerElement&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumDocumentSize&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumElements&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumNameLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumNSDeclarations&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumNamespaceLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateLeadingWhiteSpace&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateCloseTagShorthand&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowCDATA&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowExternalReferences&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowProcessingInstructions&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/first*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;wildcardOrder&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;form-data&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*xml*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;Content-Type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;xml&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*json*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;Content-Type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;json&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/Common/user_defined_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_METHOD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_JSON_MALFORMED&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_JSON_FORMAT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_XML_FORMAT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;handleJsonValuesAsParameters&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumTotalLengthOfJSONData&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumArrayLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumStructureDepth&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;xml-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumAttributesPerElement&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumDocumentDepth&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumAttributeValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumChildrenPerElement&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumDocumentSize&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumElements&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumNameLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumNSDeclarations&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumNamespaceLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateLeadingWhiteSpace&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateCloseTagShorthand&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowCDATA&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowExternalReferences&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowProcessingInstructions&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/first*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;wildcardOrder&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;form-data&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*xml*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;Content-Type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;xml&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*json*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;Content-Type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;json&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 
id="do-nothing">Do-Nothing  <a class="headerlink float-right" href="#do-nothing" title="Do-Nothing"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The do-nothing in urlContentProfiles allows the user to avoid inspecting or parsing the content in a policy, and instead handle the request&rsquo;s header according to the specifications outlined in the security policy.</p>
<p>In this example, we configure do-nothing content types for a specific user-defined URL:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f62f37fb8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f62f37fb8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore_body&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;do-nothing&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;ignore_body&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;do-nothing&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="user-defined-parameters">User-Defined Parameters  <a class="headerlink float-right" href="#user-defined-parameters" title="User-Defined Parameters"><i class="fas fa-link fa-xs"></i></a>
</h4><p>So far, we have been managing the default parameter or * entity. What if we want to give specific attributes to specific parameters? This can be done by creating and configuring the user-defined parameters. This feature gives the user full control over what the parameter should include, where it should be located and allows for granularity in configuring each and every parameter. Here you can:</p>
<ul>
<li>Create unique parameters and specify attributes for each.</li>
<li>Define what data type the parameter should contain.</li>
<li>Define the allowed location where you expect to see a parameter.</li>
<li>Define minimum/maximum values and minimum/maximum lengths for a parameter.</li>
<li>Define whether a parameter is mandatory or not.</li>
<li>Define whether the parameter can have empty values or not.</li>
<li>Define whether to inspect a parameter for violations, attack signatures, or meta-characters.</li>
<li>Decide whether to exclude certain violations, attack signatures, or meta-characters for a parameter.</li>
</ul>
<p>In the following example, we configure two parameters. The first one, <code>text</code>, takes string values (here configured as alpha-numeric), and limits the length of the allowed string between 4 and 8 characters. Any string below or above these values will trigger the violation <code>VIOL_PARAMETER_VALUE_LENGTH</code>. Note that we enable this violation to <em>block</em> the violating request.</p>
<p>The second parameter, <code>query</code>, is added to the policy just to avoid a false positive condition due to a specific signature, <code>200002835</code>. Suppose you realized that whenever this signature detected on this parameter, it was false positive. You would like to disable this signature, but only in the context of this parameter. The signature will still be detected on values of other parameters.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63006c50&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63006c50">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_data_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;text&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;alpha-numeric&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMinValueLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValueLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;minimumLength&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;maximumLength&#34;</span><span class="p">:</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;query&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;alpha-numeric&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200002835</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_data_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;text&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;alpha-numeric&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMinValueLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValueLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;minimumLength&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;maximumLength&#34;</span><span class="p">:</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;query&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;alpha-numeric&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200002835</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In the next example, we configure a numeric parameter. This parameter accepts only integer values and allows values between 9 and 99 (non-inclusive). If the request includes anything other than an integer, it will trigger the <code>VIOL_PARAMETER_DATA_TYPE</code> violation. If the parameter value falls beyond or below the desired values, it will trigger the <code>VIOL_PARAMETER_NUMERIC_VALUE</code> violation. Note that if you change the values of <code>exclusiveMin</code> and <code>exclusiveMax</code> to false, values equal to the boundary values will be accepted (namely 9 and 99).</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f630d3d90&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f630d3d90">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_data_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NUMERIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_STATIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_DATA_TYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;number&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;integer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMinValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;minimumValue&#34;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;maximumValue&#34;</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;exclusiveMin&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;exclusiveMax&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_data_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NUMERIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_STATIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_DATA_TYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;number&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;integer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMinValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;minimumValue&#34;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;maximumValue&#34;</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;exclusiveMin&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;exclusiveMax&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>For increased granularity, you can configure whether the parameter value is also a multiple of a specific number. This is useful when you wish to limit the input to specific values. The following example configures a parameter that accepts values in the range of 0 to 10 and are only multiples of 3. This means that the accepted values are 3, 6 and 9. Any other value will trigger the <code>VIOL_PARAMETER_NUMERIC_VALUE</code> violation.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6317b928&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6317b928">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_data_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NUMERIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_STATIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_DATA_TYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;multiples&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;integer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMinValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;minimumValue&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;maximumValue&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMultipleOfValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;multipleOf&#34;</span><span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_data_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NUMERIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_STATIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_DATA_TYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;multiples&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;integer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMinValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;minimumValue&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;maximumValue&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMultipleOfValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;multipleOf&#34;</span><span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Another very useful example is when the user wants to limit the parameter to a single context, like in a header or a query string. If the same variable appears in a different location, it will trigger the <code>VIOL_PARAMETER_LOCATION</code> violation.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6323b778&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6323b778">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_misc_test&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NUMERIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_STATIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_DATA_TYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_LOCATION&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;headerparam&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;header&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;alpha-numeric&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMinValueLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValueLength&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_misc_test&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NUMERIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_STATIC_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_DATA_TYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_LOCATION&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;headerparam&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;header&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;alpha-numeric&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMinValueLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;checkMaxValueLength&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Another very useful example is the following configuration. It has:</p>
<ul>
<li>A sensitive parameter <code>mypass</code> that should be masked in the logs.</li>
<li>A parameter <code>empty</code> that is allowed to be empty.</li>
<li>A parameter <code>repeated</code> that can be repeated multiple times.</li>
<li>A parameter <code>mandatory</code> that is mandatory for all requests.</li>
</ul>
<p>Note that new violations were enabled so that the configuration becomes effective.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63357670&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63357670">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_misc_test&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_EMPTY_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_REPEATED&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_MANDATORY_PARAMETER&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mypass&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;empty&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;repeated&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mandatory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_parameters_misc_test&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_EMPTY_VALUE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_REPEATED&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_MANDATORY_PARAMETER&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mypass&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;empty&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;repeated&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mandatory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatory&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowEmptyValue&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;allowRepeatedParameterName&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sensitiveParameter&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;auto-detect&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 
id="user-defined-signatures">User-Defined Signatures  <a class="headerlink float-right" href="#user-defined-signatures" title="User-Defined Signatures"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Another useful expansion to the customization capabilities is the ability to create user-defined signatures. This capability allows the user to define new signatures, configure how they behave in terms of enforcement, and categorize them in user-defined signature sets (using tags) for ease of management.</p>
<p>The process of creating and implementing a user policy that contains user-defined signatures is a three-fold process:</p>
<ul>
<li>Creating the user-defined signature definitions in separate JSON files.</li>
<li>Adding the relevant references (names, tags, signature sets) to the user-defined signatures in a policy JSON file.</li>
<li>Referencing user-defined JSON files in a <a href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/compiler/#global-settings">global settings</a> file.</li>
<li>Compiling a policy bundle using <a href="http://localhost:1313/nginx-app-protect-waf/v5/admin-guide/compiler/">NGINX App Protect WAF Compiler</a></li>
</ul>
<h5 
id="user-defined-signature-definitions">User-Defined Signature Definitions  <a class="headerlink float-right" href="#user-defined-signature-definitions" title="User-Defined Signature Definitions"><i class="fas fa-link fa-xs"></i></a>
</h5><p>The user-defined signature definition file is a JSON file where the signatures themselves are defined and given their properties and tags. The format of the user-defined signature definition is as follows:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63423fe0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63423fe0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;tag_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;revisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2020-01-21T18:32:02Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;tag_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;revisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2020-01-21T18:32:02Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Tags help organizing the user-defined signatures in bundles so that all signatures in that bundle are (usually) authored by the same person and share a common purpose or set of applications that will consume it. It also creates name spaces that avoid name conflicts among user-defined signatures. Signatures are uniquely identified by the combination of tag and name. The <code>tag_name</code> should be replaced with the tag name to be assigned to all signatures in this file or group. The <code>revisionDatetime</code> specifies the date or version of the signature file. Note that you can create as many user-defined signature definition files as you wish provided that you assign a unique tag for each file and that the user-defined signatures have unique names, both within the same file, or across different files.</p>
<p>To add user-defined signatures to the signatures list, each signature must have the following format:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6347b650&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6347b650">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;unique_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Add your description here&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;rule&#34;</span><span class="p">:</span> <span class="s2">&#34;content:\&#34;string\&#34;; nocase;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Buffer Overflow&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Microsoft Windows&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unix/Linux&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;unique_name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Add your description here&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;rule&#34;</span><span class="p">:</span> <span class="s2">&#34;content:\&#34;string\&#34;; nocase;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Buffer Overflow&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Microsoft Windows&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unix/Linux&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here is a brief explanation about each of the above items in the signature definition:</p>
<ul>
<li><code>name</code> - is the unique name to be given to the user-defined signature.</li>
<li><code>description</code> - is an optional item where you can add a human-readable text to describe the functionality or purpose of the signature.</li>
<li><code>rule</code> - is the rule by which the enforcement will be done. The rule uses Snort syntax: a keyword to look for in a certain context, such as URL, header, parameter, content, and optionally one or more regular expressions. For full details on how to create a rule and the possible permutations, check the <a href="https://techdocs.f5.com/kb/en-us/products/big-ip_asm/manuals/product/asm-bot-and-attack-signatures-13-0-0/7.html#guid-797a0c69-a859-45cd-be11-fd0e1a975780" target="_blank" rel="noopener">Rule Syntax</a> page.</li>
<li><code>signatureType</code> - defines whether the signature is relevant to the request or the response.</li>
<li><code>attackType</code> - this field gives an indication of the attack type the signature is intended to prevent. This field is mostly useful for signature set enforcement and logging purposes. A full list of the available attack types can be found in the <a href="#attack-types">Attack Types</a> section.</li>
<li><code>systems</code> - is a list of systems (operating systems, programming languages, etc.) that the signature should be applicable for. Note that <code>systems</code> have the same meaning and use as <code>server technologies</code> although the overlap between both terms is not perfect. This is explained in the above section <a href="#server-technologies">Server Technologies</a>.</li>
<li><code>risk</code> - defines the risk level associated with this signature. Possible values are: low, medium, high.</li>
<li><code>accuracy</code> - defines the accuracy level of the signature. Note that the value of this field contributes to the value of the <a href="#violations">Violation Rating</a>. Possible values are: low, medium, high.</li>
</ul>
<p>The following is an example of a user-defined signature definition file called <code>user_defined_signature_definitions.json</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f635068e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f635068e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;softwareVersion&#34;</span><span class="p">:</span> <span class="s2">&#34;15.1.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruits&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;revisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2020-01-22T18:32:02Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Apple_medium_acc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;rule&#34;</span><span class="p">:</span> <span class="s2">&#34;content:\&#34;apple\&#34;; nocase;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Buffer Overflow&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Microsoft Windows&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unix/Linux&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Medium accuracy user defined signature with tag (Fruits)&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;softwareVersion&#34;</span><span class="p">:</span> <span class="s2">&#34;15.1.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruits&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;revisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2020-01-22T18:32:02Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Apple_medium_acc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;rule&#34;</span><span class="p">:</span> <span class="s2">&#34;content:\&#34;apple\&#34;; nocase;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Buffer Overflow&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Microsoft Windows&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unix/Linux&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Medium accuracy user defined signature with tag (Fruits)&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h5 
id="updating-the-policy">Updating the Policy  <a class="headerlink float-right" href="#updating-the-policy" title="Updating the Policy"><i class="fas fa-link fa-xs"></i></a>
</h5><p>Once all the user-defined signatures are added to definitions files, it is time to activate and use them in the policy. To achieve this, certain items need to be added to the policy file to enable these signatures, and to specify the action to take when they are matched. The following policy shows a simplified policy file example called <code>user_defined_signatures_policy.json</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f635936c8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f635936c8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_single_signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-requirements&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruits&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;minRevisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2020-01-20T18:32:02Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;maxRevisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2020-01-23T18:32:02Z&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Apple_medium_acc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruits&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruit_signature_set&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureSet&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;filter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;tagValue&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruits&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;tagFilter&#34;</span><span class="p">:</span> <span class="s2">&#34;eq&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;user_defined_single_signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-requirements&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruits&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;minRevisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2020-01-20T18:32:02Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;maxRevisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2020-01-23T18:32:02Z&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Apple_medium_acc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruits&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruit_signature_set&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureSet&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;filter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;tagValue&#34;</span><span class="p">:</span> <span class="s2">&#34;Fruits&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;tagFilter&#34;</span><span class="p">:</span> <span class="s2">&#34;eq&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Following is an explanation of each of the items added to the bare policy that are relevant to user-defined signatures:</p>
<ul>
<li><code>signature-requirements</code> - Specifies which tags are being used in this policy, and from which revision/version (<code>minRevisionDatetime</code> and <code>maxRevisionDatetime</code> are optional). The signature requirements serve as an indication of what tags and revisions are required for the proper operation of the policy. If the requirement is met and the tag exists, this means that the signature import was successful, and that the policy compilation process will pass. However, if the tag/revision requirement is specified and no such tag or revision exists, then the policy compilation process will fail. This could mean that the user imported the wrong definitions file, imported a different revision than the one we require, or even forgot to import the definitions file altogether.</li>
<li><code>signatures</code> - The list of signatures we want to add to the policy. Note that each signature should have its unique name added as well as its relevant tag. The signature will then be automatically enabled. This section is redundant if the user wants to enable all signatures. However, if they want to disable specific signature(s), this section becomes mandatory where each signature should have the <code>enabled:</code> with <code>true</code> or <code>false</code> specified. A better way to disable signatures is by removing them from the definitions file altogether and reloading the policy.</li>
<li><code>signature-sets</code> - How the signatures are added to the policy enforcement. The set filters the signatures by tag and adds all the signatures matching this tag to the user-defined signature set. Here we can specify the action taken when a signature match is made (whether to alarm, block, or both)</li>
</ul>

<h5 
id="updating-nginxconf">Updating nginx.conf  <a class="headerlink float-right" href="#updating-nginxconf" title="Updating nginx.conf"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In order for NGINX App Protect WAF to load the new user-defined signatures, the user needs to add the directive: <code>app_protect_user_defined_signatures</code>. This directive can only be used (multiple times, if needed) in the http context in the nginx.conf file and cannot be used under the server or location contexts. This directive accepts the path of the user-defined signature definition file as an argument. To add multiple definition files, the user will need to add a directive per file. Note that if the file or directory is not accessible by the nginx user, an error message will be displayed, and the policy will fail to compile.</p>
<p>An example configuration file is listed below:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f5fe21d20&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f5fe21d20">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_processes</span>  <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">65536</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">sendfile</span>        <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">keepalive_timeout</span>  <span class="mi">65</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/nginx/user_defined_signatures_policy.json&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_user_defined_signatures</span> <span class="s">&#34;/etc/nginx/user_defined_signature_definitions.json&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_security_log</span> <span class="s">&#34;/etc/app_protect/conf/log_default.json&#34;</span> <span class="s">syslog:server=127.0.0.1:514</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:8080</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_processes</span>  <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">65536</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">sendfile</span>        <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">keepalive_timeout</span>  <span class="mi">65</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/nginx/user_defined_signatures_policy.json&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_user_defined_signatures</span> <span class="s">&#34;/etc/nginx/user_defined_signature_definitions.json&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_security_log</span> <span class="s">&#34;/etc/app_protect/conf/log_default.json&#34;</span> <span class="s">syslog:server=127.0.0.1:514</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:8080</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="user-defined-signature-sets">User-Defined Signature Sets  <a class="headerlink float-right" href="#user-defined-signature-sets" title="User-Defined Signature Sets"><i class="fas fa-link fa-xs"></i></a>
</h4><p>NGINX App Protect WAF comes with pre-defined signatures and signature sets. Also, the user can create their own user-defined signatures (as we have seen above) as well as user-defined signature sets. User-defined Signature sets are suitable for organizing the sheer number of pre-defined and user-defined signatures into logical sets for better use in the policy. For pre-defined signatures, there are two ways of managing signature sets: manual addition of signatures using the signature unique IDs, or filtering signatures based on specific criteria, like request/response, risk level, accuracy level, attack type, systems, etc. For the user-defined signatures, signature IDs are automatically generated, and they cannot be used in manual addition of signatures. Therefore, only one way is possible: filtering based on tag, request/response, risk level, accuracy level, attack type, systems, etc.</p>
<p>The following example shows the creation of a new signature set based on filtering all signatures that have accuracy equals to &ldquo;low&rdquo;:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f636709d8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f636709d8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;filtered_signature_sets&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-low-accuracy-signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureSet&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;filter-based&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;filter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Other Application Attacks&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;riskFilter&#34;</span><span class="p">:</span> <span class="s2">&#34;eq&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;riskValue&#34;</span><span class="p">:</span> <span class="s2">&#34;high&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;accuracyFilter&#34;</span><span class="p">:</span> <span class="s2">&#34;le&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;accuracyValue&#34;</span><span class="p">:</span> <span class="s2">&#34;high&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;filtered_signature_sets&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-low-accuracy-signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureSet&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;filter-based&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;filter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Other Application Attacks&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;riskFilter&#34;</span><span class="p">:</span> <span class="s2">&#34;eq&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;riskValue&#34;</span><span class="p">:</span> <span class="s2">&#34;high&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;accuracyFilter&#34;</span><span class="p">:</span> <span class="s2">&#34;le&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;accuracyValue&#34;</span><span class="p">:</span> <span class="s2">&#34;high&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Note that the filter can have one of the following values:</p>
<ul>
<li><code>eq</code> - Include values equal to.</li>
<li><code>le</code> - Include values less than or equal.</li>
<li><code>ge</code> - Include values greater than or equal.</li>
<li><code>all</code> - Do not filter, use all items. Note that <code>all</code> is the default value so if the user does not specify a filter, it will be considered as <code>all</code>. Also, if the user specifies the <code>all</code> filter, there is no need to specify the corresponding value element.</li>
</ul>
<p>Therefore, the above example can be interpreted as: include all the signatures with risk equal to &ldquo;high&rdquo; and all signatures with accuracy equal to or less than medium. The result should include all low and medium accuracy signatures that have a high risk value.</p>
<p>In the following example, we demonstrate how to add signatures manually to a signature set by specifying the signature ID of each of the signatures:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f636e4950&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f636e4950">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;manual_signature_sets&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-cherry-picked-signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureSet&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;manual&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200003360</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001234</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;manual_signature_sets&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-cherry-picked-signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureSet&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;manual&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200003360</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001234</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>It is worthy to note that if a newly added signature set name matches an existing signature set name, it will not overwrite the existing set. Instead, a new set will be created with &ldquo;_2&rdquo; appended to the signature set name. For example, if we create a signature set with the name &ldquo;My_custom_signatures&rdquo; with 3 signatures, then add a new signature to the set and reload the <code>nginx</code> process, a new signature set will be created with the name &ldquo;My_custom_signatures_2&rdquo; containing the new list of 4 signatures. The older list &ldquo;My_custom_signatures&rdquo; with 3 signatures will remain intact.</p>

<h4 
id="user-defined-browser-control">User-Defined Browser Control  <a class="headerlink float-right" href="#user-defined-browser-control" title="User-Defined Browser Control"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The User-Defined Browser Control feature allows a user to define new custom browsers, and create a list of allowed or disallowed browsers (both user-defined and factory preset browsers) used by the client application. It mainly provides the opportunity:</p>
<ol>
<li>To detect browsers that are not among the factory supported ones so that they can be verified they are indeed browsers using the anti-automation feature.</li>
<li>To be able to block access to specific browsers types and versions that the application does not support. This is not a security feature but rather a means to provide a smooth user experience.</li>
</ol>
<h5 
id="user-defined-browser-control-configuration">User-Defined Browser Control Configuration  <a class="headerlink float-right" href="#user-defined-browser-control-configuration" title="User-Defined Browser Control Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p>User-defined browsers can be configured in the <code>browser-definitions</code> section in the policy. There are a number of properties that can be configured per user-defined browser element:</p>
<ul>
<li><code>name</code> - must be unique and not conflict with factory names.</li>
<li><code>matchString</code> - string that should be present in the <code>User-Agent</code> header to trigger enforcement.</li>
<li><code>matchRegex</code> - regex that should be matched in the <code>User-Agent</code> header to trigger enforcement.</li>
<li><code>description</code> - description of the custom browser agent element.</li>
</ul>
<p>Please note that:</p>
<ul>
<li><code>matchString</code> and <code>matchRegex</code> are mutually exclusive (either can appear but never both at the same time).</li>
</ul>
<p>Defining a list of allowed or disallowed browsers can be done in <code>classes</code> and <code>browsers</code> sections under <code>bot-defense/mitigations</code> section.</p>
<ol>
<li>classes
<ul>
<li><code>name</code> - name of class (in this case only <code>browser</code> and <code>unknown</code> are relevant).</li>
<li><code>action</code> - detect / alarm / block.</li>
</ul>
</li>
<li>browsers
<ul>
<li><code>name</code> - name of the browser (factory or user-defined).</li>
<li><code>action</code>  - detect / alarm / block.</li>
<li><code>minVersion</code> (int) - minimum version of the browser for which the action is applicable (major browser version only).</li>
<li><code>maxVersion</code> (int) - maximum version of the browser for which the action is applicable (major browser version only).</li>
</ul>
</li>
</ol>
<p>Please note that:</p>
<ul>
<li><code>browser</code> class defines the default action for any browser that is not in the supported factory browsers list (the default action is <code>detect</code>).</li>
<li><code>unknown</code> class defines the default action for unclassified clients that did not match any browser or bot type (the default action is <code>alarm</code>).</li>
<li><code>minVersion</code> and <code>maxVersion</code> properties are available only for factory browsers and refer to major browser version. These fields are optional - when not present (either one) then it means &ldquo;any&rdquo; version.</li>
</ul>
<h5 
id="list-of-supported-factory-browsers">List of Supported Factory Browsers  <a class="headerlink float-right" href="#list-of-supported-factory-browsers" title="List of Supported Factory Browsers"><i class="fas fa-link fa-xs"></i></a>
</h5><p>The following table specifies supported built-in (factory) browsers:</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Declarative Name</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">android</td>
          <td style="text-align: left">The native Android browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">blackberry</td>
          <td style="text-align: left">The native Blackberry browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">chrome</td>
          <td style="text-align: left">Chrome browser on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">chrome</td>
          <td style="text-align: left">Chrome browser on Android.</td>
      </tr>
      <tr>
          <td style="text-align: left">firefox</td>
          <td style="text-align: left">Firefox on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">firefox</td>
          <td style="text-align: left">Firefox on Android.</td>
      </tr>
      <tr>
          <td style="text-align: left">internet-explorer</td>
          <td style="text-align: left">Internet Explorer on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">internet-explorer</td>
          <td style="text-align: left">Internet Explorer on mobile devices.</td>
      </tr>
      <tr>
          <td style="text-align: left">opera</td>
          <td style="text-align: left">Opera Browser on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">opera</td>
          <td style="text-align: left">Opera Mini Browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">opera</td>
          <td style="text-align: left">Opera on Mobile devices.</td>
      </tr>
      <tr>
          <td style="text-align: left">safari</td>
          <td style="text-align: left">Safari Browser on Microsoft Windows or Apple macOS.</td>
      </tr>
      <tr>
          <td style="text-align: left">safari</td>
          <td style="text-align: left">Safari Browser on Apple iOS and iPadOS devices.</td>
      </tr>
      <tr>
          <td style="text-align: left">edge</td>
          <td style="text-align: left">Microsoft Edge Browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">uc</td>
          <td style="text-align: left">UC Browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">puffin</td>
          <td style="text-align: left">Puffin Browser on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">puffin</td>
          <td style="text-align: left">Puffin Browser on Android devices.</td>
      </tr>
      <tr>
          <td style="text-align: left">puffin</td>
          <td style="text-align: left">Puffin Browser on iOS devices.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Declarative Name</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">android</td>
          <td style="text-align: left">The native Android browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">blackberry</td>
          <td style="text-align: left">The native Blackberry browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">chrome</td>
          <td style="text-align: left">Chrome browser on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">chrome</td>
          <td style="text-align: left">Chrome browser on Android.</td>
      </tr>
      <tr>
          <td style="text-align: left">firefox</td>
          <td style="text-align: left">Firefox on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">firefox</td>
          <td style="text-align: left">Firefox on Android.</td>
      </tr>
      <tr>
          <td style="text-align: left">internet-explorer</td>
          <td style="text-align: left">Internet Explorer on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">internet-explorer</td>
          <td style="text-align: left">Internet Explorer on mobile devices.</td>
      </tr>
      <tr>
          <td style="text-align: left">opera</td>
          <td style="text-align: left">Opera Browser on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">opera</td>
          <td style="text-align: left">Opera Mini Browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">opera</td>
          <td style="text-align: left">Opera on Mobile devices.</td>
      </tr>
      <tr>
          <td style="text-align: left">safari</td>
          <td style="text-align: left">Safari Browser on Microsoft Windows or Apple macOS.</td>
      </tr>
      <tr>
          <td style="text-align: left">safari</td>
          <td style="text-align: left">Safari Browser on Apple iOS and iPadOS devices.</td>
      </tr>
      <tr>
          <td style="text-align: left">edge</td>
          <td style="text-align: left">Microsoft Edge Browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">uc</td>
          <td style="text-align: left">UC Browser.</td>
      </tr>
      <tr>
          <td style="text-align: left">puffin</td>
          <td style="text-align: left">Puffin Browser on Microsoft Windows.</td>
      </tr>
      <tr>
          <td style="text-align: left">puffin</td>
          <td style="text-align: left">Puffin Browser on Android devices.</td>
      </tr>
      <tr>
          <td style="text-align: left">puffin</td>
          <td style="text-align: left">Puffin Browser on iOS devices.</td>
      </tr>
  </tbody>
</table>

</div>
<h5 
id="user-defined-browser-control-enforcement">User-Defined Browser Control Enforcement  <a class="headerlink float-right" href="#user-defined-browser-control-enforcement" title="User-Defined Browser Control Enforcement"><i class="fas fa-link fa-xs"></i></a>
</h5><p>If the received request has no bot signatures, then the following actions are enforced:</p>
<ol>
<li>Parse the <code>User-Agent</code> header. If a known browser is identified, then enforce based on the action set in the <code>browser</code> subsection of the <code>classes</code> section.</li>
<li>If no factory or user-defined browser is identified, then enforce based on the action set in the <code>unknown</code> subsection of the <code>classes</code> section.</li>
<li>If both factory and user-defined browser were detected, then the user-defined one takes precedence and its action is executed according to point 1.</li>
<li>If more than one user-defined browser was detected, then the most severe action of the detected browsers is taken.</li>
</ol>
<p>Please note that:</p>
<ul>
<li>User-Defined Browser Control configuration is part of the <code>bot-defense</code> configuration in the policy, therefore enforcement can take place only if <code>isEnabled</code> flag under <code>bot-defense</code> section is set to <code>true</code> (it is set to true in the default policy).</li>
</ul>
<h5 
id="user-defined-browser-control-configuration-examples">User-Defined Browser Control Configuration Examples  <a class="headerlink float-right" href="#user-defined-browser-control-configuration-examples" title="User-Defined Browser Control Configuration Examples"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In the following example, the policy is configured with these items:</p>
<ul>
<li>Define some user-defined browsers.</li>
<li>Detect (allow) all browsers except for browsers with action set to <code>block</code> in <code>browsers</code> section (according to <code>minVersion</code>/<code>maxVersion</code> fields values).</li>
<li>Alarm if no browser was detected.</li>
</ul>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63821f70&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63821f70">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example_1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;browser-definitions&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowserV3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;matchString&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowser/1.3.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;SmartBrowser4&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;matchRegex&#34;</span><span class="p">:</span> <span class="s2">&#34;smartbrowser/([\\d.]+)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;classes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;browser&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;detect&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;unknown&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;alarm&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;browsers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;safari&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;chrome&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;minVersion&#34;</span><span class="p">:</span> <span class="mi">77</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;firefox&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;minVersion&#34;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;maxVersion&#34;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowserV3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example_1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;browser-definitions&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowserV3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;matchString&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowser/1.3.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;SmartBrowser4&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;matchRegex&#34;</span><span class="p">:</span> <span class="s2">&#34;smartbrowser/([\\d.]+)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;classes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;browser&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;detect&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;unknown&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;alarm&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;browsers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;safari&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;chrome&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;minVersion&#34;</span><span class="p">:</span> <span class="mi">77</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;firefox&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;minVersion&#34;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;maxVersion&#34;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowserV3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In the next example, the policy is configured with the following items:</p>
<ul>
<li>Define some user-defined browsers.</li>
<li>Block all browsers except for browsers with action set to <code>detect</code> or <code>alarm</code> in <code>browsers</code> section (according to <code>minVersion</code>/<code>maxVersion</code> fields values).</li>
<li>Block request if no browser was detected.</li>
</ul>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6388af20&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6388af20">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example_2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;browser-definitions&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowserV3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;matchString&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowser/1.3.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;SmartBrowser4&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;matchRegex&#34;</span><span class="p">:</span> <span class="s2">&#34;smartbrowser/([\\d.]+)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;classes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;browser&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;unknown&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;browsers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;safari&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;detect&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;chrome&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;minVersion&#34;</span><span class="p">:</span> <span class="mi">77</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;alarm&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;firefox&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;minVersion&#34;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;maxVersion&#34;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;detect&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowserV3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;detect&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example_2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;browser-definitions&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowserV3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;matchString&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowser/1.3.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;SmartBrowser4&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;matchRegex&#34;</span><span class="p">:</span> <span class="s2">&#34;smartbrowser/([\\d.]+)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;bot-defense&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;settings&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mitigations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;classes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;browser&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;unknown&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;block&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;browsers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;safari&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;detect&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;chrome&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;minVersion&#34;</span><span class="p">:</span> <span class="mi">77</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;alarm&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;firefox&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;minVersion&#34;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;maxVersion&#34;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;detect&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;FunkyBrowserV3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;detect&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 
id="deny-and-allow-ip-lists">Deny and Allow IP Lists  <a class="headerlink float-right" href="#deny-and-allow-ip-lists" title="Deny and Allow IP Lists"><i class="fas fa-link fa-xs"></i></a>
</h4><p>It is possible to define IP addresses or ranges for which the traffic will always be allowed or denied or never logged despite the rest of the configuration settings in the policy.</p>
<ol>
<li><strong>Always Allowed</strong> (<code>&quot;blockRequests&quot;: &quot;never&quot;</code>) - requests from this IP range will be passed even if they have blocking violations.</li>
<li><strong>Always Denied</strong> (<code>&quot;blockRequests&quot;: &quot;always&quot;</code>) - requests from this IP range will be always blocked even if they have no other blocking violations. The <code>VIOL_BLACKLISTED_IP</code> violation will be triggered in this case and its block flag must be set to <code>true</code> in order for the request to be actually blocked.</li>
<li><strong>Never Log</strong> (<code>&quot;neverLogRequests&quot;: true</code>) - requests from this IP range will not be logged even if they were supposed to be in the logging configuration. Note this is independent of the other setting, so the same IP range can be both denied (or allowed) and yet never logged.</li>
</ol>
<p>In this IPv4 example, we use the default configuration while enabling the deny list violation. In the configuration section, we define:</p>
<ul>
<li>An always allowed IP 1.1.1.1</li>
<li>An always denied IP 2.2.2.2</li>
<li>An always allowed range of IPs 3.3.3.0/24</li>
<li>An allowed range of IPs 4.4.4.0/24 which should never log</li>
</ul>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f639c5278&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f639c5278">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;allow_deny&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_BLACKLISTED_IP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;whitelist-ips&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;neverLogRequests&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;1.1.1.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;255.255.255.255&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;always&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;2.2.2.2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;255.255.255.255&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;neverLogRequests&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;3.3.3.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;255.255.255.0&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;neverLogRequests&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;4.4.4.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;255.255.255.0&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;allow_deny&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_BLACKLISTED_IP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;whitelist-ips&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;neverLogRequests&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;1.1.1.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;255.255.255.255&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;always&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;2.2.2.2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;255.255.255.255&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;neverLogRequests&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;3.3.3.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;255.255.255.0&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;neverLogRequests&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;4.4.4.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;255.255.255.0&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> The above configuration assumes the IP address represents the original requestor. However, it is also common that the client address may instead represent a downstream proxy device as opposed to the original requestor&rsquo;s IP address. In this case, you may need to configure NGINX App Protect WAF to prefer the use of an <code>X-Forwarded-For</code> (or similar) header injected to the request by a downstream proxy in order to more accurately identify the <em>actual</em> originator of the request. <a href="#xff-headers-and-trust">See the XFF Headers and Trust</a> for information regarding the additional settings required for this configuration.</div>
</blockquote>

<p>Here&rsquo;s an example of IPv6 notation with a single address and an IP subnet with a 120-bit prefix:</p>
<p>The first address is a single IP address, because the mask is all f&rsquo;s. Since this is a default value, there is no need to specify the mask in this case. The second address is a subnet of 120 bits (out of the 128 of an IPv6 address). The trailing 8 bits (128-120) must be <strong>zero</strong> in both the mask and the address itself.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63a3a190&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63a3a190">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;allow_deny&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_BLACKLISTED_IP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;whitelist-ips&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;2023::4ef3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;2034::2300&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ff00&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;allow_deny&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_BLACKLISTED_IP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;whitelist-ips&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;2023::4ef3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipAddress&#34;</span><span class="p">:</span> <span class="s2">&#34;2034::2300&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ipMask&#34;</span><span class="p">:</span> <span class="s2">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ff00&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;blockRequests&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 
id="csrf-protection-using-origin-validation">CSRF Protection Using Origin Validation  <a class="headerlink float-right" href="#csrf-protection-using-origin-validation" title="CSRF Protection Using Origin Validation"><i class="fas fa-link fa-xs"></i></a>
</h4><p>CSRF (Cross-Site Request Forgery) is an attack vector in which the victim user that visits a sensitive site such as a bank account, is lured to click on a malicious link attempting a fraudulent operation on that sensitive site. The link may be sent over email or in a hidden frame in another site. NGINX App Protect WAF provides protection against CSRF attacks by validating the Origin header for AJAX POST requests (default configuration).</p>
<h5 
id="csrf-configuration">CSRF Configuration  <a class="headerlink float-right" href="#csrf-configuration" title="CSRF Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p>There are several settings that can be configured to enable CSRF protection, some are global while others are specific. Following is a list of all the settings that can be configured to enable or customize the CSRF settings:</p>
<ol>
<li>In the <code>csrf-protection</code> section, enable CSRF protection. This is a global configuration option and applies to all policy elements.</li>
<li>Enable the CSRF violation <code>VIOL_CSRF</code> in the violations section (the violation is already enabled in <code>Alarm</code> mode in the base template). This is a global configuration option and applies to all policy elements.</li>
<li>In the <code>csrf-urls</code> section, the user can define method and URL configurations. By default, the wildcard URL <code>*</code> with the <code>POST</code> method is configured to enforce Origin validation. The default configuration can be deleted to allow for customized configuration for specific methods and URLs.</li>
<li>In the <code>urls</code> section, you can enable CSRF protection for specific URLs, and define a list of acceptable origins. If the wildcard URL <code>*</code> is selected, the configuration becomes global for all URLs. Otherwise, the configuration is applicable only to the specified URL.</li>
<li>In the <code>host-names</code> section, you can add a list of the domains that are to be accepted when comparing the origin to the hostnames. The user can enable or disable the inclusion of subdomains. This is a global configuration option and applies to all policy elements.</li>
</ol>
<p>Please note that:</p>
<ul>
<li>Both <code>VIOL_CSRF</code> and <code>csrf-protection</code> settings need to be enabled for CSRF protection to be active. Disabling either setting will disable CSRF protection altogether.</li>
<li>Configuring <code>urls</code> is required only if there are external origins that have to be allowed.</li>
<li><code>host-names</code> are internal, owned by the application and used by clients to reach it. The <code>crossDomainAllowedOrigin</code> in the <code>urls</code> are external domains, from other applications, that we wish to allow as origins.</li>
</ul>
<h5 
id="csrf-enforcement">CSRF Enforcement  <a class="headerlink float-right" href="#csrf-enforcement" title="CSRF Enforcement"><i class="fas fa-link fa-xs"></i></a>
</h5><p>If CSRF is enabled in the violation section and in the <code>csrf-protection</code> settings, when receiving a request to a URL that matches one of the <code>csrf-urls</code> and all its conditions: method and parameters (if applicable there), then the following conditions must be met:</p>
<ol>
<li>Origin header must exist in the request.</li>
<li>The domain name from the Origin header must match any of the following criteria:
<ul>
<li>The Host header in the same request.</li>
<li>One of the hostnames in the policy.</li>
<li>One of the allowed origins in the matching URL entity in the policy.</li>
</ul>
</li>
</ol>
<p>If the first condition is not met, the validation will fail with the message &ldquo;Origin header validation failed: Origin is absent&rdquo;. If the second condition fails to match any of the items, the validation will fail with the message &ldquo;Origin header validation failed: Origin is not allowed&rdquo;.</p>
<h5 
id="csrf-configuration-examples">CSRF Configuration Examples  <a class="headerlink float-right" href="#csrf-configuration-examples" title="CSRF Configuration Examples"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In the following example, CSRF Protection is enabled globally (in <code>Block</code> mode) with no customization:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63b1d260&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63b1d260">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;csrf_default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_CSRF&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-protection&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;csrf_default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_CSRF&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-protection&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In the following example, the policy is configured with the following items:</p>
<ul>
<li>Enable CSRF Protection globally (in <code>Block</code> mode).</li>
<li>Delete the default wildcard CSRF URL and define a new custom one.</li>
<li>Define a policy-wide hostname domain without its subdomains.</li>
</ul>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63bb4458&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63bb4458">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example_2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_CSRF&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-protection&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enforcementAction&#34;</span><span class="p">:</span> <span class="s2">&#34;verify-origin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;/operation.aspx&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;host-names&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;includeSubdomains&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example_2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_CSRF&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-protection&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enforcementAction&#34;</span><span class="p">:</span> <span class="s2">&#34;verify-origin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;/operation.aspx&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;host-names&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;includeSubdomains&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In the following example, the policy is configured with the following items:</p>
<ul>
<li>Enable CSRF Protection globally (violation already in <code>Alarm</code> mode in the default policy).</li>
<li>Delete the default wildcard CSRF URL and define a new custom one.</li>
<li>Define a policy-wide hostname domain with subdomains.</li>
<li>Add a custom URL &ldquo;myurl&rdquo; where CSRF enforcement is enabled, and define a custom origin for this URL.</li>
</ul>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63c69e98&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63c69e98">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example_3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-protection&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enforcementAction&#34;</span><span class="p">:</span> <span class="s2">&#34;verify-origin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;/csrfurl&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;host-names&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;includeSubdomains&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/myurl&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;html5CrossOriginRequestsEnforcement&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;enforce&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;crossDomainAllowedOrigin&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;includeSubDomains&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;originName&#34;</span><span class="p">:</span> <span class="s2">&#34;foo.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;originPort&#34;</span><span class="p">:</span> <span class="s2">&#34;all&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;originProtocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http/https&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example_3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-protection&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;csrf-urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enforcementAction&#34;</span><span class="p">:</span> <span class="s2">&#34;verify-origin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;/csrfurl&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;host-names&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;includeSubdomains&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/myurl&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;html5CrossOriginRequestsEnforcement&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;enforce&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;crossDomainAllowedOrigin&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;includeSubDomains&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;originName&#34;</span><span class="p">:</span> <span class="s2">&#34;foo.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;originPort&#34;</span><span class="p">:</span> <span class="s2">&#34;all&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;originProtocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http/https&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 
id="clickjacking-protection">Clickjacking Protection  <a class="headerlink float-right" href="#clickjacking-protection" title="Clickjacking Protection"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Clickjacking refers to a technique used by malicious actors to embed remote website content into their malicious websites, tricking the end users to click on the embedded frames triggering actions the users were not aware of, such as liking a certain Facebook page or giving a restaurant a 5 star rating. To protect against such attacks, NGINX App Protect WAF uses the <code>X-Frame-Options</code> header capabilities. The <code>X-Frame-Options</code> header is injected by NGINX App Protect WAF to indicate to the browser whether it should embed  the content or not. Please note that this additional layer of security is available only in browsers that support the <code>X-Frame-Options</code> headers.</p>
<h5 
id="configuration">Configuration  <a class="headerlink float-right" href="#configuration" title="Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p><code>X-Frame-Options</code> can be configured as follows:</p>
<ul>
<li>X-Frame-Options: <code>deny</code> - This option will prevent the browser from displaying the content in a frame, regardless of the website trying to do so.</li>
<li>X-Frame-Options: <code>only-same</code> - This option allows the browser to display the content in a frame only if it comes from the same website.</li>
</ul>
<p>Please note that a third configuration option was available but it was deprecated by RFC and is not supported by NGINX App Protect WAF.</p>
<p>To enable this protection in NGINX App Protect WAF, we enable the feature for a URL (or for all URLs, via the wildcard URL), and then set the value to be assigned to the <code>X-Frame-Options</code> header. Following is an example of a policy enabling the feature for the URL <code>/clickme</code>, and using <code>only-same</code> as the value for the <code>X-Frame-Options</code> header:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63d14cf8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63d14cf8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;x_frame_options&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/clickme&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;allowRenderingInFrames&#34;</span><span class="p">:</span> <span class="s2">&#34;only-same&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;x_frame_options&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/clickme&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;allowRenderingInFrames&#34;</span><span class="p">:</span> <span class="s2">&#34;only-same&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In the following example, a policy is created with Clickjacking enabled for the URL <code>/clickme</code>, and using <code>DENY</code> as the value for the <code>X-Frame-Options</code> header:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63d42b58&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63d42b58">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;x_frame_options&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/clickme&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;allowRenderingInFrames&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;x_frame_options&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/clickme&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;allowRenderingInFrames&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="detect-base64">Detect Base64  <a class="headerlink float-right" href="#detect-base64" title="Detect Base64"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The Detect Base64 feature allows NGINX App Protect WAF to detect whether values in headers, cookies, and parameters are Base64 encoded. When an entity is detected as Base64 encoded NGINX App Protect WAF will enforce the configured signatures on the decoded value, instead of on the original value.</p>
<p>This feature is disabled by default or by setting the <code>decodeValueAsBase64</code> to <code>disabled</code>.</p>
<p>There is a small risk that the system will wrongly detect a field value as Base64 decodable, when it&rsquo;s actually not. In that case signatures will not be detected properly. To mitigate this, set <code>decodeValueAsBase64</code> to <code>disabled</code> on known non Base64 entities.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63e00a68&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63e00a68">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;detect_base64&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cookies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;disabled&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;catchPhrase&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;disabled&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Catch-Phrase&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;disabled&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;detect_base64&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cookies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;disabled&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;catchPhrase&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;disabled&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Catch-Phrase&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;disabled&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>If <code>decodeValueAsBase64</code> is set to <code>required</code>, then a violation is raised if the value is not Base64 decodable.</p>
<p>In this example we already know which specific entity values are Base64 decodable, so we set the value of <code>decodeValueAsBase64</code> to <code>required</code> to raise a violation if the value is not Base64 decodable:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63eab0f8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63eab0f8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;detect_base64&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_BASE64&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cookies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mySession&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;myId&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;My-Header&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;detect_base64&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_BASE64&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cookies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mySession&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;myId&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;My-Header&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="handling-xml-and-json-content">Handling XML and JSON Content  <a class="headerlink float-right" href="#handling-xml-and-json-content" title="Handling XML and JSON Content"><i class="fas fa-link fa-xs"></i></a>
</h3><h4 
id="xml-and-json-content-profiles">XML and JSON Content Profiles  <a class="headerlink float-right" href="#xml-and-json-content-profiles" title="XML and JSON Content Profiles"><i class="fas fa-link fa-xs"></i></a>
</h4><p>By default every request with a Content-Type header containing XML or JSON is expected to have an XML or JSON body, respectively. Consequently, a series of checks are performed to ensure that the body is indeed well-formed as XML or JSON, and certain restrictions are enforced on the size and content of that body. These restrictions are specified in <strong>XML and JSON profiles</strong>. These configuration structures are associated with URLs and optionally also with Parameters, in case parameters that are known to have XML or JSON values are defined. One of the most powerful restrictions in a JSON profile is enforcing a schema with which the content must comply. This will be detailed in the next section.</p>
<p>The default Base template comes with default JSON and XML profiles, both called &ldquo;default&rdquo;. They are associated to the * URL based on the values of the Content-Type header as described above. You can use those profiles on other URLs or Parameters in your policies, and you can also create your own custom JSON and XML profiles to customize the checks that you want on your content.</p>
<p>Let&rsquo;s assume you have a JSON registration form under the URL <code>/register</code>. It is a small form, and it makes sense to limit its size to 1000 characters and its nesting depth to 2.  Here is a policy that enforces this:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63f6e210&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63f6e210">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;json_form_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumArrayLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumStructureDepth&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumTotalLengthOfJSONData&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateJSONParsingWarnings&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/register&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;disallowFileUploadOfExecutables&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatoryBody&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;methodsOverrideOnUrlCheck&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;json_form_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumArrayLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumStructureDepth&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumTotalLengthOfJSONData&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateJSONParsingWarnings&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/register&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;disallowFileUploadOfExecutables&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatoryBody&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;methodsOverrideOnUrlCheck&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The enforcement on the JSON payload is defined in the <code>reg_form_prof</code> JSON profile. This profile is attached to the <code>/register</code> URL. Note JSON content is always expected for this URL - it applies to all header name and value combinations, and no other content option exists for this URL. Also note that we limited the method to <code>POST</code> in this URL. A POST request to this URL with a body that is not well-formed JSON will trigger the <code>VIOL_JSON_MALFORMED</code> violation.</p>
<p>If the body of the request is legal JSON, but violates any of the restrictions in the <code>reg_form_prof</code> JSON profile, for example has a nesting depth of 3, then you should expect the <code>VIOL_JSON_FORMAT</code> violation with details on what exactly was wrong with the JSON payload.</p>
<p>Let&rsquo;s assume that in your JSON registration there is a specific field that should be Base64 encoded.
we can set the value of <code>handleJsonValuesAsParameters</code> to <code>true</code> on the profile level,
and set the value of <code>decodeValueAsBase64</code> to <code>required</code> on the parameter level.
Here is a policy that enforces this:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f63ff7948&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f63ff7948">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;json_parse_param_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;caseInsensitive&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_BASE64&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;alpha-numeric&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateJSONParsingWarnings&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;handleJsonValuesAsParameters&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;validationFiles&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;json_parse_param_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;caseInsensitive&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_BASE64&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameterLocation&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;valueType&#34;</span><span class="p">:</span> <span class="s2">&#34;user-input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;dataType&#34;</span><span class="p">:</span> <span class="s2">&#34;alpha-numeric&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeValueAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateJSONParsingWarnings&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;handleJsonValuesAsParameters&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;validationFiles&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> Defining a JSON or XML profile in a policy has no effect until you assign it to a URL or Parameter you defined in that policy. Profiles can be shared by more than one URL and/or Parameter.</div>
</blockquote>

<h4 
id="applying-a-json-schema">Applying a JSON Schema  <a class="headerlink float-right" href="#applying-a-json-schema" title="Applying a JSON Schema"><i class="fas fa-link fa-xs"></i></a>
</h4><p>If a schema for the JSON payload exists, it can be attached to the JSON profile and App Protect will enforce it along with the other restrictions.</p>
<p>Here is a sample JSON schema for a registration form. It contains personal details:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6404fb70&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6404fb70">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;$schema&#34;</span><span class="p">:</span> <span class="s2">&#34;http://json-schema.org/draft-07/schema#&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;title&#34;</span><span class="p">:</span> <span class="s2">&#34;Person&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;object&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;additionalProperties&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;properties&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;firstName&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;The person&#39;s first name.&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;lastName&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;The person&#39;s last name.&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;age&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Age in years which must be equal to or greater than zero.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;integer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;minimum&#34;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;$schema&#34;</span><span class="p">:</span> <span class="s2">&#34;http://json-schema.org/draft-07/schema#&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;title&#34;</span><span class="p">:</span> <span class="s2">&#34;Person&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;object&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;additionalProperties&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;properties&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;firstName&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;The person&#39;s first name.&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;lastName&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;The person&#39;s last name.&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;age&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Age in years which must be equal to or greater than zero.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;integer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;minimum&#34;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Embedding the schema into the <code>reg_form_prof</code> JSON profile should be done in the following way:</p>
<ul>
<li>Add an object containing the JSON schema to the <code>json-validation-files</code> array, which details all the available JSON schema validation files available in the profile. A unique <code>fileName</code> should be specified, and the escaped contents of the JSON schema added via the <code>contents</code> keyword.</li>
<li>Associate the specific JSON schema to the <code>reg_form_prof</code> JSON profile by adding a <code>validationFiles</code> array object and set the <code>fileName</code> in the <code>jsonValidationFile</code> object to the JSON schema <code>fileName</code>.</li>
<li>All JSON schema files including external references must be added in this way to both the <code>json-validation-files</code> array and associated with the JSON profile. The <code>isPrimary</code> should be set on the object containing the primary JSON schema.</li>
</ul>
<p>This yields the following policy:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64137290&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64137290">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;json_form_policy_inline_schema&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-validation-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;contents&#34;</span><span class="p">:</span> <span class="s2">&#34;{\r\n \&#34;$schema\&#34;: \&#34;http://json-schema.org/draft-07/schema#\&#34;,\r\n \&#34;title\&#34;: \&#34;Person\&#34;,\r\n \&#34;type\&#34;: \&#34;object\&#34;,\r\n \&#34;properties\&#34;: {\r\n \&#34;firstName\&#34;: {\r\n \&#34;type\&#34;: \&#34;string\&#34;,\r\n \&#34;description\&#34;: \&#34;The person&#39;s first name.\&#34;\r\n },\r\n \&#34;lastName\&#34;: {\r\n \&#34;type\&#34;: \&#34;string\&#34;,\r\n \&#34;description\&#34;: \&#34;The person&#39;s last name.\&#34;\r\n },\r\n \&#34;age\&#34;: {\r\n \&#34;description\&#34;: \&#34;Age in years which must be equal to or greater than zero.\&#34;,\r\n \&#34;type\&#34;: \&#34;integer\&#34;,\r\n \&#34;minimum\&#34;: 0\r\n }\r\n }\r\n}&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumArrayLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumStructureDepth&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumTotalLengthOfJSONData&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateJSONParsingWarnings&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;validationFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isPrimary&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;jsonValidationFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/register&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;disallowFileUploadOfExecutables&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatoryBody&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;methodsOverrideOnUrlCheck&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;json&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;json_form_policy_inline_schema&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-validation-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;contents&#34;</span><span class="p">:</span> <span class="s2">&#34;{\r\n \&#34;$schema\&#34;: \&#34;http://json-schema.org/draft-07/schema#\&#34;,\r\n \&#34;title\&#34;: \&#34;Person\&#34;,\r\n \&#34;type\&#34;: \&#34;object\&#34;,\r\n \&#34;properties\&#34;: {\r\n \&#34;firstName\&#34;: {\r\n \&#34;type\&#34;: \&#34;string\&#34;,\r\n \&#34;description\&#34;: \&#34;The person&#39;s first name.\&#34;\r\n },\r\n \&#34;lastName\&#34;: {\r\n \&#34;type\&#34;: \&#34;string\&#34;,\r\n \&#34;description\&#34;: \&#34;The person&#39;s last name.\&#34;\r\n },\r\n \&#34;age\&#34;: {\r\n \&#34;description\&#34;: \&#34;Age in years which must be equal to or greater than zero.\&#34;,\r\n \&#34;type\&#34;: \&#34;integer\&#34;,\r\n \&#34;minimum\&#34;: 0\r\n }\r\n }\r\n}&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumArrayLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumStructureDepth&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumTotalLengthOfJSONData&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateJSONParsingWarnings&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;validationFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isPrimary&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;jsonValidationFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/register&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;disallowFileUploadOfExecutables&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatoryBody&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;methodsOverrideOnUrlCheck&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;json&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>When a request to the <code>/register</code> URL is <code>POST</code>-ed with JSON content that does not comply with the above schema, the <code>VIOL_JSON_SCHEMA</code> violation is triggered. In the default base template, the <code>alarm</code> flag is turned on for this violation and if it is triggered, it affects Violation Rating. In addition, you can turn on the <code>block</code> flag so that this violation will also block when triggered.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>The schema file is embedded as a quoted string; therefore you must escape the quotes inside the schema itself.</li>
<li>We removed the nesting depth check in the JSON profile because it is enforced by the schema. It is not an error to leave the sizing checks together with the schema enforcement, but usually the schema has more accurate restrictions and leaving the profile restriction might be redundant in the best case or cause false positives in the worst.</li>
</ul>
<h4 
id="including-an-external-json-schema-file">Including an External JSON Schema File  <a class="headerlink float-right" href="#including-an-external-json-schema-file" title="Including an External JSON Schema File"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Schema files are often developed as part of the application, independently from the App Protect Policy. It is often desirable to keep it in a separate file and reference it from the policy using a URL. Just as in all externally referenced policy sections, the JSON schema file can reside either in the NGINX file system (the default directory <code>/etc/app_protect/conf</code> is assumed if only the filename is specified in the <code>file:</code> URL, that is: <code>file:///my_schema.json</code> refers to the file located at <code>/etc/app_protect/conf/my_schema.json</code>), or on a remote Web server, typically, your source control system.</p>
<p>In this example the file is in the default directory:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f641aa650&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f641aa650">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;json_form_policy_external_schema&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-validation-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;file://person_schema.json&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumArrayLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumStructureDepth&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumTotalLengthOfJSONData&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateJSONParsingWarnings&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;validationFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isPrimary&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;jsonValidationFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/register&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;disallowFileUploadOfExecutables&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatoryBody&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;methodsOverrideOnUrlCheck&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;json&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;json_form_policy_external_schema&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-validation-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;file://person_schema.json&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;json-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumArrayLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumStructureDepth&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumTotalLengthOfJSONData&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumValueLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;tolerateJSONParsingWarnings&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;validationFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isPrimary&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;jsonValidationFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/register&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;clickjackingProtection&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;disallowFileUploadOfExecutables&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;mandatoryBody&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;methodsOverrideOnUrlCheck&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;reg_form_prof&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;json&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The schema file is identified by the <code>filename</code> property. It is a good practice to keep the <code>filename</code> identical to the one on the URL path, but it is not an error to have different names for each.</p>
<p>if you want to reference the file externally, replace the content of the <code>link</code> property with an HTTP or HTTPS URL:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f641e4418&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f641e4418">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;json-validation-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;https://git.mydomain.com/my_app/person_schema.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;json-validation-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;person_schema.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;https://git.mydomain.com/my_app/person_schema.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="enforcer-cookie-settings">Enforcer Cookie Settings  <a class="headerlink float-right" href="#enforcer-cookie-settings" title="Enforcer Cookie Settings"><i class="fas fa-link fa-xs"></i></a>
</h3><p>NGINX App Protect WAF generates its own cookies and adds them on top of the application cookies.</p>
<p>These are called Enforcer Cookies.</p>
<p>You can control the attributes within these cookies:</p>
<ul>
<li><code>httpOnlyAttribute</code>: Whether or not to add HttpOnly attribute, value is either <code>true</code> or <code>false</code>, default is <strong>true</strong>.</li>
<li><code>secureAttribute</code>: Whether or not to add Secure attribute, value is either <code>always</code> or <code>never</code>, default is <strong>always</strong>.</li>
<li><code>sameSiteAttribute</code>: In which mode to add SameSite attribute, value is one of: <code>none-value</code>, <code>lax</code>, <code>strict</code> or <code>none</code>, default is <strong>strict</strong>. Use <code>none</code> in order to not add this attribute to the cookie at all.</li>
</ul>
<p>In this example, we configure HttpOnly to be <code>true</code>, Secure to be <code>never</code>, and SameSite to be <code>strict</code>.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64602f18&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64602f18">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;cookie_attrs_configured&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcer-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcerStateCookies&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;httpOnlyAttribute&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;secureAttribute&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sameSiteAttribute&#34;</span><span class="p">:</span> <span class="s2">&#34;strict&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;cookie_attrs_configured&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcer-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;enforcerStateCookies&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;httpOnlyAttribute&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;secureAttribute&#34;</span><span class="p">:</span> <span class="s2">&#34;never&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;sameSiteAttribute&#34;</span><span class="p">:</span> <span class="s2">&#34;strict&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><ul>
<li><code>httpOnlyAttribute</code>: Default value was <code>true</code> for all policies.</li>
<li><code>secureAttribute</code>: Default value was <code>never</code> in the default policy, and <code>always</code> in the strict and API policies.</li>
<li><code>sameSiteAttribute</code>: Default value was <code>lax</code> in the default and API policies, and <code>strict</code> in the strict policy.</li>
</ul>

<h3 
id="additional-configuration-options">Additional Configuration Options  <a class="headerlink float-right" href="#additional-configuration-options" title="Additional Configuration Options"><i class="fas fa-link fa-xs"></i></a>
</h3><h4 
id="xff-headers-and-trust">XFF Headers and Trust  <a class="headerlink float-right" href="#xff-headers-and-trust" title="XFF Headers and Trust"><i class="fas fa-link fa-xs"></i></a>
</h4><p>XFF trust is disabled by default but can be enabled.</p>
<p>In this example, we use the default configuration but enable the trust of XFF header.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f647758c8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f647758c8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;xff_enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;general&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;customXffHeaders&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;trustXff&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;xff_enabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;general&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;customXffHeaders&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;trustXff&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In this example, we configure a policy with a custom-defined XFF header.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6481cc90&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6481cc90">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;xff_custom_headers&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;general&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;customXffHeaders&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;xff&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;trustXff&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;xff_custom_headers&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;general&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;customXffHeaders&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;xff&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;trustXff&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="blocking-page-customization">Blocking Page Customization  <a class="headerlink float-right" href="#blocking-page-customization" title="Blocking Page Customization"><i class="fas fa-link fa-xs"></i></a>
</h4><p>You can customize the blocking page text and formatting to suit your particular design requirements.</p>
<p>In this example, we use the default configuration but modify the response page that is displayed to the customer.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6491aef8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6491aef8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking_page&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response-pages&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responseContent&#34;</span><span class="p">:</span> <span class="s2">&#34;&lt;html&gt;&lt;head&gt;&lt;title&gt;Custom Reject Page&lt;/title&gt;&lt;/head&gt;&lt;body&gt;This is a custom response page; it is supposed to overwrite the default page with custom text.&lt;br&gt;&lt;br&gt;Your support ID is: &lt;%TS.request.ID()%&gt;&lt;br&gt;&lt;br&gt;&lt;a href=&#39;javascript:history.back();&#39;&gt;[Go Back]&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responseHeader&#34;</span><span class="p">:</span> <span class="s2">&#34;HTTP/1.1 200 OK\r\nCache-Control: no-cache\r\nPragma: no-cache\r\nConnection: close&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responseActionType&#34;</span><span class="p">:</span> <span class="s2">&#34;custom&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responsePageType&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking_page&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response-pages&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responseContent&#34;</span><span class="p">:</span> <span class="s2">&#34;&lt;html&gt;&lt;head&gt;&lt;title&gt;Custom Reject Page&lt;/title&gt;&lt;/head&gt;&lt;body&gt;This is a custom response page; it is supposed to overwrite the default page with custom text.&lt;br&gt;&lt;br&gt;Your support ID is: &lt;%TS.request.ID()%&gt;&lt;br&gt;&lt;br&gt;&lt;a href=&#39;javascript:history.back();&#39;&gt;[Go Back]&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responseHeader&#34;</span><span class="p">:</span> <span class="s2">&#34;HTTP/1.1 200 OK\r\nCache-Control: no-cache\r\nPragma: no-cache\r\nConnection: close&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responseActionType&#34;</span><span class="p">:</span> <span class="s2">&#34;custom&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responsePageType&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="ajax-response-page-for-single-page-applications-spas">AJAX Response Page for Single Page Applications (SPAs)  <a class="headerlink float-right" href="#ajax-response-page-for-single-page-applications-spas" title="AJAX Response Page for Single Page Applications (SPAs)"><i class="fas fa-link fa-xs"></i></a>
</h4><p>There is a special scenario where default or regular custom response pages cannot be used. SPAs (Single Page Applications) are applications that provide application functionality within the boundaries of a single HTML page. Once a SPA application has been loaded in the browser, it typically makes REST API calls to remote resources expecting JSON response bodies rather than HTML markup. If this SPA application were to receive a default HTML-formatted block page, it would not be able to interpret this, likely causing an application error.</p>
<p>A way to handle such a situation is via configuring an AJAX response page. The AJAX response page will cause a pop-up to appear on the client browser, informing them that the request has been blocked.</p>
<p>In this example, we set up an AJAX response page.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f649c9408&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f649c9408">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;NGINX-SPA&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Policy with AJAX response page enabled for blocking AJAX requests&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response-pages&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responsePageType&#34;</span><span class="p">:</span> <span class="s2">&#34;ajax&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ajaxEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ajaxPopupMessage&#34;</span><span class="p">:</span> <span class="s2">&#34;My customized popup message! Your support ID is: &lt;%TS.request.ID()%&gt;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;NGINX-SPA&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Policy with AJAX response page enabled for blocking AJAX requests&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response-pages&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responsePageType&#34;</span><span class="p">:</span> <span class="s2">&#34;ajax&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ajaxEnabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;ajaxPopupMessage&#34;</span><span class="p">:</span> <span class="s2">&#34;My customized popup message! Your support ID is: &lt;%TS.request.ID()%&gt;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="modifying-configurations">Modifying Configurations  <a class="headerlink float-right" href="#modifying-configurations" title="Modifying Configurations"><i class="fas fa-link fa-xs"></i></a>
</h3><p>What we have been seeing so far has been related to making changes by actually overriding specific configuration values. What would happen in the case we wanted to remove a specific configuration entity from the policy. For example, let&rsquo;s say we have added file types &ldquo;aaa&rdquo;, &ldquo;bbb&rdquo;, and &ldquo;ccc&rdquo;, and now we wish to remove &ldquo;bbb&rdquo; from the list of disallowed file types. Deleting this entity from the declarative configuration file will simply mean that this entity will be left intact when the policy is rebuilt, meaning that the entity is still in the disallowed file types list. To resolve such situations, we have a <code>modifications</code> section where we can force modification where otherwise it is not possible using direct declarative configuration.</p>
<p>There is a specific section named <code>modifications</code> where we can configure items to be removed/deleted or forcefully modified in the policy.</p>
<p>In this example, we specify that we wish to remove the file type <strong>log</strong> from the disallowed file types list.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64af7be0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64af7be0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;modifying_disallowed_file_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;log&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;filetype&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;modifying_disallowed_file_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;explicit&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;log&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;filetype&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="entitytype-list">entityType List  <a class="headerlink float-right" href="#entitytype-list" title="entityType List"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The below list provides information about the <code>entityType</code> which can be used in the <code>modifications</code> section of the App Protect policy:</p>
<ul>
<li>blocking-settings/evasion</li>
<li>blocking-settings-general</li>
<li>blocking-settings/http-protocol</li>
<li>blocking-settings/violation</li>
<li>bot-defense/mitigations/anomaly</li>
<li>bot-defense/mitigations/browser</li>
<li>bot-defense/mitigations/class</li>
<li>bot-defense/mitigations/signature</li>
<li>bot-defense/settings</li>
<li>browser-definition</li>
<li>character-set</li>
<li>cookie</li>
<li>cookie-settings</li>
<li>csrf-protection</li>
<li>csrf-url</li>
<li>data-guard</li>
<li>enforcer-settings</li>
<li>filetype</li>
<li>general</li>
<li>graphql-profile</li>
<li>grpc-profile</li>
<li>header</li>
<li>header-settings</li>
<li>host-name</li>
<li>json-profile</li>
<li>method</li>
<li>parameter</li>
<li>response-page</li>
<li>signature</li>
<li>sensitive-parameter</li>
<li>signature-setting</li>
<li>url</li>
<li>whitelist-ip</li>
<li>xml-profile</li>
</ul>

<h2 
id="nginx-app-protect-waf-standalone-configuration">NGINX App Protect WAF Standalone Configuration  <a class="headerlink float-right" href="#nginx-app-protect-waf-standalone-configuration" title="NGINX App Protect WAF Standalone Configuration"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="apreload">apreload  <a class="headerlink float-right" href="#apreload" title="apreload"><i class="fas fa-link fa-xs"></i></a>
</h3><p>apreload is a tool that can update that can update the NGINX App Protect WAF configuration without having to reload NGINX if only the App Protect configuration is changed and the <code>nginx.conf</code> file remains unchanged. apreload does not affect the existing NGINX reload process and it functions in the same manner as before.</p>
<h4 
id="some-conditions-required-for-apreload-to-work">Some Conditions Required for apreload to Work:  <a class="headerlink float-right" href="#some-conditions-required-for-apreload-to-work" title="Some Conditions Required for apreload to Work:"><i class="fas fa-link fa-xs"></i></a>
</h4><ul>
<li>
<p>For apreload to work, NGINX must be started first.</p>
</li>
<li>
<p>apreload may be used if the App Protect configuration (policies, log configuration files, global settings etc) have been modified, but the NGINX configuration hasn&rsquo;t changed.<br></p>
<p>Whenever <code>nginx.conf</code> file or any of its included files are modified, nginx reload must be used, rather than apreload. This will also update any changes in the App Protect configuration (policies, logging profiles, global settings). This applies also if only the App Protect directives have been modified in the <code>nginx.conf</code> file.</p>
</li>
<li>
<p>apreload should be executed with the same user that executes NGINX to avoid any access error.</p>
</li>
<li>
<p>apreload handles any changes in the content of the policy, with the exception of the name of the policy.<br></p>
</li>
</ul>

<h3 
id="apreload-events">apreload Events  <a class="headerlink float-right" href="#apreload-events" title="apreload Events"><i class="fas fa-link fa-xs"></i></a>
</h3><p>apreload events use the same format as the current operation log events written in the NGINX error log, namely: <code>configuration_load_success</code> or <code>configuration_load_failure</code> with the details in JSON format. Refer to the <a href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/operation-logs/">Operation logs</a> for more details.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Note that if any of the configuration files are invalid, apreload will discover that and return the proper error message in the <code>configuration_load_failure</code> event. The Enforcer continues to run with the previous configuration.</div>
</blockquote>

<h3 
id="modification-to-nginxconf-file-and-app-protect-configurations">Modification to nginx.conf file and App Protect Configurations  <a class="headerlink float-right" href="#modification-to-nginxconf-file-and-app-protect-configurations" title="Modification to nginx.conf file and App Protect Configurations"><i class="fas fa-link fa-xs"></i></a>
</h3><p>When both <code>nginx.conf</code> file and App Protect configurations are modified, apreload enforces only the App Protect configurations but nginx reload enforces both.</p>
<p>For apreload, use the following command:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f5fedc968&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f5fedc968">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/apreload</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/apreload</span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">text</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f5ff35f18&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f5ff35f18">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">USAGE:
</span></span><span class="line"><span class="cl">    /opt/app_protect/bin/apreload:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optional arguments with default values:
</span></span><span class="line"><span class="cl">  -apply
</span></span><span class="line"><span class="cl">        Apply new configuration in enforcer (default true)
</span></span><span class="line"><span class="cl">  -i string
</span></span><span class="line"><span class="cl">        Path to the config set. Ex. /opt/app_protect/config/config_set.json (default &#34;/opt/app_protect/config/config_set.json&#34;)
</span></span><span class="line"><span class="cl">  -policy-map-location string
</span></span><span class="line"><span class="cl">        Path to policy map location (default &#34;/opt/app_protect/bd_config/policy_path.map&#34;)
</span></span><span class="line"><span class="cl">  -t    Test and prepare configuration without updating enforcement
</span></span><span class="line"><span class="cl">  -wait-for-enforcer
</span></span><span class="line"><span class="cl">        Wait until updated config is loaded (default true)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optionally, using --help will issue this help message.</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">USAGE:
</span></span><span class="line"><span class="cl">    /opt/app_protect/bin/apreload:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optional arguments with default values:
</span></span><span class="line"><span class="cl">  -apply
</span></span><span class="line"><span class="cl">        Apply new configuration in enforcer (default true)
</span></span><span class="line"><span class="cl">  -i string
</span></span><span class="line"><span class="cl">        Path to the config set. Ex. /opt/app_protect/config/config_set.json (default &#34;/opt/app_protect/config/config_set.json&#34;)
</span></span><span class="line"><span class="cl">  -policy-map-location string
</span></span><span class="line"><span class="cl">        Path to policy map location (default &#34;/opt/app_protect/bd_config/policy_path.map&#34;)
</span></span><span class="line"><span class="cl">  -t    Test and prepare configuration without updating enforcement
</span></span><span class="line"><span class="cl">  -wait-for-enforcer
</span></span><span class="line"><span class="cl">        Wait until updated config is loaded (default true)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optionally, using --help will issue this help message.</span></span></code></pre></div>
</div><h3 
id="handling-concurrent-invocations-of-apreload">Handling Concurrent Invocations of Apreload  <a class="headerlink float-right" href="#handling-concurrent-invocations-of-apreload" title="Handling Concurrent Invocations of Apreload"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Concurrent NGINX reloads are enqueued and so are the entailed invocations to apreload by the NGINX App Protect WAF module.</p>
<p>However, when invoking apreload directly, it is possible to invoke it while the previous invocation is still in progress. In this case, apreload will wait until the current invocation completes. The new invocation will bring a new configuration and the most recent configuration will only happen when the previous one is loaded.</p>
<p>In a special scenario, when the first invocation comes from the NGINX reload followed immediately by a direct call to apreload. The NGINX workers with the new <code>nginx.conf</code> will be launched as soon as the Enforcer finishes the first configuration. Later, the most recent NGINX App Protect WAF configuration will be loaded (using with the same NGINX worker instances).</p>
<h3 
id="limitation-on-http-header-and-xff-modification">Limitation on HTTP Header and XFF Modification  <a class="headerlink float-right" href="#limitation-on-http-header-and-xff-modification" title="Limitation on HTTP Header and XFF Modification"><i class="fas fa-link fa-xs"></i></a>
</h3><p>apreload will not take into effect these Policy modifications:</p>
<ul>
<li>New user defined HTTP headers, refer to <a href="#user-defined-http-headers">User-defined HTTP Headers</a> section. Note that modifications to existing user-defined headers will take effect in apreload.</li>
<li>XFF trust modifications, refer to <a href="#xff-headers-and-trust">XFF Headers and Trust</a> section for more details. <br></li>
</ul>
<p>If you want to apply any of the above modifications, reload NGINX rather invoking apreload, even if NGINX configuration has not been modified.</p>
<h2 
id="external-references">External References  <a class="headerlink float-right" href="#external-references" title="External References"><i class="fas fa-link fa-xs"></i></a>
</h2><p>External references in policy are defined as any code blocks that can be used as part of the policy without being explicitly pasted within the policy file. This means that you can have a set of pre-defined configurations for parts of the policy, and you can incorporate them as part of the policy by simply referencing them. This would save a lot of overhead having to concentrate everything into a single policy file.</p>
<p>A perfect use case for external references is when you wish to build a dynamic policy that depends on moving parts. You can have code create and populate specific files with the configuration relevant to your policy, and then compile the policy to include the latest version of these files, ensuring that your policy is always up to date when it comes to a constantly changing environment.</p>
<p><strong>Note</strong>: Any update of a single file referenced in the policy will not trigger a policy compilation. This action needs to be done actively by reloading the NGINX configuration.</p>
<p>To use the external references capability, in the policy file the direct property is replaced by &ldquo;xxxReference&rdquo; property, where xxx defines the replacement text for the property changed to singular (if originally plural) and notation converted from snake case to camelCase. For example, <code>modifications</code> section is replaced by <code>modificationsReference</code> and <code>data-guard</code> is replaced by <code>dataGuardReference</code>.</p>

<h3 
id="types-of-references">Types of References  <a class="headerlink float-right" href="#types-of-references" title="Types of References"><i class="fas fa-link fa-xs"></i></a>
</h3><p>There are different implementations based on the type of references that are being made.</p>
<h4 
id="url-reference">URL Reference  <a class="headerlink float-right" href="#url-reference" title="URL Reference"><i class="fas fa-link fa-xs"></i></a>
</h4><p>URL reference is the method of referencing an external source by providing its full URL. This is a very useful method when trying to combine or consolidate parts of the policy that are present on different server machines.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> You need to make sure that the server where the resource files are located is always available when you are compiling your policy.</div>
</blockquote>

<h5 
id="example-configuration">Example Configuration  <a class="headerlink float-right" href="#example-configuration" title="Example Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In this example, we are creating a skeleton policy, then enabling the file type violation. However, we do not wish to specify the file types as these file types depend on an app that defines these types. We therefore wish to have this section populated from an external reference. Note that the <code>filetypes</code> section is replaced by the <code>filetypeReference</code> section. For a list of all the available reference options, consult the documentation (declarative section). In the <code>filetypeReference</code> section, we define a <strong>key/value</strong> pair, where the key defines what type of reference we are making, while the value defines the actual URL to use to reach that reference item.</p>
<p>For the content of the file itself, it is an extension of the original JSON format for the policy, as if this section was cut from the policy and pasted into the file.</p>
<p><strong>Policy configuration:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64cdcd98&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64cdcd98">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;external_resources_file_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_FILETYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filetypeReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://domain.com:8081/file-types.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;external_resources_file_types&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_FILETYPE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filetypeReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://domain.com:8081/file-types.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Content of the referenced file <code>file-types.txt</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64e11718&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64e11718">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;checkPostDataLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;postDataLength&#34;</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;checkRequestLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;requestLength&#34;</span><span class="p">:</span> <span class="mi">8192</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;checkUrlLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urlLength&#34;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;checkQueryStringLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;queryStringLength&#34;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responseCheck&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;pat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;checkPostDataLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;postDataLength&#34;</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;checkRequestLength&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;requestLength&#34;</span><span class="p">:</span> <span class="mi">8192</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;checkUrlLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urlLength&#34;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;checkQueryStringLength&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;queryStringLength&#34;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responseCheck&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;pat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;mat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;allowed&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
</div><h4 
id="https-reference">HTTPS Reference  <a class="headerlink float-right" href="#https-reference" title="HTTPS Reference"><i class="fas fa-link fa-xs"></i></a>
</h4><p>HTTPS references are a special case of URL references. It uses the HTTPS protocol instead of the HTTP protocol. Make sure that the webserver you are downloading the resources from does also support HTTPS protocol and has certificates setup properly.</p>
<ul>
<li>Certificates must be valid in date (not expired) during the policy compilation.</li>
<li>Certificates must be signed by a trusted CA.</li>
<li>For Self-signed certificates, you need to make sure to add your certificates to the trusted CA of the machine where App Protect is installed.</li>
<li>Certificates must use the exact domain name that the certificate was issued for. For example, SSL will differentiate between domain.com and <a href="https://www.domain.com" target="_blank" rel="noopener">www.domain.com</a>, considering each a different domain name.</li>
</ul>
<h5 
id="example-configuration-1">Example Configuration  <a class="headerlink float-right" href="#example-configuration-1" title="Example Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In this configuration, we are completely satisfied with the basic default policy, and we wish to use it as is. However, we wish to define a custom response page using an external file located on an HTTPS web server. The external reference file contains our custom response page configuration.</p>
<p><strong>Policy configuration:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64e79ef8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64e79ef8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;external_references_custom_respsonse&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;responsePageReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;https://securedomain.com:8081/response-pages.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;external_references_custom_respsonse&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;responsePageReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;https://securedomain.com:8081/response-pages.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Content of the referenced file <code>response-pages.txt</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64ec03f8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64ec03f8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responseContent&#34;</span><span class="p">:</span> <span class="s2">&#34;&lt;html&gt;&lt;head&gt;&lt;title&gt;Custom Reject Page&lt;/title&gt;&lt;/head&gt;&lt;body&gt;This is a custom response page, it is supposed to overwrite the default page with custom text.&lt;br&gt;&lt;br&gt;Your support ID is: &lt;%TS.request.ID()%&gt;&lt;br&gt;&lt;br&gt;&lt;a href=&#39;javascript:history.back();&#39;&gt;[Go Back]&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responseHeader&#34;</span><span class="p">:</span> <span class="s2">&#34;HTTP/1.1 200 OK\r\nCache-Control: no-cache\r\nPragma: no-cache\r\nConnection: close&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responseActionType&#34;</span><span class="p">:</span> <span class="s2">&#34;custom&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responsePageType&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responseContent&#34;</span><span class="p">:</span> <span class="s2">&#34;&lt;html&gt;&lt;head&gt;&lt;title&gt;Custom Reject Page&lt;/title&gt;&lt;/head&gt;&lt;body&gt;This is a custom response page, it is supposed to overwrite the default page with custom text.&lt;br&gt;&lt;br&gt;Your support ID is: &lt;%TS.request.ID()%&gt;&lt;br&gt;&lt;br&gt;&lt;a href=&#39;javascript:history.back();&#39;&gt;[Go Back]&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responseHeader&#34;</span><span class="p">:</span> <span class="s2">&#34;HTTP/1.1 200 OK\r\nCache-Control: no-cache\r\nPragma: no-cache\r\nConnection: close&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responseActionType&#34;</span><span class="p">:</span> <span class="s2">&#34;custom&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;responsePageType&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
</div><h5 
id="example-configuration-2">Example Configuration  <a class="headerlink float-right" href="#example-configuration-2" title="Example Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In this example, we would like to enable all attack signatures. Yet, we want to exclude specific signatures from being enforced.</p>
<p><strong>Policy configuration:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64ef4fb8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64ef4fb8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;external_resources_signature_modification&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modificationsReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://my-domain.com:8081/modifications.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;external_resources_signature_modification&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modificationsReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://my-domain.com:8081/modifications.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Content of the referenced file <code>modifications.txt</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64f15f10&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64f15f10">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="file-reference">File Reference  <a class="headerlink float-right" href="#file-reference" title="File Reference"><i class="fas fa-link fa-xs"></i></a>
</h4><p>File references refers to accessing local resources on the same machine, as opposed to accessing a remote resource on another server/machine. The user can specify any location that is accessible by App Protect except for the root folder (&quot;/&quot;). If no full path is provided, the default path <code>/etc/app_protect/conf</code> will be assumed. Note that file references can only be on the local machine: you cannot use remote hosts!</p>
<p>Here are some examples of the typical cases:</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Link URL Format (examples)</th>
          <th style="text-align: left">File Path</th>
          <th style="text-align: left">Comment</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><a href="file:///foo.json">file:///foo.json</a></td>
          <td style="text-align: left">/etc/app_protect/conf/foo.json</td>
          <td style="text-align: left">Default directory assumed</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="file://foo.json">file://foo.json</a></td>
          <td style="text-align: left">/etc/app_protect/conf/foo.json</td>
          <td style="text-align: left">Formally illegal, but tolerated as long as there is no trailing slash.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="file:///etc/app_protect/conf/foo.json">file:///etc/app_protect/conf/foo.json</a></td>
          <td style="text-align: left">/etc/app_protect/conf/foo.json</td>
          <td style="text-align: left">Full path, but still the default one</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="file:///bar/foo.json">file:///bar/foo.json</a></td>
          <td style="text-align: left">/bar/foo.json</td>
          <td style="text-align: left">Non-default path</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="file://etc/app_protect/conf/foo.json">file://etc/app_protect/conf/foo.json</a></td>
          <td style="text-align: left"><strong>Not accepted</strong></td>
          <td style="text-align: left">&ldquo;etc&rdquo; is interpreted as remote host name</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Link URL Format (examples)</th>
          <th style="text-align: left">File Path</th>
          <th style="text-align: left">Comment</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><a href="file:///foo.json">file:///foo.json</a></td>
          <td style="text-align: left">/etc/app_protect/conf/foo.json</td>
          <td style="text-align: left">Default directory assumed</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="file://foo.json">file://foo.json</a></td>
          <td style="text-align: left">/etc/app_protect/conf/foo.json</td>
          <td style="text-align: left">Formally illegal, but tolerated as long as there is no trailing slash.</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="file:///etc/app_protect/conf/foo.json">file:///etc/app_protect/conf/foo.json</a></td>
          <td style="text-align: left">/etc/app_protect/conf/foo.json</td>
          <td style="text-align: left">Full path, but still the default one</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="file:///bar/foo.json">file:///bar/foo.json</a></td>
          <td style="text-align: left">/bar/foo.json</td>
          <td style="text-align: left">Non-default path</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="file://etc/app_protect/conf/foo.json">file://etc/app_protect/conf/foo.json</a></td>
          <td style="text-align: left"><strong>Not accepted</strong></td>
          <td style="text-align: left">&ldquo;etc&rdquo; is interpreted as remote host name</td>
      </tr>
  </tbody>
</table>

</div>
<h5 
id="example-configuration-3">Example Configuration  <a class="headerlink float-right" href="#example-configuration-3" title="Example Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In this example, we would like to enable all attack signatures. Yet, we want to exclude specific signatures from being enforced. To do this, we reference a local file on the machine.</p>
<p><strong>Policy Configuration:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64f454e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64f454e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;external_resources_signature_modification&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modificationsReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///modifications.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;external_resources_signature_modification&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-sets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;All Signatures&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;alarm&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modificationsReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///modifications.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Content of the referenced file <code>modifications.txt</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64f644f8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f64f644f8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;modifications&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityChanges&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001834</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;entityType&#34;</span><span class="p">:</span> <span class="s2">&#34;signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;add-or-update&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="configuration-errors">Configuration Errors  <a class="headerlink float-right" href="#configuration-errors" title="Configuration Errors"><i class="fas fa-link fa-xs"></i></a>
</h4><p>If, for any reason, the configuration was done incorrectly, the policy compilation process will fail with the following error:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f64f7df20&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f64f7df20">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">APP_PROTECT <span class="o">{</span> <span class="s2">&#34;event&#34;</span>: <span class="s2">&#34;configuration_load_failure&#34;</span> ...</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">APP_PROTECT <span class="o">{</span> <span class="s2">&#34;event&#34;</span>: <span class="s2">&#34;configuration_load_failure&#34;</span> ...</span></span></code></pre></div>
</div><p>The error details that follow will depend on the exact situation causing the policy compilation to fail.  If the policy compilation process fails, the compiler will revert to the last working policy and all the changes for the last policy compilation attempt will be lost.</p>

<h2 
id="openapi-specification-file-reference">OpenAPI Specification File Reference  <a class="headerlink float-right" href="#openapi-specification-file-reference" title="OpenAPI Specification File Reference"><i class="fas fa-link fa-xs"></i></a>
</h2><p>The OpenAPI Specification defines the spec file format needed to describe RESTful APIs. The spec file can be written either in JSON or YAML. Using a spec file simplifies the work of implementing API protection. Refer to the OpenAPI Specification (formerly called Swagger) for details.</p>
<p>The simplest way to create an API protection policy is using an OpenAPI Specification file to import the details of the APIs. If you use an OpenAPI Specification file, NGINX App Protect WAF will automatically create a policy for the following properties (depending on what&rsquo;s included in the spec file):</p>
<ul>
<li>Methods</li>
<li>URLs</li>
<li>Parameters</li>
<li>JSON profiles</li>
</ul>
<p>An OpenAPI-ready policy template is provided with the NGINX App Protect WAF packages and is located in: <code>/etc/app_protect/conf/NginxApiSecurityPolicy.json</code></p>
<p>It contains violations related to OpenAPI set to blocking (enforced).</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> NGINX App Protect WAF supports only one OpenAPI Specification file reference per policy.</div>
</blockquote>

<h3 
id="types-of-openapi-references">Types of OpenAPI References  <a class="headerlink float-right" href="#types-of-openapi-references" title="Types of OpenAPI References"><i class="fas fa-link fa-xs"></i></a>
</h3><p>There are different ways of referencing OpenAPI Specification files. The configuration is similar to <a href="#external-references">External References</a>.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Any update of an OpenAPI Specification file referenced in the policy will not trigger a policy compilation. This action needs to be done actively by reloading the NGINX configuration.</div>
</blockquote>

<h4 
id="url-reference">URL Reference  <a class="headerlink float-right" href="#url-reference" title="URL Reference"><i class="fas fa-link fa-xs"></i></a>
</h4><p>URL reference is the method of referencing an external source by providing its full URL.</p>
<p>Make sure to configure certificates prior to using the HTTPS protocol - see the <a href="#https-reference">HTTPS References</a> under the External References section for more details.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> You need to make sure that the server where the resource files are located is always available when you are compiling your policy.</div>
</blockquote>

<h5 
id="example-configuration">Example Configuration  <a class="headerlink float-right" href="#example-configuration" title="Example Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In this example, we are adding an OpenAPI Specification file reference using the link <code>http://127.0.0.1:8088/myapi.yaml</code>. This will configure allowed data types for <code>query_int</code> and <code>query_str</code> parameters values.</p>
<p><strong>Policy configuration:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f650dd438&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f650dd438">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;petstore_api_security_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;NGINX App Protect WAF API Security Policy for the Petstore API&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;open-api-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:8088/myapi.yaml&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Disallowed file upload content detected in body&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_FILE_UPLOAD_IN_BODY&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Mandatory request body is missing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_MANDATORY_REQUEST_BODY&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter location&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_LOCATION&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Mandatory parameter is missing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_MANDATORY_PARAMETER&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;JSON data does not comply with JSON schema&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_JSON_SCHEMA&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter array value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_ARRAY_VALUE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal Base64 value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_BASE64&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Disallowed file upload content detected&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_FILE_UPLOAD&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal request content type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL_CONTENT_TYPE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal static parameter value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_STATIC_VALUE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter value length&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter data type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_DATA_TYPE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter numeric value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NUMERIC_VALUE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Parameter value does not comply with regular expression&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_REGEXP&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal empty parameter value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_EMPTY_VALUE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal repeated parameter name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_REPEATED&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;petstore_api_security_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;NGINX App Protect WAF API Security Policy for the Petstore API&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;open-api-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:8088/myapi.yaml&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;blocking-settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;violations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Disallowed file upload content detected in body&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_FILE_UPLOAD_IN_BODY&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Mandatory request body is missing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_MANDATORY_REQUEST_BODY&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter location&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_LOCATION&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Mandatory parameter is missing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_MANDATORY_PARAMETER&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;JSON data does not comply with JSON schema&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_JSON_SCHEMA&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter array value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_ARRAY_VALUE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal Base64 value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_BASE64&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Disallowed file upload content detected&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_FILE_UPLOAD&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal request content type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL_CONTENT_TYPE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal static parameter value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_STATIC_VALUE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter value length&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_LENGTH&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter data type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_DATA_TYPE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter numeric value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_NUMERIC_VALUE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Parameter value does not comply with regular expression&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_VALUE_REGEXP&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_URL&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal parameter&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal empty parameter value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_EMPTY_VALUE&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;block&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Illegal repeated parameter name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;VIOL_PARAMETER_REPEATED&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Content of the referenced file <code>myapi.yaml</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">yaml</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65129ec8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65129ec8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">openapi</span><span class="p">:</span><span class="w"> </span><span class="m">3.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">info</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Primitive data types&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Primitive data types.&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;2.5.0&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">servers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">http://localhost</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">paths</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">/query</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">get</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">tags</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="l">query_int_str</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">query_int_str</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">operationId</span><span class="p">:</span><span class="w"> </span><span class="l">query_int_str</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">parameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">query_int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">in</span><span class="p">:</span><span class="w"> </span><span class="l">query</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">allowEmptyValue</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">schema</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">integer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">query_str</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">in</span><span class="p">:</span><span class="w"> </span><span class="l">query</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">allowEmptyValue</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">schema</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">responses</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">200</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">OK</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">404</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">NotFound</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">openapi</span><span class="p">:</span><span class="w"> </span><span class="m">3.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">info</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Primitive data types&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Primitive data types.&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;2.5.0&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">servers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">http://localhost</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">paths</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">/query</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">get</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">tags</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="l">query_int_str</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">query_int_str</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">operationId</span><span class="p">:</span><span class="w"> </span><span class="l">query_int_str</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">parameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">query_int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">in</span><span class="p">:</span><span class="w"> </span><span class="l">query</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">allowEmptyValue</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">schema</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">integer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">query_str</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">in</span><span class="p">:</span><span class="w"> </span><span class="l">query</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">allowEmptyValue</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">schema</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">responses</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">200</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">OK</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">404</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">NotFound</span></span></span></code></pre></div>
</div><p>In this case the following request will trigger an <code>Illegal parameter data type</code> violation, as we expect to have an integer value in the <code>query_int</code> parameter:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6513e300&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f6513e300">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://localhost/query?query_int=abc</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://localhost/query?query_int=abc</span></span></code></pre></div>
</div><p>The request will be blocked.</p>
<p>The link option is also available in the <code>openApiFileReference</code> property and synonymous with the one above in <code>open-api-files</code></p>
<p><strong>Note</strong>: <code>openApiFileReference</code> is not an array.</p>
<h5 
id="example-configuration-1">Example Configuration  <a class="headerlink float-right" href="#example-configuration-1" title="Example Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In this example, we reference the same OpenAPI Specification file as in the policy above using the <code>openApiFileReference</code> property.</p>
<p><strong>Policy configuration:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6515b7c0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6515b7c0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;openapifilereference-yaml&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;openApiFileReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:8088/ref.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;openapifilereference-yaml&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;openApiFileReference&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:8088/ref.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Content of the file <code>ref.txt</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65171368&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65171368">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:8088/myapi.yaml&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:8088/myapi.yaml&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
</div><h4 
id="file-reference">File Reference  <a class="headerlink float-right" href="#file-reference" title="File Reference"><i class="fas fa-link fa-xs"></i></a>
</h4><p>File reference refers to accessing local resources on the same machine. See the <a href="#file-reference">File References</a> under the External References section for more details.</p>
<h5 
id="example-configuration-2">Example Configuration  <a class="headerlink float-right" href="#example-configuration-2" title="Example Configuration"><i class="fas fa-link fa-xs"></i></a>
</h5><p>In this example, we would like to add an OpenAPI Specification file reference to the default policy.</p>
<p><strong>Policy Configuration:</strong></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65194db8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65194db8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;openapi-file-reference-json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;open-api-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///myapi2.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;openapi-file-reference-json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;open-api-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///myapi2.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Content of the referenced file <code>myapi2.json</code>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f651d8f90&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f651d8f90">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;openapi&#34;</span><span class="p">:</span> <span class="s2">&#34;3.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;info&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;title&#34;</span><span class="p">:</span> <span class="s2">&#34;Primitive data types2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Primitive data types.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;2.5.1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;servers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;http://localhost&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;paths&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;/query&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;get&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;tags&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;query_bool&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;query_bool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;operationId&#34;</span><span class="p">:</span> <span class="s2">&#34;query_bool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;query_bool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;in&#34;</span><span class="p">:</span> <span class="s2">&#34;query&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;required&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;schema&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;boolean&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responses&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;200&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;OK&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;404&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;NotFound&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;openapi&#34;</span><span class="p">:</span> <span class="s2">&#34;3.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;info&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;title&#34;</span><span class="p">:</span> <span class="s2">&#34;Primitive data types2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Primitive data types.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;2.5.1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;servers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;http://localhost&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;paths&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;/query&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;get&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;tags&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;query_bool&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;query_bool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;operationId&#34;</span><span class="p">:</span> <span class="s2">&#34;query_bool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;query_bool&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;in&#34;</span><span class="p">:</span> <span class="s2">&#34;query&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;required&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;schema&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;boolean&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responses&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;200&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;OK&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;404&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;NotFound&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In this case the following request will trigger an <code>Illegal repeated parameter name</code> violation, as the OpenAPI Specification doesn&rsquo;t allow repeated parameters.</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f651ec428&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f651ec428">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://localhost/query?a=true&amp;a=false</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://localhost/query?a=true&amp;a=false</span></span></code></pre></div>
</div><p>The request will not be blocked because this violation is set to alarm in the default policy.</p>

<h2 
id="grpc-protection-for-unary-traffic">gRPC Protection for Unary Traffic  <a class="headerlink float-right" href="#grpc-protection-for-unary-traffic" title="gRPC Protection for Unary Traffic"><i class="fas fa-link fa-xs"></i></a>
</h2><p>gRPC is a remote API standard and is an alternative to OpenAPI. If your applications expose gRPC APIs, NGINX App Protect WAF can protect them by parsing the messages; making sure they comply with the API definition; and enforcing security restrictions - such as size limits, detecting attack signatures, threat campaigns, and suspicious metacharacters in message string field values.
In the following sections, you will learn how to configure gRPC protection in the policy using gRPC Content Profiles.</p>

<h3 
id="grpc-content-profiles">gRPC Content Profiles  <a class="headerlink float-right" href="#grpc-content-profiles" title="gRPC Content Profiles"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The gRPC Content Profile contains all the definitions for protecting a gRPC service. It is similar in nature to the <strong>JSON and XML profiles</strong> handling JSON and XML traffic respectively. Roughly it includes:</p>
<ul>
<li><strong>The IDL files</strong> of the protected gRPC service. This is essential for App Protect to be able to parse the API messages and determine whether they are legal and what needs to be inspected for security. <a href="#including-an-external-json-schema-file">For more info regarding including an external file</a>.</li>
<li><strong>Security enforcement</strong>: whether to detect signatures and/or metacharacters and optionally an exception (a.k.a override) list of signatures that need to be disabled in the context of this profile.</li>
<li><strong>Defense attributes</strong>: special restrictions applied to the gRPC traffic. This includes a size limit for the gRPC messages in the request, and whether to tolerate fields that are not defined in the definition of the Protocol Buffer messages.</li>
</ul>
<p>Let&rsquo;s look at an example:</p>
<p>Assume you have a service with this IDL:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">proto</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f652b6688&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f652b6688">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="n">syntax</span> <span class="o">=</span> <span class="s">&#34;proto3&#34;</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kn">package</span> <span class="nn">myorg</span><span class="o">.</span><span class="n">services</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">import</span> <span class="s">&#34;common/messages.proto&#34;</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">service</span> <span class="n">photo_album</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">upload_photo</span> <span class="p">(</span><span class="n">Photo</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">OperationResult</span><span class="p">)</span> <span class="p">{};</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">get_photos</span> <span class="p">(</span><span class="n">Condition</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">PhotoResult</span><span class="p">)</span> <span class="p">{};</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">message</span> <span class="nc">Photo</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kt">string</span> <span class="n">name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kt">bytes</span> <span class="n">image</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">message</span> <span class="nc">PhotoResult</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">repeated</span> <span class="n">Photo</span> <span class="n">photos</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="n">OperationResult</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="n">syntax</span> <span class="o">=</span> <span class="s">&#34;proto3&#34;</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kn">package</span> <span class="nn">myorg</span><span class="o">.</span><span class="n">services</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">import</span> <span class="s">&#34;common/messages.proto&#34;</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">service</span> <span class="n">photo_album</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">upload_photo</span> <span class="p">(</span><span class="n">Photo</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">OperationResult</span><span class="p">)</span> <span class="p">{};</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">get_photos</span> <span class="p">(</span><span class="n">Condition</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">PhotoResult</span><span class="p">)</span> <span class="p">{};</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">message</span> <span class="nc">Photo</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kt">string</span> <span class="n">name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kt">bytes</span> <span class="n">image</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">message</span> <span class="nc">PhotoResult</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">repeated</span> <span class="n">Photo</span> <span class="n">photos</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="n">OperationResult</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span></span></span></code></pre></div>
</div><p>The definitions of <code>OperationResult</code> and <code>Condition</code> messages are in the imported file found in <code>common/messages.proto</code> which we will not list here. The two files need to be referenced in the gRPC Content Profile. Here is the policy with the profile example:</p>
<h4 
id="policy-with-the-profile-example">Policy with the profile example:  <a class="headerlink float-right" href="#policy-with-the-profile-example" title="Policy with the profile example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6530e8b0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6530e8b0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-grpc-service-policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;grpc-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;photo_service_profile&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;associateUrls&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumDataLength&#34;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowUnknownFields&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001213</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200089779</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;idlFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;$ref&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///grpc_files/album.proto&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isPrimary&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;$ref&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///grpc_files/common/messages.proto&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;importUrl&#34;</span><span class="p">:</span> <span class="s2">&#34;common&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-grpc-service-policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;grpc-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;photo_service_profile&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;associateUrls&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumDataLength&#34;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowUnknownFields&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;signatureOverrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200001213</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200089779</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;metacharCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;idlFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;$ref&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///grpc_files/album.proto&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isPrimary&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;$ref&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///grpc_files/common/messages.proto&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;importUrl&#34;</span><span class="p">:</span> <span class="s2">&#34;common&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The profile in this example enables checking of attack signatures and disallowed metacharacters in the string-typed fields within the service messages. Two signatures are disabled. The profile also limits the size of the messages to 100KB and disallows fields that are not defined in the IDL files.</p>
<p>The main IDL file, <code>album.proto</code> is marked as <code>primary</code>. The file it imports, <code>messages.proto</code>, is marked as secondary, that is, <code>isPrimary</code> is <code>false</code> and so should be any imported file. In order for App Protect to be able to match it to the import statement, the file location should be specified as done in the example above using the <code>importUrl</code> property.</p>
<p>An alternative and probably more convenient way to specify all the IDL files, the primary and all its imports, direct and indirect, is to bundle them into a single tar file in the same directory structure as they are expected by the import statements. In this case, you will have to specify which of the files in the tarball is the primary one. The supported formats are <code>tar</code> and <code>tgz</code>. App Protect will identify the file type automatically (tar, gzipped tar, or JSON) and handle it accordingly. Following the above example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65327ef0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65327ef0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;idlFiles&#34;</span><span class="err">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;$ref&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///grpc_files/album_service_files.tgz&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;primaryIdlFileName&#34;</span><span class="p">:</span> <span class="s2">&#34;album_service.proto&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;idlFiles&#34;</span><span class="err">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;$ref&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///grpc_files/album_service_files.tgz&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;primaryIdlFileName&#34;</span><span class="p">:</span> <span class="s2">&#34;album_service.proto&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}]</span></span></span></code></pre></div>
</div><p>Note the deletion of the <code>*</code> URL in the above policy. This is required if you want to accept only requests pertaining to the gRPC services exposed by your apps. If you decide to leave this catch-all URL, App Protect will accept other traffic including gRPC requests, applying policy checks such as signature detection. However, it will not apply to any gRPC-specific protection on them.</p>

<h3 
id="associating-profiles-with-urls">Associating Profiles with URLs  <a class="headerlink float-right" href="#associating-profiles-with-urls" title="Associating Profiles with URLs"><i class="fas fa-link fa-xs"></i></a>
</h3><p>As with JSON and XML profiles, in order for a gRPC Content Profile to become effective, it has to be associated with a URL that represents the service. However, in the sample policy above, the profile was apparently not associated with any URL and yet the profile is active. How did this happen? By setting <code>associateUrls</code> with <code>true</code>, App Protect <strong>implicitly</strong> creates the URL based on the package and service name as defined in the IDL file and associates the profile with that URL. In this example, the URL is <code>/myorg.services.photo_album/*</code>. Note it is a wildcard URL so that all methods in this service match it in its suffix; for example <code>/myorg.services.photo_album/get_photos</code> represents the <code>get_photos</code> RPC method.</p>
<p>Automatic association with URLs (<code>associateUrls</code> is <code>true</code>) is the recommended method of configuring gRPC protection, but if your gRPC services are mapped to URLs in a different manner, you can always explicitly associate a gRPC Content Profile with a different or an additional URL than the one implied by the service name, as in this example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f653958d8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f653958d8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-special-grpc-service-policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;grpc-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;special_service_profile&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;associateUrls&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumDataLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowUnknownFields&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;idlFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;$ref&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///grpc_files/special_service.proto&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isPrimary&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/services/unique/special/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;special_service_profile&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;grpc&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-special-grpc-service-policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;grpc-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;special_service_profile&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;associateUrls&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defenseAttributes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;maximumDataLength&#34;</span><span class="p">:</span> <span class="s2">&#34;any&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;allowUnknownFields&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;attackSignaturesCheck&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;idlFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;$ref&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///grpc_files/special_service.proto&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;isPrimary&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/services/unique/special/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;isAllowed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;urlContentProfiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;contentProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;special_service_profile&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerName&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerOrder&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;headerValue&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;grpc&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wildcard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;$action&#34;</span><span class="p">:</span> <span class="s2">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>You can always override the properties of the URL with the gRPC Content Profile even if you use <code>associateUrls</code> to <code>true</code>. For example, you can turn off meta character checks by adding <code>&quot;metacharsOnUrlCheck&quot;: false</code> within the respective URL entry.</p>

<h3 
id="grpc-response-pages">gRPC Response Pages  <a class="headerlink float-right" href="#grpc-response-pages" title="gRPC Response Pages"><i class="fas fa-link fa-xs"></i></a>
</h3><p>A gRPC error response page is returned when a request is blocked. The default page returns gRPC status code <code>UNKNOWN</code> (numeric value of 2) and a short textual message that includes the support ID. You can customize any of these two by configuring a custom gRPC response page in your policy.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f653c94f8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f653c94f8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-special-grpc-service-policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response-pages&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responsePageType&#34;</span><span class="p">:</span> <span class="s2">&#34;grpc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;grpcStatusCode&#34;</span><span class="p">:</span> <span class="s2">&#34;INVALID_ARGUMENT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;grpcStatusMessage&#34;</span><span class="p">:</span> <span class="s2">&#34;Operation does not comply with the service requirements. Please contact your administrator with the following number: &lt;%TS.request.ID()%&gt;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my-special-grpc-service-policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response-pages&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;responsePageType&#34;</span><span class="p">:</span> <span class="s2">&#34;grpc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;grpcStatusCode&#34;</span><span class="p">:</span> <span class="s2">&#34;INVALID_ARGUMENT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;grpcStatusMessage&#34;</span><span class="p">:</span> <span class="s2">&#34;Operation does not comply with the service requirements. Please contact your administrator with the following number: &lt;%TS.request.ID()%&gt;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The <code>grpcStatusCode</code> expects one of the <a href="https://grpc.github.io/grpc/core/md_doc_statuscodes.html" target="_blank" rel="noopener">standard gRPC status code values</a>.</p>

<h3 
id="detect-base64-in-string-values">Detect Base64 in String Values  <a class="headerlink float-right" href="#detect-base64-in-string-values" title="Detect Base64 in String Values"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The Detect Base64 feature allows NGINX App Protect WAF to detect whether values in string fields in gRPC payload are Base64 encoded. When a value is detected as Base64 encoded NGINX App Protect WAF will enforce the configured signatures on the decoded value <strong>and</strong> on the original value.</p>
<p>This feature is disabled by default and can be enabled by setting <code>decodeStringValuesAsBase64</code> to <code>enabled</code>.</p>
<p>This has to be used with care because Protocol Buffer protocol is supposed to carry binary fields of &ldquo;bytes&rdquo; type and, thus, trying to decode strings as Base64 may lead to false positives. Using Base64-encoded strings for binary data is usually not a good practice but, if the protected app still does that, then enable Base64 detection.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6541d0d0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6541d0d0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;valid_string_encoding_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;idl-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;valid_string.proto&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///tmp/grpc/valid_string.proto&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;grpc-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;base64_decode_strings&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;My first profile&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;idlFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;valid_string.proto&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeStringValuesAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;enabled&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;valid_string_encoding_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;idl-files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;valid_string.proto&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;link&#34;</span><span class="p">:</span> <span class="s2">&#34;file:///tmp/grpc/valid_string.proto&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;grpc-profiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;base64_decode_strings&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;My first profile&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;idlFiles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;idlFile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&#34;fileName&#34;</span><span class="p">:</span> <span class="s2">&#34;valid_string.proto&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}],</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;decodeStringValuesAsBase64&#34;</span><span class="p">:</span> <span class="s2">&#34;enabled&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="protocol-buffers-supported-version">Protocol Buffers Supported Version  <a class="headerlink float-right" href="#protocol-buffers-supported-version" title="Protocol Buffers Supported Version"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The supported Protocol Buffer version is 3 i.e. only proto3 is supported. Version 2 is not supported. Hence any obsolete feature of version 2, such as message extensions in the IDL files, will be rejected. IDL files that have the <code>syntax = &quot;proto2&quot;;</code> statement is also rejected.</p>

<h3 
id="grpc-server-reflection">gRPC Server Reflection  <a class="headerlink float-right" href="#grpc-server-reflection" title="gRPC Server Reflection"><i class="fas fa-link fa-xs"></i></a>
</h3><p><a href="https://grpc.github.io/grpc/core/md_doc_server_reflection_tutorial.html" target="_blank" rel="noopener">gRPC Server Reflection</a> provides information about publicly-accessible gRPC services on a server, and assists clients at runtime to construct RPC requests and responses without precompiled service information. gRPC Server reflection is not currently supported in App Protect. If Server Reflection support is required, App Protect must be disabled on the reflection URIs by adding a location block such as this:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65459d78&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65459d78">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/grpc.reflection</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_enable</span> <span class="no">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_pass</span> <span class="s">grpc://grpc_backend</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/grpc.reflection</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_enable</span> <span class="no">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_pass</span> <span class="s">grpc://grpc_backend</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h2 
id="grpc-protection-for-bidirectional-streaming">gRPC Protection for Bidirectional Streaming  <a class="headerlink float-right" href="#grpc-protection-for-bidirectional-streaming" title="gRPC Protection for Bidirectional Streaming"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="bidirectional-streaming-overview">Bidirectional Streaming Overview  <a class="headerlink float-right" href="#bidirectional-streaming-overview" title="Bidirectional Streaming Overview"><i class="fas fa-link fa-xs"></i></a>
</h3><p>A gRPC service can have a stream of messages on each side: client, server, or both. Bidirectional Streaming leverages HTTP/2 streaming capability, namely the ability to send multiple gRPC messages from either side ended by the message having the <code>END_STREAM</code> flag set to 1.</p>
<p>The Bidirectional Streaming will:</p>
<ol>
<li>Accept streaming services on either or both sides (client or server) and send a sequence of messages using a read-write stream.</li>
<li>Inspect the client messages in the stream and log them one by one.</li>
<li>In case of blocking action:
<ul>
<li>Send the blocking response.</li>
<li>Close the stream on both directions.</li>
</ul>
</li>
<li>Pass the server messages through without inspection.</li>
</ol>
<p><br> The below image demonstrates bidirectional streaming (client-side and server-side streaming):</p>
<p><figure><img class="figure-bitmap" src="/grpc/grpc_streaming.png"
    alt="gRPC Streaming">
</figure>
<br></p>

<h3 
id="configuration">Configuration  <a class="headerlink float-right" href="#configuration" title="Configuration"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The only configuration related to streaming is the IDL file or more specifically the <code>rpc</code> declaration. The keyword <code>stream</code> indicates that the message on the respective side is streaming. <br> <br>For example:</p>
<h4 
id="client-stream">Client Stream  <a class="headerlink float-right" href="#client-stream" title="Client Stream"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Where the client writes a sequence of messages and sends them to the server, again using a provided stream. Once the client has finished writing the messages, it waits for the server to read them and return its response. Again gRPC guarantees message ordering within an individual RPC call.</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f654bb028&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f654bb028">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">rpc LotsOfGreetings<span class="o">(</span>stream HelloRequest<span class="o">)</span> returns <span class="o">(</span>HelloResponse<span class="o">)</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">rpc LotsOfGreetings<span class="o">(</span>stream HelloRequest<span class="o">)</span> returns <span class="o">(</span>HelloResponse<span class="o">)</span><span class="p">;</span></span></span></code></pre></div>
</div><h4 
id="server-stream">Server Stream  <a class="headerlink float-right" href="#server-stream" title="Server Stream"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Where the client sends a request to the server and gets a stream to read a sequence of messages back. The client reads from the returned stream until there are no more messages. gRPC guarantees message ordering within an individual RPC call.</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f654dd308&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f654dd308">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">rpc LotsOfReplies<span class="o">(</span>HelloRequest<span class="o">)</span> returns <span class="o">(</span>stream HelloResponse<span class="o">)</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">rpc LotsOfReplies<span class="o">(</span>HelloRequest<span class="o">)</span> returns <span class="o">(</span>stream HelloResponse<span class="o">)</span><span class="p">;</span></span></span></code></pre></div>
</div><h4 
id="bidirectional-streams">Bidirectional Streams  <a class="headerlink float-right" href="#bidirectional-streams" title="Bidirectional Streams"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Where both sides send a sequence of messages using a read-write stream. The two streams operate independently, so clients and servers can read and write in whatever order they like: for example, the server could wait to receive all the client messages before writing its responses, or it could alternately read a message and then write a message, or some other combination of reads and writes. The order of messages in each stream is preserved.</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f654fb768&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f654fb768">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">rpc BidiHello<span class="o">(</span>stream HelloRequest<span class="o">)</span> returns <span class="o">(</span>stream HelloResponse<span class="o">)</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">rpc BidiHello<span class="o">(</span>stream HelloRequest<span class="o">)</span> returns <span class="o">(</span>stream HelloResponse<span class="o">)</span><span class="p">;</span></span></span></code></pre></div>
</div><h4 
id="bidirectional-idl-file-example">Bidirectional IDL File Example:  <a class="headerlink float-right" href="#bidirectional-idl-file-example" title="Bidirectional IDL File Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">proto</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65549198&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65549198">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="n">syntax</span> <span class="o">=</span> <span class="s">&#34;proto3&#34;</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kn">package</span> <span class="nn">streaming</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">service</span> <span class="n">Greeter</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">BothUnary</span> <span class="p">(</span><span class="n">HelloRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">HelloReply</span><span class="p">)</span> <span class="p">{}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">ClientStreaming</span> <span class="p">(</span><span class="n">stream</span> <span class="n">HelloRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">HelloReply</span><span class="p">)</span> <span class="p">{}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">ServerStreaming</span> <span class="p">(</span><span class="n">HelloRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">HelloReply</span><span class="p">)</span> <span class="p">{}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">BidirectionalStreaming</span> <span class="p">(</span><span class="n">stream</span> <span class="n">HelloRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">HelloReply</span><span class="p">)</span> <span class="p">{}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">message</span> <span class="nc">HelloRequest</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kt">string</span> <span class="kd">message</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">message</span> <span class="nc">HelloReply</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kt">string</span> <span class="kd">message</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="n">syntax</span> <span class="o">=</span> <span class="s">&#34;proto3&#34;</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kn">package</span> <span class="nn">streaming</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">service</span> <span class="n">Greeter</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">BothUnary</span> <span class="p">(</span><span class="n">HelloRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">HelloReply</span><span class="p">)</span> <span class="p">{}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">ClientStreaming</span> <span class="p">(</span><span class="n">stream</span> <span class="n">HelloRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">HelloReply</span><span class="p">)</span> <span class="p">{}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">ServerStreaming</span> <span class="p">(</span><span class="n">HelloRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">HelloReply</span><span class="p">)</span> <span class="p">{}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">rpc</span> <span class="n">BidirectionalStreaming</span> <span class="p">(</span><span class="n">stream</span> <span class="n">HelloRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">HelloReply</span><span class="p">)</span> <span class="p">{}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">message</span> <span class="nc">HelloRequest</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kt">string</span> <span class="kd">message</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="kd">message</span> <span class="nc">HelloReply</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kt">string</span> <span class="kd">message</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="enabling-the-grpc-protection-for-bidirectional-streaming">Enabling the gRPC Protection for Bidirectional Streaming  <a class="headerlink float-right" href="#enabling-the-grpc-protection-for-bidirectional-streaming" title="Enabling the gRPC Protection for Bidirectional Streaming"><i class="fas fa-link fa-xs"></i></a>
</h4><p>For enabling the gRPC capability, an HTTP/2 server definition needs to be applied with the <code>grpc_pass</code> location in the <code>nginx.conf</code> file. In addition, the <code>app_protect_policy_file</code> directive points to a policy specific to gRPC. All the gRPC messages will be logged in Security Log under the <code>log_grpc_all.json</code> file. For more details on how these requests are handled in gRPC, refer to the <a href="#grpc-logging">gRPC Logging</a> section.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65599e90&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65599e90">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_processes</span> <span class="s">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">working_directory</span> <span class="s">/tmp/cores</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_rlimit_core</span> <span class="s">1000M</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">1024</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">keepalive_timeout</span>  <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">client_body_timeout</span> <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">send_timeout</span> <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_connect_timeout</span>  <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_send_timeout</span>  <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_read_timeout</span>  <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_socket_keepalive</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span> <span class="s">default_server</span> <span class="s">http2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/grpc_policy.json&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_security_log</span> <span class="s">&#34;/opt/app_protect/share/defaults/log_grpc_all.json&#34;</span> <span class="s">/tmp/grpc.log</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_socket_keepalive</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_read_timeout</span> <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_send_timeout</span> <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">grpc_pass</span> <span class="s">grpc://&lt;GRPC_BACKEND_SERVER_IP&gt;:&lt;PORT&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_processes</span> <span class="s">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">working_directory</span> <span class="s">/tmp/cores</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_rlimit_core</span> <span class="s">1000M</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">1024</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">keepalive_timeout</span>  <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">client_body_timeout</span> <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">send_timeout</span> <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_connect_timeout</span>  <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_send_timeout</span>  <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_read_timeout</span>  <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_socket_keepalive</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span> <span class="s">default_server</span> <span class="s">http2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/grpc_policy.json&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_security_log</span> <span class="s">&#34;/opt/app_protect/share/defaults/log_grpc_all.json&#34;</span> <span class="s">/tmp/grpc.log</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_socket_keepalive</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_read_timeout</span> <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_send_timeout</span> <span class="mi">30m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">grpc_pass</span> <span class="s">grpc://&lt;GRPC_BACKEND_SERVER_IP&gt;:&lt;PORT&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="policy-with-the-profile-example">Policy with the profile example:  <a class="headerlink float-right" href="#policy-with-the-profile-example" title="Policy with the profile example:"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Refer to the above section for more details on <a href="#policy-with-the-profile-example">policy with the profile example</a>.</p>

<h3 
id="grpc-bidirectional-streaming-enforcement">gRPC Bidirectional Streaming Enforcement  <a class="headerlink float-right" href="#grpc-bidirectional-streaming-enforcement" title="gRPC Bidirectional Streaming Enforcement"><i class="fas fa-link fa-xs"></i></a>
</h3><h4 
id="client-request-flow">Client Request Flow  <a class="headerlink float-right" href="#client-request-flow" title="Client Request Flow"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Bidirectional Enforcement is per message; each message is buffered and processed (doing all the inspection actions according to the policy: signatures, metacharacters, and other violations) on its own. The following section provides more details on receiving a client event:</p>
<ul>
<li>The request header and each of the messages in the client stream is enforced <strong>separately</strong>.</li>
<li>The Enforcer issues a separate security log message per each message containing the violations found on it (if any). Refer to the <a href="#grpc-violations">gRPC Violations</a> section for more details on gRPC violations. There is also a separate log message per request headers opening the stream.</li>
<li>Then the Enforcer decides on the action that results from the violations just as it does for a regular HTTP request, but in gRPC it is done <strong>per message</strong> rather than the per whole stream. So if a message needs to be blocked, a blocking response is sent to the client and the stream is closed, but all the messages that preceded the blocked message have already been sent to the server.</li>
<li>A special case is when the request headers message had blocking violations. In that case, the blocking response is sent right away, ignoring any messages the client may have sent afterward. The security log will just reflect the headers in this case. See more details in the <a href="#sending-blocking-response-in-bidirectional-streaming">Sending Blocking Response in Bidirectional Streaming</a> section below.</li>
</ul>
<h4 
id="server-response-flow">Server Response Flow  <a class="headerlink float-right" href="#server-response-flow" title="Server Response Flow"><i class="fas fa-link fa-xs"></i></a>
</h4><p>gRPC server messages are not processed. All gRPC messages (unary or streaming) including the headers and trailer messages, are sent directly to the client (without sending them to the Enforcer).</p>
<h4 
id="sending-blocking-response-in-bidirectional-streaming">Sending Blocking Response in Bidirectional Streaming  <a class="headerlink float-right" href="#sending-blocking-response-in-bidirectional-streaming" title="Sending Blocking Response in Bidirectional Streaming"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The blocking response comes as the <strong>trailers</strong> message is sent to the client on behalf of the server. At the same time, the server gets the <code>END_STREAM</code> frame to ensure streams on both sides are closed.</p>

<h3 
id="size-limits">Size Limits  <a class="headerlink float-right" href="#size-limits" title="Size Limits"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The maximum total request size is applied to each message on its own, rather than to the total stream messages. By default, the maximum gRPC message size is 4MB.
You can configure different sizes in the declarative policy, like the 100K in the <a href="#policy-with-the-profile-example">Policy Example File</a>. If a message is sent with a size larger than that value, a <code>GRPC_FORMAT</code> violation is raised. If a message is sent with a size larger than 10MB, a <code>GRPC_MALFORMED</code> and <code>REQUEST_MAX_LENGTH</code> violation is raised.</p>
<p>There is no limit to the number of messages in a stream.</p>

<h3 
id="message-compression">Message Compression  <a class="headerlink float-right" href="#message-compression" title="Message Compression"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Currently, Message Compression is not supported. Therefore, a violation <code>VIOL_GRPC_MALFORMED</code> will be raised and the connection will be blocked if a compressed message is sent.</p>

<h3 
id="slow-post-attacks">Slow POST Attacks  <a class="headerlink float-right" href="#slow-post-attacks" title="Slow POST Attacks"><i class="fas fa-link fa-xs"></i></a>
</h3><p>A Slow POST attack or Slow HTTP POST attack is a type of denial of service attack. The attacker sends a legitimate HTTP POST request with the header Content-Length specified. The attacker then proceeds to send this content slowly. The server establishes a connection to the client and keeps it open to receive the request that it thinks is legitimate.</p>
<p>The attacker sends several such requests and effectively occupies the servers entire connection pool. As a result, it blocks the service for other legitimate users and results in a denial of service.</p>

<h3 
id="handling-slow-post-attacks">Handling Slow POST Attacks  <a class="headerlink float-right" href="#handling-slow-post-attacks" title="Handling Slow POST Attacks"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Slow POST attack mitigation - A client sending messages very slowly for a long time may be cut off by resetting the connection.</p>
<p>In gRPC, a connection is considered &ldquo;slow&rdquo; if a message takes more than 10 seconds to process. In other words, the slow connection timer will be reset when a message ends and not when the whole request ends. This way, a limit is applied on the number of concurrent messages rather than the number of concurrent gRPC connections (streams), as many of them may be idle.</p>
<p>The number of slow connections is limited to 25. Once another connection becomes slow it is reset.</p>

<h2 
id="other-grpc-references">Other gRPC References  <a class="headerlink float-right" href="#other-grpc-references" title="Other gRPC References"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="grpc-violations">gRPC Violations  <a class="headerlink float-right" href="#grpc-violations" title="gRPC Violations"><i class="fas fa-link fa-xs"></i></a>
</h3><p>There are three violations that are specific to gRPC. They are all enabled in the default policy. See also the <a href="#violations">Violations</a> section.</p>
<ul>
<li><code>VIOL_GRPC_MALFORMED</code>: This violation is issued when a gRPC message cannot be parsed according to its expected definition. This violation <strong>blocks</strong> in the default policy.</li>
<li><code>VIOL_GRPC_FORMAT</code>: This violation is issued when any of the definitions in the <code>defenseAttributes</code> of the profile are violated; for example, the maximum total size is exceeded.</li>
<li><code>VIOL_GRPC_METHOD</code>: This violation is issued when the gRPC method is unrecognized in the configured IDL.</li>
</ul>
<p>The violation <code>VIOL_METHOD</code> (not to be confused with the above <code>VIOL_GRPC_METHOD</code>) is not unique to gRPC, but in the context of a gRPC Content Profile, it is issued in special circumstances. Since gRPC mandates using the <code>POST</code> method on any gRPC request over HTTP, any other HTTP method on a request to URL with gRPC Content Profile will trigger this violation, even if the respective HTTP method is allowed in the policy. So, in our first example above, the request <code>GET /myorg.services.photo_album/get_photos</code> will trigger <code>VIOL_METHOD</code> even though <code>GET</code> is among the allowed HTTP methods in the policy (by the base template).</p>

<h3 
id="grpc-logging">gRPC Logging  <a class="headerlink float-right" href="#grpc-logging" title="gRPC Logging"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Security log for gRPC requests has unique fields: <code>uri</code>, <code>grpc_method</code>, and <code>grpc_service</code>. Also, since the content of gRPC requests is binary (Protocol Buffers), it is better transferred in Base64 encoding. Hence, it is recommended to use the <code>headers</code> and <code>request_body_base64</code> fields instead of the <code>request</code> field. A new predefined log format called <code>grpc</code> should be used in all gRPC locations that also use policies with gRPC Content Profiles.
The <code>grpc</code> format also contains the above new gRPC fields (<code>grpc_service</code> and <code>grpc_method</code>). See <a href="http://localhost:1313/nginx-app-protect-waf/v5/logging-overview/security-log/#available-security-log-attributes">Available Security Log Attributes</a>.</p>
<p>NGINX App Protect WAF provides three security log bundles for gRPC: <code>log_grpc_all</code>, <code>log_grpc_illegal</code> and <code>log_grpc_blocked</code> using the <code>grpc</code> format with three filters: all requests, illegal requests, and blocked requests respectively. Unless you have special logging format requirements, the best practice is to use one of these bundles in all gRPC locations with the <code>app_protect_security_log</code> directive.</p>
<p>Here is a typical example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65662980&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65662980">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">my_grpc_service.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/policy_with_grpc_profile.tgz&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_security_log</span> <span class="s">&#34;/etc/app_protect/conf/log_grpc_all.tgz&#34;</span> <span class="s">stderr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_pass</span> <span class="s">grpcs://grpc_backend</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">my_grpc_service.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/policy_with_grpc_profile.tgz&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_security_log</span> <span class="s">&#34;/etc/app_protect/conf/log_grpc_all.tgz&#34;</span> <span class="s">stderr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">grpc_pass</span> <span class="s">grpcs://grpc_backend</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h2 
id="securing-graphql-apis-with-nginx-app-protect-waf">Securing GraphQL APIs with NGINX App protect WAF  <a class="headerlink float-right" href="#securing-graphql-apis-with-nginx-app-protect-waf" title="Securing GraphQL APIs with NGINX App protect WAF"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="graphql-overview">GraphQL Overview  <a class="headerlink float-right" href="#graphql-overview" title="GraphQL Overview"><i class="fas fa-link fa-xs"></i></a>
</h3><p>GraphQL is an API technology that has grown rapidly in recent years and is continuing to gain traction. GraphQL is a query language designed for APIs to use in the development of client applications that access large data sets with intricate relations among themselves. It provides an intuitive application and flexible syntax for describing data requirements. <br></p>
<p>GraphQL provides a more efficient, powerful and flexible alternative to REST APIs. This makes it easier to retrieve the data you require in a single request and helps in overcoming challenges which include under-fetching and over-fetching of data. GraphQL also enables faster front-end development without the need for new API endpoints (GraphQL works on a single endpoint), great backend analytics using GraphQL queries and a structured schema and type system.</p>
<p>GraphQL also allows the client to specify exactly what data it needs, reducing the amount of data transferred over the network and improving the overall performance of the application.</p>
<p>In the following sections, you will learn more about enabling GraphQL configuration (using basic and advanced configuration) plus GraphQL security, GraphQL profile and URL settings.</p>

<h3 
id="graphql-security">GraphQL Security  <a class="headerlink float-right" href="#graphql-security" title="GraphQL Security"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Securing GraphQL APIs with NGINX App Protect WAF involves using WAF to monitor and protect against security threats and attacks. GraphQL, like REST, is usually <a href="http://graphql.org/learn/serving-over-http/" target="_blank" rel="noopener">served over HTTP</a>, using GET and POST requests and a proprietary <a href="https://graphql.org/learn/schema/#the-query-and-mutation-types" target="_blank" rel="noopener">query language</a>. It is prone to the typical Web APIs security vulnerabilities, such as injection attacks, Denial of Service (DoS) attacks and abuse of flawed authorization.</p>
<p>Unlike REST, where Web resources are identified by multiple URLs, GraphQL server operates on a single URL/endpoint, usually <strong>/graphql</strong>. All GraphQL requests for a given service should be directed to this endpoint.</p>

<h2 
id="enabling-graphql-with-basic-configuration">Enabling GraphQL with Basic Configuration  <a class="headerlink float-right" href="#enabling-graphql-with-basic-configuration" title="Enabling GraphQL with Basic Configuration"><i class="fas fa-link fa-xs"></i></a>
</h2><p>This section describes how to configure GraphQL with minimal configuration. Refer to the following sections for GraphQL elements definitions and details about advanced configuration options.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> GraphQL is supported on NGINX App Protect WAF version starting 4.2. Make sure you&rsquo;re running NGINX App Protect WAF version 4.2 or later to get GraphQL to work properly.</div>
</blockquote>

<p>GraphQL policy consists of three basic elements: GraphQL Profile, GraphQL Violations and GraphQL URL.</p>
<p>You can enable GraphQL on App Protect by following these steps:</p>
<ol>
<li>Create a GraphQL policy that includes the policy name. Note that GraphQL profile and GraphQL violation will be enabled by default in the default policy.
You can enable GraphQL on App Protect with minimum effort by using the following GraphQL policy example.</li>
<li>Add the GraphQL URL to the policy and associate the GraphQL default profile with it.</li>
<li>Optionally, if the app that uses this policy serves only GraphQL traffic, then delete the wildcard URL &ldquo;*&rdquo; from the policy so that requests to any URL other than <strong>/graphql</strong> will trigger a violation. In the example below we assume this is the case.</li>
<li>Update the <code>nginx.conf</code> file. To enforce GraphQL settings, update the <code>app_protect_policy_file</code> field with the GraphQL policy name in <code>nginx.conf</code> file. Perform nginx reload once <code>nginx.conf</code> file is updated to enforce the GraphQL settings.</li>
</ol>
<p>In the following policy example, the GraphQL &ldquo;policy name&rdquo; i.e. &ldquo;graphql_policy&rdquo;, and graphql &ldquo;urls&rdquo; settings are defined.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65706698&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65706698">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;graphql_policy&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;applicationLanguage&#34;</span>: <span class="s2">&#34;utf-8&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;caseInsensitive&#34;</span>: false,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;blocking&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;urls&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl"> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;</span><span class="nv">$action</span><span class="s2">&#34;</span>: <span class="s2">&#34;delete&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;method&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;wildcard&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>,
</span></span><span class="line"><span class="cl"> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/graphql&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;urlContentProfiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl"> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;contentProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;headerValue&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;headerName&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;headerOrder&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;graphql&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl"> <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl"> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;graphql_policy&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;applicationLanguage&#34;</span>: <span class="s2">&#34;utf-8&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;caseInsensitive&#34;</span>: false,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;blocking&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;urls&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl"> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;</span><span class="nv">$action</span><span class="s2">&#34;</span>: <span class="s2">&#34;delete&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;method&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;wildcard&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>,
</span></span><span class="line"><span class="cl"> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/graphql&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;urlContentProfiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl"> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;contentProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;headerValue&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;headerName&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;headerOrder&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;graphql&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl"> <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl"> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
</div><p>As described in point 4 above, here is an example <code>nginx.conf</code> file:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65755068&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65755068">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_processes</span>  <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">65536</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">sendfile</span>        <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">keepalive_timeout</span>  <span class="mi">65</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>  <span class="c1"># This is how you enable NGINX App Protect WAF in the relevant context/block
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/NginxDefaultPolicy.json&#34;</span><span class="p">;</span> <span class="c1"># This is a reference to the policy file to use. If not defined, the default policy is used
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span> <span class="c1"># This section enables the logging capability
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_security_log</span> <span class="s">&#34;/etc/app_protect/conf/log_default.json&#34;</span> <span class="s">syslog:server=127.0.0.1:514</span><span class="p">;</span> <span class="c1"># This is where the remote logger is defined in terms of: logging options (defined in the referenced file), log server IP, log server port
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://172.29.38.211:80</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/graphql</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/graphQL_policy.json&#34;</span><span class="p">;</span> <span class="c1"># This location will invoke the custom GraphQL policy
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="kn">proxy_pass</span> <span class="s">http://172.29.38.211:80</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">worker_processes</span>  <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">65536</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">sendfile</span>        <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">keepalive_timeout</span>  <span class="mi">65</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>  <span class="c1"># This is how you enable NGINX App Protect WAF in the relevant context/block
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/NginxDefaultPolicy.json&#34;</span><span class="p">;</span> <span class="c1"># This is a reference to the policy file to use. If not defined, the default policy is used
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_security_log_enable</span> <span class="no">on</span><span class="p">;</span> <span class="c1"># This section enables the logging capability
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kn">app_protect_security_log</span> <span class="s">&#34;/etc/app_protect/conf/log_default.json&#34;</span> <span class="s">syslog:server=127.0.0.1:514</span><span class="p">;</span> <span class="c1"># This is where the remote logger is defined in terms of: logging options (defined in the referenced file), log server IP, log server port
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://172.29.38.211:80</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/graphql</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="kn">client_max_body_size</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="kn">app_protect_policy_file</span> <span class="s">&#34;/etc/app_protect/conf/graphQL_policy.json&#34;</span><span class="p">;</span> <span class="c1"># This location will invoke the custom GraphQL policy
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="kn">proxy_pass</span> <span class="s">http://172.29.38.211:80</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h2 
id="graphql-advanced-configuration">GraphQL Advanced Configuration  <a class="headerlink float-right" href="#graphql-advanced-configuration" title="GraphQL Advanced Configuration"><i class="fas fa-link fa-xs"></i></a>
</h2><p>The below sections provides details about enabling GraphQL with advanced configuration.</p>
<p>In advanced configuration, GraphQL policy consists of GraphQL Violations, GraphQL Profile and the URL section.</p>

<h3 
id="graphql-violations">GraphQL Violations  <a class="headerlink float-right" href="#graphql-violations" title="GraphQL Violations"><i class="fas fa-link fa-xs"></i></a>
</h3><p>NGINX App Protect WAF introduces four new violations specific to GraphQL: <code>VIOL_GRAPHQL_FORMAT</code>, <code>VIOL_GRAPHQL_MALFORMED</code>, <code>VIOL_GRAPHQL_INTROSPECTION_QUERY</code> and <code>VIOL_GRAPHQL_ERROR_RESPONSE</code>. <br></p>
<p>Under the &ldquo;blocking-settings,&rdquo; user can either enable or disable these violations. Note that these violations will be enabled by default. Any changes to these violation settings here will override the default settings. The details regarding logs will be recorded in the security log. <br></p>
<p>See also the <a href="#violations">Violations</a> section for more details.</p>
<p>While configuring GraphQL, since the GraphQL violations are enabled by default, you can change the GraphQL violations settings i.e. alarm: <code>true</code> and block: <code>false</code> under the &ldquo;blocking settings&rdquo;. In this manner, the GraphQL profile detects violations but does not block the request. They may contribute to the Violation Rating, which, if raised above 3, will automatically block the request.</p>
<p>However, setting the alarm and block to <code>true</code> will enforce block settings and App Protect will block any violating requests.</p>
<p>See below example for more details:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f657e4178&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f657e4178">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;graphql_policy&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;applicationLanguage&#34;</span>: <span class="s2">&#34;utf-8&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;caseInsensitive&#34;</span>: false,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;blocking&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;blocking-settings&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;violations&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GRAPHQL_FORMAT&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GRAPHQL_MALFORMED&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GRAPHQL_INTROSPECTION_QUERY&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GRAPHQL_ERROR_RESPONSE&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;graphql_policy&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;applicationLanguage&#34;</span>: <span class="s2">&#34;utf-8&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;caseInsensitive&#34;</span>: false,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;blocking&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;blocking-settings&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;violations&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GRAPHQL_FORMAT&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GRAPHQL_MALFORMED&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GRAPHQL_INTROSPECTION_QUERY&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GRAPHQL_ERROR_RESPONSE&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
</div>
<h3 
id="graphql-profile">GraphQL Profile  <a class="headerlink float-right" href="#graphql-profile" title="GraphQL Profile"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The GraphQL Profile defines the GraphQL properties that are enforced by the security policy.</p>
<p>The profile can be added by the security engineers to make sure that GraphQL apps are bound to the same security settings defined in the profile. Different GraphQL apps can have different profiles based on the security needs.</p>
<p>The GraphQL Profile includes:</p>
<ul>
<li><strong>Security enforcement</strong>: whether to detect signatures and/or metacharacters and optionally an exception (a.k.a override) list of signatures that need to be disabled in the context of this profile.</li>
<li><strong>Defense attributes</strong>: special restrictions applied to the GraphQL traffic. The below example shows the customized GraphQL properties.</li>
<li><strong>responseEnforcement</strong>: whether to block Disallowed patterns and provide the list of patterns against the <code>disallowedPatterns</code> property.</li>
</ul>
<p>GraphQL profile example:</p>
<p>In the GraphQL profile example below, we changed the &ldquo;defenseAttributes&rdquo; to custom values. You can customize these values under the &ldquo;defenseAttributes&rdquo; property. Add a list of disallowed patterns to the &ldquo;disallowedPatterns&rdquo; field (for example, here we&rsquo;ve added pattern1 and pattern2).</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6584f450&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f6584f450">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;graphql-profiles&#34;</span> : <span class="o">[</span>
</span></span><span class="line"><span class="cl">         <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;attackSignaturesCheck&#34;</span> : true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;defenseAttributes&#34;</span> : <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;allowIntrospectionQueries&#34;</span> : false,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumBatchedQueries&#34;</span> : 10,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumQueryCost&#34;</span> : <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumStructureDepth&#34;</span> : 10,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumTotalLength&#34;</span> : 100000,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumValueLength&#34;</span> : 100000,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;tolerateParsingWarnings&#34;</span> : <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;description&#34;</span> : <span class="s2">&#34;&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;metacharElementCheck&#34;</span> : false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span> : <span class="s2">&#34;response_block&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseEnforcement&#34;</span> : <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;blockDisallowedPatterns&#34;</span> : true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;disallowedPatterns&#34;</span>:<span class="o">[</span><span class="s2">&#34;pattern1&#34;</span>,<span class="s2">&#34;pattern2&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">     <span class="o">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;graphql-profiles&#34;</span> : <span class="o">[</span>
</span></span><span class="line"><span class="cl">         <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;attackSignaturesCheck&#34;</span> : true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;defenseAttributes&#34;</span> : <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;allowIntrospectionQueries&#34;</span> : false,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumBatchedQueries&#34;</span> : 10,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumQueryCost&#34;</span> : <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumStructureDepth&#34;</span> : 10,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumTotalLength&#34;</span> : 100000,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;maximumValueLength&#34;</span> : 100000,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;tolerateParsingWarnings&#34;</span> : <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;description&#34;</span> : <span class="s2">&#34;&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;metacharElementCheck&#34;</span> : false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span> : <span class="s2">&#34;response_block&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseEnforcement&#34;</span> : <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;blockDisallowedPatterns&#34;</span> : true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;disallowedPatterns&#34;</span>:<span class="o">[</span><span class="s2">&#34;pattern1&#34;</span>,<span class="s2">&#34;pattern2&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">     <span class="o">]</span></span></span></code></pre></div>
</div>
<blockquote class="note">
  <div><strong>Note:</strong><br/> For GraphQL profile default values and GraphQL violations reference, see NGINX App Protect WAF <a href="http://localhost:1313/nginx-app-protect-waf/v4/declarative-policy/policy/" target="_blank" rel="noopener">Declarative Policy guide.</a></div>
</blockquote>

<h3 
id="define-url-settings">Define URL settings  <a class="headerlink float-right" href="#define-url-settings" title="Define URL settings"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The second step to configure GraphQL is to define the URL settings. Set the values for &ldquo;isAllowed&rdquo;: <strong>true</strong>, &ldquo;name&rdquo;: <strong>/graphql</strong> in the URLs section, which means URLs with <strong>/graphql</strong> name are permitted. This path will be used for all GraphQL API requests.</p>
<p>Under the &ldquo;urlContentProfiles&rdquo; settings define the GraphQL profile name, headerValue: <code>*</code> (wildcard), headerName: <code>*</code> (wildcard), headerOrder: <code>default</code> (allowing any GraphQL URL request with any headerValue, headerName and type should be <code>graphql</code>.</p>
<p>There are no restrictions on the number of GraphQL profiles that can be added by the user.</p>
<p>GraphQL URL example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f658bd608&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f658bd608">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  <span class="s2">&#34;urls&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;</span><span class="nv">$action</span><span class="s2">&#34;</span>: <span class="s2">&#34;delete&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;wildcard&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;isAllowed&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/graphql&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;performStaging&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;urlContentProfiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">                <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;contentProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerValue&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerName&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerOrder&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;graphql&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  <span class="s2">&#34;urls&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;</span><span class="nv">$action</span><span class="s2">&#34;</span>: <span class="s2">&#34;delete&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;wildcard&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;isAllowed&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/graphql&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;performStaging&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;urlContentProfiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">                <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;contentProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerValue&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerName&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerOrder&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;graphql&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span></span></span></code></pre></div>
</div>
<h3 
id="associating-graphql-profiles-with-url">Associating GraphQL Profiles with URL  <a class="headerlink float-right" href="#associating-graphql-profiles-with-url" title="Associating GraphQL Profiles with URL"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The last step is to associate the GraphQL profiles with the URLs. As with JSON and XML profiles, in order for a GraphQL Profile to become effective, it has to be associated with a URL that represents the service. Add the GraphQL profile name which you defined previously under the GraphQL profiles in the name field. For example, here we have defined two GraphQL profiles with the &ldquo;name&rdquo;: &ldquo;Default&rdquo; and &ldquo;My Custom Profile&rdquo; under the urlContentProfiles. Later we also associated these profiles in &ldquo;graphql-profiles&rdquo;.</p>
<p>GraphQL configuration example:</p>
<p>In this example we define a custom GraphQL profile and use it on one URL, while assigning the default profile to another one.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f659de708&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f659de708">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;graphql_policy&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;applicationLanguage&#34;</span>: <span class="s2">&#34;utf-8&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;caseInsensitive&#34;</span>: false,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;blocking&#34;</span>,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;graphql-profiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;attackSignaturesCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;defenseAttributes&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;allowIntrospectionQueries&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumBatchedQueries&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumQueryCost&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumStructureDepth&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumTotalLength&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumValueLength&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;tolerateParsingWarnings&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;Default GraphQL Profile&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;metacharElementCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Default&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseEnforcement&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;blockDisallowedPatterns&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;attackSignaturesCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;defenseAttributes&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;allowIntrospectionQueries&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumBatchedQueries&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumQueryCost&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumStructureDepth&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumTotalLength&#34;</span>: <span class="s2">&#34;400&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumValueLength&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;tolerateParsingWarnings&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;my custom Profile&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;metacharElementCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;My Custom Profile&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseEnforcement&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;blockDisallowedPatterns&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;disallowedPatterns&#34;</span>: <span class="o">[</span><span class="s2">&#34;pattern1&#34;</span>, <span class="s2">&#34;pattern2&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;urls&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;</span><span class="nv">$action</span><span class="s2">&#34;</span>: <span class="s2">&#34;delete&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;wildcard&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;isAllowed&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/graphql&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;performStaging&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;urlContentProfiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">                <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;contentProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerValue&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerName&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerOrder&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;graphql&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;isAllowed&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/mygraphql&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;performStaging&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;urlContentProfiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">                <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;contentProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;My Custom Profile&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerValue&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerName&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerOrder&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;graphql&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;graphql_policy&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;applicationLanguage&#34;</span>: <span class="s2">&#34;utf-8&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;caseInsensitive&#34;</span>: false,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;blocking&#34;</span>,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;graphql-profiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;attackSignaturesCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;defenseAttributes&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;allowIntrospectionQueries&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumBatchedQueries&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumQueryCost&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumStructureDepth&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumTotalLength&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumValueLength&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;tolerateParsingWarnings&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;Default GraphQL Profile&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;metacharElementCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Default&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseEnforcement&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;blockDisallowedPatterns&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;attackSignaturesCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;defenseAttributes&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;allowIntrospectionQueries&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumBatchedQueries&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumQueryCost&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumStructureDepth&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumTotalLength&#34;</span>: <span class="s2">&#34;400&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;maximumValueLength&#34;</span>: <span class="s2">&#34;any&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;tolerateParsingWarnings&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;my custom Profile&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;metacharElementCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;My Custom Profile&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseEnforcement&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;blockDisallowedPatterns&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;disallowedPatterns&#34;</span>: <span class="o">[</span><span class="s2">&#34;pattern1&#34;</span>, <span class="s2">&#34;pattern2&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;urls&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;</span><span class="nv">$action</span><span class="s2">&#34;</span>: <span class="s2">&#34;delete&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;wildcard&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;isAllowed&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/graphql&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;performStaging&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;urlContentProfiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">                <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;contentProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Default&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerValue&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerName&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerOrder&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;graphql&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;isAllowed&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/mygraphql&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;performStaging&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;urlContentProfiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">                <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;contentProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;My Custom Profile&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerValue&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerName&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;headerOrder&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;graphql&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
</div>
<h3 
id="graphql-response-pages">GraphQL Response Pages  <a class="headerlink float-right" href="#graphql-response-pages" title="GraphQL Response Pages"><i class="fas fa-link fa-xs"></i></a>
</h3><p>A GraphQL error response page is returned when a request is blocked. This GraphQL response page, like other blocking response pages, can be customized, but the GraphQL JSON syntax must be preserved for them to be displayed correctly. The default page returns the GraphQL status code Blocking Response Page (BRP) and a short JSON error message which includes the support ID.</p>
<p>For example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65a14a38&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65a14a38">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;response-pages&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responsePageType&#34;</span>: <span class="s2">&#34;graphql&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseActionType&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseContent&#34;</span>: <span class="s2">&#34;{\&#34;errors\&#34;: [{\&#34;message\&#34;: \&#34;This is a custom GraphQL blocking response page. Code: BRP. Your support ID is: &lt;%TS.request.ID()%&gt;\&#34;}]}&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;response-pages&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responsePageType&#34;</span>: <span class="s2">&#34;graphql&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseActionType&#34;</span>: <span class="s2">&#34;default&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;responseContent&#34;</span>: <span class="s2">&#34;{\&#34;errors\&#34;: [{\&#34;message\&#34;: \&#34;This is a custom GraphQL blocking response page. Code: BRP. Your support ID is: &lt;%TS.request.ID()%&gt;\&#34;}]}&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span></span></span></code></pre></div>
</div>
<h2 
id="override-rules">Override Rules  <a class="headerlink float-right" href="#override-rules" title="Override Rules"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="override-rules-overview">Override Rules Overview  <a class="headerlink float-right" href="#override-rules-overview" title="Override Rules Overview"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The <strong>Override Rules</strong> feature allows overriding of the <strong>default policy</strong> settings. Each override rule consists of a condition followed by changes to the original policy applied to requests that meet the respective condition. This feature provides the ability to include the override rules within a declarative policy such that all incoming requests are verified against those rules.</p>
<p>With this enhancement, users now have more control over how a unique policy setting is applied to incoming requests with a specific method, source IP address, header or URI value through one or multiple unique override rules. Each override rule possesses a unique name and specific conditions that are matched against incoming traffic from a specific client side. The structure of these override rules adheres to the JSON schema defined by the declarative policy.</p>
<p>Here is an example of a declarative policy using an override rules entity:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65b055c8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65b055c8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;override_rules_example&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;override-rules&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;localhost-log-only&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;host.contains(&#39;localhost&#39;) and clientIp == &#39;127.0.0.1&#39; and userAgent.lower().startsWith(&#39;curl&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;login_page&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;method == &#39;POST&#39; and not parameters[&#39;ref&#39;].lower().matches(&#39;example&#39;) and uri.contains(&#39;/login/&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;login_page_block_redirect&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">              <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;signature-sets&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">              <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;All Signatures&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">              <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;response-pages&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">              <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;responseRedirectUrl&#34;</span>: <span class="s2">&#34;https://example.com/rejected?id=&lt;%TS.request.ID()%&gt;&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;responseActionType&#34;</span>: <span class="s2">&#34;redirect&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;responsePageType&#34;</span>: <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">          <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;api-strict&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;uri.contains(&#39;api4&#39;) and not (clientIp.matches(&#39;fd00:1::/48&#39;) or userAgent.lower().startsWith(&#39;Mozilla&#39;))&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;</span><span class="nv">$ref</span><span class="s2">&#34;</span>: <span class="s2">&#34;file:///NginxStrictPolicy.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;strict-post&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;method.matches(&#39;POST&#39;) and (cookies[&#39;sessionToken&#39;] != &#39;c2Vzc2lvblRva2Vu&#39; or headers[&#39;Content-Encoding&#39;] == &#39;gzip&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;</span><span class="nv">$ref</span><span class="s2">&#34;</span>: <span class="s2">&#34;file:///NginxStrictPolicy.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;usa-only&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;geolocation != &#39;US&#39;&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;violation&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;violation&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;block&#34;</span>: true,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;attackType&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                           <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Forceful Browsing&#34;</span>
</span></span><span class="line"><span class="cl">                       <span class="o">}</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;Attempt to access from outside the USA&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;rating&#34;</span>: <span class="m">4</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;override_rules_example&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;override-rules&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;localhost-log-only&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;host.contains(&#39;localhost&#39;) and clientIp == &#39;127.0.0.1&#39; and userAgent.lower().startsWith(&#39;curl&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;login_page&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;method == &#39;POST&#39; and not parameters[&#39;ref&#39;].lower().matches(&#39;example&#39;) and uri.contains(&#39;/login/&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;login_page_block_redirect&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">              <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;signature-sets&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">              <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;All Signatures&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;block&#34;</span>: true,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;alarm&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">              <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;response-pages&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">              <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;responseRedirectUrl&#34;</span>: <span class="s2">&#34;https://example.com/rejected?id=&lt;%TS.request.ID()%&gt;&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;responseActionType&#34;</span>: <span class="s2">&#34;redirect&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;responsePageType&#34;</span>: <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">          <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;api-strict&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;uri.contains(&#39;api4&#39;) and not (clientIp.matches(&#39;fd00:1::/48&#39;) or userAgent.lower().startsWith(&#39;Mozilla&#39;))&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;</span><span class="nv">$ref</span><span class="s2">&#34;</span>: <span class="s2">&#34;file:///NginxStrictPolicy.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;strict-post&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;method.matches(&#39;POST&#39;) and (cookies[&#39;sessionToken&#39;] != &#39;c2Vzc2lvblRva2Vu&#39; or headers[&#39;Content-Encoding&#39;] == &#39;gzip&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;</span><span class="nv">$ref</span><span class="s2">&#34;</span>: <span class="s2">&#34;file:///NginxStrictPolicy.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;usa-only&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;geolocation != &#39;US&#39;&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;violation&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;violation&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;block&#34;</span>: true,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;attackType&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                           <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Forceful Browsing&#34;</span>
</span></span><span class="line"><span class="cl">                       <span class="o">}</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;Attempt to access from outside the USA&#34;</span>,
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;rating&#34;</span>: <span class="m">4</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
</div><p>The above &ldquo;override_rules_example&rdquo; policy contains five override rules:</p>
<ol>
<li>The <strong>&ldquo;localhost-log-only&rdquo;</strong> rule applies to the requests with a user agent header starting with &ldquo;curl&rdquo;, a host header containing &ldquo;localhost&rdquo;, and a client IP address set to 127.0.0.1. It switches the enforcement mode to &ldquo;transparent&rdquo; without blocking the request. The remaining policy settings remain unchanged. This type of override rule is an example of an <strong>Inline Policy Reference</strong>.</li>
<li>The <strong>&ldquo;login_page&rdquo;</strong> rule is triggered by POST requests to URIs containing &ldquo;/login/&rdquo;. Since the &ldquo;actionType&rdquo; field is set to &ldquo;replace-policy&rdquo;, it overrides the policy with a new one named &ldquo;login_page_block_redirect&rdquo;. This new policy is independent of the &ldquo;override_rules_example&rdquo; policy. It enables all signature sets and redirects the user to a rejection page. This is another example of an <strong>Inline Policy Reference</strong> with a different condition.</li>
<li>The <strong>&ldquo;api-strict&rdquo;</strong> rule is applied for requests with &ldquo;api4&rdquo; in the URI, except for client IP addresses matching the &ldquo;fd00:1::/48&rdquo; range and user agents starting with &ldquo;Mozilla&rdquo;. It references an external policy file named &ldquo;NginxStrictPolicy.json&rdquo; located at &ldquo;/etc/app_protect/conf/&rdquo; to override the current policy. The &ldquo;actionType&rdquo; field is set to &ldquo;replace-policy&rdquo; and the external policy can be specified using a reference to its file using <strong>$ref</strong>. The file is the JSON policy source of that policy. This type of policy switching is known as <strong>External Policy Reference</strong>.</li>
<li>The <strong>&ldquo;strict-post&rdquo;</strong> rule is triggered when POST requests include a session token in the cookies that is not equal to &ldquo;c2Vzc2lvblRva2Vu&rdquo; or when the &ldquo;gzip&rdquo; value is found in the content-encoding headers. This rule follows a similar approach to referencing an external policy file, just like the <strong>api-strict</strong> rule mentioned above.</li>
<li>The <strong>&ldquo;usa-only&rdquo;</strong> rule is triggered when a request coming from a country other than the USA. The actionType is set to &ldquo;violation&rdquo;, meaning that <code>VIOL_RULE</code> violation is triggered for such a request. This violation will block and mark the request as illegal with regard to the &ldquo;block&rdquo; and &ldquo;alarm&rdquo; attributes. There is no change in policy for this rule. For more details about <strong>Geolocation</strong> feature, see <a href="#geolocation-in-policy-override-rules-conditions">Geolocation in Policy Override Rules Conditions</a>.</li>
</ol>
<p>These five rules demonstrate how the override rules feature allows for customization and the ability to modify specific aspects of the original policy based on predefined conditions.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> <ul>
<li>By default, the actionType field is configured to &ldquo;extend-policy&rdquo;.</li>
<li>External references are supported for any policy reference.</li>
</ul>
</div>
</blockquote>


<h3 
id="condition-syntax-usage">Condition Syntax Usage  <a class="headerlink float-right" href="#condition-syntax-usage" title="Condition Syntax Usage"><i class="fas fa-link fa-xs"></i></a>
</h3><p>For the full reference of Override Rules condition syntax and usage see the NGINX App Protect WAF <a href="http://localhost:1313/nginx-app-protect-waf/v4/declarative-policy/policy//#policy/override-rules">Declarative Policy guide</a>.</p>
<h3 
id="first-match-principle">First Match Principle  <a class="headerlink float-right" href="#first-match-principle" title="First Match Principle"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The policy enforcement operates on the <strong>first match</strong> principle. This principle is applied when multiple conditions match or are similar, indicating that any incoming requests that match the first condition will be processed. In the following example, the &ldquo;override_rules_example2&rdquo; policy uses two override rules: &ldquo;this_rule_will_match&rdquo; and &ldquo;non_matching_rule&rdquo;. Since both conditions match, the first match principle will be applied, and requests with &ldquo;api&rdquo; in the URI will be processed. It will reference an external policy file named &ldquo;NginxStrictPolicy.json&rdquo; to override the current policy. .</p>
<p>For example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65b81628&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65b81628">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;override_rules_example2&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;override-rules&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;this_rule_will_match&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;uri.contains(&#39;api&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;</span><span class="nv">$ref</span><span class="s2">&#34;</span>: <span class="s2">&#34;file:///NginxStrictPolicy.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;non_matching_rule&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;uri.contains(&#39;api&#39;) and not clientIp == &#39;192.168.0.10&#39;&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;extend-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;override_rules_example2&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;template&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;override-rules&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;this_rule_will_match&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;uri.contains(&#39;api&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;</span><span class="nv">$ref</span><span class="s2">&#34;</span>: <span class="s2">&#34;file:///NginxStrictPolicy.json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;non_matching_rule&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;uri.contains(&#39;api&#39;) and not clientIp == &#39;192.168.0.10&#39;&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;extend-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
</div>
<h3 
id="important-things-to-remember-about-override-rules">Important Things to Remember About Override Rules  <a class="headerlink float-right" href="#important-things-to-remember-about-override-rules" title="Important Things to Remember About Override Rules"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Here are some key points to remember regarding the Override Rules feature:</p>
<ul>
<li>To ensure efficient compilation time and optimal resource allocation for policies, there are limitations in place. Currently, policies have a maximum limit of 10 rules and a maximum of 5 clauses in a condition. These limitations help maintain better performance and manageability. A compilation error will not occur if a policy file contains more than 5 clauses or 10 overrides.</li>
<li>The replacement policy should not include any override rules. Override rules should be used to extend or switch to a different policy, rather than being part of the replacement policy itself.</li>
<li>Each override rule will be compiled as a separate policy, whether extending the main policy or switching to a new one. The enforcer will switch to the policy that corresponds to the matched rule, but the main policy name will be reported along with the override rule property.</li>
<li>The URI, host, and user-agent strings in the request will be treated as plain ASCII characters and won&rsquo;t undergo language decoding. If any of these strings contain non-ASCII characters, they may be misinterpreted and may not comply with rules that expect specific values in the conditions.</li>
</ul>

<h3 
id="override-rules-logging--reporting">Override Rules Logging &amp; Reporting  <a class="headerlink float-right" href="#override-rules-logging--reporting" title="Override Rules Logging &amp; Reporting"><i class="fas fa-link fa-xs"></i></a>
</h3><p>If a request matches an override rule, the <code>json_log</code> field will include a new block named &lsquo;overrideRule&rsquo;. However, if no rules match the request, the log will not contain any related information. When the &lsquo;actionType&rsquo; flag is set to &ldquo;replace-policy&rdquo;, the &lsquo;originalPolicyName&rsquo; field in the log will reflect the name of the original policy name (the one that contains override rules), and the <code>policy_name</code> field will reflect the policy that was enforced.</p>
<p>For example, if the matching override rule is called &ldquo;login_page&rdquo;:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65bd55e8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65bd55e8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="nv">policy_name</span><span class="o">=</span><span class="s2">&#34;login_page_block_redirect&#34;</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">json_log will have:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;overrideRule&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;login_page&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;originalPolicyName&#34;</span>: <span class="s2">&#34;override_rule_example&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">    ...</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="nv">policy_name</span><span class="o">=</span><span class="s2">&#34;login_page_block_redirect&#34;</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">json_log will have:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;overrideRule&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;login_page&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;originalPolicyName&#34;</span>: <span class="s2">&#34;override_rule_example&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">    ...</span></span></code></pre></div>
</div><p>If the matching override rule is called &ldquo;usa-only&rdquo;:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65c0efc8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65c0efc8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;enforcementState&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;isBlocked&#34;</span>: true,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;isAlarmed&#34;</span>: true,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;rating&#34;</span>: 4,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;attackType&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;ATTACK_TYPE_FORCEFUL_BROWSING&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;violation&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_RULE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;policyEntity&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override-rule&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;usa-only&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;Trying to access special&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>,</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;enforcementState&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;isBlocked&#34;</span>: true,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;isAlarmed&#34;</span>: true,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;rating&#34;</span>: 4,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;attackType&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;ATTACK_TYPE_FORCEFUL_BROWSING&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;violation&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_RULE&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;policyEntity&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override-rule&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;usa-only&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;Trying to access special&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>,</span></span></code></pre></div>
</div>
<h3 
id="errors-and-warnings">Errors and Warnings  <a class="headerlink float-right" href="#errors-and-warnings" title="Errors and Warnings"><i class="fas fa-link fa-xs"></i></a>
</h3><h4 
id="missing-policy-name">Missing Policy Name  <a class="headerlink float-right" href="#missing-policy-name" title="Missing Policy Name"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Every policy must have a name if actionType is either &ldquo;extend-policy&rdquo; or &ldquo;replace-policy&rdquo;. If the policy &rsquo;name&rsquo; is not provided in the override section, an error message will be displayed indicating the missing policy &rsquo;name&rsquo; within that specific override rule. For instance, in the override rule below, the policy name is not specified.</p>
<p>Example of Missing policy &rsquo;name':</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65c5f8d8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65c5f8d8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;override-rules&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;example-rule&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;uri.contains(&#39;127&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;policy_name&#34;</span>,  &lt;--- the missing part
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;override-rules&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;example-rule&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;condition&#34;</span>: <span class="s2">&#34;uri.contains(&#39;127&#39;)&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;actionType&#34;</span>: <span class="s2">&#34;replace-policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;override&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;policy_name&#34;</span>,  &lt;--- the missing part
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;enforcementMode&#34;</span>: <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span></span></span></code></pre></div>
</div><p>Example of Missing policy &rsquo;name&rsquo; error:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65c75480&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f65c75480">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;error_message&#34;</span>: <span class="s2">&#34;Failed to import Policy &#39;policy1&#39; from &#39;/etc/app_protect/conf/test.json&#39;: Missing policy &#39;name&#39; in the override rule &#39;example-rule&#39;.&#34;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;error_message&#34;</span>: <span class="s2">&#34;Failed to import Policy &#39;policy1&#39; from &#39;/etc/app_protect/conf/test.json&#39;: Missing policy &#39;name&#39; in the override rule &#39;example-rule&#39;.&#34;</span></span></span></code></pre></div>
</div><h4 
id="cyclic-override-rule-error">Cyclic Override Rule Error  <a class="headerlink float-right" href="#cyclic-override-rule-error" title="Cyclic Override Rule Error"><i class="fas fa-link fa-xs"></i></a>
</h4><p>If an inline or externally referenced policy contains an override rule, a Cyclic Override Rule error will be issued.</p>
<p>Example of Cyclic Override Rule error:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65c89ca0&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f65c89ca0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;error_message&#34;</span>: <span class="s2">&#34;Failed to import an override policy: Cyclic override-rules detected.&#34;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;error_message&#34;</span>: <span class="s2">&#34;Failed to import an override policy: Cyclic override-rules detected.&#34;</span></span></span></code></pre></div>
</div>
<h2 
id="geolocation">Geolocation  <a class="headerlink float-right" href="#geolocation" title="Geolocation"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="overview-1">Overview  <a class="headerlink float-right" href="#overview-1" title="Overview"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Geolocation refers to the process of assessing or determining the geographic location of an object. This feature helps in identifying the geographic location of a client or web application user.</p>
<p>In NGINX App Protect WAF, the Enforcer will look up the client IP address in the Geolocation file included in the app protect package, and extract the corresponding <a href="https://www.iso.org/obp/ui/#search" target="_blank" rel="noopener">ISO 3166</a> two-letter code, representing the country. For instance, &ldquo;IL&rdquo; denotes Israel. This information is denoted as &ldquo;geolocation&rdquo; in the condition and is also included in the request reporting.</p>

<h3 
id="disallowing-application-use-in-certain-geolocations">Disallowing Application Use in Certain Geolocations  <a class="headerlink float-right" href="#disallowing-application-use-in-certain-geolocations" title="Disallowing Application Use in Certain Geolocations"><i class="fas fa-link fa-xs"></i></a>
</h3><p>For applications protected by app protect, you can use Geolocation enforcement to restrict or allow application use in specific countries. You can adjust the lists of which countries or locations are allowed or disallowed in a app protect security policy. If the user tries to access the web application from a location that is not allowed, the <code>VIOL_GEOLOCATION</code> violation will be triggered. By default, all locations are allowed, and the alarm and block flags are enabled.</p>
<p>Requests from certain locations, such as RFC-1918 addresses or unassigned global addresses, do not include a valid country code. The geolocation is shown as <strong>N/A</strong> in both the request and the list of geolocations. You have the option to disallow N/A requests whose country of origination is unknown.</p>
<p>For example, in the policy provided below, within the &ldquo;disallowed-geolocations&rdquo; section, &ldquo;countryCode&rdquo;: IL and &ldquo;countryName&rdquo;: Israel have been included.  This signifies that requests originating from these locations will raise an alarm, trigger the <code>VIOL_GEOLOCATION</code> violation and will be blocked.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65ce8840&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65ce8840">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;general&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;customXffHeaders&#34;</span>: <span class="o">[]</span>,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;trustXff&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl"><span class="s2">&#34;disallowed-geolocations&#34;</span> : <span class="o">[</span>
</span></span><span class="line"><span class="cl">         <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;countryCode&#34;</span> : <span class="s2">&#34;IL&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;countryName&#34;</span> : <span class="s2">&#34;Israel&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">]</span>,
</span></span><span class="line"><span class="cl"><span class="s2">&#34;blocking-settings&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;violations&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">       <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GEOLOCATION&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;block&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;general&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;customXffHeaders&#34;</span>: <span class="o">[]</span>,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;trustXff&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl"><span class="s2">&#34;disallowed-geolocations&#34;</span> : <span class="o">[</span>
</span></span><span class="line"><span class="cl">         <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;countryCode&#34;</span> : <span class="s2">&#34;IL&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;countryName&#34;</span> : <span class="s2">&#34;Israel&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">]</span>,
</span></span><span class="line"><span class="cl"><span class="s2">&#34;blocking-settings&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;violations&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">       <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_GEOLOCATION&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;block&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
</div>
<h3 
id="geolocation-in-policy-override-rules-conditions">Geolocation in Policy Override Rules Conditions  <a class="headerlink float-right" href="#geolocation-in-policy-override-rules-conditions" title="Geolocation in Policy Override Rules Conditions"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The below example represents a security policy for a web application. The policy named as &ldquo;override_rule_example&rdquo; is based on a template called &ldquo;POLICY_TEMPLATE_NGINX_BASE.&rdquo; The policy is set to operate in &ldquo;blocking&rdquo; mode, which means it will prevent certain activities.</p>
<p>There&rsquo;s a specific configuration under &ldquo;general&rdquo; that deals with custom headers for cross-origin requests, specifically the &ldquo;xff&rdquo; header. The policy is configured to trust this header.</p>
<p>In the &ldquo;override-rules&rdquo; section there is one override rule named &ldquo;myFirstRule.&rdquo; This rule is set up to trigger when the geolocation of a request is identified as &lsquo;IL&rsquo; (Israel). When this condition is met, the action taken is to extend the policy, but with a change in enforcement mode to &ldquo;transparent.&rdquo;</p>
<p>In simpler terms, when someone tries to access the web application from Israel (&lsquo;IL&rsquo;), the security policy will be adjusted to allow the access but in a more transparent manner, meaning it won&rsquo;t block the access but may monitor it differently.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65d31450&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65d31450">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;override_rule_example&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;general&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;customXffHeaders&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;xff&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;trustXff&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;override-rules&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;myFirstRule&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;condition&#34;</span><span class="p">:</span> <span class="s2">&#34;geolocation == &#39;IL&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;actionType&#34;</span><span class="p">:</span> <span class="s2">&#34;extend-policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;override&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;override_rule_example&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;general&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;customXffHeaders&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;xff&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;trustXff&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;override-rules&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;myFirstRule&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;condition&#34;</span><span class="p">:</span> <span class="s2">&#34;geolocation == &#39;IL&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;actionType&#34;</span><span class="p">:</span> <span class="s2">&#34;extend-policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;override&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;transparent&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h2 
id="json-web-token-protection">JSON Web Token Protection  <a class="headerlink float-right" href="#json-web-token-protection" title="JSON Web Token Protection"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="overview-2">Overview  <a class="headerlink float-right" href="#overview-2" title="Overview"><i class="fas fa-link fa-xs"></i></a>
</h3><p>JSON Web Token (JWT) is a compact and self-contained way to represent information between two parties in a JSON (JavaScript Object Notation) format and is commonly used for authentication and authorization. With NGINX App Protect now it is possible to control access to its application using JWT validation. NGINX App Protect WAF validates the authenticity and well-formedness of JWTs coming from a client, denying access to the service exclusively when the validation process fails. JWT is mainly used for API access.</p>
<p>When a user logs in to a web application, they might receive a JWT, which can then be included in subsequent requests to the server. The server can validate the JWT to ensure that the user is authenticated to access the requested resources.</p>
<p>Now NGINX App Protect WAF provides JSON Web Token (JWT) protection. NGINX App Protect WAF will be placed in the path leading to the application server and will handle the token for the application. This includes:</p>
<ol>
<li>Validating the token&rsquo;s existence and ensuring its correct structure for specific URLs.</li>
<li>Verifying the token&rsquo;s signature based on provisioned certificates.</li>
<li>Check the validity period of the token.</li>
<li>Extract the user identity from the token and use it for logging and session awareness.</li>
</ol>
<p>The JSON Web Token consists of three parts: the <strong>Header</strong>, <strong>Claims</strong> and <strong>Signature</strong>. The first two parts are in JSON and Base64 encoded when carried in a request. The three parts are separated by a dot &ldquo;.&rdquo; delimiter and put in the authorization header of type &ldquo;Bearer&rdquo;, but can also be carried in a query string parameter.</p>
<ul>
<li>
<p><strong>Header</strong>: It contains information about the type of token (usually &ldquo;JWT&rdquo;) and the cryptographic algorithm being used to secure the JSON Web Signature (JWS).</p>
</li>
<li>
<p><strong>Claims</strong>: This part contains claims, which refers to the statements or assertions about an entity (typically, the user) that the token is issued for. Claims are <strong>key/value</strong> pairs contained within the token&rsquo;s payload. The claims is the second part of a JWT and typically looks like this:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65d6e0f8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65d6e0f8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;sub&#34;</span><span class="p">:</span> <span class="s2">&#34;1234567890&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;John Doe&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;iat&#34;</span><span class="p">:</span> <span class="mi">1654591231</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;nbf&#34;</span><span class="p">:</span> <span class="mi">1654607591</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;exp&#34;</span><span class="p">:</span> <span class="mi">1654608348</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;sub&#34;</span><span class="p">:</span> <span class="s2">&#34;1234567890&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;John Doe&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;iat&#34;</span><span class="p">:</span> <span class="mi">1654591231</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;nbf&#34;</span><span class="p">:</span> <span class="mi">1654607591</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;exp&#34;</span><span class="p">:</span> <span class="mi">1654608348</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div></li>
</ul>
<p>In example above, the payload contains several claims:</p>
<ul>
<li>
<p>sub (Subject) - Represents the subject of the JWT, typically the user or entity for which the token was created.</p>
</li>
<li>
<p>name (Issuer) - Indicates the entity that issued the JWT. It is a string that identifies the issuer of the token.</p>
</li>
<li>
<p>iat (Issued At) - Indicates the time at which the token was issued. Like exp, it is represented as a timestamp.</p>
</li>
<li>
<p>nbf (Not Before) - Specifies the time before which the token should not be considered valid.</p>
</li>
<li>
<p>exp (Expiration Time) - Specifies the expiration time of the token. It is represented as a numeric timestamp (for example, 1654608348), and the token is considered invalid after this time.</p>
</li>
</ul>
<p>These claims provide information about the JWT and can be used by the recipient to verify the token&rsquo;s authenticity and determine its validity. Additionally, you can include custom claims in the payload to carry additional information specific to your application.</p>
<ul>
<li><strong>Signature</strong> - To create the signature part, the header and payload are encoded using a specified algorithm and a secret key. This signature can be used to verify the authenticity of the token and to ensure that it has not been tampered with during transmission. The signature is computed based on the algorithm and the keys used and also Base64-encoded.</li>
</ul>
<h4 
id="nginx-app-protect-waf-supports-the-following-types-of-jwt">NGINX App Protect WAF supports the following types of JWT:  <a class="headerlink float-right" href="#nginx-app-protect-waf-supports-the-following-types-of-jwt" title="NGINX App Protect WAF supports the following types of JWT:"><i class="fas fa-link fa-xs"></i></a>
</h4><p>JSON Web Signature (JWS) - JWT content is digitally signed. The following algorithm can be used for signing:</p>
<ul>
<li>RSA/SHA-256 (RS256 for short)</li>
</ul>
<p>Here is an example of a Header: describes a JWT signed with HMAC 256 encryption algorithm:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65d85410&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65d85410">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;RS256&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;typ&#34;</span><span class="p">:</span> <span class="s2">&#34;JWT&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;RS256&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;typ&#34;</span><span class="p">:</span> <span class="s2">&#34;JWT&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="configuring-nginx-app-protect-waf-to-authenticate-json-web-token">Configuring NGINX App Protect WAF to Authenticate JSON Web Token  <a class="headerlink float-right" href="#configuring-nginx-app-protect-waf-to-authenticate-json-web-token" title="Configuring NGINX App Protect WAF to Authenticate JSON Web Token"><i class="fas fa-link fa-xs"></i></a>
</h3><h4 
id="access-profile">Access Profile  <a class="headerlink float-right" href="#access-profile" title="Access Profile"><i class="fas fa-link fa-xs"></i></a>
</h4><p>NGINX App Protect WAF introduces a new policy entity known as &ldquo;<strong>access profile</strong>&rdquo; to authenticate JSON Web Token. Access Profile is added to the app protect policy to enforce JWT settings. JSON Web Token needs to be applied to the URLs for enforcement and includes the actions to be taken with respect to access tokens. It is specifically associated with HTTP URLs and does not have any predefined default profiles.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> At present, only one access profile is supported within the App Protect policy. However, the JSON schema for the policy will be designed to accommodate multiple profiles in the future.</div>
</blockquote>

<p>The access profile includes:</p>
<ul>
<li><strong>Enforcement Settings</strong>: here you can configure the &ldquo;enforceMaximumLength,&rdquo; &ldquo;enforceValidityPeriod,&rdquo; and &ldquo;keyFiles&rdquo; settings within the scope of this profile, allowing you to enable or disable them as needed.</li>
<li><strong>Location</strong>: here you can modify the location settings, choosing between &ldquo;header&rdquo; or &ldquo;query,&rdquo; as well as specifying the &ldquo;name&rdquo; for the header or parameter.</li>
<li><strong>Access Profile Settings</strong>: here you can set the &ldquo;maximumLength&rdquo; as well as specify the &ldquo;name&rdquo; and &ldquo;type&rdquo; for the access profile, with &ldquo;jwt&rdquo; representing JSON Web Token.</li>
</ul>
<p>Access Profile example:</p>
<p>Refer to the following example where all access profile properties are configured to enforce specific settings within the App Protect policy. In this instance, we have established an access profile named &ldquo;<strong>access_profile_jwt</strong>&rdquo; located in the <strong>authorization header</strong>. The &ldquo;maximumLength&rdquo; for the token is defined as <strong>2000</strong>, and &ldquo;verifyDigitalSignature&rdquo; is set to <strong>true</strong>.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f605633e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f605633e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;jwt_policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;template&#34;</span>: <span class="o">{</span> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;access-profiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">         <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;enforceMaximumLength&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;enforceValidityPeriod&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;keyFiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">               <span class="o">{</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;contents&#34;</span>: <span class="s2">&#34;{\r\n  \&#34;keys\&#34;: [\r\n    {\r\n      \&#34;alg\&#34;: \&#34;RS256\&#34;,\r\n      \&#34;e\&#34;: \&#34;AQAB\&#34;,\r\n      \&#34;kid\&#34;: \&#34;1234\&#34;,\r\n      \&#34;kty\&#34;: \&#34;RSA\&#34;,\r\n      \&#34;n\&#34;: \&#34;tSbi8WYTScbuM4fe5qe4l60A2SG5oo3u5JDBtH_dPJTeQICRkrgLD6oyyHJc9BCe9abX4FEq_Qd1SYHBdl838g48FWblISBpn9--B4D9O5TPh90zAYP65VnViKun__XHGrfGT65S9HFykvo2KxhtxOFAFw0rE6s5nnKPwhYbV7omVS71KeT3B_u7wHsfyBXujr_cxzFYmyg165Yx9Z5vI1D-pg4EJLXIo5qZDxr82jlIB6EdLCL2s5vtmDhHzwQSdSOMWEp706UgjPl_NFMideiPXsEzdcx2y1cS97gyElhmWcODl4q3RgcGTlWIPFhrnobhoRtiCZzvlphu8Nqn6Q\&#34;,\r\n      \&#34;use\&#34;: \&#34;sig\&#34;,\r\n      \&#34;x5c\&#34;: [\r\n        \&#34;MIID1zCCAr+gAwIBAgIJAJ/bOlwBpErqMA0GCSqGSIb3DQEBCwUAMIGAMQswCQYDVQQGEwJpbDEPMA0GA1UECAwGaXNyYWVsMRAwDgYDVQQHDAd0ZWxhdml2MRMwEQYDVQQKDApmNW5ldHdvcmtzMQwwCgYDVQQLDANkZXYxDDAKBgNVBAMMA21heDEdMBsGCSqGSIb3DQEJARYOaG93ZHlAbWF0ZS5jb20wIBcNMjIxMTA3MTM0ODQzWhgPMjA1MDAzMjUxMzQ4NDNaMIGAMQswCQYDVQQGEwJpbDEPMA0GA1UECAwGaXNyYWVsMRAwDgYDVQQHDAd0ZWxhdml2MRMwEQYDVQQKDApmNW5ldHdvcmtzMQwwCgYDVQQLDANkZXYxDDAKBgNVBAMMA21heDEdMBsGCSqGSIb3DQEJARYOaG93ZHlAbWF0ZS5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC1JuLxZhNJxu4zh97mp7iXrQDZIbmije7kkMG0f908lN5AgJGSuAsPqjLIclz0EJ71ptfgUSr9B3VJgcF2XzfyDjwVZuUhIGmf374HgP07lM+H3TMBg/rlWdWIq6f/9ccat8ZPrlL0cXKS+jYrGG3E4UAXDSsTqzmeco/CFhtXuiZVLvUp5PcH+7vAex/IFe6Ov9zHMVibKDXrljH1nm8jUP6mDgQktcijmpkPGvzaOUgHoR0sIvazm+2YOEfPBBJ1I4xYSnvTpSCM+X80UyJ16I9ewTN1zHbLVxL3uDISWGZZw4OXirdGBwZOVYg8WGuehuGhG2IJnO+WmG7w2qfpAgMBAAGjUDBOMB0GA1UdDgQWBBSHykVOY3Q1bWmwFmJbzBkQdyGtkTAfBgNVHSMEGDAWgBSHykVOY3Q1bWmwFmJbzBkQdyGtkTAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQCgcgp72Xw6qzbGLHyNMaCm9A6smtquKTdFCXLWVSOBix6WAJGPv1iKOvvMNF8ZV2RU44vS4Qa+o1ViBN8DXuddmRbShtvxcJzRKy1I73szZBMlZL6euRB1KN4m8tBtDj+rfKtPpheMtwIPbiukRjJrzRzSz3LXAAlxEIEgYSifKpL/okYZYRY6JF5PwSR0cvrfe/qa/G2iYF6Ps7knxy424RK6gpMbnhxb2gdhLPqDE50uxkr6dVHXbc85AuwAi983tOMhTyzDh3XTBEt2hr26F7jSeniC7TTIxmMgDdtYzRMwdb1XbubdtzUPnB/SW7jemK9I45kpKlUBDZD/QwER\&#34;\r\n      ]\r\n    }\r\n  ]\r\n}&#34;</span>,  <span class="c1"># there can be more only one JWKs file (contents) in the policy JSON schema, however, the total amount of JWK in the JWKs is limited to 10.</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;fileName&#34;</span>: <span class="s2">&#34;JWKSFile.json&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;location&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;in&#34;</span>: <span class="s2">&#34;header&#34;</span>,  <span class="c1"># the other option is: &#34;query&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;authorization&#34;</span>  <span class="c1"># the name of the header or parameter (according to &#34;part&#34;)</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;maximumLength&#34;</span>: 2000,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;access_profile_jwt&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;jwt&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;usernameExtraction&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;claimPropertyName&#34;</span>: <span class="s2">&#34;sub&#34;</span>,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;enabled&#34;</span>: true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;isMandatory&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;verifyDigitalSignature&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">]</span>,
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;urls&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">         <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/jwt&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;accessProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;access_profile_jwt&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;attackSignaturesCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;isAllowed&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;mandatoryBody&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;methodsOverrideOnUrlCheck&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/jwt&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;performStaging&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;jwt_policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;template&#34;</span>: <span class="o">{</span> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;access-profiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">         <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;enforceMaximumLength&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;enforceValidityPeriod&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;keyFiles&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">               <span class="o">{</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;contents&#34;</span>: <span class="s2">&#34;{\r\n  \&#34;keys\&#34;: [\r\n    {\r\n      \&#34;alg\&#34;: \&#34;RS256\&#34;,\r\n      \&#34;e\&#34;: \&#34;AQAB\&#34;,\r\n      \&#34;kid\&#34;: \&#34;1234\&#34;,\r\n      \&#34;kty\&#34;: \&#34;RSA\&#34;,\r\n      \&#34;n\&#34;: \&#34;tSbi8WYTScbuM4fe5qe4l60A2SG5oo3u5JDBtH_dPJTeQICRkrgLD6oyyHJc9BCe9abX4FEq_Qd1SYHBdl838g48FWblISBpn9--B4D9O5TPh90zAYP65VnViKun__XHGrfGT65S9HFykvo2KxhtxOFAFw0rE6s5nnKPwhYbV7omVS71KeT3B_u7wHsfyBXujr_cxzFYmyg165Yx9Z5vI1D-pg4EJLXIo5qZDxr82jlIB6EdLCL2s5vtmDhHzwQSdSOMWEp706UgjPl_NFMideiPXsEzdcx2y1cS97gyElhmWcODl4q3RgcGTlWIPFhrnobhoRtiCZzvlphu8Nqn6Q\&#34;,\r\n      \&#34;use\&#34;: \&#34;sig\&#34;,\r\n      \&#34;x5c\&#34;: [\r\n        \&#34;MIID1zCCAr+gAwIBAgIJAJ/bOlwBpErqMA0GCSqGSIb3DQEBCwUAMIGAMQswCQYDVQQGEwJpbDEPMA0GA1UECAwGaXNyYWVsMRAwDgYDVQQHDAd0ZWxhdml2MRMwEQYDVQQKDApmNW5ldHdvcmtzMQwwCgYDVQQLDANkZXYxDDAKBgNVBAMMA21heDEdMBsGCSqGSIb3DQEJARYOaG93ZHlAbWF0ZS5jb20wIBcNMjIxMTA3MTM0ODQzWhgPMjA1MDAzMjUxMzQ4NDNaMIGAMQswCQYDVQQGEwJpbDEPMA0GA1UECAwGaXNyYWVsMRAwDgYDVQQHDAd0ZWxhdml2MRMwEQYDVQQKDApmNW5ldHdvcmtzMQwwCgYDVQQLDANkZXYxDDAKBgNVBAMMA21heDEdMBsGCSqGSIb3DQEJARYOaG93ZHlAbWF0ZS5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC1JuLxZhNJxu4zh97mp7iXrQDZIbmije7kkMG0f908lN5AgJGSuAsPqjLIclz0EJ71ptfgUSr9B3VJgcF2XzfyDjwVZuUhIGmf374HgP07lM+H3TMBg/rlWdWIq6f/9ccat8ZPrlL0cXKS+jYrGG3E4UAXDSsTqzmeco/CFhtXuiZVLvUp5PcH+7vAex/IFe6Ov9zHMVibKDXrljH1nm8jUP6mDgQktcijmpkPGvzaOUgHoR0sIvazm+2YOEfPBBJ1I4xYSnvTpSCM+X80UyJ16I9ewTN1zHbLVxL3uDISWGZZw4OXirdGBwZOVYg8WGuehuGhG2IJnO+WmG7w2qfpAgMBAAGjUDBOMB0GA1UdDgQWBBSHykVOY3Q1bWmwFmJbzBkQdyGtkTAfBgNVHSMEGDAWgBSHykVOY3Q1bWmwFmJbzBkQdyGtkTAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQCgcgp72Xw6qzbGLHyNMaCm9A6smtquKTdFCXLWVSOBix6WAJGPv1iKOvvMNF8ZV2RU44vS4Qa+o1ViBN8DXuddmRbShtvxcJzRKy1I73szZBMlZL6euRB1KN4m8tBtDj+rfKtPpheMtwIPbiukRjJrzRzSz3LXAAlxEIEgYSifKpL/okYZYRY6JF5PwSR0cvrfe/qa/G2iYF6Ps7knxy424RK6gpMbnhxb2gdhLPqDE50uxkr6dVHXbc85AuwAi983tOMhTyzDh3XTBEt2hr26F7jSeniC7TTIxmMgDdtYzRMwdb1XbubdtzUPnB/SW7jemK9I45kpKlUBDZD/QwER\&#34;\r\n      ]\r\n    }\r\n  ]\r\n}&#34;</span>,  <span class="c1"># there can be more only one JWKs file (contents) in the policy JSON schema, however, the total amount of JWK in the JWKs is limited to 10.</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;fileName&#34;</span>: <span class="s2">&#34;JWKSFile.json&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;location&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;in&#34;</span>: <span class="s2">&#34;header&#34;</span>,  <span class="c1"># the other option is: &#34;query&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;authorization&#34;</span>  <span class="c1"># the name of the header or parameter (according to &#34;part&#34;)</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;maximumLength&#34;</span>: 2000,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;access_profile_jwt&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;jwt&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;usernameExtraction&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;claimPropertyName&#34;</span>: <span class="s2">&#34;sub&#34;</span>,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;enabled&#34;</span>: true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;isMandatory&#34;</span>: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;verifyDigitalSignature&#34;</span>: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">]</span>,
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;urls&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">         <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/jwt&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;accessProfile&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;access_profile_jwt&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;attackSignaturesCheck&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;isAllowed&#34;</span>: true,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;mandatoryBody&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span>: <span class="s2">&#34;*&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;methodsOverrideOnUrlCheck&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;/jwt&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;performStaging&#34;</span>: false,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;http&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span>: <span class="s2">&#34;explicit&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> For access profile default values and their related field names, see NGINX App Protect WAF <a href="http://localhost:1313/nginx-app-protect-waf/v4/declarative-policy/policy/" target="_blank" rel="noopener">Declarative Policy guide</a>.</div>
</blockquote>

<h4 
id="access-profile-in-url-settings">Access Profile in URL Settings  <a class="headerlink float-right" href="#access-profile-in-url-settings" title="Access Profile in URL Settings"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The next step to configure JWT is to define the URL settings. Add the access profile name that you defined previously under the access profiles in the &ldquo;name&rdquo; field. From the previous example, we associate the access profile &ldquo;<strong>access_profile_jwt</strong>&rdquo; with the &ldquo;name&rdquo;: <strong>/jwt</strong> in the URLs section to become effective, which means URLs with /jwt name are permitted for this feature and will be used for all JWT API requests.</p>
<p>Please note that the access profile cannot be deleted if it is in use in any URL.</p>
<h3 
id="authorization-rules-in-urls">Authorization Rules in URLs  <a class="headerlink float-right" href="#authorization-rules-in-urls" title="Authorization Rules in URLs"><i class="fas fa-link fa-xs"></i></a>
</h3><p>A new entity named as <code>authorizationRules</code> is introduced under the URL. This entity encompasses an authorization condition essential for &ldquo;Claims&rdquo; validation, enabling access to a specific URL based on claims of a JWT.
The <code>authorizationRules</code> entity consists of the following two mandatory fields:</p>
<ul>
<li><code>name</code>: a unique descriptive name for the condition predicate</li>
<li><code>condition</code>: a boolean expression that defines the conditions for granting access to the URL</li>
</ul>
<p>Here is an example of declarative policy using an <code>authorizationRules</code> entity under the access profile:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60664910&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f60664910">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/api/v3/shops/items/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accessProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my_jwt&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;authorizationRules&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;condition&#34;</span><span class="p">:</span> <span class="s2">&#34;claims[&#39;scope&#39;].contains(&#39;pet:read&#39;) and claims[&#39;scope&#39;].contains(&#39;pet:write&#39;)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;auth_scope&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;condition&#34;</span><span class="p">:</span> <span class="s2">&#34;claims[&#39;roles&#39;].contains(&#39;admin&#39;) or claims[&#39;roles&#39;].contains(&#39;inventory-manager&#39;)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;auth_roles&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;condition&#34;</span><span class="p">:</span> <span class="s2">&#34;claims[&#39;email&#39;].endsWith(&#39;petshop.com&#39;)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;auth_email&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;urls&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/api/v3/shops/items/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accessProfile&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my_jwt&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;authorizationRules&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;condition&#34;</span><span class="p">:</span> <span class="s2">&#34;claims[&#39;scope&#39;].contains(&#39;pet:read&#39;) and claims[&#39;scope&#39;].contains(&#39;pet:write&#39;)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;auth_scope&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;condition&#34;</span><span class="p">:</span> <span class="s2">&#34;claims[&#39;roles&#39;].contains(&#39;admin&#39;) or claims[&#39;roles&#39;].contains(&#39;inventory-manager&#39;)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;auth_roles&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;condition&#34;</span><span class="p">:</span> <span class="s2">&#34;claims[&#39;email&#39;].endsWith(&#39;petshop.com&#39;)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;auth_email&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="authorizationrules-condition-syntax-usage">AuthorizationRules Condition Syntax Usage  <a class="headerlink float-right" href="#authorizationrules-condition-syntax-usage" title="AuthorizationRules Condition Syntax Usage"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The <code>authorizationRules</code> use a Boolean expression to articulate the conditions for granting access to the URL. The conditions use the same syntax as in <a href="#override-rules">Policy Override Rules</a> with one additional attribute <strong>&ldquo;claims&rdquo;</strong>.</p>
<h4 
id="claims-attribute">Claims Attribute  <a class="headerlink float-right" href="#claims-attribute" title="Claims Attribute"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The newly introduced attribute &ldquo;claims&rdquo; is a mapping of JSON paths for claims from the JWT to their respective values. Only structure nesting is supported using the &ldquo;.&rdquo; notation.
A few points to remember regarding JWT claims:</p>
<ul>
<li>Please note that at the moment, accessing individual cells within JSON arrays isn&rsquo;t possible. Instead, the entire array gets serialized as a string, and its elements can be evaluated using string operators like &ldquo;contains&rdquo;.</li>
<li>While it&rsquo;s technically feasible to consolidate all conditions into one with &ldquo;and&rdquo; between them, it&rsquo;s not recommended. Dividing them into multiple conditions enhances the readability and clarity of the policy, particularly when explaining the reasons for authorization failure.
For the full reference of authorizationRules condition syntax and usage see the NGINX App Protect WAF <a href="http://localhost:1313/nginx-app-protect-waf/v4/declarative-policy/policy//#policy/override-rules">Declarative Policy guide</a>.
See below example for JWT claims:</li>
</ul>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f606a2d28&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f606a2d28">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;scope&#34;</span><span class="p">:</span> <span class="s2">&#34;top-level:read&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;roles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;inventory-manager&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;price-editor&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;sub&#34;</span><span class="p">:</span> <span class="s2">&#34;joe@doe.com&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;address&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;country&#34;</span><span class="p">:</span> <span class="s2">&#34;US&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;state&#34;</span><span class="p">:</span> <span class="s2">&#34;NY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;city&#34;</span><span class="p">:</span> <span class="s2">&#34;New York&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;street&#34;</span><span class="p">:</span> <span class="s2">&#34;888 38th W&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;scope&#34;</span><span class="p">:</span> <span class="s2">&#34;top-level:read&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;roles&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;inventory-manager&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;price-editor&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;sub&#34;</span><span class="p">:</span> <span class="s2">&#34;joe@doe.com&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;address&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;country&#34;</span><span class="p">:</span> <span class="s2">&#34;US&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;state&#34;</span><span class="p">:</span> <span class="s2">&#34;NY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;city&#34;</span><span class="p">:</span> <span class="s2">&#34;New York&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;street&#34;</span><span class="p">:</span> <span class="s2">&#34;888 38th W&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>then the claims can be:</p>



<div class="code-block" data-mf="true" style="display: none;"><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f606ca9e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f606ca9e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">claims[&#39;scope&#39;] = &#34;top-level:read&#34;
</span></span><span class="line"><span class="cl">claims[&#39;roles&#39;] = &#34;[&#34;inventory-manager&#34;, &#34;price-editor]&#34; # the whole array is presented as a string
</span></span><span class="line"><span class="cl">claims[&#39;address.country&#39;] = &#34;US&#34;
</span></span><span class="line"><span class="cl">claims[&#39;company&#39;] = null # does not exist
</span></span><span class="line"><span class="cl">claims[&#39;address&#39;] = &#34;{ \&#34;address\&#34;: { .... } }&#34; # JSON structs can be accessed using the dot &#34;.&#34; notation</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">claims[&#39;scope&#39;] = &#34;top-level:read&#34;
</span></span><span class="line"><span class="cl">claims[&#39;roles&#39;] = &#34;[&#34;inventory-manager&#34;, &#34;price-editor]&#34; # the whole array is presented as a string
</span></span><span class="line"><span class="cl">claims[&#39;address.country&#39;] = &#34;US&#34;
</span></span><span class="line"><span class="cl">claims[&#39;company&#39;] = null # does not exist
</span></span><span class="line"><span class="cl">claims[&#39;address&#39;] = &#34;{ \&#34;address\&#34;: { .... } }&#34; # JSON structs can be accessed using the dot &#34;.&#34; notation</span></span></code></pre></div>
</div><h3 
id="attack-signatures">Attack Signatures  <a class="headerlink float-right" href="#attack-signatures" title="Attack Signatures"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Attack signatures are detected within the JSON values of the token, i.e. the header and claims parts, but not on the digital signature part of the token. The detection of signatures, and specifically which signatures are recognized, depends on the configuration entity within the Policy. Typically, this configuration entity is the Authorization HTTP header or else, the header or parameter entity configured as the location of the token in the access profile.</p>
<p>If the request doesn&rsquo;t align with a URL associated with an Access Profile, an attempt is made to parse the &ldquo;bearer&rdquo; type Authorization header, but no violations are raised, except for Base64. More information can be found below:</p>
<ol>
<li>
<p>Token parsed successfully - No violations are detected when enforced on URL with or without access profile.</p>
</li>
<li>
<p>There are more or less than two dots in the token - <code>VIOL_ACCESS_MALFORMED</code> is detected when enforced on URL with access profile.</p>
</li>
<li>
<p>Base64 decoding failure - <code>VIOL_ACCESS_MALFORMED</code> is detected when enforced on URL with access profile. <code>VIOL_PARAMETER_BASE64</code> is detected when enforced with access profile.</p>
</li>
<li>
<p>JSON parsing failure - <code>VIOL_ACCESS_MALFORMED</code> is detected when enforced on URL with access profile.</p>
</li>
</ol>

<h3 
id="json-web-token-violations">JSON Web Token Violations  <a class="headerlink float-right" href="#json-web-token-violations" title="JSON Web Token Violations"><i class="fas fa-link fa-xs"></i></a>
</h3><p>NGINX App Protect WAF introduces three new violations specific to JWT: <code>VIOL_ACCESS_INVALID</code>, <code>VIOL_ACCESS_MISSING</code> and <code>VIOL_ACCESS_MALFORMED</code>.</p>
<p>Under the &ldquo;blocking-settings,&rdquo; user can either enable or disable these violations. Note that these violations will be enabled by default. The details regarding logs will be recorded in the security log.</p>
<p>See the below example for these violations.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65e0ef30&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65e0ef30">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;jwt_policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;template&#34;</span>: <span class="o">{</span> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;blocking-settings&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">           <span class="s2">&#34;violations&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;block&#34;</span>: false,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_ACCESS_INVALID&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;block&#34;</span>: false,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_ACCESS_MISSING&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;block&#34;</span>: false,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_ACCESS_MALFORMED&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;policy&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;jwt_policy&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;template&#34;</span>: <span class="o">{</span> <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span> <span class="o">}</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;blocking-settings&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">           <span class="s2">&#34;violations&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;block&#34;</span>: false,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_ACCESS_INVALID&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;block&#34;</span>: false,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_ACCESS_MISSING&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;alarm&#34;</span>: true,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;block&#34;</span>: false,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;VIOL_ACCESS_MALFORMED&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
</div>
<h3 
id="violation-rating-calculation">Violation Rating Calculation  <a class="headerlink float-right" href="#violation-rating-calculation" title="Violation Rating Calculation"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The default violation rating is set to the level of <strong>5</strong> regardless of any violation. Any changes to these violation settings here will override the default settings. The details regarding logs will be recorded in the security log. All violations will be disabled on upgrade.</p>
<p>See also the <a href="#violations">Violations</a> section for more details.</p>

<h3 
id="other-references">Other References  <a class="headerlink float-right" href="#other-references" title="Other References"><i class="fas fa-link fa-xs"></i></a>
</h3><p>For more information about JSON Web Token (JWT) see below reference links:</p>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc7519" target="_blank" rel="noopener">The definition of the JSON Web Token (JWT)</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc7515" target="_blank" rel="noopener">Specification of how tokens are digitally signed</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc7515" target="_blank" rel="noopener">The format of the JSON Web Key (JWK) that needs to be included in the profile for extracting the public keys used to verify the signatures</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc7520" target="_blank" rel="noopener">Examples of Protecting Content Using JSON Object Signing and Encryption (JOSE)</a></li>
</ul>

<h2 
id="brute-force-attack-preventions">Brute Force Attack Preventions  <a class="headerlink float-right" href="#brute-force-attack-preventions" title="Brute Force Attack Preventions"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="overview-3">Overview  <a class="headerlink float-right" href="#overview-3" title="Overview"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Brute force attacks are attempts to break in to secured areas of a web application by trying exhaustive,
systematic, username/password combinations to discover legitimate authentication credentials.
To prevent brute force attacks, NGINX App Protect WAF monitors IP addresses, usernames, and the number of failed login attempts beyond a maximum threshold.
When brute force patterns are detected, the NGINX App Protect WAF policy either trigger an alarm or block the attack if the failed
login attempts reached a maximum threshold for a specific username or coming from a specific IP address.
To enable brute force protection, at least one login page must be created.
The login page entity is created separately and is not included in the brute force configuration block.</p>
<hr>
<h3 
id="login-page-policy-example">Login page policy example  <a class="headerlink float-right" href="#login-page-policy-example" title="Login page policy example"><i class="fas fa-link fa-xs"></i></a>
</h3><p>A login page specifies the login URL that users must pass through to get authenticated. The configuration of a login URL includes the URL itself, the username and passwords parameters and the validation criteria (how we know that a login was successful or failed)</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60705360&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f60705360">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">	    <span class="s2">&#34;login-pages&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;accessValidation&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;responseContains&#34;</span><span class="p">:</span> <span class="s2">&#34;Success&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;authenticationType&#34;</span><span class="p">:</span> <span class="s2">&#34;form&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;url&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;method&#34;</span> <span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;/html_login&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;protocol&#34;</span> <span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;explicit&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;usernameParameterName&#34;</span><span class="p">:</span> <span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;passwordParameterName&#34;</span><span class="p">:</span> <span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">	    <span class="s2">&#34;login-pages&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;accessValidation&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;responseContains&#34;</span><span class="p">:</span> <span class="s2">&#34;Success&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;authenticationType&#34;</span><span class="p">:</span> <span class="s2">&#34;form&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;url&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;method&#34;</span> <span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;/html_login&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;protocol&#34;</span> <span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;explicit&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;usernameParameterName&#34;</span><span class="p">:</span> <span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;passwordParameterName&#34;</span><span class="p">:</span> <span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> For further configuration details, see NGINX App Protect WAF Declarative Policy Guide <a href="http://localhost:1313/nginx-app-protect-waf/v4/declarative-policy/policy/#policy/login-pages" target="_blank" rel="noopener">Declarative Policy guide</a>.</div>
</blockquote>

<hr>
<h3 
id="brute-force-policy-example">Brute force policy example  <a class="headerlink float-right" href="#brute-force-policy-example" title="Brute force policy example"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Example1: A single brute force configuration is applied universally to all login pages.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f607b6f20&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f607b6f20">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;BruteForcePolicy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;brute-force-attack-preventions&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;bruteForceProtectionForAllLoginPages&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;loginAttemptsFromTheSameIp&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span> <span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;enabled&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;threshold&#34;</span> <span class="p">:</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;loginAttemptsFromTheSameUser&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span> <span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;enabled&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;threshold&#34;</span> <span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;reEnableLoginAfter&#34;</span> <span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;sourceBasedProtectionDetectionPeriod&#34;</span> <span class="p">:</span> <span class="mi">3600</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;BruteForcePolicy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;brute-force-attack-preventions&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;bruteForceProtectionForAllLoginPages&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;loginAttemptsFromTheSameIp&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span> <span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;enabled&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;threshold&#34;</span> <span class="p">:</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;loginAttemptsFromTheSameUser&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span> <span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;enabled&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;threshold&#34;</span> <span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;reEnableLoginAfter&#34;</span> <span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;sourceBasedProtectionDetectionPeriod&#34;</span> <span class="p">:</span> <span class="mi">3600</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Example2: Different brute force configurations can be defined for individual login pages,
with each configuration referencing a specific login page.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60921018&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f60921018">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;BruteForcePolicySpec&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;brute-force-attack-preventions&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;bruteForceProtectionForAllLoginPages&#34;</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;loginAttemptsFromTheSameIp&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span> <span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;enabled&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;threshold&#34;</span> <span class="p">:</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;loginAttemptsFromTheSameUser&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span> <span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;enabled&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;threshold&#34;</span> <span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;reEnableLoginAfter&#34;</span> <span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;sourceBasedProtectionDetectionPeriod&#34;</span> <span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/html_login&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span>
</span></span><span class="line"><span class="cl">		       <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;BruteForcePolicySpec&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span><span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span><span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;brute-force-attack-preventions&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;bruteForceProtectionForAllLoginPages&#34;</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;loginAttemptsFromTheSameIp&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span> <span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;enabled&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;threshold&#34;</span> <span class="p">:</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;loginAttemptsFromTheSameUser&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span> <span class="p">:</span> <span class="s2">&#34;alarm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;enabled&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;threshold&#34;</span> <span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">               <span class="p">},</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;reEnableLoginAfter&#34;</span> <span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;sourceBasedProtectionDetectionPeriod&#34;</span> <span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;/html_login&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span>
</span></span><span class="line"><span class="cl">		       <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> For further configuration details, see NGINX App Protect WAF Declarative Policy Guide <a href="http://localhost:1313/nginx-app-protect-waf/v4/declarative-policy/policy/#policy/brute-force-attack-preventions" target="_blank" rel="noopener">Declarative Policy guide</a>.</div>
</blockquote>

<h2 
id="custom-dimensions-log-entries">Custom Dimensions Log Entries  <a class="headerlink float-right" href="#custom-dimensions-log-entries" title="Custom Dimensions Log Entries"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="overview-4">Overview  <a class="headerlink float-right" href="#overview-4" title="Overview"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Custom dimensions log entries feature refers to the new configuration in NGINX App Protect WAF, where the new directive called <code>app_protect_custom_log_attribute</code> is assigned to a particular location or server or http level in the <code>nginx.conf</code> file. The need is to be able to add custom identifiers to the respective location and/or server and identify requests in the Security Log by those identifiers.</p>
<p>The <code>app_protect_custom_log_attribute</code> directive will be used to track the assigned location/server/http dimension of each request by adding the <code>app_protect_custom_log_attribute</code> to the <strong>Security Logs</strong> a.k.a <strong>Request Logs</strong>. Since it is a custom attribute a customer can set, that custom attribute will appear for every request log entry that was handled by that location/server.</p>

<h3 
id="configuration-1">Configuration  <a class="headerlink float-right" href="#configuration-1" title="Configuration"><i class="fas fa-link fa-xs"></i></a>
</h3><p>A new directive <code>app_protect_custom_log_attribute</code> will be added to the <code>nginx.conf</code> file. You can set this directive at all scopes: http, server and location. The setting at the location scope overrides the setting in the server and/or http scopes and the server scope overrides the http scope. The <code>app_protect_custom_log_attribute</code> directive syntax will consist of a <strong>name/value</strong> or <strong>key/value</strong> pair i.e. &ldquo;app_protect_custom_log_attribute <name> <value>&rdquo;.</p>
<p>Example Configuration:</p>
<p>In the below example, we are configuring the <code>app_protect_custom_log_attribute</code> directive at the server and location level where we define the <strong>key/value</strong> pair as one string.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65eafd68&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65eafd68">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">65536</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_custom_log_attribute</span> <span class="s">environment&#39;</span> <span class="s">&#39;env1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_custom_log_attribute</span> <span class="s">gateway</span> <span class="s">gway1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_custom_log_attribute</span> <span class="s">component</span> <span class="s">comp1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://172.29.38.211:80</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">error_log</span> <span class="s">/var/log/nginx/error.log</span> <span class="s">debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">worker_connections</span>  <span class="mi">65536</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">app_protect_custom_log_attribute</span> <span class="s">environment&#39;</span> <span class="s">&#39;env1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_custom_log_attribute</span> <span class="s">gateway</span> <span class="s">gway1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_custom_log_attribute</span> <span class="s">component</span> <span class="s">comp1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://172.29.38.211:80</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div>
</div><p>The <strong>key/value</strong> pair will be &rsquo;environment env1&rsquo;, gateway gway1 and component comp1 in the above examples, i.e.</p>
<ul>
<li>app_protect_custom_log_attribute environment env1;</li>
<li>app_protect_custom_log_attribute gateway gway1;</li>
<li>app_protect_custom_log_attribute component comp1;</li>
</ul>
<p>The above key/value pair will be parsed as below:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65ed5310&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65ed5310">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;customLogAttributes&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;gateway&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;value&#34;</span>: <span class="s2">&#34;gway1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;component&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;value&#34;</span>: <span class="s2">&#34;comp1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl"><span class="o">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="s2">&#34;customLogAttributes&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;gateway&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;value&#34;</span>: <span class="s2">&#34;gway1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;component&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;value&#34;</span>: <span class="s2">&#34;comp1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl"><span class="o">]</span></span></span></code></pre></div>
</div>
<h3 
id="things-to-remember-while-configuring-the-custom-dimensions-log-entries">Things to Remember While Configuring the Custom Dimensions Log Entries  <a class="headerlink float-right" href="#things-to-remember-while-configuring-the-custom-dimensions-log-entries" title="Things to Remember While Configuring the Custom Dimensions Log Entries"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The <code>app_protect_custom_log_attribute</code> directive has a few limitations which should be kept in mind while configuring this directive:</p>
<ul>
<li>Key and value strings are limited to 64 chars</li>
<li>Maximum possible directive numbers are limited to 10 (in total) in each context i.e. Limit of 10 keys and values</li>
</ul>

<h3 
id="errors-and-warnings-1">Errors and Warnings  <a class="headerlink float-right" href="#errors-and-warnings-1" title="Errors and Warnings"><i class="fas fa-link fa-xs"></i></a>
</h3><p>An error message &ldquo;<code>app_protect_custom_log_attribute</code> directive is invalid&rdquo; will be displayed in the Security Log if the below conditions are met:</p>
<ol>
<li>If the <code>app_protect_custom_log_attribute</code> exceeds the maximum number of 10 directives</li>
<li>If the <code>app_protect_custom_log_attribute</code> exceeds the maximum name length of 64 chars</li>
<li>If the <code>app_protect_custom_log_attribute</code> exceeds the maximum value of 64 chars</li>
</ol>
<p>Error message example:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65f17d78&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f65f17d78">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">app_protect_custom_log_attribute directive is invalid. Number of app_protect_custom_log_attribute directives exceeds maximum</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">app_protect_custom_log_attribute directive is invalid. Number of app_protect_custom_log_attribute directives exceeds maximum</span></span></code></pre></div>
</div>
<h3 
id="logging-and-reporting">Logging and Reporting  <a class="headerlink float-right" href="#logging-and-reporting" title="Logging and Reporting"><i class="fas fa-link fa-xs"></i></a>
</h3><p>When <code>app_protect_custom_log_attribute</code> is assigned to a particular location/server/http context, it will appear in the <code>json_log</code> field as a new JSON property called &ldquo;customLogAttributes&rdquo; at the top level. The property will not appear if no <code>app_protect_custom_log_attribute</code> directive was assigned.</p>
<p>Attributes at the http level applies to all servers and locations unless a specific server or location overrides the same key with a different value. Same goes for the server level and all locations under it. In the below example, the &ldquo;environment&rdquo; attribute will appear in logs of all locations under that server.</p>
<p>Security logging example in json_log:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65f4ade0&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f65f4ade0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;&#34;</span><span class="err">customLogAttribute</span><span class="s2">&#34;&#34;</span><span class="err">:</span><span class="p">[{</span><span class="nt">&#34;&#34;</span><span class="err">name</span><span class="s2">&#34;&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="err">component</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;&#34;</span><span class="err">value</span><span class="s2">&#34;&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="err">comp</span><span class="mi">1</span><span class="s2">&#34;&#34;</span><span class="p">},{</span><span class="nt">&#34;&#34;</span><span class="err">name</span><span class="s2">&#34;&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="err">gateway</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;&#34;</span><span class="err">value</span><span class="s2">&#34;&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="err">gway</span><span class="mi">1</span><span class="s2">&#34;&#34;</span><span class="p">}]</span><span class="err">}&#34;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;&#34;</span><span class="err">customLogAttribute</span><span class="s2">&#34;&#34;</span><span class="err">:</span><span class="p">[{</span><span class="nt">&#34;&#34;</span><span class="err">name</span><span class="s2">&#34;&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="err">component</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;&#34;</span><span class="err">value</span><span class="s2">&#34;&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="err">comp</span><span class="mi">1</span><span class="s2">&#34;&#34;</span><span class="p">},{</span><span class="nt">&#34;&#34;</span><span class="err">name</span><span class="s2">&#34;&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="err">gateway</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;&#34;</span><span class="err">value</span><span class="s2">&#34;&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="err">gway</span><span class="mi">1</span><span class="s2">&#34;&#34;</span><span class="p">}]</span><span class="err">}&#34;</span></span></span></code></pre></div>
</div>
<h2 
id="time-based-signature-staging">Time-Based Signature Staging  <a class="headerlink float-right" href="#time-based-signature-staging" title="Time-Based Signature Staging"><i class="fas fa-link fa-xs"></i></a>
</h2><p>When new attack signatures are introduced in an App Protect policy, the policy is tested in a staging environment first before being promoted to production. However, in some instances where it is challenging to replicate real traffic accurately in the staging environment, the detection of genuine attacks becomes difficult. There can be false positives and expose the application to attacks. For such cases, we need to deploy the new signatures in staging environment in staging mode.</p>
<p>The <strong>Certification Time</strong> policy property determines the point in time for which signatures have been tested, approved and certified.</p>
<p>The purpose of this feature is to put signatures in staging by their age (modification time).</p>
<p>There are two types of signatures:</p>
<ol>
<li><strong>Staging Signatures</strong> - All the signatures in the policy that were created or modified <strong>after</strong> the certification time are in staging.</li>
<li><strong>Enforced Signatures</strong>  All the signatures in the policy that were created or modified <strong>prior</strong> to the certification date time or exactly at that time.</li>
</ol>

<h3 
id="latest-signature-certification-time">Latest Signature Certification Time  <a class="headerlink float-right" href="#latest-signature-certification-time" title="Latest Signature Certification Time"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The latest signatures certification time is the timestamp (in date-time ISO format) as the time the signatures in the policy are considered as trusted by the user and separates enforced signatures from signatures in staging.</p>
<p>When this value is not defined and the staging flag is enabled, it means that all the signatures in the policy are in staging. If the signature was added to the policy but was created and last modified before the certification date-time then it will not be in staging.</p>
<p>A signature is considered new if it was introduced by a recent signature update that was applied to the respective policy. Note that signatures that were added later to the policy (by adding a new signature set) are not considered new unless they were added in the recent signature update. These signatures will not be in staging.</p>

<h3 
id="new-policy">New Policy  <a class="headerlink float-right" href="#new-policy" title="New Policy"><i class="fas fa-link fa-xs"></i></a>
</h3><p>When a new policy is deployed, the user prefers to have all its signatures present in the staging environment. To facilitate this, the <code>performStaging</code> flag is configured to true at the signature settings level.</p>

<h3 
id="signature-update">Signature Update  <a class="headerlink float-right" href="#signature-update" title="Signature Update"><i class="fas fa-link fa-xs"></i></a>
</h3><p>After applying a signature update (F5 or user-defined), and assuming the update creation time is later than the previous signature update applied to the policy (in other words, the signatures are upgraded, not downgraded), then all the signatures that were affected by the update (created or modified) are automatically put in staging. That&rsquo;s because their modification time is newer than the current <code>stagingCertificationDatetime</code>. Signatures that were not affected by the update will <strong>not</strong> be in staging.</p>

<h3 
id="configuration-2">Configuration  <a class="headerlink float-right" href="#configuration-2" title="Configuration"><i class="fas fa-link fa-xs"></i></a>
</h3><h4 
id="staging-certification-date-time">Staging Certification Date-Time  <a class="headerlink float-right" href="#staging-certification-date-time" title="Staging Certification Date-Time"><i class="fas fa-link fa-xs"></i></a>
</h4><p>A new property known as <code>stagingCertificationDatetime</code> is added to <code>signature-settings</code> section. All signatures that were created or modified in a signature update that is later than that time are in staging while all the rest are enforced and not in staging.</p>
<p>The <code>stagingCertificationDatetime</code> property will contain <code>ISO 8601</code> date-time format. It has effect only if <code>performStaging</code> is set to true. It is <strong>optional</strong> and its absence means that all signatures are placed in the staging environment, assuming the <code>performStaging</code> setting is set to true.</p>
<p>See below policy for more details.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f65fce758&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f65fce758">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;policy&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span> <span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span> <span class="p">:</span> <span class="s2">&#34;Nginx Policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span> <span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;fullPath&#34;</span> <span class="p">:</span> <span class="s2">&#34;/Common/my_test_nginx_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;my_test_nginx_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;performStaging&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-settings&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;stagingCertificationDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2023-06-13T14:53:24Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;signatureStaging&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;security&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;policy&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;applicationLanguage&#34;</span> <span class="p">:</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span> <span class="p">:</span> <span class="s2">&#34;Nginx Policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;enforcementMode&#34;</span> <span class="p">:</span> <span class="s2">&#34;blocking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;fullPath&#34;</span> <span class="p">:</span> <span class="s2">&#34;/Common/my_test_nginx_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;my_test_nginx_policy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;performStaging&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;signature-settings&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;stagingCertificationDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2023-06-13T14:53:24Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;signatureStaging&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;template&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;POLICY_TEMPLATE_NGINX_BASE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;security&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="enforcing-the-modified-signatures-after-testing-them">Enforcing the Modified Signatures After Testing Them  <a class="headerlink float-right" href="#enforcing-the-modified-signatures-after-testing-them" title="Enforcing the Modified Signatures After Testing Them"><i class="fas fa-link fa-xs"></i></a>
</h3><p>All signatures are considered to be in staging if their creation or modification time is later than the <code>stagingCertificationDatetime</code>.</p>
<p>A signature in staging will be reported in the security log but will not cause the request to be blocked and will not raise the Violation Rating (threat score). The potential Violation Rating in case all the detected signatures were not in staging will also be reported.</p>
<p>After you review the logs and can be assured that the new and modified signatures that were in staging are behaving correctly and do not cause false positives, you should enforce them. To do so, change the <code>stagingCertificationDatetime</code> to the time stamp of the latest signature update. This moves all the signatures out of staging. When installing a new signature update in the future, all the new and modified signatures in that update will be automatically placed in staging.</p>
<p>Note that we do not recommend setting the <code>stagingCertificationDatetime</code> to the current time, the time you finished reviewing the signatures. That&rsquo;s because the future signature update might have been created before that time, and when you install that update, modified signatures in it will not be in staging because they will be older than the <code>stagingCertificationDatetime</code>.</p>

<h3 
id="logging-and-reporting-1">Logging and Reporting  <a class="headerlink float-right" href="#logging-and-reporting-1" title="Logging and Reporting"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Time-based Signature will be logged and reported in the Security log without blocking the request as discussed in the above section.</p>
<p>Security log will have the following new fields under the enforcementState:</p>
<ul>
<li>The Violation Rating if there was no staging - <code>ratingIncludingViolationsInStaging</code></li>
<li>The <code>stagingCertificationDatetime</code> from the policy</li>
<li>The specific staging state of the signature</li>
<li>The <code>lastUpdateTime</code> of the signature - for the user to be able to determine why the signature was (or was not) in staging.</li>
</ul>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f6607b110&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f6607b110">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">json_log=</span><span class="s2">&#34;{&#34;&#34;id&#34;&#34;:&#34;&#34;7103271131347005954&#34;&#34;,&#34;&#34;violations&#34;&#34;:[{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:true,&#34;&#34;isAlarmed&#34;&#34;:true,&#34;&#34;isInStaging&#34;&#34;:false,&#34;&#34;isLearned&#34;&#34;:false,&#34;&#34;isLikelyFalsePositive&#34;&#34;:false},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_ATTACK_SIGNATURE&#34;&#34;},&#34;&#34;signature&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;XSS script tag (Parameter)&#34;&#34;,&#34;&#34;signatureId&#34;&#34;:200000098,&#34;&#34;accuracy&#34;&#34;:&#34;&#34;high&#34;&#34;,&#34;&#34;risk&#34;&#34;:&#34;&#34;high&#34;&#34;,&#34;&#34;hasCve&#34;&#34;:false,&#34;&#34;stagingCertificationDatetime&#34;&#34;:&#34;&#34;2024-01-01T00:00:00Z&#34;&#34;,&#34;&#34;lastUpdateTime&#34;&#34;:&#34;&#34;2023-11-02T19:36:54Z&#34;&#34;},&#34;&#34;snippet&#34;&#34;:{&#34;&#34;buffer&#34;&#34;:&#34;&#34;cGFyYW09PHNjcmlwdA==&#34;&#34;,&#34;&#34;offset&#34;&#34;:6,&#34;&#34;length&#34;&#34;:7},&#34;&#34;policyEntity&#34;&#34;:{&#34;&#34;parameters&#34;&#34;:[{&#34;&#34;name&#34;&#34;:&#34;&#34;*&#34;&#34;,&#34;&#34;level&#34;&#34;:&#34;&#34;global&#34;&#34;,&#34;&#34;type&#34;&#34;:&#34;&#34;wildcard&#34;&#34;}]},&#34;&#34;observedEntity&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;cGFyYW0=&#34;&#34;,&#34;&#34;value&#34;&#34;:&#34;&#34;PHNjcmlwdA==&#34;&#34;,&#34;&#34;location&#34;&#34;:&#34;&#34;query&#34;&#34;}},{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:false,&#34;&#34;isAlarmed&#34;&#34;:true,&#34;&#34;isLearned&#34;&#34;:false},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;&#34;},&#34;&#34;policyEntity&#34;&#34;:{&#34;&#34;parameters&#34;&#34;:[{&#34;&#34;name&#34;&#34;:&#34;&#34;*&#34;&#34;,&#34;&#34;level&#34;&#34;:&#34;&#34;global&#34;&#34;,&#34;&#34;type&#34;&#34;:&#34;&#34;wildcard&#34;&#34;}]},&#34;&#34;observedEntity&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;cGFyYW0=&#34;&#34;,&#34;&#34;value&#34;&#34;:&#34;&#34;PHNjcmlwdA==&#34;&#34;,&#34;&#34;location&#34;&#34;:&#34;&#34;query&#34;&#34;},&#34;&#34;metachar&#34;&#34;:&#34;&#34;0x3c&#34;&#34;,&#34;&#34;charsetType&#34;&#34;:&#34;&#34;parameter-value&#34;&#34;},{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:false},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_HTTP_PROTOCOL&#34;&#34;},&#34;&#34;policyEntity&#34;&#34;:{&#34;&#34;blocking-settings&#34;&#34;:{&#34;&#34;http-protocols&#34;&#34;:{&#34;&#34;description&#34;&#34;:&#34;&#34;Host header contains IP address&#34;&#34;}}}},{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:true},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_RATING_THREAT&#34;&#34;}},{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:false},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_BOT_CLIENT&#34;&#34;}}],&#34;&#34;enforcementAction&#34;&#34;:&#34;&#34;block&#34;&#34;,&#34;&#34;method&#34;&#34;:&#34;&#34;GET&#34;&#34;,&#34;&#34;clientPort&#34;&#34;:6026,&#34;&#34;clientIp&#34;&#34;:&#34;&#34;10.42.0.1&#34;&#34;,&#34;&#34;host&#34;&#34;:&#34;&#34;nginx-78b84c446f-flw6h&#34;&#34;,&#34;&#34;responseCode&#34;&#34;:0,&#34;&#34;serverIp&#34;&#34;:&#34;&#34;0.0.0.0&#34;&#34;,&#34;&#34;serverPort&#34;&#34;:80,&#34;&#34;requestStatus&#34;&#34;:&#34;&#34;blocked&#34;&#34;,&#34;&#34;url&#34;&#34;:&#34;&#34;L2luZGV4LnBocA==&#34;&#34;,&#34;&#34;virtualServerName&#34;&#34;:&#34;&#34;24-localhost:1-/&#34;&#34;,&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:true,&#34;&#34;isAlarmed&#34;&#34;:true,&#34;&#34;rating&#34;&#34;:4,&#34;&#34;attackType&#34;&#34;:[{&#34;&#34;name&#34;&#34;:&#34;&#34;Non-browser Client&#34;&#34;},{&#34;&#34;name&#34;&#34;:&#34;&#34;Abuse of Functionality&#34;&#34;},{&#34;&#34;name&#34;&#34;:&#34;&#34;Cross Site Scripting (XSS)&#34;&#34;},{&#34;&#34;name&#34;&#34;:&#34;&#34;Other Application Activity&#34;&#34;},{&#34;&#34;name&#34;&#34;:&#34;&#34;HTTP Parser Attack&#34;&#34;}],&#34;&#34;ratingIncludingViolationsInStaging&#34;&#34;:4,&#34;&#34;stagingCertificationDatetime&#34;&#34;:&#34;&#34;2024-01-01T00:00:00Z&#34;&#34;},&#34;&#34;requestDatetime&#34;&#34;:&#34;&#34;2023-12-27T14:22:29Z&#34;</span><span class="err">&#34;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">json_log=</span><span class="s2">&#34;{&#34;&#34;id&#34;&#34;:&#34;&#34;7103271131347005954&#34;&#34;,&#34;&#34;violations&#34;&#34;:[{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:true,&#34;&#34;isAlarmed&#34;&#34;:true,&#34;&#34;isInStaging&#34;&#34;:false,&#34;&#34;isLearned&#34;&#34;:false,&#34;&#34;isLikelyFalsePositive&#34;&#34;:false},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_ATTACK_SIGNATURE&#34;&#34;},&#34;&#34;signature&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;XSS script tag (Parameter)&#34;&#34;,&#34;&#34;signatureId&#34;&#34;:200000098,&#34;&#34;accuracy&#34;&#34;:&#34;&#34;high&#34;&#34;,&#34;&#34;risk&#34;&#34;:&#34;&#34;high&#34;&#34;,&#34;&#34;hasCve&#34;&#34;:false,&#34;&#34;stagingCertificationDatetime&#34;&#34;:&#34;&#34;2024-01-01T00:00:00Z&#34;&#34;,&#34;&#34;lastUpdateTime&#34;&#34;:&#34;&#34;2023-11-02T19:36:54Z&#34;&#34;},&#34;&#34;snippet&#34;&#34;:{&#34;&#34;buffer&#34;&#34;:&#34;&#34;cGFyYW09PHNjcmlwdA==&#34;&#34;,&#34;&#34;offset&#34;&#34;:6,&#34;&#34;length&#34;&#34;:7},&#34;&#34;policyEntity&#34;&#34;:{&#34;&#34;parameters&#34;&#34;:[{&#34;&#34;name&#34;&#34;:&#34;&#34;*&#34;&#34;,&#34;&#34;level&#34;&#34;:&#34;&#34;global&#34;&#34;,&#34;&#34;type&#34;&#34;:&#34;&#34;wildcard&#34;&#34;}]},&#34;&#34;observedEntity&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;cGFyYW0=&#34;&#34;,&#34;&#34;value&#34;&#34;:&#34;&#34;PHNjcmlwdA==&#34;&#34;,&#34;&#34;location&#34;&#34;:&#34;&#34;query&#34;&#34;}},{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:false,&#34;&#34;isAlarmed&#34;&#34;:true,&#34;&#34;isLearned&#34;&#34;:false},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_PARAMETER_VALUE_METACHAR&#34;&#34;},&#34;&#34;policyEntity&#34;&#34;:{&#34;&#34;parameters&#34;&#34;:[{&#34;&#34;name&#34;&#34;:&#34;&#34;*&#34;&#34;,&#34;&#34;level&#34;&#34;:&#34;&#34;global&#34;&#34;,&#34;&#34;type&#34;&#34;:&#34;&#34;wildcard&#34;&#34;}]},&#34;&#34;observedEntity&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;cGFyYW0=&#34;&#34;,&#34;&#34;value&#34;&#34;:&#34;&#34;PHNjcmlwdA==&#34;&#34;,&#34;&#34;location&#34;&#34;:&#34;&#34;query&#34;&#34;},&#34;&#34;metachar&#34;&#34;:&#34;&#34;0x3c&#34;&#34;,&#34;&#34;charsetType&#34;&#34;:&#34;&#34;parameter-value&#34;&#34;},{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:false},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_HTTP_PROTOCOL&#34;&#34;},&#34;&#34;policyEntity&#34;&#34;:{&#34;&#34;blocking-settings&#34;&#34;:{&#34;&#34;http-protocols&#34;&#34;:{&#34;&#34;description&#34;&#34;:&#34;&#34;Host header contains IP address&#34;&#34;}}}},{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:true},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_RATING_THREAT&#34;&#34;}},{&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:false},&#34;&#34;violation&#34;&#34;:{&#34;&#34;name&#34;&#34;:&#34;&#34;VIOL_BOT_CLIENT&#34;&#34;}}],&#34;&#34;enforcementAction&#34;&#34;:&#34;&#34;block&#34;&#34;,&#34;&#34;method&#34;&#34;:&#34;&#34;GET&#34;&#34;,&#34;&#34;clientPort&#34;&#34;:6026,&#34;&#34;clientIp&#34;&#34;:&#34;&#34;10.42.0.1&#34;&#34;,&#34;&#34;host&#34;&#34;:&#34;&#34;nginx-78b84c446f-flw6h&#34;&#34;,&#34;&#34;responseCode&#34;&#34;:0,&#34;&#34;serverIp&#34;&#34;:&#34;&#34;0.0.0.0&#34;&#34;,&#34;&#34;serverPort&#34;&#34;:80,&#34;&#34;requestStatus&#34;&#34;:&#34;&#34;blocked&#34;&#34;,&#34;&#34;url&#34;&#34;:&#34;&#34;L2luZGV4LnBocA==&#34;&#34;,&#34;&#34;virtualServerName&#34;&#34;:&#34;&#34;24-localhost:1-/&#34;&#34;,&#34;&#34;enforcementState&#34;&#34;:{&#34;&#34;isBlocked&#34;&#34;:true,&#34;&#34;isAlarmed&#34;&#34;:true,&#34;&#34;rating&#34;&#34;:4,&#34;&#34;attackType&#34;&#34;:[{&#34;&#34;name&#34;&#34;:&#34;&#34;Non-browser Client&#34;&#34;},{&#34;&#34;name&#34;&#34;:&#34;&#34;Abuse of Functionality&#34;&#34;},{&#34;&#34;name&#34;&#34;:&#34;&#34;Cross Site Scripting (XSS)&#34;&#34;},{&#34;&#34;name&#34;&#34;:&#34;&#34;Other Application Activity&#34;&#34;},{&#34;&#34;name&#34;&#34;:&#34;&#34;HTTP Parser Attack&#34;&#34;}],&#34;&#34;ratingIncludingViolationsInStaging&#34;&#34;:4,&#34;&#34;stagingCertificationDatetime&#34;&#34;:&#34;&#34;2024-01-01T00:00:00Z&#34;&#34;},&#34;&#34;requestDatetime&#34;&#34;:&#34;&#34;2023-12-27T14:22:29Z&#34;</span><span class="err">&#34;</span></span></span></code></pre></div>
</div>
<h2 
id="directives">Directives  <a class="headerlink float-right" href="#directives" title="Directives"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="global-directives">Global Directives  <a class="headerlink float-right" href="#global-directives" title="Global Directives"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Global configuration consists of a series of <code>nginx.conf</code> directives at the <code>http</code> context controlling aspects that are not specific to a specific application.</p>
<p>When applied to a cluster, all cluster members will get the same globals as expected.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Whether an incoming request is inspected by NGINX App Protect WAF may be determined by the URL in the request. This happens if you configure <code>app_protect_enable</code> and <code>app_protect_policy_file</code> directives in the <code>location</code> scope. In the case where the URL itself has violations such as <em>bad unescape</em> or <em>illegal metacharacter</em> then the request might be assigned to a location in which NGINX App Protect WAF is disabled or has a relaxed policy that does not detect these violations. Such malicious requests will be allowed without inspection. In order to avoid this, it is recommended to have a basic policy enabled at the <code>http</code> scope or at least at the <code>server</code> scope to process malicious requests in a more complete manner.</div>
</blockquote>






<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Directive Name</th>
          <th style="text-align: left">Syntax</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Default</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">app_protect_physical_memory_util_thresholds</td>
          <td style="text-align: left">app_protect_physical_memory_util_thresholds high=&lt;number_0-100&gt; low=&lt;number_0-100&gt;</td>
          <td style="text-align: left">Sets the physical memory utilization thresholds for entering (high) and exiting (low) failure mode. When the high threshold is exceeded the system enters failure mode until memory drops below the low threshold. Setting the value of 100 disables this feature.</td>
          <td style="text-align: left">high=low=100 (disabled)</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_cpu_thresholds</td>
          <td style="text-align: left">app_protect_cpu_thresholds high=&lt;number_0-100&gt; low=&lt;number_0-100&gt;</td>
          <td style="text-align: left">Sets the CPU utilization thresholds for entering and exiting failure mode respectively: when the high threshold is exceeded the system enters failure mode until CPU drops below the low threshold. Setting the value of 100 disables this feature.<br>         <strong>Note</strong>:  The system does not enter failure mode during policy compilation after reload even if the threshold is exceeded.</td>
          <td style="text-align: left">high=low=100 (disabled)</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_failure_mode_action</td>
          <td style="text-align: left">app_protect_failure_mode_action pass | drop</td>
          <td style="text-align: left">How to handle requests when the App Protect Enforcer cannot process them, either because it is down, disconnected or because of excessive CPU or memory utilization. There are two values:<ul><li><strong>pass</strong>: Pass the request without App Protect Enforcer inspection, a.k.a. &ldquo;fail-open&rdquo;.</li><li><strong>drop</strong>: Drop the request by returning the response &ldquo;503 Service Unavailable&rdquo;, a.k.a. &ldquo;fail-close&rdquo;.</li></ul></td>
          <td style="text-align: left">pass</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_cookie_seed</td>
          <td style="text-align: left">app_protect_cookie_seed <string></td>
          <td style="text-align: left">A long randomized string that serves to generate the encryption key for the cookies generated by App Protect. The string should contain only alphanumeric characters and be no longer than 1000 characters.</td>
          <td style="text-align: left">Auto-generated random string</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_compressed_requests_action</td>
          <td style="text-align: left">app_protect_compressed_requests_action pass | drop</td>
          <td style="text-align: left">Determines how to handle compressed requests. There are two values:<ul><li><strong>pass</strong>: Pass the request without App Protect Enforcer inspection, a.k.a. &ldquo;fail-open&rdquo;.</li><li><strong>drop</strong>: Drop the request by returning the response &ldquo;501 Not Implemented&rdquo;, a.k.a. &ldquo;fail-close&rdquo;.</li></ul> <strong>Note</strong>: Starting with App Protect release version 4.6, this directive has been deprecated from the <code>nginx.conf</code> file.</td>
          <td style="text-align: left">drop</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_request_buffer_overflow_action</td>
          <td style="text-align: left">app_protect_request_buffer_overflow_action pass | drop</td>
          <td style="text-align: left">Determines how to handle requests in case the NGINX request buffer is full and requests cannot be buffered anymore. There are two values:<ul><li><strong>pass</strong>: Pass the request without App Protect Enforcer inspection, a.k.a. &ldquo;fail-open&rdquo;.</li><li><strong>drop</strong>: Drop the request by resetting connection. No response page is returned, a.k.a. &ldquo;fail-close&rdquo;.</li></ul></td>
          <td style="text-align: left">pass</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_user_defined_signatures</td>
          <td style="text-align: left">app_protect_user_defined_signatures <path></td>
          <td style="text-align: left">Imports the user-defined tagged signature file with the respective tag name from the provided path. Multiple instances of this directive are supported. In order to import multiple signatures files, each file must have a different tag.</td>
          <td style="text-align: left">N/A</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_reconnect_period_seconds</td>
          <td style="text-align: left">app_protect_reconnect_period_seconds <value> <br> <strong>Value type</strong>: number with decimal fraction <br> <strong>Value Range</strong>:  0-60. 0 is illegal</td>
          <td style="text-align: left">Determines the period of time between reconnect retries of the module to the web application firewall (WAF) engine. The time unit is seconds.</td>
          <td style="text-align: left">5</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Directive Name</th>
          <th style="text-align: left">Syntax</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Default</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">app_protect_physical_memory_util_thresholds</td>
          <td style="text-align: left">app_protect_physical_memory_util_thresholds high=&lt;number_0-100&gt; low=&lt;number_0-100&gt;</td>
          <td style="text-align: left">Sets the physical memory utilization thresholds for entering (high) and exiting (low) failure mode. When the high threshold is exceeded the system enters failure mode until memory drops below the low threshold. Setting the value of 100 disables this feature.</td>
          <td style="text-align: left">high=low=100 (disabled)</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_cpu_thresholds</td>
          <td style="text-align: left">app_protect_cpu_thresholds high=&lt;number_0-100&gt; low=&lt;number_0-100&gt;</td>
          <td style="text-align: left">Sets the CPU utilization thresholds for entering and exiting failure mode respectively: when the high threshold is exceeded the system enters failure mode until CPU drops below the low threshold. Setting the value of 100 disables this feature.<br>         <strong>Note</strong>:  The system does not enter failure mode during policy compilation after reload even if the threshold is exceeded.</td>
          <td style="text-align: left">high=low=100 (disabled)</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_failure_mode_action</td>
          <td style="text-align: left">app_protect_failure_mode_action pass | drop</td>
          <td style="text-align: left">How to handle requests when the App Protect Enforcer cannot process them, either because it is down, disconnected or because of excessive CPU or memory utilization. There are two values:<ul><li><strong>pass</strong>: Pass the request without App Protect Enforcer inspection, a.k.a. &ldquo;fail-open&rdquo;.</li><li><strong>drop</strong>: Drop the request by returning the response &ldquo;503 Service Unavailable&rdquo;, a.k.a. &ldquo;fail-close&rdquo;.</li></ul></td>
          <td style="text-align: left">pass</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_cookie_seed</td>
          <td style="text-align: left">app_protect_cookie_seed <string></td>
          <td style="text-align: left">A long randomized string that serves to generate the encryption key for the cookies generated by App Protect. The string should contain only alphanumeric characters and be no longer than 1000 characters.</td>
          <td style="text-align: left">Auto-generated random string</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_compressed_requests_action</td>
          <td style="text-align: left">app_protect_compressed_requests_action pass | drop</td>
          <td style="text-align: left">Determines how to handle compressed requests. There are two values:<ul><li><strong>pass</strong>: Pass the request without App Protect Enforcer inspection, a.k.a. &ldquo;fail-open&rdquo;.</li><li><strong>drop</strong>: Drop the request by returning the response &ldquo;501 Not Implemented&rdquo;, a.k.a. &ldquo;fail-close&rdquo;.</li></ul> <strong>Note</strong>: Starting with App Protect release version 4.6, this directive has been deprecated from the <code>nginx.conf</code> file.</td>
          <td style="text-align: left">drop</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_request_buffer_overflow_action</td>
          <td style="text-align: left">app_protect_request_buffer_overflow_action pass | drop</td>
          <td style="text-align: left">Determines how to handle requests in case the NGINX request buffer is full and requests cannot be buffered anymore. There are two values:<ul><li><strong>pass</strong>: Pass the request without App Protect Enforcer inspection, a.k.a. &ldquo;fail-open&rdquo;.</li><li><strong>drop</strong>: Drop the request by resetting connection. No response page is returned, a.k.a. &ldquo;fail-close&rdquo;.</li></ul></td>
          <td style="text-align: left">pass</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_user_defined_signatures</td>
          <td style="text-align: left">app_protect_user_defined_signatures <path></td>
          <td style="text-align: left">Imports the user-defined tagged signature file with the respective tag name from the provided path. Multiple instances of this directive are supported. In order to import multiple signatures files, each file must have a different tag.</td>
          <td style="text-align: left">N/A</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_reconnect_period_seconds</td>
          <td style="text-align: left">app_protect_reconnect_period_seconds <value> <br> <strong>Value type</strong>: number with decimal fraction <br> <strong>Value Range</strong>:  0-60. 0 is illegal</td>
          <td style="text-align: left">Determines the period of time between reconnect retries of the module to the web application firewall (WAF) engine. The time unit is seconds.</td>
          <td style="text-align: left">5</td>
      </tr>
  </tbody>
</table>

</div>

<h3 
id="app-protect-specific-directives">App Protect Specific Directives  <a class="headerlink float-right" href="#app-protect-specific-directives" title="App Protect Specific Directives"><i class="fas fa-link fa-xs"></i></a>
</h3><p>This table summarizes the nginx.conf directives for NGINX App Protect WAF functionality.</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Directive Name</th>
          <th style="text-align: left">Syntax</th>
          <th style="text-align: left">Functionality</th>
          <th style="text-align: left">nginx.conf Contexts</th>
          <th style="text-align: left">Example</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">load_module</td>
          <td style="text-align: left">load_module &lt;library_file_path&gt;</td>
          <td style="text-align: left">NGINX directive to load the App Protect module. It must be invoked with the App Protect library path</td>
          <td style="text-align: left">Global</td>
          <td style="text-align: left">load_module modules/ngx_http_app_protect_module.so</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_enable</td>
          <td style="text-align: left">app_protect_enable on | off</td>
          <td style="text-align: left">Whether to enable App Protect at the respective context. If not present, inherits from the parent context</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_enable on</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_policy_file</td>
          <td style="text-align: left">app_protect_policy_file &lt;file_path&gt;</td>
          <td style="text-align: left">Set a App Protect policy configuring behavior for the respective context.</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_policy_file /config/waf/strict_policy.json</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_security_log_enable</td>
          <td style="text-align: left">app_protect_security_log_enable on | off</td>
          <td style="text-align: left">Whether to enable the App Protect per-request log at the respective context.</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_security_log_enable on</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_security_log</td>
          <td style="text-align: left">app_protect_security_log &lt;file_path&gt; <destination></td>
          <td style="text-align: left">Specifies the per-request logging: what to log and where</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_security_log /config/waf/log_illegal.json syslog:localhost:522</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_custom_log_attribute</td>
          <td style="text-align: left">app_protect_custom_log_attribute &lt;key_value&gt;</td>
          <td style="text-align: left">Specifies the assigned location/server/http dimension of each request.</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_custom_log_attribute environment&rsquo; &rsquo;env1'</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Directive Name</th>
          <th style="text-align: left">Syntax</th>
          <th style="text-align: left">Functionality</th>
          <th style="text-align: left">nginx.conf Contexts</th>
          <th style="text-align: left">Example</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">load_module</td>
          <td style="text-align: left">load_module &lt;library_file_path&gt;</td>
          <td style="text-align: left">NGINX directive to load the App Protect module. It must be invoked with the App Protect library path</td>
          <td style="text-align: left">Global</td>
          <td style="text-align: left">load_module modules/ngx_http_app_protect_module.so</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_enable</td>
          <td style="text-align: left">app_protect_enable on | off</td>
          <td style="text-align: left">Whether to enable App Protect at the respective context. If not present, inherits from the parent context</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_enable on</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_policy_file</td>
          <td style="text-align: left">app_protect_policy_file &lt;file_path&gt;</td>
          <td style="text-align: left">Set a App Protect policy configuring behavior for the respective context.</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_policy_file /config/waf/strict_policy.json</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_security_log_enable</td>
          <td style="text-align: left">app_protect_security_log_enable on | off</td>
          <td style="text-align: left">Whether to enable the App Protect per-request log at the respective context.</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_security_log_enable on</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_security_log</td>
          <td style="text-align: left">app_protect_security_log &lt;file_path&gt; <destination></td>
          <td style="text-align: left">Specifies the per-request logging: what to log and where</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_security_log /config/waf/log_illegal.json syslog:localhost:522</td>
      </tr>
      <tr>
          <td style="text-align: left">app_protect_custom_log_attribute</td>
          <td style="text-align: left">app_protect_custom_log_attribute &lt;key_value&gt;</td>
          <td style="text-align: left">Specifies the assigned location/server/http dimension of each request.</td>
          <td style="text-align: left">HTTP, Server, Location</td>
          <td style="text-align: left">app_protect_custom_log_attribute environment&rsquo; &rsquo;env1'</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="horizontal-scaling">Horizontal Scaling  <a class="headerlink float-right" href="#horizontal-scaling" title="Horizontal Scaling"><i class="fas fa-link fa-xs"></i></a>
</h4><p>NGINX App Protect WAF can be deployed in multiple instances that share the traffic to the same applications. In that case all the instances must share the same configuration files. It is your responsibility to synchronize the files on all instances. You also have to provide a load balancing solution in front of those instances such as another NGINX instance.</p>
<p>When deploying multiple scalability instances you have to add the <code>app_protect_cookie_seed</code> directive to nginx.conf in the <code>http</code> block:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f609a7488&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f609a7488">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">...</span>
</span></span><span class="line"><span class="cl"><span class="s">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="s">app_protect_cookie_seed</span> <span class="s">jkldsf90upiokasdj120</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="s">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">...</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="s">...</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">...</span>
</span></span><span class="line"><span class="cl"><span class="s">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="s">app_protect_cookie_seed</span> <span class="s">jkldsf90upiokasdj120</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="s">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">...</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="s">...</span></span></span></code></pre></div>
</div><p>As the argument of this directive, put a random alphanumeric string of at least 20 characters length (but not more than 1000 characters). That seed is used by NGINX App Protect WAF to generate the encryption key for the cookies it creates. These cookies are used for various purposes such as validating the integrity of the cookies generated by the application.</p>
<p>In the absence of this directive, App Protect generates a random string by itself. In that case, each instance will have a different seed. A cookie created and encrypted on one instance of App Protect will fail to be decrypted when sent by the same client to another App Protect instance having a different encryption key.</p>
<h4 
id="failure-mode">Failure Mode  <a class="headerlink float-right" href="#failure-mode" title="Failure Mode"><i class="fas fa-link fa-xs"></i></a>
</h4><p>If the App Protect daemons are down or disconnected from the NGINX workers, there are two modes of operation until they are up and connected again:</p>
<ul>
<li><strong>Pass</strong> the traffic without inspection. Use this when preferring availability over security. This mode is also known as &ldquo;fail open&rdquo;.</li>
<li><strong>Drop</strong> the traffic. Use this when preferring security over availability. This mode is also known as &ldquo;fail closed&rdquo;.</li>
</ul>
<p>The default is to <strong>pass</strong>, fail open, but you can control this using the <code>app_protect_failure_mode_action</code> directive with one argument with two possible values: &ldquo;pass&rdquo; or &ldquo;fail&rdquo; for the two above options.</p>
<p>This directive is also placed in the <code>http</code> block of the nginx.conf file.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f609d27f0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f609d27f0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">...</span>
</span></span><span class="line"><span class="cl"><span class="s">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="s">app_protect_failure_mode_action</span> <span class="s">drop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="s">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="s">...</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">...</span>
</span></span><span class="line"><span class="cl"><span class="s">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="s">app_protect_failure_mode_action</span> <span class="s">drop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="s">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">...</span>
</span></span><span class="line"><span class="cl">    <span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="s">...</span></span></span></code></pre></div>
</div><h4 
id="handling-compressed-requests">Handling Compressed Requests  <a class="headerlink float-right" href="#handling-compressed-requests" title="Handling Compressed Requests"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Starting with NGINX App Protect WAF release version 4.6, the <a href="#global-directives"><code>app_protect_compressed_requests_action</code></a> directive has been deprecated from the nginx configuration. When configuring this directive in the <code>nginx.conf</code> file, App Protect will disregard any previously used values (&ldquo;pass&rdquo; or &ldquo;drop&rdquo;) and issue a warning.</p>
<h4 
id="handling-decompression">Handling Decompression  <a class="headerlink float-right" href="#handling-decompression" title="Handling Decompression"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Now by default the enforcer will decompress all the HTTP compressed payload request and will apply the enforcment. The supported compression algorithms for this feature are &ldquo;<strong>gzip</strong>&rdquo; and &ldquo;<strong>deflate</strong>&rdquo;. There will be no decompression, if the compression method is not supported.</p>
<p>The &lsquo;Content-Encoding&rsquo; header must match the compression algorithm used while sending compressed payload in a HTTP request, else the enfocer will fail to decompress the payload.</p>
<p>The decompressed request must not exceed the size limit of 10 MB. If it does exceed this limit, NGINX App Protect WAF will only decompress the first 10 KB, ignoring the remainder, and trigger the <code>VIOL_REQUEST_MAX_LENGTH</code> violation, just as it would for an uncompressed request that exceeds 10 MB.</p>
<p>In the cases where decompression fails,  NGINX App Protect WAF will continue with the scan in the same manner as it does for uncompressed requests.</p>
<h2 
id="violations">Violations  <a class="headerlink float-right" href="#violations" title="Violations"><i class="fas fa-link fa-xs"></i></a>
</h2><p>App Protect violations are rated by the App Protect algorithms to help distinguish between attacks and potential false positive alerts.  A violation rating is a numerical rating that our algorithms give to requests based on the presence of violation(s). Each violation type and severity contributes to the calculation of the final rating. The final rating then defines the action taken for the specific request. As per the default policy, any violation rating of 1, 2 and 3 will not cause the request to be blocked and only a log will be generated with <strong>alerted</strong> status. If the violation rating is 4 or 5, the request is blocked: a blocking page is displayed and a log generated for the transaction with <strong>blocked</strong> status. Violation ratings are displayed in the logs by default.</p>

<h3 
id="supported-violations">Supported Violations  <a class="headerlink float-right" href="#supported-violations" title="Supported Violations"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The following violations are supported and can be enabled by turning on the <strong>alarm</strong> and/or <strong>block</strong> flags.</p>
 
 
 
 
 
 <table class="table table-striped table-bordered table-sm table-responsive table-v1">
   <thead>
       <tr>
           <th style="text-align: left">Violation Name</th>
           <th style="text-align: left">Title</th>
           <th style="text-align: left">Enabled Flags in Default Template</th>
           <th style="text-align: left">Description</th>
           <th style="text-align: left">Comment</th>
       </tr>
   </thead>
   <tbody>
       <tr>
           <td style="text-align: left">VIOL_ACCESS_INVALID</td>
           <td style="text-align: left">Access token does not comply with the profile requirements</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks the access token in a request according to the access profile attached to the respective URL. The violation is raised when at least one of the enforced checks in the profile is not satisfied</td>
           <td style="text-align: left">This would trigger a Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ACCESS_MISSING</td>
           <td style="text-align: left">Missing Access Token</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains the access token for the respective URL according to the Access Profile. The violation is raised when that token is not found.</td>
           <td style="text-align: left">This would trigger a Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ACCESS_MALFORMED</td>
           <td style="text-align: left">Malformed Access Token</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The access token required for the URL in the request was malformed.</td>
           <td style="text-align: left">This would trigger a Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ACCESS_UNAUTHORIZED</td>
           <td style="text-align: left">Unauthorized access attempt</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the access token complies with the authorization conditions defined per the accessed URL. The violation is raised at least one condition is not met.</td>
           <td style="text-align: left">This would trigger a Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ASM_COOKIE_MODIFIED</td>
           <td style="text-align: left">Modified ASM cookie</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request contains an ASM cookie that has not been modified or tampered with. Blocks modified requests.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ATTACK_SIGNATURE</td>
           <td style="text-align: left">Attack signature detected</td>
           <td style="text-align: left">N/A</td>
           <td style="text-align: left">The system examines the HTTP message for known attacks by matching it against known attack patterns.</td>
           <td style="text-align: left">Determined per signature set. <br>Note: This violation cannot be configured by the user. Rather, the violation is determined by the combination of the signature sets on the policy.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_BLACKLISTED_IP</td>
           <td style="text-align: left">IP is in the deny list</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The violation is issued when a request comes from an IP address that falls in the range of an IP address exception marked for &ldquo;always blocking&rdquo;, that is, the deny list of IPs.</td>
           <td style="text-align: left">Would trigger Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_BOT_CLIENT</td>
           <td style="text-align: left">Bot Client Detected</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system detects automated clients, and classifies them to Bot types.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_COOKIE_EXPIRED</td>
           <td style="text-align: left">Expired timestamp</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the timestamp in the HTTP cookie is not old. An old timestamp indicates that a client session has expired. Blocks expired requests. The timestamp is extracted and validated against the current time. If the timestamp is expired and it is not an entry point, the system issues the Expired Timestamp violation.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_COOKIE_LENGTH</td>
           <td style="text-align: left">Illegal cookie length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request does not include a cookie header that exceeds the acceptable length specified in the security policy.</td>
           <td style="text-align: left">Determined by policy setting which is disabled in default template.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_COOKIE_MALFORMED</td>
           <td style="text-align: left">Cookie not RFC-compliant</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation occurs when HTTP cookies contain at least one of the following components:<br><ul><li>Quotation marks in the cookie name.</li><li>A space in the cookie name.</li><li>An equal sign (=) in the cookie name.</li></ul><br>  Note: A space between the cookie name and the equal sign (=), and between the equal sign (=) and cookie value is allowed.<ul><li>An equal sign (=) before the cookie name.</li><li>A carriage return (hexadecimal value of 0xd) in the cookie name.</li></ul></td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_COOKIE_MODIFIED</td>
           <td style="text-align: left">Modified domain cookie(s)</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the web application cookies within the request have not been tampered, and the system checks that the request includes a web application cookie defined in the security policy.</td>
           <td style="text-align: left">Determined by cookie type: applied to &ldquo;enforced&rdquo; cookies.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_DATA_GUARD</td>
           <td style="text-align: left">Data Guard: Information leakage detected</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system examines responses and searches for sensitive information.</td>
           <td style="text-align: left">Controlled by the DG enable flag which is disabled in default template.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ENCODING</td>
           <td style="text-align: left">Failed to convert character</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system detects that one of the characters does not comply with the configured language encoding of the web application&rsquo;s security policy.</td>
           <td style="text-align: left">Enforced by NGINX core, reported by App Protect.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_EVASION</td>
           <td style="text-align: left">Evasion technique detected</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">This category contains a list of evasion techniques that attackers use to bypass detection.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_FILETYPE</td>
           <td style="text-align: left">Illegal file type</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the requested file type is configured as a valid file type, or not configured as an invalid file type, within the security policy.</td>
           <td style="text-align: left">Only for disallowed file types.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_FILE_UPLOAD</td>
           <td style="text-align: left">Disallowed file upload content detected</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the file upload content is not a binary executable file format.</td>
           <td style="text-align: left">The check must be enabled for parameters of data type file upload</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_FILE_UPLOAD_IN_BODY</td>
           <td style="text-align: left">Disallowed file upload content detected in body</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the file upload content is not a binary executable file format.</td>
           <td style="text-align: left">The check must be enabled for URLs</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GEOLOCATION</td>
           <td style="text-align: left">Disallowed Geolocations</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation will be triggered when an attempt is made to access the web application from a restricted location.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRAPHQL_MALFORMED</td>
           <td style="text-align: left">Malformed GraphQL data</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation will be issued when the traffic expected to be GraphQL doesn&rsquo;t comply to the GraphQL syntax. The specifics of the syntax that will be enforced in App Protect is detailed in the enforcing section. The violation details will note the error.</td>
           <td style="text-align: left">In case of tolerate parser warning turned on, missing closing bracket of the JSON should not issue a violation.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRAPHQL_FORMAT</td>
           <td style="text-align: left">GraphQL format data does not comply with format settings</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation will be issued when the GraphQL profile settings are not satisfied, for example the length is too long, depth is too deep, a specific value is too long or too many batched queries. <br> The violation details will note what happened and the found length, depth or which value is too long and by what. <br> The depth violation is not learnable. The reason is that we don&rsquo;t know the actual depth of the query - we stop parsing at the max depth. <br> Note that the values will be used on the variables JSON part as well as the query. In a way, we can see these values as a JSON profile attributes just for the variables.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRAPHQL_INTROSPECTION_QUERY</td>
           <td style="text-align: left">GraphQL introspection Query</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation will be issued when an introspection query was seen.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRAPHQL_ERROR_RESPONSE</td>
           <td style="text-align: left">GraphQL Error Response</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">GraphQL disallowed pattern in response.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRPC_FORMAT</td>
           <td style="text-align: left">gRPC data does not comply with format settings</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains gRPC content and complies with the various request limits within the defense configuration in the security policy&rsquo;s gRPC Content Profile. Enforces valid gRPC requests and protects the server from Protocol Buffers parser attacks. This violation is generated when a gRPC request does not meet restrictive conditions in the gRPC Content Profile, such as the message length or existence of unknown fields.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRPC_MALFORMED</td>
           <td style="text-align: left">Malformed gRPC data</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request contains gRPC content that is well-formed. Enforces parsable gRPC requests.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRPC_METHOD</td>
           <td style="text-align: left">Illegal gRPC method</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the gRPC service method invoked matches one of the methods defined in the IDL file. The violation is triggered if the method does not appear there.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_HEADER_LENGTH</td>
           <td style="text-align: left">Illegal header length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request includes a total HTTP header length that does not exceed the length specified in the security policy.</td>
           <td style="text-align: left">The actual size in default policy is 4 KB</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_HEADER_METACHAR</td>
           <td style="text-align: left">Illegal meta character in header</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the values of all headers within the request only contain meta characters defined as allowed in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_HTTP_PROTOCOL</td>
           <td style="text-align: left">HTTP protocol compliance failed</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">This category contains a list of validation checks that the system performs on HTTP requests to ensure that the requests are formatted properly.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_HTTP_RESPONSE_STATUS</td>
           <td style="text-align: left">Illegal HTTP response status</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The server response contains an HTTP status code that is not defined as valid in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_JSON_FORMAT</td>
           <td style="text-align: left">JSON data does not comply with format settings</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains JSON content and complies with the various request limits within the defense configuration in the security policy&rsquo;s JSON profile. Enforces valid JSON requests and protects the server from JSON parser attacks. This violation is generated when a problem is detected in a JSON request, generally checking the message according to boundaries such as the message&rsquo;s size and meta characters in parameter value.</td>
           <td style="text-align: left">Controlled from the default JSON profile.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_JSON_MALFORMED</td>
           <td style="text-align: left">Malformed JSON data</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request contains JSON content that is well-formed. Enforces parsable JSON requests.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_JSON_SCHEMA</td>
           <td style="text-align: left">JSON data does not comply with JSON schema</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the incoming request contains JSON data that matches the schema file that is part of a JSON profile configured in the security policy. Enforces proper JSON requests defined by the schema.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_MANDATORY_PARAMETER</td>
           <td style="text-align: left">Mandatory parameter is missing</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that parameter marked as mandatory exists in the request.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_MANDATORY_REQUEST_BODY</td>
           <td style="text-align: left">Mandatory request body is missing</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the body exists in the request</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_METHOD</td>
           <td style="text-align: left">Illegal method</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request references an HTTP request method that is found in the security policy. Enforces desired HTTP methods; GET and POST are always allowed.</td>
           <td style="text-align: left">These HTTP methods are supported:<br><ul><li>GET</li><li>HEAD</li><li>POST</li><li>PUT</li><li>PATCH</li><li>DELETE</li><li>OPTIONS</li></ul></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER</td>
           <td style="text-align: left">Illegal parameter</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that every parameter in the request is defined in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_ARRAY_VALUE</td>
           <td style="text-align: left">Illegal parameter array value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The value of an item in an array parameter is not according to the defined data type.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_DATA_TYPE</td>
           <td style="text-align: left">Illegal parameter data type</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a parameter whose data type matches the data type defined in the security policy. The data types that this violation applies to are integer, email, and phone.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_EMPTY_VALUE</td>
           <td style="text-align: left">Illegal empty parameter value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a parameter whose value is not empty when it must contain a value.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_LOCATION</td>
           <td style="text-align: left">Illegal parameter location</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The parameter was found in a different location than it was configured in the policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_MULTIPART_NULL_VALUE</td>
           <td style="text-align: left">Null in multi-part parameter value</td>
           <td style="text-align: left">Disabled</td>
           <td style="text-align: left">The system checks that the multi-part request has a parameter value that does not contain the NULL character (0x00). If a multipart parameter with binary content type contains NULL in its value, the Enforcer issues this violation. The exceptions to this are:<br><ul><li>If that parameter is configured in the policy as <code>Ignore value</code>.</li><li>If that parameter is configured in the security policy as <code>user-input file-upload</code>.</li><li>If the parameter has a content-type that contains the string &lsquo;XML&rsquo; and the parameter value contains a valid UTF16 encoded XML document (the encoding is valid). In this case NULL is allowed as it is part of the UTF16 encoding.</li></ul></td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_NAME_METACHAR</td>
           <td style="text-align: left">Illegal meta character in parameter name</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that all parameter names within the incoming request only contain meta characters defined as allowed in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_NUMERIC_VALUE</td>
           <td style="text-align: left">Illegal parameter numeric value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the incoming request contains a parameter whose value is in the range of decimal or integer values defined in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_REPEATED</td>
           <td style="text-align: left">Illegal repeated parameter name</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">Detected multiple parameters of the same name in a single HTTP request.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_STATIC_VALUE</td>
           <td style="text-align: left">Illegal static parameter value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a static parameter whose value is defined in the security policy. Prevents static parameter change. NGINX App Protect WAF can be configured to block parameter values that are not in a predefined list. Parameters can be defined on each of the following levels: file type, URL, and flow. Each parameter can be one of the following types: explicit or wildcard.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_VALUE_BASE64</td>
           <td style="text-align: left">Illegal Base64 value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the value is a valid Base64 string. If the value is indeed Base64, the system decodes this value and continues with its security checks.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_VALUE_LENGTH</td>
           <td style="text-align: left">Illegal parameter value length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a parameter whose value length (in bytes) matches the value length defined in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_VALUE_METACHAR</td>
           <td style="text-align: left">Illegal meta character in value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that all parameter values, XML element/attribute values, or JSON values within the request only contain meta characters defined as allowed in the security policy. Enforces proper input values. In case of a violation, the reported value represents the decimal ASCII value (metachar_index), or, in case of using &ldquo;json_log&rdquo; the hexadecimal ASCII value (metachar) of the violating character.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_VALUE_REGEXP</td>
           <td style="text-align: left">Parameter value does not comply with regular expression</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains an alphanumeric parameter value that matches the expected pattern specified by the regular-expression field for that parameter. Prevents HTTP requests which do not comply with a defined pattern. NGINX App Protect WAF lets you set up a regular expression to block requests where a parameter value does not match the regular expression.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_POST_DATA_LENGTH</td>
           <td style="text-align: left">Illegal POST data length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains POST data whose length does not exceed the acceptable length specified in the security policy.</td>
           <td style="text-align: left">In * file type entity. This check is disabled by default.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_QUERY_STRING_LENGTH</td>
           <td style="text-align: left">Illegal query string length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a query string whose length does not exceed the acceptable length specified in the security policy.</td>
           <td style="text-align: left">In * file type entity. Actual size is 2 KB.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_RATING_THREAT</td>
           <td style="text-align: left">Request is likely a threat</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The combination of violations in this request determined that the request is likely to be a threat.</td>
           <td style="text-align: left">For VR = 4 or 5</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_RATING_NEED_EXAMINATION</td>
           <td style="text-align: left">Request needs further examination</td>
           <td style="text-align: left">Disabled</td>
           <td style="text-align: left">The combination of violations could not determine whether the request is a threat or violations are false positives thus requiring more examination.</td>
           <td style="text-align: left">For VR = 3</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_REQUEST_LENGTH</td>
           <td style="text-align: left">Illegal request length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request length does not exceed the  acceptable length specified in the security policy per the requested file type.</td>
           <td style="text-align: left">In * file type entity. This check is disabled by default.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_REQUEST_MAX_LENGTH</td>
           <td style="text-align: left">Request length exceeds defined buffer size</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request length is not larger than the maximum memory buffer size. Note that this protects NGINX App Protect WAF from consuming too much memory across all security policies which are active on the device.</td>
           <td style="text-align: left">Default is 10MB</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_RULE</td>
           <td style="text-align: left">Actionable override rule was triggered.</td>
           <td style="text-align: left">Disabled</td>
           <td style="text-align: left">A policy override rule with an action was triggered.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_THREAT_CAMPAIGN</td>
           <td style="text-align: left">Threat Campaign detected</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system examines the HTTP message for known threat campaigns by matching it against known attack patterns.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_URL</td>
           <td style="text-align: left">Illegal URL</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the requested URL is configured as a valid URL, or not configured as an invalid URL, within the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_URL_CONTENT_TYPE</td>
           <td style="text-align: left">Illegal request content type</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The URL in the security policy has a <code>Header-Based Content Profiles</code> setting that disallows the request because the specified HTTP header or the default is set to <code>disallow</code>.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_URL_LENGTH</td>
           <td style="text-align: left">Illegal URL length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request is for a URL whose length does not exceed the acceptable length specified in the security policy.</td>
           <td style="text-align: left">In * file type entity. Actual size is 2 KB.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_URL_METACHAR</td>
           <td style="text-align: left">Illegal meta character in URL</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the incoming request includes a URL that contains only meta characters defined as allowed in the security policy. Enforces a desired set of acceptable characters.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_XML_FORMAT</td>
           <td style="text-align: left">XML data does not comply with format settings</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains XML data that complies with the various document limits within the defense configuration in the security policy&rsquo;s XML profile. Enforces proper XML requests and the data failed format/defense settings such as the maximum document length.<br>       This violation is generated when a problem in an XML document is detected (for example, an XML bomb), generally checking the message according to boundaries such as the message&rsquo;s size, maximum depth, and maximum number of children.</td>
           <td style="text-align: left">Controlled by the default XML profile</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_XML_MALFORMED</td>
           <td style="text-align: left">Malformed XML data</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request contains XML data that is well-formed, according to W3C standards. Enforces proper XML requests.</td>
           <td style="text-align: left"></td>
       </tr>
   </tbody>
 </table>
 
 
 
 
 
 
   
 
 
 <div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
     <table>
   <thead>
       <tr>
           <th style="text-align: left">Violation Name</th>
           <th style="text-align: left">Title</th>
           <th style="text-align: left">Enabled Flags in Default Template</th>
           <th style="text-align: left">Description</th>
           <th style="text-align: left">Comment</th>
       </tr>
   </thead>
   <tbody>
       <tr>
           <td style="text-align: left">VIOL_ACCESS_INVALID</td>
           <td style="text-align: left">Access token does not comply with the profile requirements</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks the access token in a request according to the access profile attached to the respective URL. The violation is raised when at least one of the enforced checks in the profile is not satisfied</td>
           <td style="text-align: left">This would trigger a Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ACCESS_MISSING</td>
           <td style="text-align: left">Missing Access Token</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains the access token for the respective URL according to the Access Profile. The violation is raised when that token is not found.</td>
           <td style="text-align: left">This would trigger a Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ACCESS_MALFORMED</td>
           <td style="text-align: left">Malformed Access Token</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The access token required for the URL in the request was malformed.</td>
           <td style="text-align: left">This would trigger a Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ACCESS_UNAUTHORIZED</td>
           <td style="text-align: left">Unauthorized access attempt</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the access token complies with the authorization conditions defined per the accessed URL. The violation is raised at least one condition is not met.</td>
           <td style="text-align: left">This would trigger a Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ASM_COOKIE_MODIFIED</td>
           <td style="text-align: left">Modified ASM cookie</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request contains an ASM cookie that has not been modified or tampered with. Blocks modified requests.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ATTACK_SIGNATURE</td>
           <td style="text-align: left">Attack signature detected</td>
           <td style="text-align: left">N/A</td>
           <td style="text-align: left">The system examines the HTTP message for known attacks by matching it against known attack patterns.</td>
           <td style="text-align: left">Determined per signature set. <br>Note: This violation cannot be configured by the user. Rather, the violation is determined by the combination of the signature sets on the policy.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_BLACKLISTED_IP</td>
           <td style="text-align: left">IP is in the deny list</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The violation is issued when a request comes from an IP address that falls in the range of an IP address exception marked for &ldquo;always blocking&rdquo;, that is, the deny list of IPs.</td>
           <td style="text-align: left">Would trigger Violation Rating of 5.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_BOT_CLIENT</td>
           <td style="text-align: left">Bot Client Detected</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system detects automated clients, and classifies them to Bot types.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_COOKIE_EXPIRED</td>
           <td style="text-align: left">Expired timestamp</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the timestamp in the HTTP cookie is not old. An old timestamp indicates that a client session has expired. Blocks expired requests. The timestamp is extracted and validated against the current time. If the timestamp is expired and it is not an entry point, the system issues the Expired Timestamp violation.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_COOKIE_LENGTH</td>
           <td style="text-align: left">Illegal cookie length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request does not include a cookie header that exceeds the acceptable length specified in the security policy.</td>
           <td style="text-align: left">Determined by policy setting which is disabled in default template.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_COOKIE_MALFORMED</td>
           <td style="text-align: left">Cookie not RFC-compliant</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation occurs when HTTP cookies contain at least one of the following components:<br><ul><li>Quotation marks in the cookie name.</li><li>A space in the cookie name.</li><li>An equal sign (=) in the cookie name.</li></ul><br>  Note: A space between the cookie name and the equal sign (=), and between the equal sign (=) and cookie value is allowed.<ul><li>An equal sign (=) before the cookie name.</li><li>A carriage return (hexadecimal value of 0xd) in the cookie name.</li></ul></td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_COOKIE_MODIFIED</td>
           <td style="text-align: left">Modified domain cookie(s)</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the web application cookies within the request have not been tampered, and the system checks that the request includes a web application cookie defined in the security policy.</td>
           <td style="text-align: left">Determined by cookie type: applied to &ldquo;enforced&rdquo; cookies.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_DATA_GUARD</td>
           <td style="text-align: left">Data Guard: Information leakage detected</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system examines responses and searches for sensitive information.</td>
           <td style="text-align: left">Controlled by the DG enable flag which is disabled in default template.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_ENCODING</td>
           <td style="text-align: left">Failed to convert character</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system detects that one of the characters does not comply with the configured language encoding of the web application&rsquo;s security policy.</td>
           <td style="text-align: left">Enforced by NGINX core, reported by App Protect.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_EVASION</td>
           <td style="text-align: left">Evasion technique detected</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">This category contains a list of evasion techniques that attackers use to bypass detection.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_FILETYPE</td>
           <td style="text-align: left">Illegal file type</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the requested file type is configured as a valid file type, or not configured as an invalid file type, within the security policy.</td>
           <td style="text-align: left">Only for disallowed file types.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_FILE_UPLOAD</td>
           <td style="text-align: left">Disallowed file upload content detected</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the file upload content is not a binary executable file format.</td>
           <td style="text-align: left">The check must be enabled for parameters of data type file upload</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_FILE_UPLOAD_IN_BODY</td>
           <td style="text-align: left">Disallowed file upload content detected in body</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the file upload content is not a binary executable file format.</td>
           <td style="text-align: left">The check must be enabled for URLs</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GEOLOCATION</td>
           <td style="text-align: left">Disallowed Geolocations</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation will be triggered when an attempt is made to access the web application from a restricted location.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRAPHQL_MALFORMED</td>
           <td style="text-align: left">Malformed GraphQL data</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation will be issued when the traffic expected to be GraphQL doesn&rsquo;t comply to the GraphQL syntax. The specifics of the syntax that will be enforced in App Protect is detailed in the enforcing section. The violation details will note the error.</td>
           <td style="text-align: left">In case of tolerate parser warning turned on, missing closing bracket of the JSON should not issue a violation.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRAPHQL_FORMAT</td>
           <td style="text-align: left">GraphQL format data does not comply with format settings</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation will be issued when the GraphQL profile settings are not satisfied, for example the length is too long, depth is too deep, a specific value is too long or too many batched queries. <br> The violation details will note what happened and the found length, depth or which value is too long and by what. <br> The depth violation is not learnable. The reason is that we don&rsquo;t know the actual depth of the query - we stop parsing at the max depth. <br> Note that the values will be used on the variables JSON part as well as the query. In a way, we can see these values as a JSON profile attributes just for the variables.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRAPHQL_INTROSPECTION_QUERY</td>
           <td style="text-align: left">GraphQL introspection Query</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">This violation will be issued when an introspection query was seen.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRAPHQL_ERROR_RESPONSE</td>
           <td style="text-align: left">GraphQL Error Response</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">GraphQL disallowed pattern in response.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRPC_FORMAT</td>
           <td style="text-align: left">gRPC data does not comply with format settings</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains gRPC content and complies with the various request limits within the defense configuration in the security policy&rsquo;s gRPC Content Profile. Enforces valid gRPC requests and protects the server from Protocol Buffers parser attacks. This violation is generated when a gRPC request does not meet restrictive conditions in the gRPC Content Profile, such as the message length or existence of unknown fields.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRPC_MALFORMED</td>
           <td style="text-align: left">Malformed gRPC data</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request contains gRPC content that is well-formed. Enforces parsable gRPC requests.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_GRPC_METHOD</td>
           <td style="text-align: left">Illegal gRPC method</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the gRPC service method invoked matches one of the methods defined in the IDL file. The violation is triggered if the method does not appear there.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_HEADER_LENGTH</td>
           <td style="text-align: left">Illegal header length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request includes a total HTTP header length that does not exceed the length specified in the security policy.</td>
           <td style="text-align: left">The actual size in default policy is 4 KB</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_HEADER_METACHAR</td>
           <td style="text-align: left">Illegal meta character in header</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the values of all headers within the request only contain meta characters defined as allowed in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_HTTP_PROTOCOL</td>
           <td style="text-align: left">HTTP protocol compliance failed</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">This category contains a list of validation checks that the system performs on HTTP requests to ensure that the requests are formatted properly.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_HTTP_RESPONSE_STATUS</td>
           <td style="text-align: left">Illegal HTTP response status</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The server response contains an HTTP status code that is not defined as valid in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_JSON_FORMAT</td>
           <td style="text-align: left">JSON data does not comply with format settings</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains JSON content and complies with the various request limits within the defense configuration in the security policy&rsquo;s JSON profile. Enforces valid JSON requests and protects the server from JSON parser attacks. This violation is generated when a problem is detected in a JSON request, generally checking the message according to boundaries such as the message&rsquo;s size and meta characters in parameter value.</td>
           <td style="text-align: left">Controlled from the default JSON profile.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_JSON_MALFORMED</td>
           <td style="text-align: left">Malformed JSON data</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request contains JSON content that is well-formed. Enforces parsable JSON requests.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_JSON_SCHEMA</td>
           <td style="text-align: left">JSON data does not comply with JSON schema</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the incoming request contains JSON data that matches the schema file that is part of a JSON profile configured in the security policy. Enforces proper JSON requests defined by the schema.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_MANDATORY_PARAMETER</td>
           <td style="text-align: left">Mandatory parameter is missing</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that parameter marked as mandatory exists in the request.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_MANDATORY_REQUEST_BODY</td>
           <td style="text-align: left">Mandatory request body is missing</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the body exists in the request</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_METHOD</td>
           <td style="text-align: left">Illegal method</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request references an HTTP request method that is found in the security policy. Enforces desired HTTP methods; GET and POST are always allowed.</td>
           <td style="text-align: left">These HTTP methods are supported:<br><ul><li>GET</li><li>HEAD</li><li>POST</li><li>PUT</li><li>PATCH</li><li>DELETE</li><li>OPTIONS</li></ul></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER</td>
           <td style="text-align: left">Illegal parameter</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that every parameter in the request is defined in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_ARRAY_VALUE</td>
           <td style="text-align: left">Illegal parameter array value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The value of an item in an array parameter is not according to the defined data type.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_DATA_TYPE</td>
           <td style="text-align: left">Illegal parameter data type</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a parameter whose data type matches the data type defined in the security policy. The data types that this violation applies to are integer, email, and phone.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_EMPTY_VALUE</td>
           <td style="text-align: left">Illegal empty parameter value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a parameter whose value is not empty when it must contain a value.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_LOCATION</td>
           <td style="text-align: left">Illegal parameter location</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The parameter was found in a different location than it was configured in the policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_MULTIPART_NULL_VALUE</td>
           <td style="text-align: left">Null in multi-part parameter value</td>
           <td style="text-align: left">Disabled</td>
           <td style="text-align: left">The system checks that the multi-part request has a parameter value that does not contain the NULL character (0x00). If a multipart parameter with binary content type contains NULL in its value, the Enforcer issues this violation. The exceptions to this are:<br><ul><li>If that parameter is configured in the policy as <code>Ignore value</code>.</li><li>If that parameter is configured in the security policy as <code>user-input file-upload</code>.</li><li>If the parameter has a content-type that contains the string &lsquo;XML&rsquo; and the parameter value contains a valid UTF16 encoded XML document (the encoding is valid). In this case NULL is allowed as it is part of the UTF16 encoding.</li></ul></td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_NAME_METACHAR</td>
           <td style="text-align: left">Illegal meta character in parameter name</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that all parameter names within the incoming request only contain meta characters defined as allowed in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_NUMERIC_VALUE</td>
           <td style="text-align: left">Illegal parameter numeric value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the incoming request contains a parameter whose value is in the range of decimal or integer values defined in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_REPEATED</td>
           <td style="text-align: left">Illegal repeated parameter name</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">Detected multiple parameters of the same name in a single HTTP request.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_STATIC_VALUE</td>
           <td style="text-align: left">Illegal static parameter value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a static parameter whose value is defined in the security policy. Prevents static parameter change. NGINX App Protect WAF can be configured to block parameter values that are not in a predefined list. Parameters can be defined on each of the following levels: file type, URL, and flow. Each parameter can be one of the following types: explicit or wildcard.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_VALUE_BASE64</td>
           <td style="text-align: left">Illegal Base64 value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the value is a valid Base64 string. If the value is indeed Base64, the system decodes this value and continues with its security checks.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_VALUE_LENGTH</td>
           <td style="text-align: left">Illegal parameter value length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a parameter whose value length (in bytes) matches the value length defined in the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_VALUE_METACHAR</td>
           <td style="text-align: left">Illegal meta character in value</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that all parameter values, XML element/attribute values, or JSON values within the request only contain meta characters defined as allowed in the security policy. Enforces proper input values. In case of a violation, the reported value represents the decimal ASCII value (metachar_index), or, in case of using &ldquo;json_log&rdquo; the hexadecimal ASCII value (metachar) of the violating character.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_PARAMETER_VALUE_REGEXP</td>
           <td style="text-align: left">Parameter value does not comply with regular expression</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains an alphanumeric parameter value that matches the expected pattern specified by the regular-expression field for that parameter. Prevents HTTP requests which do not comply with a defined pattern. NGINX App Protect WAF lets you set up a regular expression to block requests where a parameter value does not match the regular expression.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_POST_DATA_LENGTH</td>
           <td style="text-align: left">Illegal POST data length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains POST data whose length does not exceed the acceptable length specified in the security policy.</td>
           <td style="text-align: left">In * file type entity. This check is disabled by default.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_QUERY_STRING_LENGTH</td>
           <td style="text-align: left">Illegal query string length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains a query string whose length does not exceed the acceptable length specified in the security policy.</td>
           <td style="text-align: left">In * file type entity. Actual size is 2 KB.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_RATING_THREAT</td>
           <td style="text-align: left">Request is likely a threat</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The combination of violations in this request determined that the request is likely to be a threat.</td>
           <td style="text-align: left">For VR = 4 or 5</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_RATING_NEED_EXAMINATION</td>
           <td style="text-align: left">Request needs further examination</td>
           <td style="text-align: left">Disabled</td>
           <td style="text-align: left">The combination of violations could not determine whether the request is a threat or violations are false positives thus requiring more examination.</td>
           <td style="text-align: left">For VR = 3</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_REQUEST_LENGTH</td>
           <td style="text-align: left">Illegal request length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request length does not exceed the  acceptable length specified in the security policy per the requested file type.</td>
           <td style="text-align: left">In * file type entity. This check is disabled by default.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_REQUEST_MAX_LENGTH</td>
           <td style="text-align: left">Request length exceeds defined buffer size</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request length is not larger than the maximum memory buffer size. Note that this protects NGINX App Protect WAF from consuming too much memory across all security policies which are active on the device.</td>
           <td style="text-align: left">Default is 10MB</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_RULE</td>
           <td style="text-align: left">Actionable override rule was triggered.</td>
           <td style="text-align: left">Disabled</td>
           <td style="text-align: left">A policy override rule with an action was triggered.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_THREAT_CAMPAIGN</td>
           <td style="text-align: left">Threat Campaign detected</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system examines the HTTP message for known threat campaigns by matching it against known attack patterns.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_URL</td>
           <td style="text-align: left">Illegal URL</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the requested URL is configured as a valid URL, or not configured as an invalid URL, within the security policy.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_URL_CONTENT_TYPE</td>
           <td style="text-align: left">Illegal request content type</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The URL in the security policy has a <code>Header-Based Content Profiles</code> setting that disallows the request because the specified HTTP header or the default is set to <code>disallow</code>.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_URL_LENGTH</td>
           <td style="text-align: left">Illegal URL length</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request is for a URL whose length does not exceed the acceptable length specified in the security policy.</td>
           <td style="text-align: left">In * file type entity. Actual size is 2 KB.</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_URL_METACHAR</td>
           <td style="text-align: left">Illegal meta character in URL</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the incoming request includes a URL that contains only meta characters defined as allowed in the security policy. Enforces a desired set of acceptable characters.</td>
           <td style="text-align: left"></td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_XML_FORMAT</td>
           <td style="text-align: left">XML data does not comply with format settings</td>
           <td style="text-align: left">Alarm</td>
           <td style="text-align: left">The system checks that the request contains XML data that complies with the various document limits within the defense configuration in the security policy&rsquo;s XML profile. Enforces proper XML requests and the data failed format/defense settings such as the maximum document length.<br>       This violation is generated when a problem in an XML document is detected (for example, an XML bomb), generally checking the message according to boundaries such as the message&rsquo;s size, maximum depth, and maximum number of children.</td>
           <td style="text-align: left">Controlled by the default XML profile</td>
       </tr>
       <tr>
           <td style="text-align: left">VIOL_XML_MALFORMED</td>
           <td style="text-align: left">Malformed XML data</td>
           <td style="text-align: left">Alarm &amp; Block</td>
           <td style="text-align: left">The system checks that the request contains XML data that is well-formed, according to W3C standards. Enforces proper XML requests.</td>
           <td style="text-align: left"></td>
       </tr>
   </tbody>
 </table>
 
 </div>

<h3 
id="http-compliance-sub-violations">HTTP Compliance Sub-Violations  <a class="headerlink float-right" href="#http-compliance-sub-violations" title="HTTP Compliance Sub-Violations"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The following table specifies the HTTP Compliance sub-violation settings. All are supported in NGINX App Protect WAF, but not all are enabled in the default App Protect security template. The table specifies which. Some of the checks are enforced by NGINX Plus and App Protect only gets a notification. <strong>Note:</strong>  In this case, the request is <strong>always</strong> blocked regardless of the App Protect policy.</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Sub-Violation</th>
          <th style="text-align: left">Default Template</th>
          <th style="text-align: left">Enforced by</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Unparsable request content</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">This violation is triggered when the system&rsquo;s parser cannot parse the message.</td>
      </tr>
      <tr>
          <td style="text-align: left">Several Content-Length headers</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">More than one content-length header is a non RFC violation. Indicates an HTTP response splitting attack.</td>
      </tr>
      <tr>
          <td style="text-align: left">POST request with Content-Length: 0</td>
          <td style="text-align: left">Disabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">POST request is usually sent with request body. This sub-violation is issued when a request has empty or no body at all.</td>
      </tr>
      <tr>
          <td style="text-align: left">Null in request</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Null in header - NGINX, null in body - App Protect</td>
          <td style="text-align: left">The system issues a violation for requests with a NULL character anywhere in the request (except for a NULL in the binary part of a multipart request).</td>
      </tr>
      <tr>
          <td style="text-align: left">No Host header in HTTP/1.1 request</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">Examines requests using HTTP/1.1 to see whether they contain a &ldquo;Host&rdquo; header.</td>
      </tr>
      <tr>
          <td style="text-align: left">Multiple host headers</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">Examines requests to ensure that they contain only a single &ldquo;Host&rdquo; header.</td>
      </tr>
      <tr>
          <td style="text-align: left">Host header contains IP address</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system verifies that the request&rsquo;s host header value is not an IP address to prevent non-standard requests.</td>
      </tr>
      <tr>
          <td style="text-align: left">High ASCII characters in headers</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">Checks for high ASCII characters in headers (greater than 127).</td>
      </tr>
      <tr>
          <td style="text-align: left">Header name with no header value</td>
          <td style="text-align: left">Disabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system checks for a header name without a header value.</td>
      </tr>
      <tr>
          <td style="text-align: left">CRLF characters before request start</td>
          <td style="text-align: left">N/A</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left"><strong>Note:</strong> NGINX strips any CRLF characters before the request method. The system <strong>DOES NOT</strong> issue a violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Content length should be a positive number</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">The Content-Length header value should be greater than zero; only a numeric positive number value is accepted.</td>
      </tr>
      <tr>
          <td style="text-align: left">Chunked request with Content-Length header</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system checks for a Content-Length header within chunked requests.</td>
      </tr>
      <tr>
          <td style="text-align: left">Check maximum number of parameters</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system compares the number of parameters in the request to the maximum configured number of parameters. When enabled, the default value for number of maximum number of parameters is 500.</td>
      </tr>
      <tr>
          <td style="text-align: left">Check maximum number of headers</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system compares the request headers to the maximal configured number of headers.</td>
      </tr>
      <tr>
          <td style="text-align: left">Unescaped space in URL</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system checks that there is no unescaped space within the URL in the request line. Such spaces split URLs introducing ambiguity on picking the actual one. when enabled, the default value for number of unescaped space in URL is 50.</td>
      </tr>
      <tr>
          <td style="text-align: left">Body in GET or HEAD requests</td>
          <td style="text-align: left">Disabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">Examines GET and HEAD requests which have a body.</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad multipart/form-data request parsing</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">When the content type of a request header contains the substring &ldquo;Multipart/form-data&rdquo;, the system checks whether each multipart request chunk contains the strings &ldquo;Content-Disposition&rdquo; and &ldquo;Name&rdquo;. If they do not, the system issues a violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad multipart parameters parsing</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system checks the following:<ol><li>A boundary follows immediately after request headers.</li><li>The parameter value matches the format: &rsquo;name=&ldquo;param_key&rdquo;;\r\n.</li><li>A chunked body contains at least one CRLF.</li><li>A chunked body ends with CRLF.</li><li>Final boundary was found on multipart request.</li><li>There is no payload after final boundary.</li></ol><br><br> If one of these is false, the system issues a violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad HTTP version</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">Enforces legal HTTP version number (only 0.9 or higher allowed).</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad host header value</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">Detected non RFC compliant header value.</td>
      </tr>
      <tr>
          <td style="text-align: left">Check maximum number of cookies</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system compares the request cookies to the maximal configured number of cookies. When enabled, the default value for number of maximum cookies if unmodified is 100.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Sub-Violation</th>
          <th style="text-align: left">Default Template</th>
          <th style="text-align: left">Enforced by</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Unparsable request content</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">This violation is triggered when the system&rsquo;s parser cannot parse the message.</td>
      </tr>
      <tr>
          <td style="text-align: left">Several Content-Length headers</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">More than one content-length header is a non RFC violation. Indicates an HTTP response splitting attack.</td>
      </tr>
      <tr>
          <td style="text-align: left">POST request with Content-Length: 0</td>
          <td style="text-align: left">Disabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">POST request is usually sent with request body. This sub-violation is issued when a request has empty or no body at all.</td>
      </tr>
      <tr>
          <td style="text-align: left">Null in request</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Null in header - NGINX, null in body - App Protect</td>
          <td style="text-align: left">The system issues a violation for requests with a NULL character anywhere in the request (except for a NULL in the binary part of a multipart request).</td>
      </tr>
      <tr>
          <td style="text-align: left">No Host header in HTTP/1.1 request</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">Examines requests using HTTP/1.1 to see whether they contain a &ldquo;Host&rdquo; header.</td>
      </tr>
      <tr>
          <td style="text-align: left">Multiple host headers</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">Examines requests to ensure that they contain only a single &ldquo;Host&rdquo; header.</td>
      </tr>
      <tr>
          <td style="text-align: left">Host header contains IP address</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system verifies that the request&rsquo;s host header value is not an IP address to prevent non-standard requests.</td>
      </tr>
      <tr>
          <td style="text-align: left">High ASCII characters in headers</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">Checks for high ASCII characters in headers (greater than 127).</td>
      </tr>
      <tr>
          <td style="text-align: left">Header name with no header value</td>
          <td style="text-align: left">Disabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system checks for a header name without a header value.</td>
      </tr>
      <tr>
          <td style="text-align: left">CRLF characters before request start</td>
          <td style="text-align: left">N/A</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left"><strong>Note:</strong> NGINX strips any CRLF characters before the request method. The system <strong>DOES NOT</strong> issue a violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Content length should be a positive number</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">The Content-Length header value should be greater than zero; only a numeric positive number value is accepted.</td>
      </tr>
      <tr>
          <td style="text-align: left">Chunked request with Content-Length header</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system checks for a Content-Length header within chunked requests.</td>
      </tr>
      <tr>
          <td style="text-align: left">Check maximum number of parameters</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system compares the number of parameters in the request to the maximum configured number of parameters. When enabled, the default value for number of maximum number of parameters is 500.</td>
      </tr>
      <tr>
          <td style="text-align: left">Check maximum number of headers</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system compares the request headers to the maximal configured number of headers.</td>
      </tr>
      <tr>
          <td style="text-align: left">Unescaped space in URL</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system checks that there is no unescaped space within the URL in the request line. Such spaces split URLs introducing ambiguity on picking the actual one. when enabled, the default value for number of unescaped space in URL is 50.</td>
      </tr>
      <tr>
          <td style="text-align: left">Body in GET or HEAD requests</td>
          <td style="text-align: left">Disabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">Examines GET and HEAD requests which have a body.</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad multipart/form-data request parsing</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">When the content type of a request header contains the substring &ldquo;Multipart/form-data&rdquo;, the system checks whether each multipart request chunk contains the strings &ldquo;Content-Disposition&rdquo; and &ldquo;Name&rdquo;. If they do not, the system issues a violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad multipart parameters parsing</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system checks the following:<ol><li>A boundary follows immediately after request headers.</li><li>The parameter value matches the format: &rsquo;name=&ldquo;param_key&rdquo;;\r\n.</li><li>A chunked body contains at least one CRLF.</li><li>A chunked body ends with CRLF.</li><li>Final boundary was found on multipart request.</li><li>There is no payload after final boundary.</li></ol><br><br> If one of these is false, the system issues a violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad HTTP version</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">Enforces legal HTTP version number (only 0.9 or higher allowed).</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad host header value</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">NGINX</td>
          <td style="text-align: left">Detected non RFC compliant header value.</td>
      </tr>
      <tr>
          <td style="text-align: left">Check maximum number of cookies</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">App Protect</td>
          <td style="text-align: left">The system compares the request cookies to the maximal configured number of cookies. When enabled, the default value for number of maximum cookies if unmodified is 100.</td>
      </tr>
  </tbody>
</table>

</div>

<h3 
id="evasion-techniques-sub-violations">Evasion Techniques Sub-Violations  <a class="headerlink float-right" href="#evasion-techniques-sub-violations" title="Evasion Techniques Sub-Violations"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The following table specifies the Evasion Techniques sub-violation settings. All are supported in NGINX App Protect WAF.</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Sub-Violation</th>
          <th style="text-align: left">Default Template</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">%u decoding</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Performs Microsoft %u unicode decoding (%UXXXX where X is a hexadecimal digit). For example, the system turns a%u002fb to a/b. The system performs this action on URI and parameter input to evaluate if the request contains an attack.</td>
      </tr>
      <tr>
          <td style="text-align: left">Apache whitespace</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">The system detects the following characters in the URI: 9 (0x09), 11 (0x0B), 12 (0x0C), and 13 (0x0D).</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad unescape</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">The system detects illegal HEX encoding. Reports unescaping errors (such as %RR).</td>
      </tr>
      <tr>
          <td style="text-align: left">Bare byte decoding</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">The system detects higher ASCII bytes (greater than 127).</td>
      </tr>
      <tr>
          <td style="text-align: left">Directory traversals</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Ensures that directory traversal commands like ../ are not part of the URL. While requests generated by a browser should not contain directory traversal instructions, sometimes requests generated by JavaScript have them.</td>
      </tr>
      <tr>
          <td style="text-align: left">IIS backslashes</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Normalizes backslashes (\) to slashes (/) for further processing.</td>
      </tr>
      <tr>
          <td style="text-align: left">IIS Unicode codepoints</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Handles the mapping of IIS specific non-ASCII codepoints. Indicates that, when a character is greater than &lsquo;0x00FF&rsquo;, the system decodes %u according to an ANSI Latin 1 (Windows 1252) code page mapping. For example, the system turns a%u2044b to a/b. The system performs this action on URI and parameter input.</td>
      </tr>
      <tr>
          <td style="text-align: left">Multiple decoding</td>
          <td style="text-align: left">Enabled: 3</td>
          <td style="text-align: left">The system decodes URI and parameter values multiple times according to the number specified before the request is considered an evasion.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Sub-Violation</th>
          <th style="text-align: left">Default Template</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">%u decoding</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Performs Microsoft %u unicode decoding (%UXXXX where X is a hexadecimal digit). For example, the system turns a%u002fb to a/b. The system performs this action on URI and parameter input to evaluate if the request contains an attack.</td>
      </tr>
      <tr>
          <td style="text-align: left">Apache whitespace</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">The system detects the following characters in the URI: 9 (0x09), 11 (0x0B), 12 (0x0C), and 13 (0x0D).</td>
      </tr>
      <tr>
          <td style="text-align: left">Bad unescape</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">The system detects illegal HEX encoding. Reports unescaping errors (such as %RR).</td>
      </tr>
      <tr>
          <td style="text-align: left">Bare byte decoding</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">The system detects higher ASCII bytes (greater than 127).</td>
      </tr>
      <tr>
          <td style="text-align: left">Directory traversals</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Ensures that directory traversal commands like ../ are not part of the URL. While requests generated by a browser should not contain directory traversal instructions, sometimes requests generated by JavaScript have them.</td>
      </tr>
      <tr>
          <td style="text-align: left">IIS backslashes</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Normalizes backslashes (\) to slashes (/) for further processing.</td>
      </tr>
      <tr>
          <td style="text-align: left">IIS Unicode codepoints</td>
          <td style="text-align: left">Enabled</td>
          <td style="text-align: left">Handles the mapping of IIS specific non-ASCII codepoints. Indicates that, when a character is greater than &lsquo;0x00FF&rsquo;, the system decodes %u according to an ANSI Latin 1 (Windows 1252) code page mapping. For example, the system turns a%u2044b to a/b. The system performs this action on URI and parameter input.</td>
      </tr>
      <tr>
          <td style="text-align: left">Multiple decoding</td>
          <td style="text-align: left">Enabled: 3</td>
          <td style="text-align: left">The system decodes URI and parameter values multiple times according to the number specified before the request is considered an evasion.</td>
      </tr>
  </tbody>
</table>

</div>

<h2 
id="attack-types">Attack Types  <a class="headerlink float-right" href="#attack-types" title="Attack Types"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Each signature, factory or user-defined, and violation has an <strong>Attack Type</strong>, the attack vector it protects from. When you create a user-defined signature you associate it with the most appropriate attack type from the list below. If you do not find an Attack Type that matches the threat for which your signature was written, use <code>Other Application Activity</code> Attack Type. Attach Types are also useful as part of the filter in user-defined signature <strong>sets</strong>.</p>
<p>Following is the full list of Attack Types supported in App Protect. Use the <strong>name</strong> of the Attack Type to reference it within the signature or signature set filter.</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Attack Type Name</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Abuse of Functionality</td>
          <td style="text-align: left">Abuse of Functionality is an attack technique that uses a web site&rsquo;s own features and functionality to consume, defraud, or circumvent access controls mechanisms.</td>
      </tr>
      <tr>
          <td style="text-align: left">Authentication/Authorization Attacks</td>
          <td style="text-align: left">Authentication/Authorization Attacks occur when a web site permits an attacker to access sensitive content or functionality without having to properly authenticate, or authorize, that resource.</td>
      </tr>
      <tr>
          <td style="text-align: left">Buffer Overflow</td>
          <td style="text-align: left">Buffer Overflow could be triggered when data written to memory exceeds the allocated size of the buffer for that data. This could lead to the Denial of Service or arbitrary code execution.</td>
      </tr>
      <tr>
          <td style="text-align: left">Cache Poisoning</td>
          <td style="text-align: left">Cache poisoning is an attack against the integrity of an intermediate Web cache repository, in which genuine content cached for an arbitrary URL is replaced with spoofed content.</td>
      </tr>
      <tr>
          <td style="text-align: left">Command Execution</td>
          <td style="text-align: left">Web applications can be tricked to execute operating system commands, injected from a remote machine, if user supplied input is not properly checked by the web application.</td>
      </tr>
      <tr>
          <td style="text-align: left">Cross-site Request Forgery</td>
          <td style="text-align: left">An attacker exploits the web application&rsquo;s assumption and trust that the authenticated user is purposely sending requests to perform actions or commands, while in fact the attacker is causing the user to send the commands without the user&rsquo;s knowledge or consent.</td>
      </tr>
      <tr>
          <td style="text-align: left">Cross Site Scripting (XSS)</td>
          <td style="text-align: left">Cross Site Scripting (XSS) occurs when a web application does not sanitize user-supplied input and places it directly into the page returned to the user. Usually, the attacker will submit malicious JavaScript, VBScript, ActiveX, HTML, or Flash code to the vulnerable web site.</td>
      </tr>
      <tr>
          <td style="text-align: left">Denial of Service</td>
          <td style="text-align: left">A denial-of-service (DoS) attack represents a family of attacks aimed to exhaust the application server resources up to a point that the application cannot respond to legitimate traffic, either because it has crashed, or because its slow response renders it effectively unavailable.</td>
      </tr>
      <tr>
          <td style="text-align: left">Detection Evasion</td>
          <td style="text-align: left">An attempt is made to evade detection of the attack on a web server, by obfuscating the attack using various methods such as encodings and path manipulation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Directory Indexing</td>
          <td style="text-align: left">This is a directory listing attempt which can lead to information disclosure and possible exposure of sensitive system information. Directory Indexing attacks usually target web servers that are not correctly configured, or which have a vulnerable component that allows Directory Indexing.</td>
      </tr>
      <tr>
          <td style="text-align: left">Forceful Browsing</td>
          <td style="text-align: left">This attack occurs when an attacker is directly accessing a URL, which could grant access to a restricted part of the web site.</td>
      </tr>
      <tr>
          <td style="text-align: left">HTTP Parser Attack</td>
          <td style="text-align: left">HTTP parser attack targets the functionality of the HTTP parser in order to crash it or force the parser to work abnormally.</td>
      </tr>
      <tr>
          <td style="text-align: left">HTTP Request Smuggling Attack</td>
          <td style="text-align: left">Specially crafted HTTP messages can manipulate the web server or cache&rsquo;s standard behavior. This can lead to XSS, and cache poisoning.</td>
      </tr>
      <tr>
          <td style="text-align: left">HTTP Response Splitting</td>
          <td style="text-align: left">Specially crafted HTTP messages can manipulate the web server or cache&rsquo;s standard behavior. This can lead to XSS, and cache poisoning.</td>
      </tr>
      <tr>
          <td style="text-align: left">Information Leakage</td>
          <td style="text-align: left">Sensitive information may be present within HTML comments, error messages, source code, or simply left in files which are accessible by remote clients. In addition, attackers can manipulate the application to reveal classified information like credit card numbers. This can lead to the disclosure of sensitive system information which may be used by an attacker to further compromise the system.</td>
      </tr>
      <tr>
          <td style="text-align: left">Insecure Deserialization</td>
          <td style="text-align: left">This is an attack against an application that receives serialized objects. An application which does not restrict which objects might be deserialized could be exploited by attackers sending specific object called &lsquo;gadgets&rsquo;, that could trigger arbitrary code execution when deserialized.</td>
      </tr>
      <tr>
          <td style="text-align: left">Insecure File Upload</td>
          <td style="text-align: left">Many applications allow uploading files to the server, such as images or documents. An application that does not correctly restrict the type of the uploaded files or the upload folder path can be exploited by attackers to upload files, called &lsquo;WebShells&rsquo;, containing malicious code that later will be executed or override the server configuration.</td>
      </tr>
      <tr>
          <td style="text-align: left">JSON Parser Attack</td>
          <td style="text-align: left">This attack targets the functionality of the JSON parser in order to crash it or force the parser to work abnormally.</td>
      </tr>
      <tr>
          <td style="text-align: left">LDAP Injection</td>
          <td style="text-align: left">If user-supplied input is not correctly sanitized, the attacker could change the construction of LDAP statements. Successful exploitation results in information gathering, system integrity compromise, and possible modification of the LDAP tree.</td>
      </tr>
      <tr>
          <td style="text-align: left">Malicious File Upload</td>
          <td style="text-align: left">Malicious file upload occurs when a user tries to upload a malicious file to the web application. This could allow remote attackers to cause Server Infection, Network Infection, Buffer Overflow and Remote Comma Execution.</td>
      </tr>
      <tr>
          <td style="text-align: left">Non-browser Client</td>
          <td style="text-align: left">An attempt is made by a non-browser client to explore the site.</td>
      </tr>
      <tr>
          <td style="text-align: left">Other Application Attacks</td>
          <td style="text-align: left">This is an attack which targets the web application and does not fall in any predefined category.</td>
      </tr>
      <tr>
          <td style="text-align: left">Parameter Tampering</td>
          <td style="text-align: left">By changing certain parameters in a URL or web page form, attackers can successfully attack the web application business logic.</td>
      </tr>
      <tr>
          <td style="text-align: left">Path Traversal</td>
          <td style="text-align: left">Path traversal can be used to bypass the web server root and request various files, including system files or private directories and resources. This attack can lead to information disclosure, and possible exposure of sensitive system information.</td>
      </tr>
      <tr>
          <td style="text-align: left">Predictable Resource Location</td>
          <td style="text-align: left">By making educated guesses, the attacker could discover hidden web site content and functionality, such as configuration, temporary, backup, or sample files. This can lead to the disclosure of sensitive system information which may be used by an attacker to compromise the system.</td>
      </tr>
      <tr>
          <td style="text-align: left">Remote File Include</td>
          <td style="text-align: left">Remote File Inclusion attacks allow attackers to run arbitrary code on a vulnerable website.</td>
      </tr>
      <tr>
          <td style="text-align: left">Server Side Code Injection</td>
          <td style="text-align: left">An attacker can submit server-side code by invalidated input. The web server, when parsing malicious input, may execute operating system commands or access restricted files.</td>
      </tr>
      <tr>
          <td style="text-align: left">Server-Side Request Forgery (SSRF)</td>
          <td style="text-align: left">Some applications receive a URL as input and use it to exchange data with another service. An attacker could provide special URLs to read or update internal resources such as localhost services, cloud metadata servers, internal network web applications or HTTP enabled databases.</td>
      </tr>
      <tr>
          <td style="text-align: left">Server-Side Template Injection</td>
          <td style="text-align: left">Some applications use server-side templates for better modularity. This attack occurs when a non-sanitized input containing template directives is embedded into a server-side template which then leads to execution of the injected code when rendered.</td>
      </tr>
      <tr>
          <td style="text-align: left">Session Hijacking</td>
          <td style="text-align: left">An attacker can steal a valid web session from legitimate users in order to gain unauthorized access.</td>
      </tr>
      <tr>
          <td style="text-align: left">SQL-Injection</td>
          <td style="text-align: left">SQL-Injection occurs when a web application does not sanitize user-supplied input, and places it directly into the SQL statement. This attack allows remote attackers to run SQL statements on the internal database.</td>
      </tr>
      <tr>
          <td style="text-align: left">Trojan/Backdoor/Spyware</td>
          <td style="text-align: left">This is an attack initiated by some form of malicious code.</td>
      </tr>
      <tr>
          <td style="text-align: left">Vulnerability Scan</td>
          <td style="text-align: left">An attempt is made using an automatic tool to scan a web server, or an application running on a web server, for a possible vulnerability.</td>
      </tr>
      <tr>
          <td style="text-align: left">XML External Entities (XXE)</td>
          <td style="text-align: left">This is a type of attack against an application that parses XML input. This attack occurs when XML input containing a reference to an external entity is processed by a weakly configured XML parser.</td>
      </tr>
      <tr>
          <td style="text-align: left">XML Parser Attack</td>
          <td style="text-align: left">This attack targets the functionality of the XML parser in order to crash it or force the parser to work abnormally.</td>
      </tr>
      <tr>
          <td style="text-align: left">XPath Injection</td>
          <td style="text-align: left">XPath-Injection occurs when a web application does not sanitize user-supplied input but places it directly into the XML document query. Successful exploitation results in information gathering and system integrity compromise.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Attack Type Name</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Abuse of Functionality</td>
          <td style="text-align: left">Abuse of Functionality is an attack technique that uses a web site&rsquo;s own features and functionality to consume, defraud, or circumvent access controls mechanisms.</td>
      </tr>
      <tr>
          <td style="text-align: left">Authentication/Authorization Attacks</td>
          <td style="text-align: left">Authentication/Authorization Attacks occur when a web site permits an attacker to access sensitive content or functionality without having to properly authenticate, or authorize, that resource.</td>
      </tr>
      <tr>
          <td style="text-align: left">Buffer Overflow</td>
          <td style="text-align: left">Buffer Overflow could be triggered when data written to memory exceeds the allocated size of the buffer for that data. This could lead to the Denial of Service or arbitrary code execution.</td>
      </tr>
      <tr>
          <td style="text-align: left">Cache Poisoning</td>
          <td style="text-align: left">Cache poisoning is an attack against the integrity of an intermediate Web cache repository, in which genuine content cached for an arbitrary URL is replaced with spoofed content.</td>
      </tr>
      <tr>
          <td style="text-align: left">Command Execution</td>
          <td style="text-align: left">Web applications can be tricked to execute operating system commands, injected from a remote machine, if user supplied input is not properly checked by the web application.</td>
      </tr>
      <tr>
          <td style="text-align: left">Cross-site Request Forgery</td>
          <td style="text-align: left">An attacker exploits the web application&rsquo;s assumption and trust that the authenticated user is purposely sending requests to perform actions or commands, while in fact the attacker is causing the user to send the commands without the user&rsquo;s knowledge or consent.</td>
      </tr>
      <tr>
          <td style="text-align: left">Cross Site Scripting (XSS)</td>
          <td style="text-align: left">Cross Site Scripting (XSS) occurs when a web application does not sanitize user-supplied input and places it directly into the page returned to the user. Usually, the attacker will submit malicious JavaScript, VBScript, ActiveX, HTML, or Flash code to the vulnerable web site.</td>
      </tr>
      <tr>
          <td style="text-align: left">Denial of Service</td>
          <td style="text-align: left">A denial-of-service (DoS) attack represents a family of attacks aimed to exhaust the application server resources up to a point that the application cannot respond to legitimate traffic, either because it has crashed, or because its slow response renders it effectively unavailable.</td>
      </tr>
      <tr>
          <td style="text-align: left">Detection Evasion</td>
          <td style="text-align: left">An attempt is made to evade detection of the attack on a web server, by obfuscating the attack using various methods such as encodings and path manipulation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Directory Indexing</td>
          <td style="text-align: left">This is a directory listing attempt which can lead to information disclosure and possible exposure of sensitive system information. Directory Indexing attacks usually target web servers that are not correctly configured, or which have a vulnerable component that allows Directory Indexing.</td>
      </tr>
      <tr>
          <td style="text-align: left">Forceful Browsing</td>
          <td style="text-align: left">This attack occurs when an attacker is directly accessing a URL, which could grant access to a restricted part of the web site.</td>
      </tr>
      <tr>
          <td style="text-align: left">HTTP Parser Attack</td>
          <td style="text-align: left">HTTP parser attack targets the functionality of the HTTP parser in order to crash it or force the parser to work abnormally.</td>
      </tr>
      <tr>
          <td style="text-align: left">HTTP Request Smuggling Attack</td>
          <td style="text-align: left">Specially crafted HTTP messages can manipulate the web server or cache&rsquo;s standard behavior. This can lead to XSS, and cache poisoning.</td>
      </tr>
      <tr>
          <td style="text-align: left">HTTP Response Splitting</td>
          <td style="text-align: left">Specially crafted HTTP messages can manipulate the web server or cache&rsquo;s standard behavior. This can lead to XSS, and cache poisoning.</td>
      </tr>
      <tr>
          <td style="text-align: left">Information Leakage</td>
          <td style="text-align: left">Sensitive information may be present within HTML comments, error messages, source code, or simply left in files which are accessible by remote clients. In addition, attackers can manipulate the application to reveal classified information like credit card numbers. This can lead to the disclosure of sensitive system information which may be used by an attacker to further compromise the system.</td>
      </tr>
      <tr>
          <td style="text-align: left">Insecure Deserialization</td>
          <td style="text-align: left">This is an attack against an application that receives serialized objects. An application which does not restrict which objects might be deserialized could be exploited by attackers sending specific object called &lsquo;gadgets&rsquo;, that could trigger arbitrary code execution when deserialized.</td>
      </tr>
      <tr>
          <td style="text-align: left">Insecure File Upload</td>
          <td style="text-align: left">Many applications allow uploading files to the server, such as images or documents. An application that does not correctly restrict the type of the uploaded files or the upload folder path can be exploited by attackers to upload files, called &lsquo;WebShells&rsquo;, containing malicious code that later will be executed or override the server configuration.</td>
      </tr>
      <tr>
          <td style="text-align: left">JSON Parser Attack</td>
          <td style="text-align: left">This attack targets the functionality of the JSON parser in order to crash it or force the parser to work abnormally.</td>
      </tr>
      <tr>
          <td style="text-align: left">LDAP Injection</td>
          <td style="text-align: left">If user-supplied input is not correctly sanitized, the attacker could change the construction of LDAP statements. Successful exploitation results in information gathering, system integrity compromise, and possible modification of the LDAP tree.</td>
      </tr>
      <tr>
          <td style="text-align: left">Malicious File Upload</td>
          <td style="text-align: left">Malicious file upload occurs when a user tries to upload a malicious file to the web application. This could allow remote attackers to cause Server Infection, Network Infection, Buffer Overflow and Remote Comma Execution.</td>
      </tr>
      <tr>
          <td style="text-align: left">Non-browser Client</td>
          <td style="text-align: left">An attempt is made by a non-browser client to explore the site.</td>
      </tr>
      <tr>
          <td style="text-align: left">Other Application Attacks</td>
          <td style="text-align: left">This is an attack which targets the web application and does not fall in any predefined category.</td>
      </tr>
      <tr>
          <td style="text-align: left">Parameter Tampering</td>
          <td style="text-align: left">By changing certain parameters in a URL or web page form, attackers can successfully attack the web application business logic.</td>
      </tr>
      <tr>
          <td style="text-align: left">Path Traversal</td>
          <td style="text-align: left">Path traversal can be used to bypass the web server root and request various files, including system files or private directories and resources. This attack can lead to information disclosure, and possible exposure of sensitive system information.</td>
      </tr>
      <tr>
          <td style="text-align: left">Predictable Resource Location</td>
          <td style="text-align: left">By making educated guesses, the attacker could discover hidden web site content and functionality, such as configuration, temporary, backup, or sample files. This can lead to the disclosure of sensitive system information which may be used by an attacker to compromise the system.</td>
      </tr>
      <tr>
          <td style="text-align: left">Remote File Include</td>
          <td style="text-align: left">Remote File Inclusion attacks allow attackers to run arbitrary code on a vulnerable website.</td>
      </tr>
      <tr>
          <td style="text-align: left">Server Side Code Injection</td>
          <td style="text-align: left">An attacker can submit server-side code by invalidated input. The web server, when parsing malicious input, may execute operating system commands or access restricted files.</td>
      </tr>
      <tr>
          <td style="text-align: left">Server-Side Request Forgery (SSRF)</td>
          <td style="text-align: left">Some applications receive a URL as input and use it to exchange data with another service. An attacker could provide special URLs to read or update internal resources such as localhost services, cloud metadata servers, internal network web applications or HTTP enabled databases.</td>
      </tr>
      <tr>
          <td style="text-align: left">Server-Side Template Injection</td>
          <td style="text-align: left">Some applications use server-side templates for better modularity. This attack occurs when a non-sanitized input containing template directives is embedded into a server-side template which then leads to execution of the injected code when rendered.</td>
      </tr>
      <tr>
          <td style="text-align: left">Session Hijacking</td>
          <td style="text-align: left">An attacker can steal a valid web session from legitimate users in order to gain unauthorized access.</td>
      </tr>
      <tr>
          <td style="text-align: left">SQL-Injection</td>
          <td style="text-align: left">SQL-Injection occurs when a web application does not sanitize user-supplied input, and places it directly into the SQL statement. This attack allows remote attackers to run SQL statements on the internal database.</td>
      </tr>
      <tr>
          <td style="text-align: left">Trojan/Backdoor/Spyware</td>
          <td style="text-align: left">This is an attack initiated by some form of malicious code.</td>
      </tr>
      <tr>
          <td style="text-align: left">Vulnerability Scan</td>
          <td style="text-align: left">An attempt is made using an automatic tool to scan a web server, or an application running on a web server, for a possible vulnerability.</td>
      </tr>
      <tr>
          <td style="text-align: left">XML External Entities (XXE)</td>
          <td style="text-align: left">This is a type of attack against an application that parses XML input. This attack occurs when XML input containing a reference to an external entity is processed by a weakly configured XML parser.</td>
      </tr>
      <tr>
          <td style="text-align: left">XML Parser Attack</td>
          <td style="text-align: left">This attack targets the functionality of the XML parser in order to crash it or force the parser to work abnormally.</td>
      </tr>
      <tr>
          <td style="text-align: left">XPath Injection</td>
          <td style="text-align: left">XPath-Injection occurs when a web application does not sanitize user-supplied input but places it directly into the XML document query. Successful exploitation results in information gathering and system integrity compromise.</td>
      </tr>
  </tbody>
</table>

</div>

<h2 
id="converter-tools">Converter Tools  <a class="headerlink float-right" href="#converter-tools" title="Converter Tools"><i class="fas fa-link fa-xs"></i></a>
</h2><p>NGINX App Protect WAF includes a number of tools that can be used to facilitate the process of porting existing resources or configuration files from the BIG-IP for use in the NGINX App Protect WAF environment. Note that these tools are available in the compiler package, and do not require a full installation of NGINX App Protect WAF or NGINX Plus.</p>
<h3 
id="policy-converter">Policy Converter  <a class="headerlink float-right" href="#policy-converter" title="Policy Converter"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The Policy Converter tool <code>/opt/app_protect/bin/convert-policy</code> is used for converting XML formatted ASM and Advanced WAF policies to JSON. The converted JSON policy is based on the NGINX App Protect WAF policy base template and contains the minimal diff to it in JSON declarative policy format.</p>
<p>Elements in the XML policy that are not supported in the NGINX App Protect WAF environment will generate warnings. Note that any configuration that is invalid or irrelevant to the NGINX App Protect WAF environment is removed from the exported declarative policy.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> All NGINX App Protect WAF versions support converting XML policies exported from BIG-IP regardless of any version. If the source XML policy has not changed from when it was in use on BIG-IP, then it&rsquo;s always a good idea to convert it with the Policy Converter tool included with the version of NGINX App Protect WAF you are using. This way, as more configuration items from BIG-IP become supported in NGINX App Protect WAF, they will be included in the converted policy. A policy that was converted will work on the same or greater NGINX App Protect WAF version it originally came from.</div>
</blockquote>

<p>The Policy Converter tool has options to include the following elements in a full export:</p>
<ul>
<li>Elements that are the same as the default template policy. (Invalid elements are removed, but no warnings reported.)</li>
<li>Elements that are not supported in the NGINX App Protect WAF environment. (No elements removed and no warnings reported.)</li>
</ul>
<p>The XML policy file can be obtained by exporting the policy from the BIG-IP device on which the policy is currently deployed.</p>
<p>Using the tool:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60a021a8&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f60a021a8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-policy</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-policy</span></span></code></pre></div>
</div><p>Output:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60d27c48&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f60d27c48">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">USAGE:
</span></span><span class="line"><span class="cl">    /opt/app_protect/bin/convert-policy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Required arguments:
</span></span><span class="line"><span class="cl">    --outfile<span class="p">|</span><span class="nv">o</span><span class="o">=</span><span class="s1">&#39;/path/to/policy.json&#39;</span>
</span></span><span class="line"><span class="cl">        File name <span class="k">for</span> where to write exported policy.
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: EXPORT_FILE
</span></span><span class="line"><span class="cl">    --infile<span class="p">|</span><span class="nv">i</span><span class="o">=</span><span class="s1">&#39;/path/to/policy.xml&#39;</span>
</span></span><span class="line"><span class="cl">        Advanced WAF/ASM Security Policy file to convert
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: IMPORT_FILE
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optional arguments:
</span></span><span class="line"><span class="cl">    --format<span class="p">|</span><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">        Desired output format <span class="k">for</span> signature file. Default <span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">        Supported formats: <span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">    --keep-full-configuration
</span></span><span class="line"><span class="cl">        By default the exported policy will only contain elements that are valid <span class="k">for</span> the environment in which this tool is run.
</span></span><span class="line"><span class="cl">        If keep-full-configuration is enabled <span class="k">then</span> the full configuration is retained, including elements that are not supported in NGINX App Protect WAF.
</span></span><span class="line"><span class="cl">    --full-export
</span></span><span class="line"><span class="cl">        By default the exported policy will only contain elements that are different from the default policy template.
</span></span><span class="line"><span class="cl">        If full-export is enabled <span class="k">then</span> all policy elements are included in the <span class="nb">export</span> file.
</span></span><span class="line"><span class="cl">        When this option is selected, no warnings are generated when removing unsupported elements from the exported policy.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optionally, using --help will issue this <span class="nb">help</span> message.</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">USAGE:
</span></span><span class="line"><span class="cl">    /opt/app_protect/bin/convert-policy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Required arguments:
</span></span><span class="line"><span class="cl">    --outfile<span class="p">|</span><span class="nv">o</span><span class="o">=</span><span class="s1">&#39;/path/to/policy.json&#39;</span>
</span></span><span class="line"><span class="cl">        File name <span class="k">for</span> where to write exported policy.
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: EXPORT_FILE
</span></span><span class="line"><span class="cl">    --infile<span class="p">|</span><span class="nv">i</span><span class="o">=</span><span class="s1">&#39;/path/to/policy.xml&#39;</span>
</span></span><span class="line"><span class="cl">        Advanced WAF/ASM Security Policy file to convert
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: IMPORT_FILE
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optional arguments:
</span></span><span class="line"><span class="cl">    --format<span class="p">|</span><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">        Desired output format <span class="k">for</span> signature file. Default <span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">        Supported formats: <span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">    --keep-full-configuration
</span></span><span class="line"><span class="cl">        By default the exported policy will only contain elements that are valid <span class="k">for</span> the environment in which this tool is run.
</span></span><span class="line"><span class="cl">        If keep-full-configuration is enabled <span class="k">then</span> the full configuration is retained, including elements that are not supported in NGINX App Protect WAF.
</span></span><span class="line"><span class="cl">    --full-export
</span></span><span class="line"><span class="cl">        By default the exported policy will only contain elements that are different from the default policy template.
</span></span><span class="line"><span class="cl">        If full-export is enabled <span class="k">then</span> all policy elements are included in the <span class="nb">export</span> file.
</span></span><span class="line"><span class="cl">        When this option is selected, no warnings are generated when removing unsupported elements from the exported policy.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optionally, using --help will issue this <span class="nb">help</span> message.</span></span></code></pre></div>
</div><p>Example of generating a JSON policy suitable for NGINX App Protect WAF usage:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60d629b0&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f60d629b0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-policy -i /path/to/policy.xml -o /path/to/policy.json <span class="p">|</span> jq</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-policy -i /path/to/policy.xml -o /path/to/policy.json <span class="p">|</span> jq</span></span></code></pre></div>
</div><p>Output:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60ebd878&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f60ebd878">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;warnings&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Traffic Learning, Policy Building, and staging are unsupported&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Element &#39;/plain-text-profiles&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_ASM_COOKIE_HIJACKING&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_BLOCKING_CONDITION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_BRUTE_FORCE&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_CONVICTION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_CROSS_ORIGIN_REQUEST&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_CSRF&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_CSRF_EXPIRED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_DYNAMIC_SESSION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_FLOW&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_FLOW_DISALLOWED_INPUT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_FLOW_ENTRY_POINT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_FLOW_MANDATORY_PARAMS&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GEOLOCATION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GRPC_FORMAT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GRPC_METHOD&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GWT_FORMAT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GWT_MALFORMED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_HOSTNAME_MISMATCH&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_LOGIN_URL_BYPASSED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_LOGIN_URL_EXPIRED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_MALICIOUS_DEVICE&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_MALICIOUS_IP&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_PARAMETER_DYNAMIC_VALUE&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_PLAINTEXT_FORMAT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_REDIRECT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_SESSION_AWARENESS&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_VIRUS&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_BAD_REQUEST&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_BINARY_MESSAGE_LENGTH&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_BINARY_MESSAGE_NOT_ALLOWED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_EXTENSION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_FRAMES_PER_MESSAGE_COUNT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_FRAME_LENGTH&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_FRAME_MASKING&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_FRAMING_PROTOCOL&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_TEXT_MESSAGE_NOT_ALLOWED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_TEXT_NULL_VALUE&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_XML_SCHEMA&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_XML_SOAP_ATTACHMENT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_XML_SOAP_METHOD&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_XML_WEB_SERVICES_SECURITY&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/http-protocols/description value &#39;Unparsable request content&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/general/enableEventCorrelation must be &#39;false&#39; (was &#39;true&#39;).&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Element &#39;/websocket-urls&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/protocolIndependent must be &#39;true&#39; (was &#39;false&#39;).&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Element &#39;/redirection-protection&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Element &#39;/gwt-profiles&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/signature-sets/learn value true is unsupported&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;file_size&#34;</span><span class="p">:</span> <span class="mi">24227</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;completed_successfully&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filename&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/policy.json&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;warnings&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Traffic Learning, Policy Building, and staging are unsupported&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Element &#39;/plain-text-profiles&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_ASM_COOKIE_HIJACKING&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_BLOCKING_CONDITION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_BRUTE_FORCE&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_CONVICTION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_CROSS_ORIGIN_REQUEST&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_CSRF&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_CSRF_EXPIRED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_DYNAMIC_SESSION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_FLOW&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_FLOW_DISALLOWED_INPUT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_FLOW_ENTRY_POINT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_FLOW_MANDATORY_PARAMS&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GEOLOCATION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GRPC_FORMAT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GRPC_METHOD&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GWT_FORMAT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_GWT_MALFORMED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_HOSTNAME_MISMATCH&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_LOGIN_URL_BYPASSED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_LOGIN_URL_EXPIRED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_MALICIOUS_DEVICE&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_MALICIOUS_IP&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_PARAMETER_DYNAMIC_VALUE&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_PLAINTEXT_FORMAT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_REDIRECT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_SESSION_AWARENESS&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_VIRUS&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_BAD_REQUEST&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_BINARY_MESSAGE_LENGTH&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_BINARY_MESSAGE_NOT_ALLOWED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_EXTENSION&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_FRAMES_PER_MESSAGE_COUNT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_FRAME_LENGTH&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_FRAME_MASKING&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_FRAMING_PROTOCOL&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_TEXT_MESSAGE_NOT_ALLOWED&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_WEBSOCKET_TEXT_NULL_VALUE&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_XML_SCHEMA&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_XML_SOAP_ATTACHMENT&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_XML_SOAP_METHOD&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/violations/name value &#39;VIOL_XML_WEB_SERVICES_SECURITY&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/blocking-settings/http-protocols/description value &#39;Unparsable request content&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/general/enableEventCorrelation must be &#39;false&#39; (was &#39;true&#39;).&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Element &#39;/websocket-urls&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/protocolIndependent must be &#39;true&#39; (was &#39;false&#39;).&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Element &#39;/redirection-protection&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Element &#39;/gwt-profiles&#39; is unsupported.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/signature-sets/learn value true is unsupported&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;file_size&#34;</span><span class="p">:</span> <span class="mi">24227</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;completed_successfully&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filename&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/policy.json&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>In the above example we piped the output to <code>jq</code> utility (which needs to be installed separately) to get the output with proper indentation.</p>
<p>Example of generating an unmodified JSON policy (may cause warnings/errors when used in NGINX App Protect WAF):</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60ef4b48&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f60ef4b48">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-policy -i /path/to/policy.xml -o /path/to/policy.json --keep-full-configuration</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-policy -i /path/to/policy.xml -o /path/to/policy.json --keep-full-configuration</span></span></code></pre></div>
</div><p>Example of translating a valid NGINX App Protect WAF JSON policy into a full JSON policy including elements from the defaults:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60f27f98&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f60f27f98">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-policy -i /path/to/policy.json -o /path/to/full_policy.json --full-export</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-policy -i /path/to/policy.json -o /path/to/full_policy.json --full-export</span></span></code></pre></div>
</div><p>Note that if the script is run without the required switches and their corresponding arguments, it will display the help message.</p>
<h3 
id="user-defined-signatures-converter">User Defined Signatures Converter  <a class="headerlink float-right" href="#user-defined-signatures-converter" title="User Defined Signatures Converter"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The User Defined Signatures Converter tool <code>/opt/app_protect/bin/convert-signatures</code> takes a User Defined Signatures XML file as input and exports the content as a JSON file suitable for use in an NGINX App Protect WAF environment.</p>
<p>The tool can optionally accept a tag argument as an input. Otherwise, the default tag value <code>user-defined-signatures</code> is assigned to the exported JSON file.</p>
<p>Note that the User Defined signatures XML file can be obtained by exporting the signatures from a BIG-IP device.</p>
<p>Using the tool:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f60f513c0&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f60f513c0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-signatures</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-signatures</span></span></code></pre></div>
</div><p>Output:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f610adde0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f610adde0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">USAGE:
</span></span><span class="line"><span class="cl">    /opt/app_protect/bin/convert-signatures
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Required arguments:
</span></span><span class="line"><span class="cl">    --outfile<span class="p">|</span><span class="nv">o</span><span class="o">=</span><span class="s1">&#39;/path/to/signatures.json&#39;</span>
</span></span><span class="line"><span class="cl">        File name to write JSON format <span class="nb">export</span>
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: EXPORT_FILE
</span></span><span class="line"><span class="cl">    --infile<span class="p">|</span><span class="nv">i</span><span class="o">=</span><span class="s1">&#39;/path/to/signatures.xml&#39;</span>
</span></span><span class="line"><span class="cl">        Advanced WAF/ASM User Defined Signatures file to Convert
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: IMPORT_FILE
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optional arguments:
</span></span><span class="line"><span class="cl">    --tag<span class="p">|</span><span class="nv">t</span><span class="o">=</span><span class="s1">&#39;mytag&#39;</span>
</span></span><span class="line"><span class="cl">        Signature Tag to associate with User Defined Signatures.
</span></span><span class="line"><span class="cl">        If no tag is specified in the XML file, a default tag of <span class="s1">&#39;user-defined-signatures&#39;</span> will be assigned.
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: TAG
</span></span><span class="line"><span class="cl">    --format<span class="p">|</span><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">        Desired output format <span class="k">for</span> signature file. Default <span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">        Supported formats: <span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optionally, using --help will issue this <span class="nb">help</span> message.</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">USAGE:
</span></span><span class="line"><span class="cl">    /opt/app_protect/bin/convert-signatures
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Required arguments:
</span></span><span class="line"><span class="cl">    --outfile<span class="p">|</span><span class="nv">o</span><span class="o">=</span><span class="s1">&#39;/path/to/signatures.json&#39;</span>
</span></span><span class="line"><span class="cl">        File name to write JSON format <span class="nb">export</span>
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: EXPORT_FILE
</span></span><span class="line"><span class="cl">    --infile<span class="p">|</span><span class="nv">i</span><span class="o">=</span><span class="s1">&#39;/path/to/signatures.xml&#39;</span>
</span></span><span class="line"><span class="cl">        Advanced WAF/ASM User Defined Signatures file to Convert
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: IMPORT_FILE
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optional arguments:
</span></span><span class="line"><span class="cl">    --tag<span class="p">|</span><span class="nv">t</span><span class="o">=</span><span class="s1">&#39;mytag&#39;</span>
</span></span><span class="line"><span class="cl">        Signature Tag to associate with User Defined Signatures.
</span></span><span class="line"><span class="cl">        If no tag is specified in the XML file, a default tag of <span class="s1">&#39;user-defined-signatures&#39;</span> will be assigned.
</span></span><span class="line"><span class="cl">        Can also be <span class="nb">set</span> via an environment variable: TAG
</span></span><span class="line"><span class="cl">    --format<span class="p">|</span><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">        Desired output format <span class="k">for</span> signature file. Default <span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">        Supported formats: <span class="s1">&#39;json&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optionally, using --help will issue this <span class="nb">help</span> message.</span></span></code></pre></div>
</div><p>Example of generating a user defined signature JSON file (with default tag):</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f610e1230&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f610e1230">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-signatures -i /path/to/signatures.xml -o /path/to/signatures.json <span class="p">|</span> jq</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-signatures -i /path/to/signatures.xml -o /path/to/signatures.json <span class="p">|</span> jq</span></span></code></pre></div>
</div><p>Output:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61110be8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61110be8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;file_size&#34;</span><span class="p">:</span> <span class="mi">1003</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filename&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/signatures.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;completed_successfully&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;file_size&#34;</span><span class="p">:</span> <span class="mi">1003</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filename&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/signatures.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;completed_successfully&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Example of the contents of the output file (displayed and piped into <code>jq</code>):</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f611e0ff0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f611e0ff0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Buffer Overflow&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my_first_sig&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;lastUpdateMicros&#34;</span><span class="p">:</span> <span class="mi">1606014750000000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;rule&#34;</span><span class="p">:</span> <span class="s2">&#34;content:\&#34;first_sig\&#34;; nocase;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;This is the first user defined signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;revision&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Microsoft Windows&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="s2">&#34;300000002&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Command Execution&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my_second_sig&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;lastUpdateMicros&#34;</span><span class="p">:</span> <span class="mi">1606014818000000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;rule&#34;</span><span class="p">:</span> <span class="s2">&#34;uricontent:\&#34;second_sig\&#34;; nocase; objonly;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Short description of the signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;revision&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unix/Linux&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="s2">&#34;300000003&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;user-defined-signatures&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Buffer Overflow&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my_first_sig&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;lastUpdateMicros&#34;</span><span class="p">:</span> <span class="mi">1606014750000000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;rule&#34;</span><span class="p">:</span> <span class="s2">&#34;content:\&#34;first_sig\&#34;; nocase;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;This is the first user defined signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;revision&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Microsoft Windows&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="s2">&#34;300000002&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Command Execution&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;my_second_sig&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;lastUpdateMicros&#34;</span><span class="p">:</span> <span class="mi">1606014818000000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;rule&#34;</span><span class="p">:</span> <span class="s2">&#34;uricontent:\&#34;second_sig\&#34;; nocase; objonly;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Short description of the signature&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;revision&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unix/Linux&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="s2">&#34;300000003&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;medium&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;user-defined-signatures&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Example of generating a user defined signature JSON file (with custom tag):</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61216768&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f61216768">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-signatures -i /path/to/signatures.xml -o /path/to/signatures.json --tag <span class="s2">&#34;MyTag&#34;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/convert-signatures -i /path/to/signatures.xml -o /path/to/signatures.json --tag <span class="s2">&#34;MyTag&#34;</span></span></span></code></pre></div>
</div><p>Note that if the script is run without the required switches and their corresponding arguments, it will display the help message.</p>
<h2 
id="attack-signature-report-tool">Attack Signature Report Tool  <a class="headerlink float-right" href="#attack-signature-report-tool" title="Attack Signature Report Tool"><i class="fas fa-link fa-xs"></i></a>
</h2><p>The Attack Signature Report tool <code>/opt/app_protect/bin/get-signatures</code> scans the system for attack signatures and generates a JSON report file that includes information about these signatures.</p>
<p>This tool can be deployed and used independently of the NGINX App Protect WAF deployment, by <a href="http://localhost:1313/nginx-app-protect-waf/v4/admin-guide/install/#converter-tool-docker-image">installing the compiler package as a standalone</a>, in order to generate a report about either the default signatures included in the package, or signatures included in a signature update package. The latter can be obtained by running the tool on a standalone compiler deployment, after installing a new signature update package on top of the compiler package. These reports can then be compared for greater clarity regarding signature updates.</p>
<p>In addition, this report can be used for reporting or troubleshooting purposes or for auditing/tracking changes for signature updates on the NGINX App Protect WAF deployment itself.</p>
<p>Using the script:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f612441e0&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f612441e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/get-signatures</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/get-signatures</span></span></code></pre></div>
</div><p>Output:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f612e2908&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f612e2908">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">USAGE:
</span></span><span class="line"><span class="cl">    /opt/app_protect/bin/get-signatures &lt;arguments&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Required arguments:
</span></span><span class="line"><span class="cl">    --outfile<span class="p">|</span><span class="nv">o</span><span class="o">=</span><span class="s1">&#39;/path/to/report-file.json&#39;</span>
</span></span><span class="line"><span class="cl">      File name to write signature report.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Optional arguments:
</span></span><span class="line"><span class="cl">    --fields<span class="p">|</span><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;list,of,fields&#39;</span>
</span></span><span class="line"><span class="cl">      Comma separated list of desired fields.
</span></span><span class="line"><span class="cl">      Available fields:
</span></span><span class="line"><span class="cl">      name,signatureId,signatureType,attackType,accuracy,tag,risk,systems,hasCve,references,isUserDefined,description,lastUpdateMicros
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optionally, using --help will issue this <span class="nb">help</span> message.</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">USAGE:
</span></span><span class="line"><span class="cl">    /opt/app_protect/bin/get-signatures &lt;arguments&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Required arguments:
</span></span><span class="line"><span class="cl">    --outfile<span class="p">|</span><span class="nv">o</span><span class="o">=</span><span class="s1">&#39;/path/to/report-file.json&#39;</span>
</span></span><span class="line"><span class="cl">      File name to write signature report.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Optional arguments:
</span></span><span class="line"><span class="cl">    --fields<span class="p">|</span><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;list,of,fields&#39;</span>
</span></span><span class="line"><span class="cl">      Comma separated list of desired fields.
</span></span><span class="line"><span class="cl">      Available fields:
</span></span><span class="line"><span class="cl">      name,signatureId,signatureType,attackType,accuracy,tag,risk,systems,hasCve,references,isUserDefined,description,lastUpdateMicros
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optionally, using --help will issue this <span class="nb">help</span> message.</span></span></code></pre></div>
</div><p>Example of generating a signature report (with all signature details):</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f613122c0&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f613122c0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/get-signatures -o /path/to/signature-report.json <span class="p">|</span> jq</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/get-signatures -o /path/to/signature-report.json <span class="p">|</span> jq</span></span></code></pre></div>
</div><p>Output:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f613462c8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f613462c8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;file_size&#34;</span><span class="p">:</span> <span class="mi">1868596</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filename&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/signature-report.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;completed_successfully&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;file_size&#34;</span><span class="p">:</span> <span class="mi">1868596</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;filename&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/signature-report.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;completed_successfully&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Example of the contents of the output file (displayed and piped into <code>jq</code>):</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61506a90&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f61506a90">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isUserDefined&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Detection Evasion&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unicode Fullwidth ASCII variant&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;hasCve&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;references&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;infosecauditor.wordpress.com/2013/05/27/bypassing-asp-net-validaterequest-for-script-injection-attacks/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;url&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">299999999</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isUserDefined&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Predictable Resource Location&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS Web Server log dir access (/W3SVC..)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;hasCve&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;references&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;www.webappsec.org/projects/threat/classes/predictable_resource_location.shtml&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;url&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200000001</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;high&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isUserDefined&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;WEB-INF dir access (/WEB-INF/)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Predictable Resource Location&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;hasCve&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Java Servlets/JSP&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Macromedia JRun&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Jetty&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;references&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;www.webappsec.org/projects/threat/classes/predictable_resource_location.shtml&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;url&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;CVE-2016-4800&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;cve&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;CVE-2007-6672&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;cve&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200000018</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;revisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2019-07-16T12:21:31Z&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;signatures&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isUserDefined&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Detection Evasion&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unicode Fullwidth ASCII variant&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;hasCve&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;references&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;infosecauditor.wordpress.com/2013/05/27/bypassing-asp-net-validaterequest-for-script-injection-attacks/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;url&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">299999999</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isUserDefined&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Predictable Resource Location&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS Web Server log dir access (/W3SVC..)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;hasCve&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;IIS&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;references&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;www.webappsec.org/projects/threat/classes/predictable_resource_location.shtml&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;url&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200000001</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;accuracy&#34;</span><span class="p">:</span> <span class="s2">&#34;high&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;isUserDefined&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;WEB-INF dir access (/WEB-INF/)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;attackType&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Predictable Resource Location&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;hasCve&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;systems&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Java Servlets/JSP&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Macromedia JRun&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Jetty&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;references&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;www.webappsec.org/projects/threat/classes/predictable_resource_location.shtml&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;url&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;CVE-2016-4800&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;cve&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;CVE-2007-6672&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;cve&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureType&#34;</span><span class="p">:</span> <span class="s2">&#34;request&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;risk&#34;</span><span class="p">:</span> <span class="s2">&#34;low&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;signatureId&#34;</span><span class="p">:</span> <span class="mi">200000018</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;revisionDatetime&#34;</span><span class="p">:</span> <span class="s2">&#34;2019-07-16T12:21:31Z&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Example of generating signature report (with a preset set of fields):</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f61545a60&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1f61545a60">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/get-signatures -o /path/to/signature-report.json --fields<span class="o">=</span>name,signatureId</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/opt/app_protect/bin/get-signatures -o /path/to/signature-report.json --fields<span class="o">=</span>name,signatureId</span></span></code></pre></div>
</div><p>Note that if the script is run without the required switches and their corresponding arguments, it will display the help message.</p>
<h2 
id="security-logs">Security Logs  <a class="headerlink float-right" href="#security-logs" title="Security Logs"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Refer to <a href="http://localhost:1313/nginx-app-protect-waf/v4/logging-overview/security-log/">Logging Overview</a> section for more details on Security Logs.</p>
<h2 
id="nginx-app-protect-waf-terminology">NGINX App Protect WAF Terminology  <a class="headerlink float-right" href="#nginx-app-protect-waf-terminology" title="NGINX App Protect WAF Terminology"><i class="fas fa-link fa-xs"></i></a>
</h2><p>This guide assumes that you have some familiarity with various Layer 7 (L7) Hypertext Transfer Protocol (HTTP) concepts, such as Uniform Resource Identifier (URI)/Uniform Resource Locator (URL), method, header, cookie, status code, request, response, and parameters.</p>





<table class="table table-striped table-bordered table-sm table-responsive table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Term</th>
          <th style="text-align: left">Definition</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Alarm</td>
          <td style="text-align: left">If selected, the NGINX App Protect WAF system records requests that trigger the violation in the remote log (depending on the settings of the logging profile).</td>
      </tr>
      <tr>
          <td style="text-align: left">Attack signature</td>
          <td style="text-align: left">Textual patterns which can be applied to HTTP requests and/or responses by NGINX App Protect WAF to determine if traffic is malicious. For example, the string <code>&lt;script&gt;</code>inside an HTTP request triggers an attack signature violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Attack signature set</td>
          <td style="text-align: left">A collection of attack signatures designed for a specific purpose (such as Apache).</td>
      </tr>
      <tr>
          <td style="text-align: left">Bot signatures</td>
          <td style="text-align: left">Textual patterns which can be applied to an HTTP request&rsquo;s User Agent or URI by NGINX App Protect WAF to determine if traffic is coming from a browser or a bot (trusted, untrusted or malicious). For example, the string <code>googlebot</code> inside the User-Agent header will be classified as <code>trusted bot</code>, and the string <code>Bichoo Spider</code> will be classified as <code>malicious bot</code>.</td>
      </tr>
      <tr>
          <td style="text-align: left">Block</td>
          <td style="text-align: left">To prevent a request from reaching a protected web application. If selected (and enforcement mode is set to Blocking), NGINX App Protect WAF blocks requests that trigger the violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Blocking response page</td>
          <td style="text-align: left">A blocking response page is displayed to a client when a request from that client has been blocked. Also called blocking page and response page.</td>
      </tr>
      <tr>
          <td style="text-align: left">Enforcement mode</td>
          <td style="text-align: left">Security policies can be in one of two enforcement modes:<ul><li><strong>Transparent mode</strong> In Transparent mode, Blocking is disabled for the security policy. Traffic is not blocked even if a violation is triggered with block flag enabled. You can use this mode when you first put a security policy into effect to make sure that no false positives occur that would stop legitimate traffic.</li><li><strong>Blocking mode</strong> In Blocking mode, Blocking is enabled for the security policy, and you can enable or disable the Block setting for individual violations. Traffic is blocked when a violation occurs if you configure the system to block that type of violation. You can use this mode when you are ready to enforce the security policy. You can change the enforcement mode for a security policy in the security policy JSON file.</li></ul></td>
      </tr>
      <tr>
          <td style="text-align: left">Entities</td>
          <td style="text-align: left">The elements of a security policy, such as HTTP methods, as well as file types, URLs, and/or parameters, which have attributes such as byte length. Also refers to elements of a security policy for which enforcement can be turned on or off, such as an attack signature.</td>
      </tr>
      <tr>
          <td style="text-align: left">False positive</td>
          <td style="text-align: left">An instance when NGINX App Protect WAF treats a legitimate request as a violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">File types</td>
          <td style="text-align: left">Examples of file types are .php, .asp, .gif, and .txt. They are the extensions for many objects that make up a web application. File Types are one type of entity a NGINX App Protect WAF policy contains.</td>
      </tr>
      <tr>
          <td style="text-align: left">Illegal request</td>
          <td style="text-align: left">A request which violates a security policy</td>
      </tr>
      <tr>
          <td style="text-align: left">Legal request</td>
          <td style="text-align: left">A request which has not violated the security policy.</td>
      </tr>
      <tr>
          <td style="text-align: left">Loosening</td>
          <td style="text-align: left">The process of adapting a security policy to allow specific entities such as File Types, URLs, and Parameters. The term also applies to attack signatures, which can be manually disabled  effectively removing the signature from triggering any violations.</td>
      </tr>
      <tr>
          <td style="text-align: left">Parameters</td>
          <td style="text-align: left">Parameters consist of &ldquo;name=value&rdquo; pairs, such as OrderID=10. The parameters appear in the query string and/or POST data of an HTTP request. Consequently, they are of particular interest to NGINX App Protect WAF because they represent inputs to the web application.</td>
      </tr>
      <tr>
          <td style="text-align: left">TPS/RPS</td>
          <td style="text-align: left">Transactions per second (TPS)/requests per second (RPS). In NGINX App Protect WAF, these terms are used interchangeably.</td>
      </tr>
      <tr>
          <td style="text-align: left">Tuning</td>
          <td style="text-align: left">Making manual changes to an existing security policy to reduce false positives and increase the policys security level.</td>
      </tr>
      <tr>
          <td style="text-align: left">URI/URL</td>
          <td style="text-align: left">The Uniform Resource Identifier (URI) specifies the name of a web object in a request. A Uniform Resource Locator (URL) specifies the location of an object on the Internet. For example, in the web address, <code>http://www.siterequest.com/index.html</code>, index.html is the URI, and the URL is <code>http://www.siterequest.com/index.html</code>. In NGINX App Protect WAF, the terms URI and URL are used interchangeably.</td>
      </tr>
      <tr>
          <td style="text-align: left">Violation</td>
          <td style="text-align: left">Violations occur when some aspect of a request or response does not comply with the security policy. You can configure the blocking settings for any violation in a security policy. When a violation occurs, the system can Alarm or Block a request (blocking is only available when the enforcement mode is set to Blocking).</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered table-sm table-responsive narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Term</th>
          <th style="text-align: left">Definition</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Alarm</td>
          <td style="text-align: left">If selected, the NGINX App Protect WAF system records requests that trigger the violation in the remote log (depending on the settings of the logging profile).</td>
      </tr>
      <tr>
          <td style="text-align: left">Attack signature</td>
          <td style="text-align: left">Textual patterns which can be applied to HTTP requests and/or responses by NGINX App Protect WAF to determine if traffic is malicious. For example, the string <code>&lt;script&gt;</code>inside an HTTP request triggers an attack signature violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Attack signature set</td>
          <td style="text-align: left">A collection of attack signatures designed for a specific purpose (such as Apache).</td>
      </tr>
      <tr>
          <td style="text-align: left">Bot signatures</td>
          <td style="text-align: left">Textual patterns which can be applied to an HTTP request&rsquo;s User Agent or URI by NGINX App Protect WAF to determine if traffic is coming from a browser or a bot (trusted, untrusted or malicious). For example, the string <code>googlebot</code> inside the User-Agent header will be classified as <code>trusted bot</code>, and the string <code>Bichoo Spider</code> will be classified as <code>malicious bot</code>.</td>
      </tr>
      <tr>
          <td style="text-align: left">Block</td>
          <td style="text-align: left">To prevent a request from reaching a protected web application. If selected (and enforcement mode is set to Blocking), NGINX App Protect WAF blocks requests that trigger the violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">Blocking response page</td>
          <td style="text-align: left">A blocking response page is displayed to a client when a request from that client has been blocked. Also called blocking page and response page.</td>
      </tr>
      <tr>
          <td style="text-align: left">Enforcement mode</td>
          <td style="text-align: left">Security policies can be in one of two enforcement modes:<ul><li><strong>Transparent mode</strong> In Transparent mode, Blocking is disabled for the security policy. Traffic is not blocked even if a violation is triggered with block flag enabled. You can use this mode when you first put a security policy into effect to make sure that no false positives occur that would stop legitimate traffic.</li><li><strong>Blocking mode</strong> In Blocking mode, Blocking is enabled for the security policy, and you can enable or disable the Block setting for individual violations. Traffic is blocked when a violation occurs if you configure the system to block that type of violation. You can use this mode when you are ready to enforce the security policy. You can change the enforcement mode for a security policy in the security policy JSON file.</li></ul></td>
      </tr>
      <tr>
          <td style="text-align: left">Entities</td>
          <td style="text-align: left">The elements of a security policy, such as HTTP methods, as well as file types, URLs, and/or parameters, which have attributes such as byte length. Also refers to elements of a security policy for which enforcement can be turned on or off, such as an attack signature.</td>
      </tr>
      <tr>
          <td style="text-align: left">False positive</td>
          <td style="text-align: left">An instance when NGINX App Protect WAF treats a legitimate request as a violation.</td>
      </tr>
      <tr>
          <td style="text-align: left">File types</td>
          <td style="text-align: left">Examples of file types are .php, .asp, .gif, and .txt. They are the extensions for many objects that make up a web application. File Types are one type of entity a NGINX App Protect WAF policy contains.</td>
      </tr>
      <tr>
          <td style="text-align: left">Illegal request</td>
          <td style="text-align: left">A request which violates a security policy</td>
      </tr>
      <tr>
          <td style="text-align: left">Legal request</td>
          <td style="text-align: left">A request which has not violated the security policy.</td>
      </tr>
      <tr>
          <td style="text-align: left">Loosening</td>
          <td style="text-align: left">The process of adapting a security policy to allow specific entities such as File Types, URLs, and Parameters. The term also applies to attack signatures, which can be manually disabled  effectively removing the signature from triggering any violations.</td>
      </tr>
      <tr>
          <td style="text-align: left">Parameters</td>
          <td style="text-align: left">Parameters consist of &ldquo;name=value&rdquo; pairs, such as OrderID=10. The parameters appear in the query string and/or POST data of an HTTP request. Consequently, they are of particular interest to NGINX App Protect WAF because they represent inputs to the web application.</td>
      </tr>
      <tr>
          <td style="text-align: left">TPS/RPS</td>
          <td style="text-align: left">Transactions per second (TPS)/requests per second (RPS). In NGINX App Protect WAF, these terms are used interchangeably.</td>
      </tr>
      <tr>
          <td style="text-align: left">Tuning</td>
          <td style="text-align: left">Making manual changes to an existing security policy to reduce false positives and increase the policys security level.</td>
      </tr>
      <tr>
          <td style="text-align: left">URI/URL</td>
          <td style="text-align: left">The Uniform Resource Identifier (URI) specifies the name of a web object in a request. A Uniform Resource Locator (URL) specifies the location of an object on the Internet. For example, in the web address, <code>http://www.siterequest.com/index.html</code>, index.html is the URI, and the URL is <code>http://www.siterequest.com/index.html</code>. In NGINX App Protect WAF, the terms URI and URL are used interchangeably.</td>
      </tr>
      <tr>
          <td style="text-align: left">Violation</td>
          <td style="text-align: left">Violations occur when some aspect of a request or response does not comply with the security policy. You can configure the blocking settings for any violation in a security policy. When a violation occurs, the system can Alarm or Block a request (blocking is only available when the enforcement mode is set to Blocking).</td>
      </tr>
  </tbody>
</table>

</div>

<h2 
id="interaction-with-nginx-features">Interaction with NGINX Features  <a class="headerlink float-right" href="#interaction-with-nginx-features" title="Interaction with NGINX Features"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Below are examples of how to configure various NGINX features with NGINX App Protect WAF.</p>
<h3 
id="configure-static-location">Configure Static Location  <a class="headerlink float-right" href="#configure-static-location" title="Configure Static Location"><i class="fas fa-link fa-xs"></i></a>
</h3>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f66729840&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f66729840">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span>    <span class="s">http://127.0.0.1:8080/proxy/</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/proxy</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">return</span> <span class="mi">200</span> <span class="s">&#34;Hello!</span> <span class="s">I</span> <span class="s">got</span> <span class="s">your</span> <span class="s">URI</span> <span class="s">request</span> <span class="s">-</span> <span class="nv">$request_uri\n&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span>    <span class="s">http://127.0.0.1:8080/proxy/</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/proxy</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">default_type</span> <span class="s">text/html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">return</span> <span class="mi">200</span> <span class="s">&#34;Hello!</span> <span class="s">I</span> <span class="s">got</span> <span class="s">your</span> <span class="s">URI</span> <span class="s">request</span> <span class="s">-</span> <span class="nv">$request_uri\n&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="configure-ranges">Configure Ranges  <a class="headerlink float-right" href="#configure-ranges" title="Configure Ranges"><i class="fas fa-link fa-xs"></i></a>
</h3>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f66762668&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f66762668">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span>    <span class="s">http://127.0.0.1:8081</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8081</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://1.2.3.4</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_force_ranges</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span>    <span class="s">http://127.0.0.1:8081</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8081</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://1.2.3.4</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_force_ranges</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="configure-slice">Configure Slice  <a class="headerlink float-right" href="#configure-slice" title="Configure Slice"><i class="fas fa-link fa-xs"></i></a>
</h3>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f66799938&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f66799938">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:8081</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8081</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://1.2.3.4</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">slice</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_set_header</span> <span class="s">Range</span> <span class="nv">$slice_range</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:8081</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8081</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://1.2.3.4</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">slice</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_set_header</span> <span class="s">Range</span> <span class="nv">$slice_range</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="configure-nginx-mirror">Configure NGINX mirror  <a class="headerlink float-right" href="#configure-nginx-mirror" title="Configure NGINX mirror"><i class="fas fa-link fa-xs"></i></a>
</h3>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f667c9ea8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f667c9ea8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">log_format</span> <span class="s">test</span> <span class="nv">$uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">mirror</span> <span class="s">/mirror</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/mirror</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">log_subrequest</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">access_log</span> <span class="s">test</span><span class="nv">$args.log</span> <span class="s">test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">log_format</span> <span class="s">test</span> <span class="nv">$uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">mirror</span> <span class="s">/mirror</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/mirror</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">log_subrequest</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">access_log</span> <span class="s">test</span><span class="nv">$args.log</span> <span class="s">test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="configure-njs">Configure njs  <a class="headerlink float-right" href="#configure-njs" title="Configure njs"><i class="fas fa-link fa-xs"></i></a>
</h3>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f66801948&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f66801948">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_js_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">js_include</span> <span class="s">service.js</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span>    <span class="s">http://127.0.0.1:8081</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8081</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">js_content</span> <span class="s">foo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_js_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">js_include</span> <span class="s">service.js</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span>    <span class="s">http://127.0.0.1:8081</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8081</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">js_content</span> <span class="s">foo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="configure-client-authorization">Configure Client Authorization  <a class="headerlink float-right" href="#configure-client-authorization" title="Configure Client Authorization"><i class="fas fa-link fa-xs"></i></a>
</h3>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f66843028&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f66843028">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">auth_request</span> <span class="s">/scan</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://localhost:8888</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/scan</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://localhost:8081</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8081</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/scan</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://localhost:8888</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">auth_request</span> <span class="s">/scan</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://localhost:8888</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/scan</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://localhost:8081</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span>       <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8081</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/scan</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://localhost:8888</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 
id="unsupported-configuration">Unsupported Configuration  <a class="headerlink float-right" href="#unsupported-configuration" title="Unsupported Configuration"><i class="fas fa-link fa-xs"></i></a>
</h3><p>There are some NGINX features that don&rsquo;t work well with NGINX App Protect WAF. Modules that use subrequest do not work when calling or being called from a scope that contains <code>app_protect_enable on</code>. Other modules that expect to receive the Range header (Slice for example) are also unsupported in the same scope as <code>app_protect_enable on</code>. For example, the following configuration is unsupported, but in the examples above you can find examples of work arounds for these features.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1f66877418&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1f66877418">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://1.2.3.4</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">slice</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_set_header</span> <span class="s">Range</span> <span class="nv">$slice_range</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">load_module</span> <span class="s">modules/ngx_http_app_protect_module.so</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">listen</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kn">app_protect_enable</span> <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_pass</span> <span class="s">http://1.2.3.4</span><span class="nv">$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">slice</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kn">proxy_set_header</span> <span class="s">Range</span> <span class="nv">$slice_range</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>

        
        

        <hr>
  
        
        <div class="last-modified">
          
<div>
    <a href="https://github.com/nginx/documentation//tree/main/content/nap-waf/v4/configuration-guide/configuration.md" class="" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> View source</a>
  </div>
  <div>
    <a href="https://github.com/nginx/documentation//edit/main/content/nap-waf/v4/configuration-guide/configuration.md" class="" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
  </div>
  <div>
    <a href="https://github.com/nginx/documentation//issues/new?title=NGINX%20App%20Protect%20WAF%20Configuration%20Guide&amp;template=2-bug_report.md" class="" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create a new issue</a>
  </div>



        </div>
        

        
         
<script type='text/javascript'> 
    (function(){var g=function(e,h,f,g){ 
        this.get=function(a){
            for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){
                for(var d=c[b];" "==d.charAt(0);)
                    d=d.substring(1,d.length);
                    if(0==d.indexOf(a))
                        return d.substring(a.length,d.length)
            }
            return null
        }; 
        
        this.set=function(a,c){
            var b="",b=new Date;
            b.setTime(b.getTime()+6048E5);
            b="; expires="+b.toGMTString();
            document.cookie=a+"="+c+b+"; path=/; "
        }; 
        
        this.check=function(){
            var a=this.get(f);
            if(a)
                a=a.split(":");
            else if(100!=e)
                "v"==h&&(e=Math.random()>=e/100?0:100),
                a=[h,e,0],
                this.set(f,a.join(":"));
            else 
                return!0;
            var c=a[1];
            if(100==c)
                return!0;
            switch(a[0]){
                case "v":
                    return!1;
                case "r":
                    return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c
            }
            return!0
        }; 

        this.go=function(){
            if(this.check()){
                var a=document.createElement("script");
                a.type="text/javascript";
                a.src=g;
                document.body&&document.body.appendChild(a)
            }
        };

        this.start=function(){
            var t=this;
            "complete"!==document.readyState?window.addEventListener ?
                window.addEventListener("load",function(){t.go()},!1) : 
                window.attachEvent&&window.attachEvent("onload",function(){t.go()}):t.go()};
    }; 

    try{
        const project_id = window.location.hostname.includes("staging") ? "QSI_S_ZN_2YG73ads2zp5bN0" : "QSI_S_ZN_2QSTn2r41YlXrYk";
        const endpoint = window.location.hostname.includes("staging") ? "https://zn2yg73ads2zp5bn0-f5.siteintercept.qualtrics.com/SIE/?Q_ZID=ZN_2YG73ads2zp5bN0" : "https://zn2qstn2r41ylxryk-f5.siteintercept.qualtrics.com/SIE/?Q_ZID=ZN_2QSTn2r41YlXrYk";
        (new g(100,"r", project_id, endpoint)).start()
    }
    catch(i){}})();

    document.addEventListener("DOMContentLoaded", function () {
        document.querySelector(".qualtrics-feedback").id = window.location.hostname.includes("staging") ? "ZN_2YG73ads2zp5bN0" : "ZN_2QSTn2r41YlXrYk"
    });
</script>
<hr>
<div style="height: 60px;"></div>
<div class="qualtrics-feedback" id='ZN_2QSTn2r41YlXrYk'></div>


        
        </main>
        
          
            <div id="toc" class="col-md-3 d-none d-xl-block d-print-none nginx-toc align-top">
            <nav class="bd-links" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <h3 class="bd-toc-link">What's on This Page</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#supported-security-policy-features">Supported Security Policy Features</a>
      <ul>
        <li><a href="#disallowed-file-types">Disallowed File Types</a></li>
      </ul>
    </li>
    <li><a href="#additional-policy-features">Additional Policy Features</a></li>
    <li><a href="#attack-signatures-overview">Attack Signatures Overview</a>
      <ul>
        <li><a href="#signature-settings">Signature Settings</a></li>
        <li><a href="#signature-sets-in-default-policy">Signature Sets in Default Policy</a></li>
        <li><a href="#basic-signature-sets-included-in-app-protect">Basic Signature Sets Included in App Protect</a></li>
      </ul>
    </li>
    <li><a href="#policy-configuration">Policy Configuration</a>
      <ul>
        <li><a href="#policy-configuration-overview">Policy Configuration Overview</a></li>
        <li><a href="#basic-configuration-and-the-default-policy">Basic Configuration and the Default Policy</a></li>
        <li><a href="#the-strict-policy">The Strict Policy</a></li>
        <li><a href="#policy-authoring-and-tuning">Policy Authoring and Tuning</a></li>
        <li><a href="#anti-automation-bot-mitigation">Anti Automation (Bot Mitigation)</a></li>
        <li><a href="#signature-sets">Signature Sets</a></li>
        <li><a href="#partial-masking-of-data-using-data-guard">Partial Masking of Data using Data Guard</a></li>
        <li><a href="#detect-base64">Detect Base64</a></li>
        <li><a href="#handling-xml-and-json-content">Handling XML and JSON Content</a></li>
        <li><a href="#enforcer-cookie-settings">Enforcer Cookie Settings</a></li>
        <li><a href="#additional-configuration-options">Additional Configuration Options</a></li>
        <li><a href="#modifying-configurations">Modifying Configurations</a></li>
      </ul>
    </li>
    <li><a href="#nginx-app-protect-waf-standalone-configuration">NGINX App Protect WAF Standalone Configuration</a>
      <ul>
        <li><a href="#apreload">apreload</a></li>
        <li><a href="#apreload-events">apreload Events</a></li>
        <li><a href="#modification-to-nginxconf-file-and-app-protect-configurations">Modification to nginx.conf file and App Protect Configurations</a></li>
        <li><a href="#handling-concurrent-invocations-of-apreload">Handling Concurrent Invocations of Apreload</a></li>
        <li><a href="#limitation-on-http-header-and-xff-modification">Limitation on HTTP Header and XFF Modification</a></li>
      </ul>
    </li>
    <li><a href="#external-references">External References</a>
      <ul>
        <li><a href="#types-of-references">Types of References</a></li>
      </ul>
    </li>
    <li><a href="#openapi-specification-file-reference">OpenAPI Specification File Reference</a>
      <ul>
        <li><a href="#types-of-openapi-references">Types of OpenAPI References</a></li>
      </ul>
    </li>
    <li><a href="#grpc-protection-for-unary-traffic">gRPC Protection for Unary Traffic</a>
      <ul>
        <li><a href="#grpc-content-profiles">gRPC Content Profiles</a></li>
        <li><a href="#associating-profiles-with-urls">Associating Profiles with URLs</a></li>
        <li><a href="#grpc-response-pages">gRPC Response Pages</a></li>
        <li><a href="#detect-base64-in-string-values">Detect Base64 in String Values</a></li>
        <li><a href="#protocol-buffers-supported-version">Protocol Buffers Supported Version</a></li>
        <li><a href="#grpc-server-reflection">gRPC Server Reflection</a></li>
      </ul>
    </li>
    <li><a href="#grpc-protection-for-bidirectional-streaming">gRPC Protection for Bidirectional Streaming</a>
      <ul>
        <li><a href="#bidirectional-streaming-overview">Bidirectional Streaming Overview</a></li>
        <li><a href="#configuration">Configuration</a></li>
        <li><a href="#grpc-bidirectional-streaming-enforcement">gRPC Bidirectional Streaming Enforcement</a></li>
        <li><a href="#size-limits">Size Limits</a></li>
        <li><a href="#message-compression">Message Compression</a></li>
        <li><a href="#slow-post-attacks">Slow POST Attacks</a></li>
        <li><a href="#handling-slow-post-attacks">Handling Slow POST Attacks</a></li>
      </ul>
    </li>
    <li><a href="#other-grpc-references">Other gRPC References</a>
      <ul>
        <li><a href="#grpc-violations">gRPC Violations</a></li>
        <li><a href="#grpc-logging">gRPC Logging</a></li>
      </ul>
    </li>
    <li><a href="#securing-graphql-apis-with-nginx-app-protect-waf">Securing GraphQL APIs with NGINX App protect WAF</a>
      <ul>
        <li><a href="#graphql-overview">GraphQL Overview</a></li>
        <li><a href="#graphql-security">GraphQL Security</a></li>
      </ul>
    </li>
    <li><a href="#enabling-graphql-with-basic-configuration">Enabling GraphQL with Basic Configuration</a></li>
    <li><a href="#graphql-advanced-configuration">GraphQL Advanced Configuration</a>
      <ul>
        <li><a href="#graphql-violations">GraphQL Violations</a></li>
        <li><a href="#graphql-profile">GraphQL Profile</a></li>
        <li><a href="#define-url-settings">Define URL settings</a></li>
        <li><a href="#associating-graphql-profiles-with-url">Associating GraphQL Profiles with URL</a></li>
        <li><a href="#graphql-response-pages">GraphQL Response Pages</a></li>
      </ul>
    </li>
    <li><a href="#override-rules">Override Rules</a>
      <ul>
        <li><a href="#override-rules-overview">Override Rules Overview</a></li>
        <li><a href="#condition-syntax-usage">Condition Syntax Usage</a></li>
        <li><a href="#first-match-principle">First Match Principle</a></li>
        <li><a href="#important-things-to-remember-about-override-rules">Important Things to Remember About Override Rules</a></li>
        <li><a href="#override-rules-logging--reporting">Override Rules Logging &amp; Reporting</a></li>
        <li><a href="#errors-and-warnings">Errors and Warnings</a></li>
      </ul>
    </li>
    <li><a href="#geolocation">Geolocation</a>
      <ul>
        <li><a href="#overview-1">Overview</a></li>
        <li><a href="#disallowing-application-use-in-certain-geolocations">Disallowing Application Use in Certain Geolocations</a></li>
        <li><a href="#geolocation-in-policy-override-rules-conditions">Geolocation in Policy Override Rules Conditions</a></li>
      </ul>
    </li>
    <li><a href="#json-web-token-protection">JSON Web Token Protection</a>
      <ul>
        <li><a href="#overview-2">Overview</a></li>
        <li><a href="#configuring-nginx-app-protect-waf-to-authenticate-json-web-token">Configuring NGINX App Protect WAF to Authenticate JSON Web Token</a></li>
        <li><a href="#authorization-rules-in-urls">Authorization Rules in URLs</a></li>
        <li><a href="#attack-signatures">Attack Signatures</a></li>
        <li><a href="#json-web-token-violations">JSON Web Token Violations</a></li>
        <li><a href="#violation-rating-calculation">Violation Rating Calculation</a></li>
        <li><a href="#other-references">Other References</a></li>
      </ul>
    </li>
    <li><a href="#brute-force-attack-preventions">Brute Force Attack Preventions</a>
      <ul>
        <li><a href="#overview-3">Overview</a></li>
        <li><a href="#login-page-policy-example">Login page policy example</a></li>
        <li><a href="#brute-force-policy-example">Brute force policy example</a></li>
      </ul>
    </li>
    <li><a href="#custom-dimensions-log-entries">Custom Dimensions Log Entries</a>
      <ul>
        <li><a href="#overview-4">Overview</a></li>
        <li><a href="#configuration-1">Configuration</a></li>
        <li><a href="#things-to-remember-while-configuring-the-custom-dimensions-log-entries">Things to Remember While Configuring the Custom Dimensions Log Entries</a></li>
        <li><a href="#errors-and-warnings-1">Errors and Warnings</a></li>
        <li><a href="#logging-and-reporting">Logging and Reporting</a></li>
      </ul>
    </li>
    <li><a href="#time-based-signature-staging">Time-Based Signature Staging</a>
      <ul>
        <li><a href="#latest-signature-certification-time">Latest Signature Certification Time</a></li>
        <li><a href="#new-policy">New Policy</a></li>
        <li><a href="#signature-update">Signature Update</a></li>
        <li><a href="#configuration-2">Configuration</a></li>
        <li><a href="#enforcing-the-modified-signatures-after-testing-them">Enforcing the Modified Signatures After Testing Them</a></li>
        <li><a href="#logging-and-reporting-1">Logging and Reporting</a></li>
      </ul>
    </li>
    <li><a href="#directives">Directives</a>
      <ul>
        <li><a href="#global-directives">Global Directives</a></li>
        <li><a href="#app-protect-specific-directives">App Protect Specific Directives</a></li>
      </ul>
    </li>
    <li><a href="#violations">Violations</a>
      <ul>
        <li><a href="#supported-violations">Supported Violations</a></li>
        <li><a href="#http-compliance-sub-violations">HTTP Compliance Sub-Violations</a></li>
        <li><a href="#evasion-techniques-sub-violations">Evasion Techniques Sub-Violations</a></li>
      </ul>
    </li>
    <li><a href="#attack-types">Attack Types</a></li>
    <li><a href="#converter-tools">Converter Tools</a>
      <ul>
        <li><a href="#policy-converter">Policy Converter</a></li>
        <li><a href="#user-defined-signatures-converter">User Defined Signatures Converter</a></li>
      </ul>
    </li>
    <li><a href="#attack-signature-report-tool">Attack Signature Report Tool</a></li>
    <li><a href="#security-logs">Security Logs</a></li>
    <li><a href="#nginx-app-protect-waf-terminology">NGINX App Protect WAF Terminology</a></li>
    <li><a href="#interaction-with-nginx-features">Interaction with NGINX Features</a>
      <ul>
        <li><a href="#configure-static-location">Configure Static Location</a></li>
        <li><a href="#configure-ranges">Configure Ranges</a></li>
        <li><a href="#configure-slice">Configure Slice</a></li>
        <li><a href="#configure-nginx-mirror">Configure NGINX mirror</a></li>
        <li><a href="#configure-njs">Configure njs</a></li>
        <li><a href="#configure-client-authorization">Configure Client Authorization</a></li>
        <li><a href="#unsupported-configuration">Unsupported Configuration</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</nav>
            </div>
          
        
        
      </div>
    </section>
  </section>
</div>




      </div>
  </section>

    <footer id="footer">
      
      <footer id="footer">
  <div class="container-fluid">
    <div class="row align-items-center">
      <div class="col-md-6 d-md-flex">
        <img class="nginx-logo-footer" src="http://localhost:1313/images/icons/NGINX-Part-of-F5-horiz-all-white-525x208@2x.png"/>
      </div>
    </div>

    
    <div class="row d-print-none d-none d-md-flex">
      <div class="col-md-3 d-none d-md-block">
        <span class="footer-head">Company</span>
        <ul class="footer-text">
          <li>
            <a
              href="https://www.f5.com/go/product/welcome-to-nginx"
              target="_blank"
              alt="Select to learn about F5 NGINX"
              >About F5 NGINX</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/company/events"
              target="_blank"
              alt="Select to learn about F5 events"
              >Events</a
            >
          </li>
        </ul>
        <br />
        <span class="footer-head">Resources</span>
        <ul class="footer-text">
          <li>
            <a
              href="https://www.f5.com/company/blog/nginx"
              target="_blank"
              alt="Select to visit the F5 NGINX blog"
              >Blog</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/go/faq/nginx-faq"
              target="_blank"
              alt="Select to visit the F5 NGINX frequently asked questions page"
              >FAQ</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/services"
              target="_blank"
              alt="Select to learn about F5 NGINX Support"
              >Professional Services</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/learn/training"
              target="_blank"
              alt="Select to learn about F5 training offerings"
              >Training</a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-3 d-none d-md-block">
        <span class="footer-head">Products</span>
        <ul class="footer-text">
          <li>
            <a
              title="F5 NGINX One"
              aria-label="F5 NGINX One"
              href="https://www.f5.com/products/nginx/one"
              >F5 NGINX One</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Plus"
              aria-label="F5 NGINX Plus"
              href="https://www.f5.com/products/nginx/nginx-plus"
              >F5 NGINX Plus</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX App Protect"
              aria-label="F5 NGINX App Protect"
              href="https://www.f5.com/products/nginx/nginx-app-protect"
              >F5 NGINX App Protect</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Instance Manager"
              aria-label="F5 NGINX Instance Manager"
              href="https://www.f5.com/products/nginx/instance-manager"
              >F5 NGINX Instance Manager</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Ingress Controller"
              aria-label="F5 NGINX Ingress Controller"
              href="https://www.f5.com/products/nginx/nginx-ingress-controller"
              >F5 NGINX Ingress Controller</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Gateway Fabric"
              aria-label="F5 NGINX Gateway Fabric"
              href="https://www.f5.com/products/nginx/nginx-gateway-fabric"
              >F5 NGINX Gateway Fabric</a
            >
          </li>
          <li>
            <a
              title="F5 NGINXaaS for Azure"
              aria-label="F5 NGINXaaS for Azure"
              href="https://www.f5.com/products/nginx/f5-nginxaas-for-azure"
              >F5 NGINXaaS for Azure</a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-3 d-none d-md-block">
        <span class="footer-head">NGINX on GitHub</span>
        <ul class="footer-text">
          <li>
            <a
              title="NGINX Open Source"
              aria-label="NGINX Open Source"
              href="https://github.com/nginx/nginx"
              ><span class="inner">NGINX Open Source</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Unit"
              aria-label="NGINX Unit"
              href="https://github.com/nginx/unit"
              ><span class="inner">NGINX Unit</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Amplify"
              aria-label="NGINX Amplify"
              href="https://github.com/nginxinc/nginx-amplify-agent"
              ><span class="inner">NGINX Amplify</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Agent"
              aria-label="NGINX Agent"
              href="https://github.com/nginx/Agent"
              ><span class="inner">NGINX Agent</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Kubernetes Ingress Controller"
              aria-label="NGINX Kubernetes Ingress Controller"
              href="https://github.com/nginxinc/kubernetes-ingress"
              ><span class="inner">NGINX Kubernetes Ingress Controller</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Gateway Fabric"
              aria-label="NGINX Gateway Fabric"
              href="https://github.com/nginxinc/nginx-gateway-fabric"
              ><span class="inner">NGINX Gateway Fabric</span></a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-2 d-none d-md-block">
        <span class="footer-head">Social</span>
        <ul class="footer-social">
          <li>
            <a
              href="https://www.facebook.com/nginxinc"
              title="facebook"
              aria-label="facebook"
              target="_blank"
              rel="noreferrer"
              ><i class="fa-brands fa-facebook" aria-hidden="true"></i>
            </a>
          </li>
          <li>
            <a
              href="https://twitter.com/nginx"
              title="X"
              aria-label="x"
              target="_blank"
              rel="noreferrer"
              ><i class="fa-brands fa-x-twitter" aria-hidden="true"></i
            ></a>
          </li>
          <li>
            <a
              href="https://www.linkedin.com/company/nginx"
              title="linkedin"
              aria-label="linkedin"
              target="_blank"
              rel="noreferrer"
              ><i class="fa-brands fa-linkedin" aria-hidden="true"></i>
            </a>
          </li>
          <li>
            <a
              href="https://www.youtube.com/user/NginxInc"
              title="youtube"
              aria-label="youtube"
              target="_blank"
              rel="noreferrer"
              alt="NGINX Youtube Channel"
              ><i class="fa-brands fa-square-youtube" aria-hidden="true"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
    
    <div class="site-info footer-text">
      <div class="text-center">
        <p>
          <a href="https://www.f5.com/"
            ><img class="f5-logo-footer" src="http://localhost:1313/images/icons/Logo_F5.svg" alt="F5 logo"></a
          >
          2025 F5, Inc. All rights reserved.
        </p>
        <p>
          <a
            href="https://www.f5.com/company/policies/trademarks"
            rel="noopener"
            target="_blank"
            >Trademarks</a
          >
          <a
            href="https://www.f5.com/company/policies"
            rel="noopener"
            target="_blank"
            >Policies</a
          >
          <a href="https://docs.nginx.com/ossc">Open Source Components</a>
          <a
            href="https://www.f5.com/company/policies/privacy-notice"
            rel="noopener"
            target="_blank"
            >Privacy</a
          >
          <a
            href="https://www.f5.com/company/policies/F5-California-privacy-summary"
            rel="noopener"
            target="_blank"
            >California Privacy</a
          >
          <a
            href="https://www.f5.com/company/policies/privacy-notice#no-sell"
            rel="noopener"
            target="_blank"
            >Do Not Sell My Personal Information</a
          >
          <span id="teconsent-v1"></span>
        </p>
      </div>
    </div>
    
  </div>
  
</footer>

      
    </footer>

    <footer data-mf="true" id="footer-v2" style="display:none;">
      
      <div class="footer-layout">
    <div class="footer-f5-trademark">
        <img class="f5-logo-footer" src="http://localhost:1313/images/icons/Logo_F5.svg" alt="F5 logo">
        <p>2025 F5, Inc. All rights reserved. NGINX is a registered trademark of F5, Inc.</p>
    </div>
    <div class="footer-useful-links">
        <a
            href="https://www.f5.com/company/policies/trademarks"
            rel="noopener"
            target="_blank"
            >Trademarks
        </a>
        <a
            href="https://www.f5.com/company/policies"
            rel="noopener"
            target="_blank"
            >Policies
        </a>
        <a
            href="https://www.f5.com/company/policies/privacy-notice"
            rel="noopener"
            target="_blank"
            >Privacy
        </a>
        <a
            href="https://www.f5.com/company/policies/F5-California-privacy-summary"
            rel="noopener"
            target="_blank"
            >California Privacy
        </a>
        <a
            href="https://www.f5.com/company/policies/privacy-notice#no-sell"
            rel="noopener"
            target="_blank"
            >Do Not Sell My Personal Information
        </a>
        <span id="teconsent-v2"></span>
    </div>
</div>

      
    </footer>
  
<script src="/js/jquery-3-6-4.min.js" type="text/javascript" integrity=""></script>


<script src="/js/kube.min.a3a07cceb64989e2f0bf41653ab4d8346ba4312270eb5cc80d6afad3bf30a0ca9768aaa2559cb582e663332c541edab6a4068ef2e88b739fa425e2e870eb0aff.js" type="text/javascript" integrity="sha512-o6B8zrZJieLwv0FlOrTYNGukMSJw61zIDWr6078woMqXaKqiVZy1guZjMyxUHtq2pAaO8uiLc5&#43;kJeLocOsK/w=="></script>



<script src="/js/bootstrap.bundle.min.c15ed88f56a52190ea645094409cbce5537eaaf108972f777c840037b8aa0c508f12e70b09e345cf8af7e450a8f6ce96ae974340f8bcd316e58d707c063b6f72.js" type="text/javascript"
  integrity="sha512-wV7Yj1alIZDqZFCUQJy85VN&#43;qvEIly93fIQAN7iqDFCPEucLCeNFz4r35FCo9s6WrpdDQPi80xbljXB8Bjtvcg=="></script>



<script src="/js/code-copy.bb21b72280613039f1fabb11acc6a901c07caaee454933031066fbda6b5406fd31077a80ec913ba32261224d138bcbb4a34d27c51efae571c68d59282943b9a4.js" type="text/javascript"></script>



<script src="/js/code-copy-v2.71bcaee23ab00cb45dc944f321264e21d25bc1ec1ae76f9596286cb408ea5654b4ee016e7914cc2554b237114eeb467d39df18735311f2d28480b3ccd2feb4ad.js" type="text/javascript"></script>





<script
  type="module"
  src="https://static.cloud.coveo.com/atomic/v3.19.0/atomic.esm.js"
  integrity="sha512-VA9k6iDWhwxl8bwKUYPD63l93lGX7daV60k3yFxEt9EuEq4iWvsu5COq1mZ8OXKl0KCOFlUSDXS32Cy+YwbufQ=="
  crossorigin="anonymous">
</script>


<script class="coveo-script" src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/CoveoJsSearch.Lazy.min.js"
  integrity="sha512-HxdDBIp5snbqtu1TPkBnXLKEvN9IPz3PeZW8zT9KfsflV9Ck822XDroDlpVbfCfXeiu8C0RDVn0fdu7aGy/H1g=="
  crossorigin="anonymous"></script>

<script src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/templates/templates.js"
  integrity="sha512-CR0Yk/LIwgh1MsKqjecDp/r6F9ipKc6gA+4+E1pplT3N3r1pk+la/HaqyDiKtjOFwrwIIbIYBFrUJgPql93QHw=="
  crossorigin="anonymous"></script>






<script src="/js/coveo.min.4acfd205930e2d31230100f345e0463332eb3e3af1b4aa9a6e3131b0b2bac53566ae4d18b390066fce94c0c75d39b5e121d1291f81e5accc1a82d93da9f11b7f.js" integrity="sha512-Ss/SBZMOLTEjAQDzReBGMzLrPjrxtKqabjExsLK6xTVmrk0Ys5AGb86UwMddObXhIdEpH4HlrMwagtk9qfEbfw=="
  type="text/javascript"></script>


















<script src="/js/sidebar.min.6fed0180a23d01103c68ffb054a183fba5e7ba673de8c56d85857af964dcc0c11623ee09f6185207a373127cb2547ff9247ae3516ed47c67e1b58dbe71e9d576.js" type="text/javascript" integrity="sha512-b&#43;0BgKI9ARA8aP&#43;wVKGD&#43;6Xnumc96MVthYV6&#43;WTcwMEWI&#43;4J9hhSB6NzEnyyVH/5JHrjUW7UfGfhtY2&#43;cenVdg=="></script>
  


<script src="/js/site-dropdown.min.3bb49b6f7d25bcd4a2b008525bb8538d84237348bf618b40970ff6eca87119d68c326ca7ba04854ad102be36495fe1d70f1cb239916555b67dd17683dc283333.js" type="text/javascript" integrity="sha512-O7Sbb30lvNSisAhSW7hTjYQjc0i/YYtAlw/27KhxGdaMMmynugSFStECvjZJX&#43;HXDxyyOZFlVbZ90XaD3CgzMw=="></script>



<script src="/js/product-selector.min.b588249327fb12c7602fa08eb618560171f54e7348d6c1bacfdbf541f5e13023493f64f78fb6d4b9014892e5e4f0aaaee95b859bb37aa53bbe8c0e27e65167d1.js" type="text/javascript" integrity="sha512-tYgkkyf7EsdgL6COthhWAXH1TnNI1sG6z9v1QfXhMCNJP2T3j7bUuQFIkuXk8Kqu6VuFm7N6pTu&#43;jA4n5lFn0Q=="></script>



<script src="/js/sidebar-v2.min.3f906631e696b2c88883bfcfc62371165359130cfd118ceb49893ae0d8760dc38177ee3bb94a61dee45023115de8445f0b9fe48f933618ef7ba7b3180a05adbd.js" type="text/javascript" integrity="sha512-P5BmMeaWssiIg7/PxiNxFlNZEwz9EYzrSYk64Nh2DcOBd&#43;47uUph3uRQIxFd6ERfC5/kj5M2GO97p7MYCgWtvQ=="></script> 
  <div id="consent_blackbar"></div>
</body>
</html>


