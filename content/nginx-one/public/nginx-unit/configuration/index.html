<!DOCTYPE html>
<html lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>  
  <style>
    body {
       
      visibility: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
  </style>
  
  <noscript>
    <style>
       
      body {
        visibility: visible;
      }
    </style>
  </noscript>
  


  <script>

    const setTheme = (isNewTheme) => {
      localStorage.setItem("useNewTheme", `${isNewTheme}`);
      
      const v1cssIds = [
        "cssFA1",
        "cssFA2",
        "cssFA3",
        "cssBootstrap",
        "css1",
        "css2",
        "css3",
        "css4",
        "css5",
        "css6",
      ];

      v1cssIds.forEach((cssId) => {
        const element = document.getElementById(cssId);
        if (element !== null) {
          element.disabled = isNewTheme;
        }
      });

      const v2cssIds = ["css7", "css9"];
      v2cssIds.forEach((cssId) => {
        const element = document.getElementById(cssId);
        if (element !== null) {
          element.disabled = !isNewTheme;
        }
      });

      
      const v1ElementIds = ["sidebar", "footer", "toc", "api", "search-v1", "breadcrumb-v1", "list-v1"]

      v1ElementIds.forEach((elementId) => {
        const element = document.getElementById(elementId);
        if (element !== null) {
          element.style.display = isNewTheme ? "none" : "";
        }

        const trustarc = document.getElementById("teconsent-v1");
        if (trustarc) {
          trustarc.id = isNewTheme ? "teconsent-v1" : "teconsent";
        }
      });

      document.querySelectorAll(".table-v1").forEach((table) => {
        table.style.display = isNewTheme ? "none" : "";
      });

      const notMfElements = ['[data-mf="false"]'];
      notMfElements.forEach((elementId) => {
        document.querySelectorAll(elementId).forEach((element) => {
          element.style.display = isNewTheme ? "none" : "";
        });
      })

      const mfElements = ['[data-mf="true"]'];
      mfElements.forEach((elementId) => {
        document.querySelectorAll(elementId).forEach((element) => {
          element.style.display = isNewTheme ? "" : "none";

          const trustarc = document.getElementById("teconsent-v2");
          if (trustarc) {
            trustarc.id = isNewTheme ? "teconsent" : "teconsent-v2";
          }
        });
      });

      document.getElementById("body").style.visibility = "visible";
    };

    const toggleTheme = () => {
      setTheme(!(localStorage.getItem("useNewTheme") === "true"));
    };

    
    const mf = toggleTheme;
    const useNewTheme = toggleTheme;

    document.addEventListener("DOMContentLoaded", () => {
      setTheme(localStorage.getItem("useNewTheme") === "true");
    });

    function gameCode(callback) {
      let kkeys = [];
      
      const code = "38,38,40,40,37,39,37,39,66,65";
      return (event) => {
        kkeys.push(event.keyCode);
        if (kkeys.toString().indexOf(code) >= 0) {
          callback(event);
          kkeys = [];
        }
      };
    }
    const handler = gameCode(() => {
      mf();
    });
    window.addEventListener("keydown", handler);

  </script>

  

  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Configuration | DEV -- docs-nginx-com</title>






<link rel="canonical" href="http://localhost:1313/nginx-unit/configuration/">







<meta property="article:publisher" content="https://www.facebook.com/nginxinc" />
<meta property="og:image" content="http://localhost:1313/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta property="og:image:width" content="500" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="" />
<meta name="twitter:title" content="Configuration" />
<meta name="twitter:site" content="@nginx" />
<meta name="twitter:image" content="http://localhost:1313/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta name="twitter:creator" content="@nginx" />

<meta http-equiv="last-modified" content="26/05/2025" />




<meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline'
    https://consent.trustarc.com/ https://mktg.tags.f5.com/basic/prod/utag.sync.js https://static.cloud.coveo.com/ https://*.f5.com/
    https://*.netlify.app https://gist.github.com
    https://tag.demandbase.com/pscSDsz4.min.js
    https://munchkin.brightfunnel.com/js/build/bf-munchkin.min.js
    https://www.googletagmanager.com/gtm.js
    https://www.google-analytics.com/
    https://www.google-analytics.com/analytics.js
    https://www.google-analytics.com/plugins/ua/linkid.js
    https://cdn.bizible.com/scripts/bizible.js
    https://cdn.bizible.com/xdc.js
    https://f5networksglobalprod.122.2o7.net/
    https://f5networksnginxdocs.122.2o7.net/
    https://*.siteintercept.qualtrics.com/SIE/?Q_ZID=*
    https://siteintercept.qualtrics.com/
    ;
    worker-src 'self' blob:">



<meta property="environment" type="development" />
<meta property="buildtype" type="webdocs" />
<meta property="isServer" type="true" />


<meta name="product" content="DEV -- docs-nginx-com">
<meta name="version" content="">
<meta name="doc_type" content="Manual">
  
  <link rel="shortcut icon" type="image/x-icon" href="http://localhost:1313/images/favicon-48x48.ico">

  
  










<link href="/css/v2/style.css" integrity="" rel="stylesheet" type="text/css" id="css7"
  disabled>


<link href="/css/inter/inter.987d1be34797653eabce3627efb116c263d4045fd5badfe003ff283c5a5da435d83a3fad6bfe524e3ce3cf8a41168a30e7aa42507961257eeb275024def0f9b9.css" integrity="sha512-mH0b40eXZT6rzjYn77EWwmPUBF/Vut/gA/8oPFpdpDXYOj&#43;ta/5STjzjz4pBFoow56pCUHlhJX7rJ1Ak3vD5uQ==" rel="stylesheet" type="text/css"
  id="cssInter">


<link href="/css/v2/highlight.min.9ef7c7ad221175216abc8a5827f967bcd7c0e035bfa91180acd26a2c36d54242ae5f485986c260d70b1bbdf225ad76cdbba3179afa7e4335282cc3080a17e337.css" rel="stylesheet" type="text/css" id="css9">





<link href="/fontawesome/css/all.min.4a71f958af9b67180f1ece38b96217f8b2c9009f7fd8f90f299e508808fa4daf3ac3e7ec6f64e47267d1c955f7a419cc15c57ba103c9925f507af4825abdd6e8.css" integrity="sha512-SnH5WK&#43;bZxgPHs44uWIX&#43;LLJAJ9/2PkPKZ5QiAj6Ta86w&#43;fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" rel="stylesheet" type="text/css"
  id="cssFA1">


<link href="/fontawesome/css/v4-font-face.min.5870089ba06cf03e9721f87919eaf15c961a65e071845949ed2da58c5bfbd18a714c5dab2c155f0455ebcd2f45bfd598a5e47ae19976e7aa3a51e22914eac1b6.css" integrity="sha512-WHAIm6Bs8D6XIfh5GerxXJYaZeBxhFlJ7S2ljFv70YpxTF2rLBVfBFXrzS9Fv9WYpeR64Zl256o6UeIpFOrBtg==" rel="stylesheet" type="text/css"
  id="cssFA2">


<link href="/fontawesome/css/v5-font-face.min.81bdf1c9f8ff16b1eda613d52d868a059f16c8c6045c3d7e0a0b771622a11666cdd94b8ea62b5edb0d4b826c3a3737ec3663065fe05b56b6b871e57de73f556b.css" integrity="sha512-gb3xyfj/FrHtphPVLYaKBZ8WyMYEXD1&#43;Cgt3FiKhFmbN2UuOpite2w1Lgmw6NzfsNmMGX&#43;BbVra4ceV95z9Vaw==" rel="stylesheet" type="text/css"
  id="cssFA3">



<link href="/css/bootstrap.min.3f9320327d6304dd356ac060534cfad10938431897a3cebec2515a84aaec41fdfb73d72ba39d7b5b35523cf575b432b3864bb6889d855602faef01b4dd21a734.css" integrity="sha512-P5MgMn1jBN01asBgU0z60Qk4QxiXo86&#43;wlFahKrsQf37c9cro517WzVSPPV1tDKzhku2iJ2FVgL67wG03SGnNA==" rel="stylesheet"
  type="text/css" id="cssBootstrap">



<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.10104/0/css/CoveoFullSearch.min.css"
  integrity="sha512-9/A9yVCU4GS6/iIwTRJKnan4Hf8gDKj3anwItN9QCsU8SixaT5xkjjWsZ/iq0TWaizhtqOLacadXJfxHlwYCcA=="
  crossorigin="anonymous" />


<link
  rel="stylesheet"
  href="https://static.cloud.coveo.com/atomic/v3.19.0/themes/coveo.css"
  integrity="sha512-m2BufPi8Tc6H2jcQfDj/PIl5H57C9jeqhbDFgFXKTtOhoC4S7ULXmx74FseZ8WXpfdT9uyccMHDBJDrIZlrUUQ=="
  crossorigin="anonymous"/>


<link href="/css/docs-nginx-com/nginx-site-header.min.80b10ed49ecfad93607ee771acca88d13dc958e6eecc642af3aa2b170c86b8dcce442e7b86c3e5298c95b0ab2b053a71074c2f15c28266c3a2c502275415b3a7.css" rel="stylesheet" type="text/css" id="css1">


<link href="/css/docs-nginx-com/style.min.2cd4748c438c49d012a5fdc6b98770223c4875fe0f89517b17423b6a5328af4d93d9d772207bfc51d9449781281e1eb8707dcc2f7467e6e24330c9b8c7c5f734.css" rel="stylesheet" type="text/css" id="css2">


<link href="/css/bootstrap-docs.min.8a70c94c72e3783cecd631bc1705c7843b2fdef99f1549f0bf7f774a4083173ee25974413a8206c2340c0fee9bb7a07acd41d41c78ae2280c96a2ce0faca2847.css" rel="stylesheet" type="text/css" id="css3">



<link href="/css/coveo.min.fce7d4df31de99e4f86510a90915820f236b8dcd02be030b27529af7ff10189f807c78cedacb91afa9d07f310a172c6046b1921832f199b9158898a7f74fa117.css" rel="stylesheet" type="text/css" id="css6">



<link href="/css/f5-hugo.min.42feae8b135e9380a66db9c3cb2803221888524a29f41cbc55790b5cb5a309ac7e6dd80e70ed0260370fd93c04b7aa8a5c3d6aca0964804341fad51cfcec963f.css" rel="stylesheet" type="text/css" id="css4">


<link href="/css/inline-overrides.min.495e6889d9955581580c654bad961bb33af6344b283af7e9a34648c5e8d5f1fe90efb8aac33359c4178efd36cd7cb92c7c6458d4175caff9c284b14bd9d2b97a.css" rel="stylesheet" type="text/css" id="css8">





<link href="/css/highlight.min.fe5647c4b67f4b3fcf0ea60b483479d567ba1b05ee6e816439207edfa3d310dbee79536278c67d89c1db5da275bde962a10163da375f05bd19743e2a80e1ad02.css" rel="stylesheet" type="text/css" id="css5">
  
  
  
  
  
  
        
  <script async="async" src="https://consent.trustarc.com/notice?domain=f5.com&c=teconsent&js=nj&noticeType=bb&text=true&gtm=1" crossorigin=""></script>
  
  

<script src="https://mktg.tags.f5.com/basic/prod/utag.sync.js"></script> 


  
  
  
  
  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-K5HG9JT');</script>
  
  </head>
  
  <body id="body">
    
   
<script type="text/javascript"> 
    (function(a,b,c,d) { 
        a='//mktg.tags.f5.com/basic/prod/utag.js'; 
        b=document;c='script';d=b.createElement(c);d.src=a; 
        d.type='text/java'+c;d.async=true; 
        a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})(); 
</script> 
    
  
    <header>
      
<div class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar navbar-fixed-top">
  <div class="container-fluid flex-md-row flex-column header-container">
    <a class="navbar-brand mr-0 mr-md-2" href="/" aria-label="NGINX Docs">
      <img class="navbar-img" src="http://localhost:1313/images/icons/NGINX-Docs-horiz-white-type.svg" alt="NGINX Docs">
    </a>
    
      <div class="navbar navbar-nav">
        
        <div id="searchbox">
          
          <div class="CoveoSearchbox" data-placeholder='Search NGINX Docs...'></div>
        </div>
        <atomic-search-interface id="search-standalone-header" data-mf="true" style="display:none;">
          <atomic-search-box redirection-url="/search.html">
          </atomic-search-box>
        </atomic-search-interface>
      </div>
    
    
    
    
    <ul class="navbar navbar-nav">
        <li class="nav-item-explore active">
          <button id="navbar-sites-button" class="button navbar-button">
              F5 Sites
              <i id="navbar-sites-button-icon" class="link-chevron-icon fa-solid fa-chevron-down"></i>
          </button>
          <div class="dropdown-content" id="dropdown-content">
            <ul>
              
                <li>
                  <a href="https://community.f5.com/" target="_blank" >DevCentral</a>
                  <p>Connect &amp; learn in our hosted community</p>
                </li>
              
                <li>
                  <a href="https://my.f5.com/" target="_blank" >MyF5</a>
                  <p>Your key to everything F5, including support, registration keys, and subscriptions</p>
                </li>
              
                <li>
                  <a href="https://nginx.org/" target="_blank" >NGINX</a>
                  <p>Learn more about NGINX Open Source and read the community blog</p>
                </li>
              
            </ul>
          </div>
        </li>
    </ul>
  </div>
</div>


    </header>
  
    <section class="base-layout" data-testid="base-layout">
      <section id="breadcrumb-v1">
        
          
          <nav aria-label="breadcrumb" class="breadcrumb navbar">
    <div class="nav flex-md-row">
        <ol class="breadcrumb">
            
            
            
            
                
            
            
                
            
            
                
            
            
            
                <li><a href="/">Home</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-unit/">NGINX Unit</a><i class="fas fa-chevron-right"></i></li>
                
            
                Configuration
        </ol>
    </div>
</nav>
  
          
        
      </section>
  
      <div class="main container-fluid min-page-height" data-menu-id="/nginx-unit/configuration/">
        
<div class="docs-container row override-sidebar-collapse">
<div class="docs-container row override-sidebar-collapse">
  <nav id="sidebar" class="sidenav overflow-auto col-md-3 d-none d-xl-block d-print-none align-top">
    

<div id="sidebar-wrapper">
     <div id="sidebar" class="sidebar" aria-label="Sidebar navigation">
        <button id="sidebar-toggle-button" title="Toggle sidebar navigation" role="button" aria-controls="sidebar-content">
           <i class="fa fa-chevron-right sidebar-visible-collapsed"></i>
           <i class="fa fa-chevron-left sidebar-visible-expanded"></i>
        </button>
        <div id="sidebar-content">
            <h3>
                <a class="sidebar-title" href="http://localhost:1313/nginx-unit/" alt="NGINX Unit"><img
                        class="card-img-top" src="http://localhost:1313//images/icons/NGINX-Unit-product-icon-RGB.png"
                        alt="NGINX Unit">
                    NGINX Unit</a>
            </h3>
            <ul>
            
            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/about/" href="http://localhost:1313/nginx-unit/about/">About NGINX Unit</a>
                </li>
                
                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/keyfeatures/" href="http://localhost:1313/nginx-unit/keyfeatures/">Key features</a>
                </li>
                
                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/installation/" href="http://localhost:1313/nginx-unit/installation/">Installation</a>
                </li>
                
                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/controlapi/" href="http://localhost:1313/nginx-unit/controlapi/">Control API</a>
                </li>
                
                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/configuration/" href="http://localhost:1313/nginx-unit/configuration/">Configuration</a>
                </li>
                
                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/scripting/" href="http://localhost:1313/nginx-unit/scripting/">Scripting</a>
                </li>
                
                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/certificates/" href="http://localhost:1313/nginx-unit/certificates/">SSL/TLS certificates</a>
                </li>
                
                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/statusapi/" href="http://localhost:1313/nginx-unit/statusapi/">Status API</a>
                </li>
                
                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/unitctl/" href="http://localhost:1313/nginx-unit/unitctl/">CLI (unitctl)</a>
                </li>
                
                

            
                
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                    <a data-menu-id="/unit/howto/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#unit--how-to-guides" aria-controls="unit--how-to-guides">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>How-to guides</a>
                            </li>
                        </div>
                        <div id="unit--how-to-guides" class="accordion-body collapse">
                            <div class="accordion-inner">
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/overview/"
                                                                href="http://localhost:1313/nginx-unit/howto/overview/">Overview</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/docker/"
                                                                href="http://localhost:1313/nginx-unit/howto/docker/">Unit in Docker</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/source/"
                                                                href="http://localhost:1313/nginx-unit/howto/source/">Building from source</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/ansible/"
                                                                href="http://localhost:1313/nginx-unit/howto/ansible/">Unit in Ansible</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/integration/"
                                                                href="http://localhost:1313/nginx-unit/howto/integration/">NGINX integration</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/certbot/"
                                                                href="http://localhost:1313/nginx-unit/howto/certbot/">TLS with Certbot</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/modules/"
                                                                href="http://localhost:1313/nginx-unit/howto/modules/">Working with language modules</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/samples/"
                                                                href="http://localhost:1313/nginx-unit/howto/samples/">App samples</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/security/"
                                                                href="http://localhost:1313/nginx-unit/howto/security/">Security checklist</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <ul class="sidebar-reg-padding">
                                        <div class="accordion" id="accordion2">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/nginx-unit/howto/walkthrough/"
                                                                href="http://localhost:1313/nginx-unit/howto/walkthrough/">Walkthrough</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                    
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/unit/howto/frameworks/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#unit--howto--frameworks">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Frameworks</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="unit--howto--frameworks" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/bottle/" href="http://localhost:1313/nginx-unit/howto/frameworks/bottle/">Bottle</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/cakephp/" href="http://localhost:1313/nginx-unit/howto/frameworks/cakephp/">CakePHP</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/catalyst/" href="http://localhost:1313/nginx-unit/howto/frameworks/catalyst/">Catalyst</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/codeigniter/" href="http://localhost:1313/nginx-unit/howto/frameworks/codeigniter/">CodeIgniter</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/django/" href="http://localhost:1313/nginx-unit/howto/frameworks/django/">Django</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/djangochannels/" href="http://localhost:1313/nginx-unit/howto/frameworks/djangochannels/">Django Channels</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/express/" href="http://localhost:1313/nginx-unit/howto/frameworks/express/">Express</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/falcon/" href="http://localhost:1313/nginx-unit/howto/frameworks/falcon/">Falcon</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/fastapi/" href="http://localhost:1313/nginx-unit/howto/frameworks/fastapi/">FastAPI</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/flask/" href="http://localhost:1313/nginx-unit/howto/frameworks/flask/">Flask</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/guillotina/" href="http://localhost:1313/nginx-unit/howto/frameworks/guillotina/">Gillotina</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/koa/" href="http://localhost:1313/nginx-unit/howto/frameworks/koa/">Koa</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/laravel/" href="http://localhost:1313/nginx-unit/howto/frameworks/laravel/">Laravel</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/lumen/" href="http://localhost:1313/nginx-unit/howto/frameworks/lumen/">Lumen</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/pyramid/" href="http://localhost:1313/nginx-unit/howto/frameworks/pyramid/">Pyramid</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/quart/" href="http://localhost:1313/nginx-unit/howto/frameworks/quart/">Quart</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/responder/" href="http://localhost:1313/nginx-unit/howto/frameworks/responder/">Responder</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/rails/" href="http://localhost:1313/nginx-unit/howto/frameworks/rails/">Ruby on Rails</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/sanic/" href="http://localhost:1313/nginx-unit/howto/frameworks/sanic/">Sanic</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/springboot/" href="http://localhost:1313/nginx-unit/howto/frameworks/springboot/">Spring Boot</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/starlette/" href="http://localhost:1313/nginx-unit/howto/frameworks/starlette/">Starlette</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/symfony/" href="http://localhost:1313/nginx-unit/howto/frameworks/symfony/">Symfony</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/yii/" href="http://localhost:1313/nginx-unit/howto/frameworks/yii/">Yii</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/frameworks/zope/" href="http://localhost:1313/nginx-unit/howto/frameworks/zope/">Zope</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/unit/howto/apps/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#unit--howto--applications">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Applications</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="unit--howto--applications" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/apollo/" href="http://localhost:1313/nginx-unit/howto/apps/apollo/">Apollo</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/bugzilla/" href="http://localhost:1313/nginx-unit/howto/apps/bugzilla/">Bugzilla</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/datasette/" href="http://localhost:1313/nginx-unit/howto/apps/datasette/">Datasette</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/dokuwiki/" href="http://localhost:1313/nginx-unit/howto/apps/dokuwiki/">DokuWiki</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/drupal/" href="http://localhost:1313/nginx-unit/howto/apps/drupal/">Drupal</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/grafana/" href="http://localhost:1313/nginx-unit/howto/apps/grafana/">Grafana</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/jira/" href="http://localhost:1313/nginx-unit/howto/apps/jira/">Jira</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/joomla/" href="http://localhost:1313/nginx-unit/howto/apps/joomla/">Joomla</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/mailman/" href="http://localhost:1313/nginx-unit/howto/apps/mailman/">Mailman Web</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/matomo/" href="http://localhost:1313/nginx-unit/howto/apps/matomo/">Matomo</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/mediawiki/" href="http://localhost:1313/nginx-unit/howto/apps/mediawiki/">MediaWiki</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/mercurial/" href="http://localhost:1313/nginx-unit/howto/apps/mercurial/">Mercurial</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/modx/" href="http://localhost:1313/nginx-unit/howto/apps/modx/">MODX</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/moin/" href="http://localhost:1313/nginx-unit/howto/apps/moin/">MoinMoin</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/nextcloud/" href="http://localhost:1313/nginx-unit/howto/apps/nextcloud/">NextCloud</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/opengrok/" href="http://localhost:1313/nginx-unit/howto/apps/opengrok/">OpenGrok</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/phpbb/" href="http://localhost:1313/nginx-unit/howto/apps/phpbb/">phpBB</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/phpmyadmin/" href="http://localhost:1313/nginx-unit/howto/apps/phpmyadmin/">phpMyAdmin</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/plone/" href="http://localhost:1313/nginx-unit/howto/apps/plone/">Plone</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/redmine/" href="http://localhost:1313/nginx-unit/howto/apps/redmine/">Redmine</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/reviewboard/" href="http://localhost:1313/nginx-unit/howto/apps/reviewboard/">Review Board</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/roundcube/" href="http://localhost:1313/nginx-unit/howto/apps/roundcube/">Roundcube</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/trac/" href="http://localhost:1313/nginx-unit/howto/apps/trac/">Trac</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/howto/apps/wordpress/" href="http://localhost:1313/nginx-unit/howto/apps/wordpress/">WordPress</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                            </div>
                        </div>
                    </div>
                </div>

                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/troubleshooting/" href="http://localhost:1313/nginx-unit/troubleshooting/">Troubleshooting</a>
                </li>
                
                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/community/" href="http://localhost:1313/nginx-unit/community/">Community</a>
                </li>
                
                

            
                
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                    <a data-menu-id="/unit/news/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#unit--releases-and-announcements" aria-controls="unit--releases-and-announcements">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Releases and announcements</a>
                            </li>
                        </div>
                        <div id="unit--releases-and-announcements" class="accordion-body collapse">
                            <div class="accordion-inner">
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/unit/news/2025/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#unit--news--2025">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>2025</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="unit--news--2025" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2025/unit-1.34.2-released/" href="http://localhost:1313/nginx-unit/news/2025/unit-1.34.2-released/">Unit 1.34.2 Released</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2025/unit-1.34.1-released/" href="http://localhost:1313/nginx-unit/news/2025/unit-1.34.1-released/">Unit 1.34.1 Released</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/unit/news/2024/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#unit--news--2024">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>2024</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="unit--news--2024" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2024/unit-1.34.0-released/" href="http://localhost:1313/nginx-unit/news/2024/unit-1.34.0-released/">Unit 1.34.0 Released</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2024/unit-1.33.0-released/" href="http://localhost:1313/nginx-unit/news/2024/unit-1.33.0-released/">Unit 1.33.0 Released</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2024/unit-1.32.1-released/" href="http://localhost:1313/nginx-unit/news/2024/unit-1.32.1-released/">Unit 1.32.1 Released</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2024/wasm-component-model-part-1/" href="http://localhost:1313/nginx-unit/news/2024/wasm-component-model-part-1/">The WebAssembly Component Model - Part 1</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2024/fermyon-spin-rust-sdk/" href="http://localhost:1313/nginx-unit/news/2024/fermyon-spin-rust-sdk/">Wasm Components: Working with the Spin SDK for Rust</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2024/wasm-component-model-part-2/" href="http://localhost:1313/nginx-unit/news/2024/wasm-component-model-part-2/">The WebAssembly Component Model - Part 2</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2024/unit-1.32.0-released/" href="http://localhost:1313/nginx-unit/news/2024/unit-1.32.0-released/">Unit 1.32.0 Released</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/unit/news/2023/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#unit--news--2023">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>2023</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="unit--news--2023" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2023/unit-1.31.1-released/" href="http://localhost:1313/nginx-unit/news/2023/unit-1.31.1-released/">Unit 1.31.1 Released</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2023/unit-1.31.0-released/" href="http://localhost:1313/nginx-unit/news/2023/unit-1.31.0-released/">Unit 1.31.0 Released</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/2023/unit-1.30.0-released/" href="http://localhost:1313/nginx-unit/news/2023/unit-1.30.0-released/">Unit 1.30.0 Released</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                                
                                    
                                    <div class="accordion" id="Accordion2">
                                        <div class="sidebar-l1-padding">
                                            <div class="accordion-group sidebar-il-border">
                                                <div class="accordion-heading">
                                                    <ul>
                                                        <li class="nginx-toc-link l2">
                                                            <a data-menu-id="/unit/news/archived-news/" class="accordion-toggle"
                                                                aria-expanded="false" data-toggle="collapse"
                                                                href="#unit--news--archived-news-and-releases">
                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>Archived news and releases</a>
                                                        </li>
                                                    <ul>
                                                </div>
                                                <div id="unit--news--archived-news-and-releases" class="accordion-body collapse leaf">
                                                    <div class="accordion-inner">

                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/archived-news/2022/" href="http://localhost:1313/nginx-unit/news/archived-news/2022/">2022</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/archived-news/2021/" href="http://localhost:1313/nginx-unit/news/archived-news/2021/">2021</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/archived-news/2020/" href="http://localhost:1313/nginx-unit/news/archived-news/2020/">2020</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/archived-news/2019/" href="http://localhost:1313/nginx-unit/news/archived-news/2019/">2019</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                        
                                                        
                                                        <ul class="sidebar-l2-padding">
                                                            <li class="nginx-toc-link l3 sidebar-il-border">
                                                                <a data-menu-id="/nginx-unit/news/archived-news/2018/" href="http://localhost:1313/nginx-unit/news/archived-news/2018/">2018</a>
                                                            </li>
                                                        </ul>
                                                        
                                                        
                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                
                            </div>
                        </div>
                    </div>
                </div>

                

            
                
                
                <li class="nginx-toc-link l1">
                    <a data-menu-id="/nginx-unit/changes/" href="http://localhost:1313/nginx-unit/changes/">Changelog</a>
                </li>
                
                

            

            </ul>
        
        </div>
    </div>
</div>

  </nav>

  
  
  <main class="content col d-block align-top content-has-toc" role="main">
  
    
  <section class="main-layout">
    <div class="sidebar-layout" id="sidebar-layout">
      <nav data-mf="true" id="sidebar-v2" class="sidebar" style="display:none;">
        


    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    





<atomic-search-interface id="search-standalone-sidebar" data-mf="true" style="display:none;">
    <atomic-search-box redirection-url="/search.html">
    </atomic-search-box>
</atomic-search-interface>
<button class="product-selector-button" id="product-selector-button">
    
    <div class="product-selector-name" id="product-selector-name"></div>
    <div class="product-selector-button-icon" id="product-selector-button-icon">
        <svg width="8" height="14" viewBox="0 0 8 14" fill="none" xmlns="http://www.w3.org/2000/svg" id="product-selector-chevron-icon">
            <path d="M1 13L7 7L0.999999 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="product-selector-chevron-icon"/>
        </svg>     
    </div>
</button>
<div class="product-selector" id="product-selector">
    
    
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX ONE</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-one">NGINX One Console</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx">NGINX Plus</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-instance-manager">NGINX Instance Manager</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-ingress-controller">NGINX Ingress Controller</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-gateway-fabric">NGINX Gateway Fabric</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="https://nginx.org/en/docs/">NGINX Open Source</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/solutions/">Subscription Licensing &amp; Solutions</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-agent">NGINX Agent</a>
                </li>
            
            </ul>
        </div>
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX APP PROTECT</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-app-protect-waf">NGINX App Protect WAF</a>
                </li>
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginx-app-protect-dos">NGINX App Protect DoS</a>
                </li>
            
            </ul>
        </div>
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX AS A SERVICE</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="/nginxaas/azure/">NGINX as a Service for Azure</a>
                </li>
            
            </ul>
        </div>
    
    
    
        <div class="product-selector-content" id="product-selector-content">
            <p id="product-selector-content-product-group-name">NGINX OTHER</p>
            <ul id="product-selector-content-product-container">
            
                <li id="product-selector-content-product-name">
                    <a id="product-selector-content-product-link" href="https://unit.nginx.org/">NGINX Unit</a>
                </li>
            
            </ul>
        </div>
    
</div>
<div class="scrollbar-container">
    <div class="sidebar-navigation">
        <ul class="parent-collapsible-content">
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/about/" style="">About NGINX Unit </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/keyfeatures/" style="">Key features </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/installation/" style="">Installation </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/controlapi/" style="">Control API </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                          
                        <span class="parent-box current"></span>                 
                    
                    <a href="http://localhost:1313/nginx-unit/configuration/" style="font-weight: bold;">Configuration </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/scripting/" style="">Scripting </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/certificates/" style="">SSL/TLS certificates </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/statusapi/" style="">Status API </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/unitctl/" style="">CLI (unitctl) </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                    <input type="checkbox" id="toggle-b6e715b43382624248394739e8be75c3" class="toggle-checkbox" style="display: none;">
                    <label for="toggle-b6e715b43382624248394739e8be75c3" class="collapsible-header">
                        
                            <span class="parent-box expand"></span>
                            <span class="parent-box opened"></span>
                        
                        How-to guides 
                    </label>
                    

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/overview/" style="">Overview </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/docker/" style="">Unit in Docker </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/source/" style="">Building from source </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/ansible/" style="">Unit in Ansible </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/integration/" style="">NGINX integration </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/certbot/" style="">TLS with Certbot </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/modules/" style="">Working with language modules </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/samples/" style="">App samples </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/security/" style="">Security checklist </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/walkthrough/" style="">Walkthrough </a>
            
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-b9a8b338bd61a9bae8c8fa73c4586030" class="toggle-checkbox" style="display: none;">
            <label for="toggle-b9a8b338bd61a9bae8c8fa73c4586030" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Frameworks 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/bottle/" style="">Bottle </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/cakephp/" style="">CakePHP </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/catalyst/" style="">Catalyst </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/codeigniter/" style="">CodeIgniter </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/django/" style="">Django </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/djangochannels/" style="">Django Channels </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/express/" style="">Express </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/falcon/" style="">Falcon </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/fastapi/" style="">FastAPI </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/flask/" style="">Flask </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/guillotina/" style="">Gillotina </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/koa/" style="">Koa </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/laravel/" style="">Laravel </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/lumen/" style="">Lumen </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/pyramid/" style="">Pyramid </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/quart/" style="">Quart </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/responder/" style="">Responder </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/rails/" style="">Ruby on Rails </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/sanic/" style="">Sanic </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/springboot/" style="">Spring Boot </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/starlette/" style="">Starlette </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/symfony/" style="">Symfony </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/yii/" style="">Yii </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/frameworks/zope/" style="">Zope </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-09968d1fab0955a476618b0867701204" class="toggle-checkbox" style="display: none;">
            <label for="toggle-09968d1fab0955a476618b0867701204" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Applications 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/apollo/" style="">Apollo </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/bugzilla/" style="">Bugzilla </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/datasette/" style="">Datasette </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/dokuwiki/" style="">DokuWiki </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/drupal/" style="">Drupal </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/grafana/" style="">Grafana </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/jira/" style="">Jira </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/joomla/" style="">Joomla </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/mailman/" style="">Mailman Web </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/matomo/" style="">Matomo </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/mediawiki/" style="">MediaWiki </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/mercurial/" style="">Mercurial </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/modx/" style="">MODX </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/moin/" style="">MoinMoin </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/nextcloud/" style="">NextCloud </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/opengrok/" style="">OpenGrok </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/phpbb/" style="">phpBB </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/phpmyadmin/" style="">phpMyAdmin </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/plone/" style="">Plone </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/redmine/" style="">Redmine </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/reviewboard/" style="">Review Board </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/roundcube/" style="">Roundcube </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/trac/" style="">Trac </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/howto/apps/wordpress/" style="">WordPress </a>
            
        
    </li>
    
</ul>
        
    </li>
    
</ul>
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/troubleshooting/" style="">Troubleshooting </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/community/" style="">Community </a> 
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                    <input type="checkbox" id="toggle-0e4363fdcd4863867aa569d5be04e127" class="toggle-checkbox" style="display: none;">
                    <label for="toggle-0e4363fdcd4863867aa569d5be04e127" class="collapsible-header">
                        
                            <span class="parent-box expand"></span>
                            <span class="parent-box opened"></span>
                        
                        Releases and announcements 
                    </label>
                    

<ul class="collapsible-content">
    
    <li>
        
            <input type="checkbox" id="toggle-1b6332cd201c87d0e2953192a375ee2e" class="toggle-checkbox" style="display: none;">
            <label for="toggle-1b6332cd201c87d0e2953192a375ee2e" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                2025 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2025/unit-1.34.2-released/" style="">Unit 1.34.2 Released </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2025/unit-1.34.1-released/" style="">Unit 1.34.1 Released </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-9a89bf12616959ac9b7812a25ae1ce66" class="toggle-checkbox" style="display: none;">
            <label for="toggle-9a89bf12616959ac9b7812a25ae1ce66" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                2024 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2024/unit-1.34.0-released/" style="">Unit 1.34.0 Released </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2024/unit-1.33.0-released/" style="">Unit 1.33.0 Released </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2024/unit-1.32.1-released/" style="">Unit 1.32.1 Released </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2024/wasm-component-model-part-1/" style="">The WebAssembly Component Model - Part 1 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2024/fermyon-spin-rust-sdk/" style="">Wasm Components: Working with the Spin SDK for Rust </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2024/wasm-component-model-part-2/" style="">The WebAssembly Component Model - Part 2 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2024/unit-1.32.0-released/" style="">Unit 1.32.0 Released </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-1d94092ba120418b2dac0a184ca22a06" class="toggle-checkbox" style="display: none;">
            <label for="toggle-1d94092ba120418b2dac0a184ca22a06" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                2023 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2023/unit-1.31.1-released/" style="">Unit 1.31.1 Released </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2023/unit-1.31.0-released/" style="">Unit 1.31.0 Released </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/2023/unit-1.30.0-released/" style="">Unit 1.30.0 Released </a>
            
        
    </li>
    
</ul>
        
    </li>
    
    <li>
        
            <input type="checkbox" id="toggle-2276752c1e9c38d1e48c111bdb8669df" class="toggle-checkbox" style="display: none;">
            <label for="toggle-2276752c1e9c38d1e48c111bdb8669df" class="collapsible-header">
                
                    <span class="box expand partial-box"></span>
                    <span class="box opened partial-box"></span>
                
                Archived news and releases 
            </label>
            

<ul class="collapsible-content">
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/archived-news/2022/" style="">2022 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/archived-news/2021/" style="">2021 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/archived-news/2020/" style="">2020 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/archived-news/2019/" style="">2019 </a>
            
        
    </li>
    
    <li>
        
                                 
                <span class="box-link partial"></span>              
            
            <a href="http://localhost:1313/nginx-unit/news/archived-news/2018/" style="">2018 </a>
            
        
    </li>
    
</ul>
        
    </li>
    
</ul>
                
            </li>
        
            <li class="parent-collapsible-content-item">
                
                                         
                        <span class="parent-box-link"></span>              
                    
                    <a href="http://localhost:1313/nginx-unit/changes/" style="">Changelog </a> 
                
            </li>
        
        </ul>
    </div>
</div>
      </nav>
    </div>

    <section class="content-layout">
      <div data-cms-edit="content" class="text-content">
        <section class="breadcrumb-layout" data-mf="true" style="display: none;">
          
            
            <nav aria-label="breadcrumb" class="breadcrumb navbar">
    <div class="nav flex-md-row">
        <ol class="breadcrumb">
            
            
            
            
                
            
            
                
            
            
                
            
            
            
                <li><a href="/">Home</a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-unit/">NGINX Unit</a><i class="fas fa-chevron-right"></i></li>
                
            
                Configuration
        </ol>
    </div>
</nav>
  
            
          
        </section>
        <h1>Configuration</h1>
        <blockquote class="note">
  <div><strong>Note:</strong><br/> The commands in this document starting with a hash (#) must be run as root or
with superuser privileges.</div>
</blockquote>

<p>The <strong>/config</strong> section of the
<a href="/nginx-unit/controlapi/#configuration-api">control API</a>
handles Unit&rsquo;s general configuration with entities such as
<a href="/nginx-unit/configuration/#configuration-listeners">listeners</a>,
<a href="/nginx-unit/configuration/#configuration-routes">routes</a>,
<a href="/nginx-unit/configuration/#configuration-applications">applications</a>,
or
<a href="/nginx-unit/configuration/#configuration-upstreams">upstreams</a>.</p>
<h2 
id="configuration-listeners">Listeners  <a class="headerlink float-right" href="#configuration-listeners" title="Listeners"><i class="fas fa-link fa-xs"></i></a>
</h2><p>To accept requests,
add a listener object in the <strong>config/listeners</strong> API section;
the object&rsquo;s name can be:</p>
<ul>
<li>A unique IP socket:
<strong>127.0.0.1:80</strong>, <strong>[::1]:8080</strong></li>
<li>A wildcard that matches any host IPs on the port:
<strong>*:80</strong></li>
<li>On Linux-based systems, <a href="https://man7.org/linux/man-pages/man7/unix.7.html" target="_blank" rel="noopener">abstract UNIX sockets</a>
can be used as well: <strong>unix:@abstract_socket</strong>.</li>
</ul>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Also on Linux-based systems, wildcard listeners can&rsquo;t overlap with other listeners
on the same port due to rules imposed by the kernel.
For example, <strong>*:8080</strong> conflicts with <strong>127.0.0.1:8080</strong>;
in particular, this means <strong>*:8080</strong> can&rsquo;t be <em>immediately</em> replaced
by <strong>127.0.0.1:8080</strong> (or vice versa) without deleting it first.</div>
</blockquote>

<p>Unit dispatches the requests it receives to destinations referenced by listeners.
You can plug several listeners into one destination or use a single listener
and hot-swap it between multiple destinations.</p>
<p>Available listener options:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>pass</strong> (required)</td>
          <td style="text-align: left">Destination to which the listener passes incoming requests. Possible alternatives: <br><br> - <a href="%20relref%20%22/unit/configuration.md#configuration-applications%22">Application</a>: <strong>applications/qwk2mart</strong> <br><br> - <a href="/nginx-unit/configuration/#configuration-php-targets">PHP target</a> or <a href="/nginx-unit/configuration/#configuration-python-targets">Python target</a>: <strong>applications/myapp/section</strong> <br><br> - <a href="/nginx-unit/configuration/#configuration-routes">Route</a>: <strong>routes/route66</strong>, <strong>routes</strong> <br><br> - <a href="/nginx-unit/configuration/#configuration-upstreams">Upstream</a>: <strong>upstreams/rr-lb</strong> <br><br> The value is <a href="/nginx-unit/configuration/#configuration-variables-native">variable</a>-interpolated; if it matches no configuration entities after interpolation, a 404 &ldquo;Not Found&rdquo; response is returned.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>forwarded</strong></td>
          <td style="text-align: left">Object; configures client IP address and protocol <a href="/nginx-unit/configuration/#configuration-listeners-forwarded">replacement</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>tls</strong></td>
          <td style="text-align: left">Object; defines SSL/TLS <a href="/nginx-unit/configuration/#configuration-listeners-ssl">settings</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>backlog</strong></td>
          <td style="text-align: left">Integer; controls the &lsquo;backlog&rsquo; parameter to the <em>listen(2)</em> system-call. This essentially limits the number of pending connections waiting to be accepted. The default varies by system. <br><br> On Linux, FreeBSD, OpenBSD, and macOS, the default is <strong>-1</strong> which means use the OS default. For example, on Linux since 5.4, this is <strong>4096</strong> (previously <strong>128</strong>) and on FreeBSD it&rsquo;s <strong>128</strong>. On other systems, the default is <strong>511</strong>. <br><br> NOTE: Whatever limit you set here will be limited by the OS system-wide sysctl. For example, on Linux that is <code>net.core.somaxconn</code> and on BSD it&rsquo;s <code>kern.ipc.somaxconn</code>. <em>(since 1.33.0)</em></td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>pass</strong> (required)</td>
          <td style="text-align: left">Destination to which the listener passes incoming requests. Possible alternatives: <br><br> - <a href="%20relref%20%22/unit/configuration.md#configuration-applications%22">Application</a>: <strong>applications/qwk2mart</strong> <br><br> - <a href="/nginx-unit/configuration/#configuration-php-targets">PHP target</a> or <a href="/nginx-unit/configuration/#configuration-python-targets">Python target</a>: <strong>applications/myapp/section</strong> <br><br> - <a href="/nginx-unit/configuration/#configuration-routes">Route</a>: <strong>routes/route66</strong>, <strong>routes</strong> <br><br> - <a href="/nginx-unit/configuration/#configuration-upstreams">Upstream</a>: <strong>upstreams/rr-lb</strong> <br><br> The value is <a href="/nginx-unit/configuration/#configuration-variables-native">variable</a>-interpolated; if it matches no configuration entities after interpolation, a 404 &ldquo;Not Found&rdquo; response is returned.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>forwarded</strong></td>
          <td style="text-align: left">Object; configures client IP address and protocol <a href="/nginx-unit/configuration/#configuration-listeners-forwarded">replacement</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>tls</strong></td>
          <td style="text-align: left">Object; defines SSL/TLS <a href="/nginx-unit/configuration/#configuration-listeners-ssl">settings</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>backlog</strong></td>
          <td style="text-align: left">Integer; controls the &lsquo;backlog&rsquo; parameter to the <em>listen(2)</em> system-call. This essentially limits the number of pending connections waiting to be accepted. The default varies by system. <br><br> On Linux, FreeBSD, OpenBSD, and macOS, the default is <strong>-1</strong> which means use the OS default. For example, on Linux since 5.4, this is <strong>4096</strong> (previously <strong>128</strong>) and on FreeBSD it&rsquo;s <strong>128</strong>. On other systems, the default is <strong>511</strong>. <br><br> NOTE: Whatever limit you set here will be limited by the OS system-wide sysctl. For example, on Linux that is <code>net.core.somaxconn</code> and on BSD it&rsquo;s <code>kern.ipc.somaxconn</code>. <em>(since 1.33.0)</em></td>
      </tr>
  </tbody>
</table>

</div>
<p>Here, a local listener accepts requests at port 8300 and passes them to the <strong>blogs</strong> app
<a href="/nginx-unit/configuration/#configuration-php-targets">target</a>
identified by the <strong>uri</strong> <a href="/nginx-unit/configuration/#configuration-variables-native">variable</a>.
The wildcard listener on port 8400 relays requests at any host IPs to the <strong>main</strong>
<a href="/nginx-unit/configuration/#configuration-routes">route</a>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaa1af10&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaa1af10">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;127.0.0.1:8300&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/blogs$uri&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;*:8400&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/main&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;127.0.0.1:8300&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/blogs$uri&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;*:8400&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/main&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Also, <strong>pass</strong> values can be
<a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">percent encoded</a>.
For example, you can escape slashes in entity names:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaa3ed48&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaa3ed48">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/slashes%2Fin%2Froute%2Fname&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;slashes/in/route/name&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/slashes%2Fin%2Froute%2Fname&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;slashes/in/route/name&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h3 
id="configuration-listeners-ssl">SSL/TLS configuration  <a class="headerlink float-right" href="#configuration-listeners-ssl" title="SSL/TLS configuration"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The <strong>tls</strong> object provides the following options:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>certificate</strong> (required)</td>
          <td style="text-align: left">String or an array of strings; refers to one or more <a href="/nginx-unit/certificates/">certificate bundles</a> uploaded earlier, enabling secure communication via the listener.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>conf_commands</strong></td>
          <td style="text-align: left">Object; defines the OpenSSL <a href="https://www.openssl.org/docs/manmaster/man3/SSL_CONF_cmd.html" target="_blank" rel="noopener">configuration commands</a> to be set for the listener. <br><br> To have this option, Unit must be built and run with OpenSSL 1.0.2 or later. <br><br> Also, make sure your OpenSSL version supports the commands set by this option.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>session</strong></td>
          <td style="text-align: left">Object; configures the TLS session cache and tickets for the listener.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>certificate</strong> (required)</td>
          <td style="text-align: left">String or an array of strings; refers to one or more <a href="/nginx-unit/certificates/">certificate bundles</a> uploaded earlier, enabling secure communication via the listener.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>conf_commands</strong></td>
          <td style="text-align: left">Object; defines the OpenSSL <a href="https://www.openssl.org/docs/manmaster/man3/SSL_CONF_cmd.html" target="_blank" rel="noopener">configuration commands</a> to be set for the listener. <br><br> To have this option, Unit must be built and run with OpenSSL 1.0.2 or later. <br><br> Also, make sure your OpenSSL version supports the commands set by this option.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>session</strong></td>
          <td style="text-align: left">Object; configures the TLS session cache and tickets for the listener.</td>
      </tr>
  </tbody>
</table>

</div>
<p>To use a certificate bundle you
<a href="/nginx-unit/certificates/#configuration-ssl">uploaded</a>
earlier,
name it in the <strong>certificate</strong> option of the <strong>tls</strong> object:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaa642f0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaa642f0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:443&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/wsgi-app&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;tls&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;bundle&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;comment_certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;Certificate bundle name&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:443&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/wsgi-app&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;tls&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;bundle&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;comment_certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;Certificate bundle name&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><details>
<summary>Configuring multiple bundles</summary>
<p>Since version 1.23.0, Unit supports configuring
<a href="https://datatracker.ietf.org/doc/html/rfc6066#section-3" target="_blank" rel="noopener">Server Name Indication (SNI)</a>
on a listener by supplying an array of certificate bundle names for the
<strong>certificate</strong> option value:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaa842a8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaa842a8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;*:443&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;tls&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;certificate&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                   <span class="s2">&#34;bundleA&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="s2">&#34;bundleB&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="s2">&#34;bundleC&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="p">]</span>
</span></span><span class="line"><span class="cl">           <span class="p">}</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;*:443&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;tls&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;certificate&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                   <span class="s2">&#34;bundleA&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="s2">&#34;bundleB&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="s2">&#34;bundleC&#34;</span>
</span></span><span class="line"><span class="cl">               <span class="p">]</span>
</span></span><span class="line"><span class="cl">           <span class="p">}</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span></span></span></code></pre></div>
</div><ul>
<li>If the connecting client sends a server name,
Unit responds with the matching certificate bundle.</li>
<li>If the name matches several bundles,
exact matches have priority over wildcards;
if this doesn&rsquo;t help, the one listed first is used.</li>
<li>If there&rsquo;s no match or no server name was sent, Unit uses
the first bundle on the list.</li>
</ul>
</details>
<p>To set custom OpenSSL
<a href="https://www.openssl.org/docs/manmaster/man3/SSL_CONF_cmd.html" target="_blank" rel="noopener">configuration commands</a>
for a listener,
use the <strong>conf_commands</strong> object in <strong>tls</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaab1168&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaab1168">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tls&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;bundle&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;Certificate bundle name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;conf_commands&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;ciphersuites&#34;</span><span class="p">:</span> <span class="s2">&#34;TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_ciphersuites&#34;</span><span class="p">:</span> <span class="s2">&#34;Mandatory cipher suites as per RFC8446, section 9.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;minprotocol&#34;</span><span class="p">:</span> <span class="s2">&#34;TLSv1.3&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tls&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;bundle&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;Certificate bundle name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;conf_commands&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;ciphersuites&#34;</span><span class="p">:</span> <span class="s2">&#34;TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_ciphersuites&#34;</span><span class="p">:</span> <span class="s2">&#34;Mandatory cipher suites as per RFC8446, section 9.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;minprotocol&#34;</span><span class="p">:</span> <span class="s2">&#34;TLSv1.3&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p><a name="configuration-listeners-ssl-sessions"></a></p>
<p>The <strong>session</strong> object in <strong>tls</strong>
configures the session settings of the listener:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>cache_size</strong></td>
          <td style="text-align: left">Integer; sets the number of sessions in the TLS session cache. <br><br> The default is <strong>0</strong> (caching is disabled).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>tickets</strong></td>
          <td style="text-align: left">Boolean, string, or an array of strings; configures TLS session tickets. <br><br> The default is <strong>false</strong> (tickets are disabled).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>timeout</strong></td>
          <td style="text-align: left">Integer; sets the session timeout for the TLS session cache. <br><br> When a new session is created, its lifetime derives from current time and <strong>timeout</strong>. If a cached session is requested past its lifetime, it is not reused. <br><br> The default is <strong>300</strong> (5 minutes).</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>cache_size</strong></td>
          <td style="text-align: left">Integer; sets the number of sessions in the TLS session cache. <br><br> The default is <strong>0</strong> (caching is disabled).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>tickets</strong></td>
          <td style="text-align: left">Boolean, string, or an array of strings; configures TLS session tickets. <br><br> The default is <strong>false</strong> (tickets are disabled).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>timeout</strong></td>
          <td style="text-align: left">Integer; sets the session timeout for the TLS session cache. <br><br> When a new session is created, its lifetime derives from current time and <strong>timeout</strong>. If a cached session is requested past its lifetime, it is not reused. <br><br> The default is <strong>300</strong> (5 minutes).</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example">Example:  <a class="headerlink float-right" href="#example" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaafb8d0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaafb8d0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tls&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;bundle&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;Certificate bundle name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;session&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;cache_size&#34;</span><span class="p">:</span> <span class="mi">10240</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;timeout&#34;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;tickets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;k5qMHi7IMC7ktrPY3lZ+sL0Zm8oC0yz6re+y/zCj0H0/sGZ7yPBwGcb77i5vw6vCx8vsQDyuvmFb6PZbf03Auj/cs5IHDTYkKIcfbwz6zSU=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;3Cy+xMFsCjAek3TvXQNmCyfXCnFNAcAOyH5xtEaxvrvyyCS8PJnjOiq2t4Rtf/Gq&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;8dUI0x3LRnxfN0miaYla46LFslJJiBDNdFiPJdqr37mYQVIzOWr+ROhyb1hpmg/QCM2qkIEWJfrJX3I+rwm0t0p4EGdEVOXQj7Z8vHFcbiA=&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tls&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;bundle&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_certificate&#34;</span><span class="p">:</span> <span class="s2">&#34;Certificate bundle name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;session&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;cache_size&#34;</span><span class="p">:</span> <span class="mi">10240</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;timeout&#34;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;tickets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;k5qMHi7IMC7ktrPY3lZ+sL0Zm8oC0yz6re+y/zCj0H0/sGZ7yPBwGcb77i5vw6vCx8vsQDyuvmFb6PZbf03Auj/cs5IHDTYkKIcfbwz6zSU=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;3Cy+xMFsCjAek3TvXQNmCyfXCnFNAcAOyH5xtEaxvrvyyCS8PJnjOiq2t4Rtf/Gq&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;8dUI0x3LRnxfN0miaYla46LFslJJiBDNdFiPJdqr37mYQVIzOWr+ROhyb1hpmg/QCM2qkIEWJfrJX3I+rwm0t0p4EGdEVOXQj7Z8vHFcbiA=&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The <strong>tickets</strong> option works as follows:</p>
<ul>
<li>
<p>Boolean values enable or disable session tickets;
with <strong>true</strong>, a random session ticket key is used:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffab31430&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffab31430">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;session&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;tickets&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;comment_tickets&#34;</span><span class="p">:</span> <span class="s2">&#34;Enables session tickets&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;session&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;tickets&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;comment_tickets&#34;</span><span class="p">:</span> <span class="s2">&#34;Enables session tickets&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span></span></span></code></pre></div>
</div></li>
<li>
<p>A string enables tickets and explicitly sets the session ticket key:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffab6a258&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffab6a258">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;session&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;tickets&#34;</span><span class="p">:</span> <span class="s2">&#34;IAMkP16P8OBuqsijSDGKTpmxrzfFNPP4EdRovXH2mqstXsodPC6MqIce5NlMzHLP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;comment_tickets&#34;</span><span class="p">:</span> <span class="s2">&#34;Enables session tickets, sets a single session ticket key&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;session&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;tickets&#34;</span><span class="p">:</span> <span class="s2">&#34;IAMkP16P8OBuqsijSDGKTpmxrzfFNPP4EdRovXH2mqstXsodPC6MqIce5NlMzHLP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;comment_tickets&#34;</span><span class="p">:</span> <span class="s2">&#34;Enables session tickets, sets a single session ticket key&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This enables ticket reuse in scenarios
where the key is shared between individual servers.</p>
 <details>
 <summary>Shared key rotation</summary>
 If multiple Unit instances need to recognize tickets
 issued by each other
 (for example, when running behind a load balancer),
 they should share session ticket keys.
<p>For example,
consider three SSH-enabled servers named <code>unit*.example.com</code>,
with Unit installed and identical <code>:443</code> listeners configured.
To configure a single set of three initial keys on each server:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffab9e260&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffab9e260">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">SERVERS=&#34;unit1.example.com
</span></span></span><span class="line"><span class="cl"><span class="go">      unit2.example.com
</span></span></span><span class="line"><span class="cl"><span class="go">      unit3.example.com&#34;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">KEY1=$(openssl rand -base64 48)
</span></span></span><span class="line"><span class="cl"><span class="go">KEY2=$(openssl rand -base64 48)
</span></span></span><span class="line"><span class="cl"><span class="go">KEY3=$(openssl rand -base64 48)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">for SRV in $SERVERS; do
</span></span></span><span class="line"><span class="cl"><span class="go">   ssh root@$SRV \ # Assuming Unit runs as root on each server
</span></span></span><span class="line"><span class="cl"><span class="go">      curl -X PUT -d &#39;[&#34;$KEY1&#34;, &#34;$KEY2&#34;, &#34;$KEY3&#34;]&#39; --unix-socket /path/to/control.unit.sock \ # Path to the remote control socket
</span></span></span><span class="line"><span class="cl"><span class="go">      &#39;http://localhost/config/listeners/*:443/tls/session/tickets/&#39;
</span></span></span><span class="line"><span class="cl"><span class="go">done
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">SERVERS=&#34;unit1.example.com
</span></span></span><span class="line"><span class="cl"><span class="go">      unit2.example.com
</span></span></span><span class="line"><span class="cl"><span class="go">      unit3.example.com&#34;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">KEY1=$(openssl rand -base64 48)
</span></span></span><span class="line"><span class="cl"><span class="go">KEY2=$(openssl rand -base64 48)
</span></span></span><span class="line"><span class="cl"><span class="go">KEY3=$(openssl rand -base64 48)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">for SRV in $SERVERS; do
</span></span></span><span class="line"><span class="cl"><span class="go">   ssh root@$SRV \ # Assuming Unit runs as root on each server
</span></span></span><span class="line"><span class="cl"><span class="go">      curl -X PUT -d &#39;[&#34;$KEY1&#34;, &#34;$KEY2&#34;, &#34;$KEY3&#34;]&#39; --unix-socket /path/to/control.unit.sock \ # Path to the remote control socket
</span></span></span><span class="line"><span class="cl"><span class="go">      &#39;http://localhost/config/listeners/*:443/tls/session/tickets/&#39;
</span></span></span><span class="line"><span class="cl"><span class="go">done
</span></span></span></code></pre></div>
</div><p>To add a new key on each server:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffabdbac0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffabdbac0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">NEWKEY</span><span class="o">=</span><span class="k">$(</span>openssl rand -base64 48<span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> SRV in <span class="nv">$SERVERS</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">   ssh root@<span class="nv">$SRV</span> <span class="se">\ </span><span class="c1"># Assuming Unit runs as root on each server</span>
</span></span><span class="line"><span class="cl">      curl -X POST -d <span class="s2">&#34;\&#34;</span><span class="nv">$NEWKEY</span><span class="s2">\&#34;&#34;</span> --unix-socket /path/to/control.unit.sock <span class="se">\ </span><span class="c1"># Path to the remote control socket</span>
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;http://localhost/config/listeners/*:443/tls/session/tickets/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">NEWKEY</span><span class="o">=</span><span class="k">$(</span>openssl rand -base64 48<span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> SRV in <span class="nv">$SERVERS</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">   ssh root@<span class="nv">$SRV</span> <span class="se">\ </span><span class="c1"># Assuming Unit runs as root on each server</span>
</span></span><span class="line"><span class="cl">      curl -X POST -d <span class="s2">&#34;\&#34;</span><span class="nv">$NEWKEY</span><span class="s2">\&#34;&#34;</span> --unix-socket /path/to/control.unit.sock <span class="se">\ </span><span class="c1"># Path to the remote control socket</span>
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;http://localhost/config/listeners/*:443/tls/session/tickets/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></div>
</div><p>To delete the oldest key after adding the new one:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">shell</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffac079e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffac079e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="k">for</span> SRV in <span class="nv">$SERVERS</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">   ssh root@<span class="nv">$SRV</span> <span class="se">\ </span><span class="c1"># Assuming Unit runs as root on each server</span>
</span></span><span class="line"><span class="cl">      curl -X DELETE --unix-socket /path/to/control.unit.sock <span class="se">\ </span><span class="c1"># Path to the remote control socket</span>
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;http://localhost/config/listeners/*:443/tls/session/tickets/0&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="k">for</span> SRV in <span class="nv">$SERVERS</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">   ssh root@<span class="nv">$SRV</span> <span class="se">\ </span><span class="c1"># Assuming Unit runs as root on each server</span>
</span></span><span class="line"><span class="cl">      curl -X DELETE --unix-socket /path/to/control.unit.sock <span class="se">\ </span><span class="c1"># Path to the remote control socket</span>
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;http://localhost/config/listeners/*:443/tls/session/tickets/0&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></div>
</div><h2 
id="between-individual-unit-instances">This scheme enables safely sharing session ticket keys
between individual Unit instances.  <a class="headerlink float-right" href="#between-individual-unit-instances" title="This scheme enables safely sharing session ticket keys
between individual Unit instances."><i class="fas fa-link fa-xs"></i></a>
</h2> </details>
<p>Unit supports AES256 (80-byte keys) or AES128 (48-byte keys);
the bytes should be encoded in Base64:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffac2a878&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffac2a878">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> openssl rand -base64 <span class="m">48</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      LoYjFVxpUFFOj4TzGkr5MsSIRMjhuh8RCsVvtIJiQ12FGhn0nhvvQsEND1+OugQ7
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> openssl rand -base64 <span class="m">48</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      LoYjFVxpUFFOj4TzGkr5MsSIRMjhuh8RCsVvtIJiQ12FGhn0nhvvQsEND1+OugQ7
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffac43ad0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffac43ad0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> openssl rand -base64 <span class="m">80</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      GQczhdXawyhTrWrtOXI7l3YYUY98PrFYzjGhBbiQsAWgaxm+mbkm4MmZZpDw0tkK
</span></span></span><span class="line"><span class="cl"><span class="go">      YTqYWxofDtDC4VBznbBwTJTCgYkJXknJc4Gk2zqD1YA=
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> openssl rand -base64 <span class="m">80</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      GQczhdXawyhTrWrtOXI7l3YYUY98PrFYzjGhBbiQsAWgaxm+mbkm4MmZZpDw0tkK
</span></span></span><span class="line"><span class="cl"><span class="go">      YTqYWxofDtDC4VBznbBwTJTCgYkJXknJc4Gk2zqD1YA=
</span></span></span></code></pre></div>
</div></li>
<li>
<p>An array of strings just like the one above:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffac61b48&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffac61b48">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;session&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;tickets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">             <span class="s2">&#34;IAMkP16P8OBuqsijSDGKTpmxrzfFNPP4EdRovXH2mqstXsodPC6MqIce5NlMzHLP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="s2">&#34;Ax4bv/JvMWoQG+BfH0feeM9Qb32wSaVVKOj1+1hmyU8ORMPHnf3Tio8gLkqm2ifC&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="p">],</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;comment_tickets&#34;</span><span class="p">:</span> <span class="s2">&#34;Enables session tickets, sets two session ticket keys&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;session&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;tickets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">             <span class="s2">&#34;IAMkP16P8OBuqsijSDGKTpmxrzfFNPP4EdRovXH2mqstXsodPC6MqIce5NlMzHLP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="s2">&#34;Ax4bv/JvMWoQG+BfH0feeM9Qb32wSaVVKOj1+1hmyU8ORMPHnf3Tio8gLkqm2ifC&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="p">],</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;comment_tickets&#34;</span><span class="p">:</span> <span class="s2">&#34;Enables session tickets, sets two session ticket keys&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span></span></span></code></pre></div>
</div><p>Unit uses these keys to decrypt the tickets submitted by clients
who want to recover their session state;
the last key is always used to create new session tickets
and update the tickets created earlier.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> An empty array effectively disables session tickets,
same as setting <strong>tickets</strong> to <strong>false</strong>.</div>
</blockquote>

</li>
</ul>
<h3 
id="configuration-listeners-forwarded">IP, protocol forwarding  <a class="headerlink float-right" href="#configuration-listeners-forwarded" title="IP, protocol forwarding"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Unit enables the <strong>X-Forwarded-*</strong> header fields
with the <strong>forwarded</strong> object and its options:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>source</strong> (required)</td>
          <td style="text-align: left">String or an array of strings; defines <a href="/nginx-unit/configuration/#configuration-routes-matching-patterns">address-based patterns</a> for trusted addresses. Replacement occurs only if the source IP of the request is a <a href="configuration-routes-matching-resolution">match</a>. <br><br> A special case here is the <strong>&ldquo;unix&rdquo;</strong> string; it matches <em>any</em> UNIX domain sockets.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>client_ip</strong></td>
          <td style="text-align: left">String; names the HTTP header fields to expect in the request. They should use the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For%3e" target="_blank" rel="noopener">X-Forwarded-For</a> format where the value is a comma- or space-separated list of IPv4s or IPv6s.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>protocol</strong></td>
          <td style="text-align: left">String; defines the relevant HTTP header field to look for in the request. Unit expects it to follow the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-Proto%3e" target="_blank" rel="noopener">X-Forwarded-Proto</a> notation, with the field value itself being <strong>http</strong>, <strong>https</strong>, or <strong>on</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>recursive</strong></td>
          <td style="text-align: left">Boolean; controls how the <strong>client_ip</strong> fields are traversed. <br><br> The default is <strong>false</strong> (no recursion).</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>source</strong> (required)</td>
          <td style="text-align: left">String or an array of strings; defines <a href="/nginx-unit/configuration/#configuration-routes-matching-patterns">address-based patterns</a> for trusted addresses. Replacement occurs only if the source IP of the request is a <a href="configuration-routes-matching-resolution">match</a>. <br><br> A special case here is the <strong>&ldquo;unix&rdquo;</strong> string; it matches <em>any</em> UNIX domain sockets.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>client_ip</strong></td>
          <td style="text-align: left">String; names the HTTP header fields to expect in the request. They should use the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For%3e" target="_blank" rel="noopener">X-Forwarded-For</a> format where the value is a comma- or space-separated list of IPv4s or IPv6s.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>protocol</strong></td>
          <td style="text-align: left">String; defines the relevant HTTP header field to look for in the request. Unit expects it to follow the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-Proto%3e" target="_blank" rel="noopener">X-Forwarded-Proto</a> notation, with the field value itself being <strong>http</strong>, <strong>https</strong>, or <strong>on</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>recursive</strong></td>
          <td style="text-align: left">Boolean; controls how the <strong>client_ip</strong> fields are traversed. <br><br> The default is <strong>false</strong> (no recursion).</td>
      </tr>
  </tbody>
</table>

</div>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Besides <strong>source</strong>, the <strong>forwarded</strong> object must specify
<strong>client_ip</strong>, <strong>protocol</strong>, or both.</div>
</blockquote>

<blockquote class="warning call-out">
  <div><strong class="call-out-type">Warning</strong><br/> <p>Before version 1.28.0, Unit provided the <strong>client_ip</strong> object
that evolved into <strong>forwarded</strong>:</p>
<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left"><strong>client_ip</strong> (pre-1.28.0)</th>
          <th style="text-align: left"><strong>forwarded</strong> (post-1.28.0)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>header</strong></td>
          <td style="text-align: left"><strong>client_ip</strong></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>recursive</strong></td>
          <td style="text-align: left"><strong>recursive</strong></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>source</strong></td>
          <td style="text-align: left"><strong>source</strong></td>
      </tr>
      <tr>
          <td style="text-align: left">N/A</td>
          <td style="text-align: left"><strong>protocol</strong></td>
      </tr>
  </tbody>
</table>
<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>client_ip</strong> (pre-1.28.0)</th>
          <th style="text-align: left"><strong>forwarded</strong> (post-1.28.0)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>header</strong></td>
          <td style="text-align: left"><strong>client_ip</strong></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>recursive</strong></td>
          <td style="text-align: left"><strong>recursive</strong></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>source</strong></td>
          <td style="text-align: left"><strong>source</strong></td>
      </tr>
      <tr>
          <td style="text-align: left">N/A</td>
          <td style="text-align: left"><strong>protocol</strong></td>
      </tr>
  </tbody>
</table>
</div>
<p>This old syntax still works but will be eventually deprecated,
though not earlier than version 1.30.0.</p>
</div>
</blockquote>

<p>When <strong>forwarded</strong> is set, Unit respects the appropriate header fields
only if the immediate source IP of the request
<a href="/nginx-unit/configuration/#configuration-routes-matching-resolution">matches</a>
the <strong>source</strong> option. Mind that it can use not only subnets but any
<a href="/nginx-unit/configuration/#configuration-routes-matching-patterns">address-based patterns</a>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffacb95a0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffacb95a0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;forwarded&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;client_ip&#34;</span><span class="p">:</span> <span class="s2">&#34;X-Forwarded-For&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.1-198.51.100.254&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;comment_source_1&#34;</span><span class="err">:</span> <span class="s2">&#34;Ranges can be specified explicitly&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!198.51.100.128/26&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;comment_source_2&#34;</span><span class="err">:</span> <span class="s2">&#34;Negation rejects any addresses originating here&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;203.0.113.195&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;comment_source_3&#34;</span><span class="err">:</span> <span class="s2">&#34;Individual addresses are supported as well&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;forwarded&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;client_ip&#34;</span><span class="p">:</span> <span class="s2">&#34;X-Forwarded-For&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.1-198.51.100.254&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;comment_source_1&#34;</span><span class="err">:</span> <span class="s2">&#34;Ranges can be specified explicitly&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!198.51.100.128/26&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;comment_source_2&#34;</span><span class="err">:</span> <span class="s2">&#34;Negation rejects any addresses originating here&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;203.0.113.195&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;comment_source_3&#34;</span><span class="err">:</span> <span class="s2">&#34;Individual addresses are supported as well&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="configuration-listeners-xfp">Overwriting protocol scheme  <a class="headerlink float-right" href="#configuration-listeners-xfp" title="Overwriting protocol scheme"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The <strong>protocol</strong> option enables overwriting the incoming request&rsquo;s protocol scheme
based on the header field it specifies. Consider the following <strong>forwarded</strong> configuration:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffad019e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffad019e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;forwarded&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;X-Forwarded-Proto&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.0/24&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;forwarded&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;X-Forwarded-Proto&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.0/24&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Suppose a request arrives with the following header field:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffad29698&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1ffad29698">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">X-Forwarded-Proto: https</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">X-Forwarded-Proto: https</span></span></code></pre></div>
</div><p>If the source IP of the request matches <strong>source</strong>,
Unit handles this request as an <strong>https</strong> one.</p>
<h4 
id="configuration-listeners-xff">Originating IP identification  <a class="headerlink float-right" href="#configuration-listeners-xff" title="Originating IP identification"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Unit also supports identifying the clients&rsquo; originating IPs
with the <strong>client_ip</strong> option:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffad4d0e8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffad4d0e8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;forwarded&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;client_ip&#34;</span><span class="p">:</span> <span class="s2">&#34;X-Forwarded-For&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;recursive&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.0/24&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;forwarded&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;client_ip&#34;</span><span class="p">:</span> <span class="s2">&#34;X-Forwarded-For&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;recursive&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.0/24&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Suppose a request arrives with the following header fields:</p>



<div class="code-block" data-mf="true" style="display: none;"><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffad628a8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffad628a8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">X-Forwarded-For: 192.0.2.18
</span></span><span class="line"><span class="cl">X-Forwarded-For: 203.0.113.195, 198.51.100.178</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">X-Forwarded-For: 192.0.2.18
</span></span><span class="line"><span class="cl">X-Forwarded-For: 203.0.113.195, 198.51.100.178</span></span></code></pre></div>
</div><p>If <strong>recursive</strong> is set to <strong>false</strong> (default), Unit chooses the <em>rightmost</em>
address of the <em>last</em> field named in <strong>client_ip</strong> as the originating IP of the
request.
In the example, it&rsquo;s set to 198.51.100.178 for requests from 192.0.2.0/24 or 198.51.100.0/24.</p>
<p>If <strong>recursive</strong> is set to <strong>true</strong>, Unit inspects all <strong>client_ip</strong> fields in reverse order.
Each is traversed from right to left until the first non-trusted address;
if found, it&rsquo;s chosen as the originating IP. In the previous example with <strong>&ldquo;recursive&rdquo;: true</strong>,
the client IP would be set to 203.0.113.195 because 198.51.100.178 is also trusted;
this simplifies working behind multiple reverse proxies.</p>
<h2 
id="configuration-routes">Routes  <a class="headerlink float-right" href="#configuration-routes" title="Routes"><i class="fas fa-link fa-xs"></i></a>
</h2><p>The <strong>config/routes</strong> configuration entity defines internal request routing.
It receives requests
from <a href="/nginx-unit/configuration/#configuration-listeners">listeners</a>
and filters them through
<a href="/nginx-unit/configuration/#configuration-routes-matching">sets of conditions</a>
to be processed by
<a href="/nginx-unit/configuration/#configuration-applications">apps</a>,
<a href="/nginx-unit/configuration/#configuration-proxy">proxied</a>
to external servers or
<a href="/nginx-unit/configuration/#configuration-upstreams">load-balanced</a>
between them,
served with
<a href="/nginx-unit/configuration/#configuration-static">static content</a>,
<a href="/nginx-unit/configuration/#configuration-return">answered</a>
with arbitrary status codes, or
<a href="/nginx-unit/configuration/#configuration-return">redirected</a>.</p>
<p>In its simplest form, <strong>routes</strong> is an array that defines a single route:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffadcd798&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffadcd798">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;*:8300&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;comment_routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;hint&#34;</span><span class="p">:</span> <span class="s2">&#34;Array-mode routes, simply referred to as &#39;routes&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;placeholder&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable route array may go here; see the &#39;Route Steps&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;*:8300&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;comment_routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;hint&#34;</span><span class="p">:</span> <span class="s2">&#34;Array-mode routes, simply referred to as &#39;routes&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;placeholder&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable route array may go here; see the &#39;Route Steps&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Another form is an object with one or more named route arrays as members:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffae02b28&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffae02b28">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;*:8300&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/main&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;main&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;comment&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable route array may go here; see the &#39;Route Steps&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;comment_main&#34;</span><span class="p">:</span> <span class="s2">&#34;Named route, referred to as &#39;routes/main&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;route66&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;comment&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable route array may go here; see the &#39;Route Steps&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;comment_route66&#34;</span><span class="p">:</span> <span class="s2">&#34;Named route, referred to as &#39;routes/route66&#39;&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;*:8300&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/main&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;main&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;comment&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable route array may go here; see the &#39;Route Steps&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;comment_main&#34;</span><span class="p">:</span> <span class="s2">&#34;Named route, referred to as &#39;routes/main&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;route66&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;comment&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable route array may go here; see the &#39;Route Steps&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;comment_route66&#34;</span><span class="p">:</span> <span class="s2">&#34;Named route, referred to as &#39;routes/route66&#39;&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h3 
id="configuration-routes-step">Route steps  <a class="headerlink float-right" href="#configuration-routes-step" title="Route steps"><i class="fas fa-link fa-xs"></i></a>
</h3><p>A
<a href="/nginx-unit/configuration/#configuration-routes">route</a>
array contains step objects as elements; they accept the following options:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>action</strong> (required)</td>
          <td style="text-align: left">Object; defines how matching requests are <a href="/nginx-unit/configuration/#configuration-routes-action">handled</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>match</strong></td>
          <td style="text-align: left">Object; defines the step&rsquo;s <a href="/nginx-unit/configuration/#configuration-routes-matching">conditions</a>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>action</strong> (required)</td>
          <td style="text-align: left">Object; defines how matching requests are <a href="/nginx-unit/configuration/#configuration-routes-action">handled</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>match</strong></td>
          <td style="text-align: left">Object; defines the step&rsquo;s <a href="/nginx-unit/configuration/#configuration-routes-matching">conditions</a>.</td>
      </tr>
  </tbody>
</table>

</div>
<p>A request passed to a route traverses its steps sequentially:</p>
<ul>
<li>If all <strong>match</strong> conditions in a step are met, the traversal ends
and the step&rsquo;s <strong>action</strong> is performed.</li>
<li>If a step&rsquo;s condition isn&rsquo;t met, Unit proceeds to the next step of the route.</li>
<li>If no steps of the route match, a 404 &ldquo;Not Found&rdquo; response is returned.</li>
</ul>
<blockquote class="warning call-out">
  <div><strong class="call-out-type">Warning</strong><br/> If a step omits the <strong>match</strong> option, its <strong>action</strong> occurs automatically.
Thus, use no more than one such step per route, always placing it last to
avoid potential routing issues.</div>
</blockquote>

<details>
<summary>Ad-Hoc examples</summary>
A basic one:



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffae4c6d8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffae4c6d8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;scheme&#34;</span><span class="p">:</span> <span class="s2">&#34;https&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/php/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php_version&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static_version$uri&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;scheme&#34;</span><span class="p">:</span> <span class="s2">&#34;https&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/php/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php_version&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static_version$uri&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This route passes all HTTPS requests to the <strong>/php/</strong> subsection of the
<strong>example.com</strong> website to the <strong>php_version</strong> app.
All other requests are served with static content from the <strong>/www/static_version/</strong>
directory. If there&rsquo;s no matching content,a 404 &ldquo;Not Found&rdquo; response is returned.</p>
<p>A more elaborate example with chained routes and proxying:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaed90d8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaed90d8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;main&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;scheme&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/http_site&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;blog.example.com&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/blog&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;*.css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;*.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;*.js&#34;</span>
</span></span><span class="line"><span class="cl">                     <span class="p">]</span>
</span></span><span class="line"><span class="cl">                  <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static$uri&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;http_site&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/v2_site/*&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/v2_site&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;main&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;scheme&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/http_site&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;blog.example.com&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/blog&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;*.css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;*.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;*.js&#34;</span>
</span></span><span class="line"><span class="cl">                     <span class="p">]</span>
</span></span><span class="line"><span class="cl">                  <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static$uri&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;http_site&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/v2_site/*&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/v2_site&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here, a route called <strong>main</strong> is explicitly defined, so <strong>routes</strong> is an object
instead of an array. The first step of the route passes all HTTP requests
to the <strong>http_site</strong> app. The second step passes all requests that target
<strong>blog.example.com</strong> to the <strong>blog</strong> app. The final step serves requests for
certain file types from the <strong>/www/static/</strong> directory.
If no steps match, a 404 &ldquo;Not Found&rdquo; response is returned.</p>
<hr>
</details>
<h3 
id="configuration-routes-matching">Matching conditions  <a class="headerlink float-right" href="#configuration-routes-matching" title="Matching conditions"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Conditions in a
<a href="/nginx-unit/configuration/#configuration-routes-step">route step</a>&rsquo;s
<strong>match</strong> object
define patterns to be compared to the request&rsquo;s properties:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Property</th>
          <th style="text-align: left">Patterns Are Matched Against</th>
          <th style="text-align: left">Case</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>arguments</strong></td>
          <td style="text-align: left">Arguments supplied with the request&rsquo;s <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">query string</a>; these names and value pairs are <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">percent decoded</a>, with plus signs (<strong>+</strong>) replaced by spaces.</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>cookies</strong></td>
          <td style="text-align: left">Cookies supplied with the request.</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>destination</strong></td>
          <td style="text-align: left">Target IP address and optional port of the request.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>headers</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc9110#section-6.3" target="_blank" rel="noopener">Header fields</a> supplied with the request.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>host</strong></td>
          <td style="text-align: left"><strong>Host</strong> <a href="https://datatracker.ietf.org/doc/html/rfc9110#section-7.2" target="_blank" rel="noopener">header field</a>, converted to lower case and normalized by removing the port number and the trailing period (if any).</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>method</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc7231#section-4" target="_blank" rel="noopener">Method</a> from the request line, uppercased.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>query</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">Query string</a>, <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">percent decoded</a>, with plus signs (<strong>+</strong>) replaced by spaces.</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>scheme</strong></td>
          <td style="text-align: left">URI <a href="https://www.iana.org/assignments/uri-schemes/uri-schemes.xhtml" target="_blank" rel="noopener">scheme</a>. Accepts only two patterns, either <strong>http</strong> or <strong>https</strong>.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>source</strong></td>
          <td style="text-align: left">Source IP address and optional port of the request.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>uri</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc9110#target.resource" target="_blank" rel="noopener">Request target</a>, <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">percent decoded</a> and normalized by removing the <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">query string</a> and resolving <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-4.2" target="_blank" rel="noopener">relative references</a> (&quot;.&quot; and &ldquo;..&rdquo;, &ldquo;//&rdquo;).</td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Property</th>
          <th style="text-align: left">Patterns Are Matched Against</th>
          <th style="text-align: left">Case</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>arguments</strong></td>
          <td style="text-align: left">Arguments supplied with the request&rsquo;s <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">query string</a>; these names and value pairs are <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">percent decoded</a>, with plus signs (<strong>+</strong>) replaced by spaces.</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>cookies</strong></td>
          <td style="text-align: left">Cookies supplied with the request.</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>destination</strong></td>
          <td style="text-align: left">Target IP address and optional port of the request.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>headers</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc9110#section-6.3" target="_blank" rel="noopener">Header fields</a> supplied with the request.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>host</strong></td>
          <td style="text-align: left"><strong>Host</strong> <a href="https://datatracker.ietf.org/doc/html/rfc9110#section-7.2" target="_blank" rel="noopener">header field</a>, converted to lower case and normalized by removing the port number and the trailing period (if any).</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>method</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc7231#section-4" target="_blank" rel="noopener">Method</a> from the request line, uppercased.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>query</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">Query string</a>, <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">percent decoded</a>, with plus signs (<strong>+</strong>) replaced by spaces.</td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>scheme</strong></td>
          <td style="text-align: left">URI <a href="https://www.iana.org/assignments/uri-schemes/uri-schemes.xhtml" target="_blank" rel="noopener">scheme</a>. Accepts only two patterns, either <strong>http</strong> or <strong>https</strong>.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>source</strong></td>
          <td style="text-align: left">Source IP address and optional port of the request.</td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>uri</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc9110#target.resource" target="_blank" rel="noopener">Request target</a>, <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">percent decoded</a> and normalized by removing the <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">query string</a> and resolving <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-4.2" target="_blank" rel="noopener">relative references</a> (&quot;.&quot; and &ldquo;..&rdquo;, &ldquo;//&rdquo;).</td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>

</div>
<details>
<summary>Arguments vs. query</summary>
<p>Both <strong>arguments</strong> and <strong>query</strong> operate on the query string,
but <strong>query</strong> is matched against the entire string whereas <strong>arguments</strong> considers
only the key-value pairs such as <strong>key1=4861&amp;key2=a4f3</strong>.</p>
<p>Use <strong>arguments</strong> to define conditions based on key-value pairs in the query string:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaf1fda8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaf1fda8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;arguments&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;key1&#34;</span><span class="p">:</span> <span class="s2">&#34;4861&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;key2&#34;</span><span class="p">:</span> <span class="s2">&#34;a4f3&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;arguments&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;key1&#34;</span><span class="p">:</span> <span class="s2">&#34;4861&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;key2&#34;</span><span class="p">:</span> <span class="s2">&#34;a4f3&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Argument order is irrelevant: <strong>key1=4861&amp;key2=a4f3</strong> and <strong>key2=a4f3&amp;key1=4861</strong>
are considered the same. Also, multiple occurrences of an argument must all match,
so <strong>key=4861&amp;key=a4f3</strong> matches this:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaf55138&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaf55138">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;arguments&#34;</span><span class="err">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;arguments&#34;</span><span class="err">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>But not this:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffaf81058&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffaf81058">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;arguments&#34;</span><span class="err">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;a*&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;arguments&#34;</span><span class="err">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;a*&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>To the contrary, use <strong>query</strong> if your conditions concern query strings
but don&rsquo;t rely on key-value pairs:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffafab420&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffafab420">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;query&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;utf8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;utf16&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;query&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;utf8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;utf16&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
</div><p>This only matches query strings of the form
<strong><a href="https://example.com?utf8" target="_blank" rel="noopener">https://example.com?utf8</a></strong> or <strong><a href="https://example.com?utf16" target="_blank" rel="noopener">https://example.com?utf16</a></strong>.</p>
<hr>
</details>
<h4 
id="configuration-routes-matching-resolution">Match resolution  <a class="headerlink float-right" href="#configuration-routes-matching-resolution" title="Match resolution"><i class="fas fa-link fa-xs"></i></a>
</h4><p>To be a match,
the property must meet two requirements:</p>
<ul>
<li>If there are patterns without negation
(the <strong>!</strong> prefix),
at least one of them matches the property value.</li>
<li>No negated patterns match the property value.</li>
</ul>
<details>
<summary>Formal explanation</summary>
<p>This logic can be described with set operations.
Suppose set <em>U</em> comprises all possible values of a property;
set <em>P</em> comprises strings that match any patterns without negation;
set <em>N</em> comprises strings that match any negation-based patterns.
In this scheme,
the matching set is:</p>
<p><em>U</em> ∩ <em>P</em> \ <em>N</em> if <em>P</em> ≠ ∅</p>
<p><em>U</em> \ <em>N</em> if <em>P</em> = ∅</p>
<hr>
</details>
<p>Here, the URI of the request must fit <strong>pattern3</strong>,
but must not match <strong>pattern1</strong> or <strong>pattern2</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb0022c0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb0022c0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!pattern1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!pattern2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;pattern3&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!pattern1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!pattern2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;pattern3&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Additionally, special matching logic applies to <strong>arguments</strong>, <strong>cookies</strong>,
and <strong>headers</strong>. Each of these can be either a single object that lists
custom-named properties and their patterns or an array of such objects.</p>
<p>To match a single object, the request must match <em>all</em> properties named in the object.
To match an object array, it&rsquo;s enough to match <em>any</em> single one of its item objects.
The following condition matches only if the request arguments include <strong>arg1</strong> and <strong>arg2</strong>,
and both match their patterns:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb052bd0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb052bd0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;arg1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;arg2&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;arg1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;arg2&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>With an object array, the condition matches if the request&rsquo;s arguments include
<strong>arg1</strong> or <strong>arg2</strong> (or both) that matches the respective pattern:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb0a7748&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb0a7748">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;arg1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;arg2&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;arg1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;arg2&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The following example combines all matching types. Here, <strong>host</strong>, <strong>method</strong>, <strong>uri</strong>,
<strong>arg1</strong> <em>and</em> <strong>arg2</strong>, either <strong>cookie1</strong> or <strong>cookie2</strong>, and either <strong>header1</strong>
or <strong>header2</strong> <em>and</em> <strong>header3</strong> must be matched for the <strong>action</strong> to be taken
(<strong>host &amp; method &amp; uri &amp; arg1 &amp; arg2 &amp; (cookie1 | cookie2)
&amp; (header1 | (header2 &amp; header3))</strong>):</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb12d000&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb12d000">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;!pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!pattern&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;arg1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;arg2&#34;</span><span class="p">:</span> <span class="s2">&#34;!pattern&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cookies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;cookie1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;cookie2&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;header1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;header2&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;header3&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;!pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!pattern&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;arg1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;arg2&#34;</span><span class="p">:</span> <span class="s2">&#34;!pattern&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cookies&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;cookie1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;cookie2&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;header1&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;header2&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;header3&#34;</span><span class="p">:</span> <span class="s2">&#34;pattern&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><details>
<summary>Object pattern examples</summary>
<p>This requires <strong>mode=strict</strong> and any <strong>access</strong> argument other than <strong>access=full</strong>
in the URI query:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb177b50&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb177b50">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mode&#34;</span><span class="p">:</span> <span class="s2">&#34;strict&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;access&#34;</span><span class="p">:</span> <span class="s2">&#34;!full&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;mode&#34;</span><span class="p">:</span> <span class="s2">&#34;strict&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;access&#34;</span><span class="p">:</span> <span class="s2">&#34;!full&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This matches requests that either use <strong>gzip</strong> and identify as <strong>Mozilla/5.0</strong>
or list <strong>curl</strong> as the user agent:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb1cbef8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb1cbef8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;Accept-Encoding&#34;</span><span class="p">:</span> <span class="s2">&#34;*gzip*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;curl*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;Accept-Encoding&#34;</span><span class="p">:</span> <span class="s2">&#34;*gzip*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;curl*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><hr>
</details>
<h4 
id="configuration-routes-matching-patterns">Pattern syntax  <a class="headerlink float-right" href="#configuration-routes-matching-patterns" title="Pattern syntax"><i class="fas fa-link fa-xs"></i></a>
</h4><p>Individual patterns can be address-based (<strong>source</strong> and <strong>destination</strong>)
or string-based (other properties).</p>
<p>String-based patterns must match the property to a character; wildcards or
regexes (Available only if Unit was built with PCRE support enabled,
which is the default for the official packages) modify this behavior:</p>
<ul>
<li>A wildcard pattern may contain any combination of wildcards
(<strong>*</strong>),
each standing for an arbitrary number of characters:
<strong>How*s*that*to*you</strong>.</li>
</ul>
<p><a name="configuration-routes-matching-patterns-regex"></a></p>
<ul>
<li>A regex pattern starts with a tilde
(<strong>~</strong>):
<strong>~^\d+\.\d+\.\d+\.\d+</strong>
(escaping backslashes is a
<a href="https://www.json.org/json-en.html" target="_blank" rel="noopener">JSON requirement</a>).
The regexes are
<a href="https://www.pcre.org/current/doc/html/pcre2syntax.html" target="_blank" rel="noopener">PCRE</a>-flavored.</li>
</ul>
<details>
<summary>Percent encoding in arguments, query, and URI patterns</summary>
<a name="percent-encoding"></a>
<p>Argument names, non-regex string patterns in <strong>arguments</strong>,
<strong>query</strong>, and <strong>uri</strong> can be `percent encoded
(<a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">https://datatracker.ietf.org/doc/html/rfc3986#section-2.1</a>)
to mask special characters (<strong>!</strong> is <strong>%21</strong>, <strong>~</strong> is <strong>%7E</strong>,
***** is <strong>%2A</strong>, <strong>%</strong> is <strong>%25</strong>) or even target single bytes.
For example, you can select diacritics such as Ö or Å by their starting byte
<strong>0xC3</strong> in UTF-8:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb225890&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb225890">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;word&#34;</span><span class="p">:</span> <span class="s2">&#34;*%C3*&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;word&#34;</span><span class="p">:</span> <span class="s2">&#34;*%C3*&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Unit decodes such strings and matches them against respective request entities,
decoding these as well:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb266b88&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb266b88">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;query&#34;</span><span class="p">:</span> <span class="s2">&#34;`%7Efuzzy word search&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">200</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;query&#34;</span><span class="p">:</span> <span class="s2">&#34;`%7Efuzzy word search&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">200</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This condition matches the following percent-encoded request:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb29e240&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb29e240">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl http://127.0.0.1/?~fuzzy%20word%20search -v
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      &gt; GET /?~fuzzy%20word%20search HTTP/1.1
</span></span></span><span class="line"><span class="cl"><span class="go">      ...
</span></span></span><span class="line"><span class="cl"><span class="go">      &lt; HTTP/1.1 200 OK
</span></span></span><span class="line"><span class="cl"><span class="go">      ...
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl http://127.0.0.1/?~fuzzy%20word%20search -v
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      &gt; GET /?~fuzzy%20word%20search HTTP/1.1
</span></span></span><span class="line"><span class="cl"><span class="go">      ...
</span></span></span><span class="line"><span class="cl"><span class="go">      &lt; HTTP/1.1 200 OK
</span></span></span><span class="line"><span class="cl"><span class="go">      ...
</span></span></span></code></pre></div>
</div><p>Note that the encoded spaces (<strong>%20</strong>) in the request match their unencoded
counterparts in the pattern; vice versa, the encoded tilde (<strong>%7E</strong>)
in the condition matches <strong>~</strong> in the request.</p>
<hr>
</details>
<details>
<summary>String pattern examples</summary>
<p><a name="conf-str-pattern-examples"></a></p>
<p>A regular expression that matches any <strong>.php</strong> files in the <strong>/data/www/</strong>
directory and its subdirectories. Note the backslashes; escaping is a
JSON-specific requirement:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb2e2be8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb2e2be8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;~^/data/www/.*\\.php(/.*)?$&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;~^/data/www/.*\\.php(/.*)?$&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Only subdomains of <strong>example.com</strong> match:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb322388&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb322388">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;*.example.com&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;*.example.com&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Only requests for <strong>.php</strong> files
located in <strong>/admin/</strong>&rsquo;s subdirectories
match:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb369828&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb369828">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/admin/*/*.php&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/admin/*/*.php&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here, any <strong>eu-</strong> subdomains of <strong>example.com</strong> match except <strong>eu-5.example.com</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb3bb0d8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb3bb0d8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;eu-*.example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!eu-5.example.com&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;eu-*.example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!eu-5.example.com&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Any methods match except <strong>HEAD</strong> and <strong>GET</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb40a660&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb40a660">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!HEAD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!GET&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!HEAD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!GET&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>You can also combine certain special characters in a pattern. Here, any URIs match
except the ones containing <strong>/api/</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb44ec20&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb44ec20">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;!*/api/*&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;!*/api/*&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here, URIs of any articles that don&rsquo;t look like <strong>YYYY-MM-DD</strong> dates match.
Again, note the backslashes; they are a JSON requirement:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb488600&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb488600">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/articles/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!~/articles/\\d{4}-\\d{2}-\\d{2}&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/articles/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!~/articles/\\d{4}-\\d{2}-\\d{2}&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><hr>
</details>
<p>Address-based patterns define individual IPv4
(dot-decimal or
<a href="https://datatracker.ietf.org/doc/html/rfc4632" target="_blank" rel="noopener">CIDR</a>),
IPv6 (hexadecimal or
<a href="https://datatracker.ietf.org/doc/html/rfc4291#section-2.3" target="_blank" rel="noopener">CIDR</a>),
or any
<a href="https://en.wikipedia.org/wiki/Unix_domain_socket" target="_blank" rel="noopener">UNIX domain socket</a>
addresses
that must exactly match the property;
wildcards and ranges modify this behavior:</p>
<ul>
<li>Wildcards
(<strong>*</strong>)
can only match arbitrary IPs
(<strong>*:&lt;port&gt;</strong>).</li>
<li>Ranges
(<strong>-</strong>)
work with both IPs
(in respective notation)
and ports
(<strong>&lt;start_port&gt;-&lt;end_port&gt;</strong>).</li>
</ul>
<details>
<summary>Address-based allow-deny lists</summary>
<p><a name="allow-deny"></a></p>
<p>Addresses come in handy when implementing an allow-deny mechanism
with routes, for instance:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb4bed18&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb4bed18">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;routes&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;!192.168.1.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;!10.1.1.0/16&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;192.168.1.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;2001:0db8::/32&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data$uri&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;routes&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;!192.168.1.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;!10.1.1.0/16&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;192.168.1.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;2001:0db8::/32&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data$uri&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
</div><p>See
<a href="/nginx-unit/configuration/#configuration-routes-matching-resolution">here</a>
for details of pattern resolution order; this corresponds to the following
<code>nginx</code> directive:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">nginx</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb514c18&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb514c18">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kn">deny</span>  <span class="mi">10</span><span class="s">.1.1.0/16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kn">deny</span>  <span class="mi">192</span><span class="s">.168.1.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kn">allow</span> <span class="mi">192</span><span class="s">.168.1.0/24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kn">allow</span> <span class="n">2001</span><span class="p">:</span><span class="mi">0</span><span class="s">db8::/32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kn">deny</span>  <span class="s">all</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kn">root</span> <span class="s">/www/data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kn">deny</span>  <span class="mi">10</span><span class="s">.1.1.0/16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kn">deny</span>  <span class="mi">192</span><span class="s">.168.1.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kn">allow</span> <span class="mi">192</span><span class="s">.168.1.0/24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kn">allow</span> <span class="n">2001</span><span class="p">:</span><span class="mi">0</span><span class="s">db8::/32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kn">deny</span>  <span class="s">all</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kn">root</span> <span class="s">/www/data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><hr>
</details>
<details>
<summary> Address pattern examples</summary>
<a name="conf-addr-pattern-examples"></a>
<p>This uses IPv4-based matching with wildcards and ranges:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb56fd20&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb56fd20">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.1-192.0.2.200&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.1-198.51.100.200:8000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;203.0.113.1-203.0.113.200:8080-8090&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:80&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;destination&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.0/24:8000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;203.0.113.0/24:8080-8090&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:80&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.1-192.0.2.200&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.1-198.51.100.200:8000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;203.0.113.1-203.0.113.200:8080-8090&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:80&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;destination&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;198.51.100.0/24:8000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;203.0.113.0/24:8080-8090&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:80&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This uses IPv6-based matching with wildcards and ranges:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb5cd150&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb5cd150">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;2001:0db8::-2001:0db8:aaa9:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;[2001:0db8:aaaa::-2001:0db8:bbbb::]:8000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;[2001:0db8:bbbb::1-2001:0db8:cccc::]:8080-8090&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;*:80&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;destination&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;2001:0db8:cccd::/48&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;[2001:0db8:ccce::/48]:8000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;[2001:0db8:ccce:ffff::/64]:8080-8090&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;*:80&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;2001:0db8::-2001:0db8:aaa9:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;[2001:0db8:aaaa::-2001:0db8:bbbb::]:8000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;[2001:0db8:bbbb::1-2001:0db8:cccc::]:8080-8090&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;*:80&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;destination&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;2001:0db8:cccd::/48&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;[2001:0db8:ccce::/48]:8000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;[2001:0db8:ccce:ffff::/64]:8080-8090&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;*:80&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This matches any of the listed IPv4 or IPv6 addresses:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb614dc0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb614dc0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;destination&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.168.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;::1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;2001:0db8:1::c0a8:1&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;destination&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.168.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;::1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;2001:0db8:1::c0a8:1&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here, any IPs from the range match except <strong>192.0.2.9</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb6558e8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb6558e8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.1-192.0.2.10&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!192.0.2.9&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;192.0.2.1-192.0.2.10&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;!192.0.2.9&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This matches any IPs but limits the acceptable ports:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb680868&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb680868">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:80&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:443&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:8000-8080&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:80&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:443&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*:8000-8080&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This matches any UNIX domain sockets:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb69fc68&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb69fc68">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="s2">&#34;unix&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="s2">&#34;unix&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;_comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;Any acceptable &#39;pass&#39; value may go here; see the &#39;Listeners&#39; section for details&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><hr>
</details>
<h3 
id="configuration-routes-action">Handling actions  <a class="headerlink float-right" href="#configuration-routes-action" title="Handling actions"><i class="fas fa-link fa-xs"></i></a>
</h3><p>If a request matches all
<a href="/nginx-unit/configuration/#configuration-routes-matching">conditions</a>
of a route step
or the step itself omits the <strong>match</strong> object,
Unit handles the request with the respective <strong>action</strong>.
The mutually exclusive <strong>action</strong> types are:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Details</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>pass</strong></td>
          <td style="text-align: left">Destination for the request, identical to a listener&rsquo;s <strong>pass</strong> option.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-listeners">Listeners</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>proxy</strong></td>
          <td style="text-align: left">Socket address of an HTTP server to where the request is proxied.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-proxy">Proxying</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>return</strong></td>
          <td style="text-align: left">HTTP status code with a context-dependent redirect location.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-return">Instant responses, redirects</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>share</strong></td>
          <td style="text-align: left">File paths that serve the request with static content.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-static">Static files</a></td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Details</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>pass</strong></td>
          <td style="text-align: left">Destination for the request, identical to a listener&rsquo;s <strong>pass</strong> option.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-listeners">Listeners</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>proxy</strong></td>
          <td style="text-align: left">Socket address of an HTTP server to where the request is proxied.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-proxy">Proxying</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>return</strong></td>
          <td style="text-align: left">HTTP status code with a context-dependent redirect location.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-return">Instant responses, redirects</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>share</strong></td>
          <td style="text-align: left">File paths that serve the request with static content.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-static">Static files</a></td>
      </tr>
  </tbody>
</table>

</div>
<p>An additional option is applicable to any of these actions:





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Details</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>response_headers</strong></td>
          <td style="text-align: left">Updates the header fields of the upcoming response.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-response-headers">Response headers</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>rewrite</strong></td>
          <td style="text-align: left">Updated the request URI, preserving the query string.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-rewrite">URI rewrite</a></td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Details</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>response_headers</strong></td>
          <td style="text-align: left">Updates the header fields of the upcoming response.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-response-headers">Response headers</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>rewrite</strong></td>
          <td style="text-align: left">Updated the request URI, preserving the query string.</td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-rewrite">URI rewrite</a></td>
      </tr>
  </tbody>
</table>

</div></p>
<p>An example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb731c58&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb731c58">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/v1/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/v2/*&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;rewrite&#34;</span><span class="p">:</span> <span class="s2">&#34;/app/$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/app&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;~\\.jpe?g$&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/var/www/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/var/www/static/assets$uri&#34;</span>
</span></span><span class="line"><span class="cl">                 <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;upstreams/cdn&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/proxy/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://192.168.0.100:80&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/return/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">301</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;location&#34;</span><span class="p">:</span> <span class="s2">&#34;https://www.example.com&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/v1/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/v2/*&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;rewrite&#34;</span><span class="p">:</span> <span class="s2">&#34;/app/$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/app&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;~\\.jpe?g$&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/var/www/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/var/www/static/assets$uri&#34;</span>
</span></span><span class="line"><span class="cl">                 <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;upstreams/cdn&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/proxy/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://192.168.0.100:80&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/return/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">301</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;location&#34;</span><span class="p">:</span> <span class="s2">&#34;https://www.example.com&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p><a name="configuration-variables"></a></p>
<h2 
id="configuration-variables-native">Variables  <a class="headerlink float-right" href="#configuration-variables-native" title="Variables"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Some options in Unit configuration allow the use ofvariables whose values are
calculated at runtime. There&rsquo;s a number of built-in variables available:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Variable</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>arg_</strong><em>, <strong>cookie_</strong></em>, <strong>header_</strong>*</td>
          <td style="text-align: left">Variables that store <a href="/nginx-unit/configuration/#configuration-routes-matching">request arguments, cookies, and header fields</a>, such as <strong>arg_queryTimeout</strong>, <strong>cookie_sessionId</strong>, or <strong>header_Accept_Encoding</strong>. The names of the <strong>header_</strong>* variables are case insensitive.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>body_bytes_sent</strong></td>
          <td style="text-align: left">Number of bytes sent in the response body.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>dollar</strong></td>
          <td style="text-align: left">Literal dollar sign (<strong>$</strong>), used for escaping.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>header_referer</strong></td>
          <td style="text-align: left">Contents of the <strong>Referer</strong> request <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer" target="_blank" rel="noopener">header field</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>header_user_agent</strong></td>
          <td style="text-align: left">Contents of the <strong>User-Agent</strong> request <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent" target="_blank" rel="noopener">header field</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>host</strong></td>
          <td style="text-align: left"><strong>Host</strong> <a href="https://datatracker.ietf.org/doc/html/rfc9110#section-7.2" target="_blank" rel="noopener">header field</a>, converted to lower case and normalized by removing the port number and the trailing period (if any).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>method</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc7231#section-4" target="_blank" rel="noopener">Method</a> from the request line.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>remote_addr</strong></td>
          <td style="text-align: left">Remote IP address of the request.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_id</strong></td>
          <td style="text-align: left">Contains a string generated with random data. Can be used as a unique request identifier.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_line</strong></td>
          <td style="text-align: left">Entire <a href="https://datatracker.ietf.org/doc/html/rfc9112#section-3" target="_blank" rel="noopener">request line</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_time</strong></td>
          <td style="text-align: left">Request processing time in milliseconds, formatted as follows: <strong>1.234</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_uri</strong></td>
          <td style="text-align: left">Request target <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.3" target="_blank" rel="noopener">path</a> <em>including</em> the <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">query</a>, normalized by resolving relative path references (&quot;.&quot; and &ldquo;..&rdquo;) and collapsing adjacent slashes.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>response_header_</strong>*</td>
          <td style="text-align: left">Variables that store <a href="/nginx-unit/configuration/#configuration-response-headers">response header fields</a>, such as <strong>response_header_content_type</strong>. The names of these variables are case insensitive.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>status</strong></td>
          <td style="text-align: left">HTTP <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-6" target="_blank" rel="noopener">status code</a> of the response.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>time_local</strong></td>
          <td style="text-align: left">Local time, formatted as follows: <strong>31/Dec/1986:19:40:00 +0300</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>uri</strong></td>
          <td style="text-align: left">Request target <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.3" target="_blank" rel="noopener">path</a> <em>without</em> the <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">query</a> part, normalized by resolving relative path references (&quot;.&quot; and &ldquo;..&rdquo;) and collapsing adjacent slashes. The value is <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">percent decoded</a>: Unit interpolates all percent-encoded entities in the request target <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.3" target="_blank" rel="noopener">path</a>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Variable</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>arg_</strong><em>, <strong>cookie_</strong></em>, <strong>header_</strong>*</td>
          <td style="text-align: left">Variables that store <a href="/nginx-unit/configuration/#configuration-routes-matching">request arguments, cookies, and header fields</a>, such as <strong>arg_queryTimeout</strong>, <strong>cookie_sessionId</strong>, or <strong>header_Accept_Encoding</strong>. The names of the <strong>header_</strong>* variables are case insensitive.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>body_bytes_sent</strong></td>
          <td style="text-align: left">Number of bytes sent in the response body.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>dollar</strong></td>
          <td style="text-align: left">Literal dollar sign (<strong>$</strong>), used for escaping.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>header_referer</strong></td>
          <td style="text-align: left">Contents of the <strong>Referer</strong> request <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer" target="_blank" rel="noopener">header field</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>header_user_agent</strong></td>
          <td style="text-align: left">Contents of the <strong>User-Agent</strong> request <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent" target="_blank" rel="noopener">header field</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>host</strong></td>
          <td style="text-align: left"><strong>Host</strong> <a href="https://datatracker.ietf.org/doc/html/rfc9110#section-7.2" target="_blank" rel="noopener">header field</a>, converted to lower case and normalized by removing the port number and the trailing period (if any).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>method</strong></td>
          <td style="text-align: left"><a href="https://datatracker.ietf.org/doc/html/rfc7231#section-4" target="_blank" rel="noopener">Method</a> from the request line.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>remote_addr</strong></td>
          <td style="text-align: left">Remote IP address of the request.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_id</strong></td>
          <td style="text-align: left">Contains a string generated with random data. Can be used as a unique request identifier.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_line</strong></td>
          <td style="text-align: left">Entire <a href="https://datatracker.ietf.org/doc/html/rfc9112#section-3" target="_blank" rel="noopener">request line</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_time</strong></td>
          <td style="text-align: left">Request processing time in milliseconds, formatted as follows: <strong>1.234</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_uri</strong></td>
          <td style="text-align: left">Request target <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.3" target="_blank" rel="noopener">path</a> <em>including</em> the <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">query</a>, normalized by resolving relative path references (&quot;.&quot; and &ldquo;..&rdquo;) and collapsing adjacent slashes.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>response_header_</strong>*</td>
          <td style="text-align: left">Variables that store <a href="/nginx-unit/configuration/#configuration-response-headers">response header fields</a>, such as <strong>response_header_content_type</strong>. The names of these variables are case insensitive.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>status</strong></td>
          <td style="text-align: left">HTTP <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-6" target="_blank" rel="noopener">status code</a> of the response.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>time_local</strong></td>
          <td style="text-align: left">Local time, formatted as follows: <strong>31/Dec/1986:19:40:00 +0300</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>uri</strong></td>
          <td style="text-align: left">Request target <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.3" target="_blank" rel="noopener">path</a> <em>without</em> the <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">query</a> part, normalized by resolving relative path references (&quot;.&quot; and &ldquo;..&rdquo;) and collapsing adjacent slashes. The value is <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.1" target="_blank" rel="noopener">percent decoded</a>: Unit interpolates all percent-encoded entities in the request target <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.3" target="_blank" rel="noopener">path</a>.</td>
      </tr>
  </tbody>
</table>

</div>
<p>These variables can be used with:</p>
<ul>
<li><strong>pass</strong> in
<a href="/nginx-unit/configuration/#configuration-listeners">listeners</a>
and
<a href="/nginx-unit/configuration/#configuration-routes-action">actions</a>
to choose between routes, applications, app targets, or upstreams.</li>
<li><strong>rewrite</strong> in
<a href="/nginx-unit/configuration/#configuration-routes-action">actions</a>
to enable <a href="/nginx-unit/configuration/#configuration-rewrite">URI rewriting</a>.</li>
<li><strong>share</strong> and <strong>chroot</strong> in
<a href="/nginx-unit/configuration/#configuration-routes-action">actions</a>
to control
<a href="/nginx-unit/configuration/#configuration-static">static content serving</a>.</li>
<li><strong>location</strong> in <strong>return</strong>
<a href="/nginx-unit/configuration/#configuration-return">actions</a>
to enable HTTP redirects.</li>
<li><strong>format</strong> in the
<a href="/nginx-unit/configuration/#configuration-access-log">access log</a>
to customize Unit&rsquo;s log output.</li>
</ul>
<p>To reference a variable, prefix its name with the dollar sign character
(<strong>$</strong>), optionally enclosing the name in curly brackets (<strong>{}</strong>) to separate it
from adjacent text or enhance visibility. Variable names can contain letters and
underscores (<strong>_</strong>), so use the brackets if the variable is immediately followed
by such characters:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb7b6570&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb7b6570">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/${method}_route&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;The method variable is thus separated from the &#39;_route&#39; postfix&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;GET_route&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">201</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;PUT_route&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">202</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;POST_route&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">203</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes/${method}_route&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_pass&#34;</span><span class="p">:</span> <span class="s2">&#34;The method variable is thus separated from the &#39;_route&#39; postfix&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;GET_route&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">201</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;PUT_route&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">202</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;POST_route&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">203</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>To reference an <strong>arg_*</strong>, <strong>cookie_*</strong>, or <strong>header_*</strong> variable, add
the name you need to the prefix. A query string of <strong>Type=car&amp;Color=red</strong>
yields two variables: <strong>$arg_Type</strong> and <strong>$arg_Color</strong>. Unit additionally
normalizes capitalization and hyphenation in header field names, so the
<strong>Accept-Encoding</strong> header field can also be referred to as <strong>$header_Accept_Encoding</strong>,
<strong>$header_accept-encoding</strong>, or <strong>$header_accept_encoding</strong>.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> With multiple argument instances (think <strong>Color=Red&amp;Color=Blue</strong>),the rightmost
one is used (<strong>Blue</strong>).</div>
</blockquote>

<p>At runtime, variables expand into dynamically computed values (at your risk!).
The previous example targets an entire set of routes, picking individual
ones by HTTP verbs from the incoming requests:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb7cc118&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb7cc118">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -i -X GET http://localhost
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    HTTP/1.1 201 Created
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -i -X GET http://localhost
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    HTTP/1.1 201 Created
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb7dcab8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb7dcab8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -i -X PUT http://localhost
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    HTTP/1.1 202 Accepted
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -i -X PUT http://localhost
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    HTTP/1.1 202 Accepted
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb826e38&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb826e38">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -i -X POST http://localhost
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    HTTP/1.1 203 Non-Authoritative Information
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -i -X POST http://localhost
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    HTTP/1.1 203 Non-Authoritative Information
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb855c38&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb855c38">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -i --head http://localhost  # Bumpy ride ahead, no route defined
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    HTTP/1.1 404 Not Found
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -i --head http://localhost  # Bumpy ride ahead, no route defined
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    HTTP/1.1 404 Not Found
</span></span></span></code></pre></div>
</div><p>If you reference a non-existing variable, it is considered empty.</p>
<details>
<summary>Examples</summary>
<a name="variables-examples"></a>
<p>This configuration selects the static file location based on the requested
hostname; if nothing&rsquo;s found, it attempts to retrieve the requested file
from a common storage:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb882710&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb882710">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/www/$host$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;comment_share_1&#34;</span><span class="err">:</span> <span class="s2">&#34;Note that the $uri variable value always includes a starting slash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/www/storage$uri&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/www/$host$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;comment_share_1&#34;</span><span class="err">:</span> <span class="s2">&#34;Note that the $uri variable value always includes a starting slash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;/www/storage$uri&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Another use case is employing the URI to choose between applications:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb8aee00&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb8aee00">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications$uri&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;blog&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/blog_app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;sandbox&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/sandbox_app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications$uri&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;blog&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/blog_app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;sandbox&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/sandbox_app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This way, requests are routed between applications by their target URIs:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb8c0f10&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb8c0f10">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/blog     # Targets the &#39;blog&#39; app
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/blog     # Targets the &#39;blog&#39; app
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb8d0cf8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb8d0cf8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/sandbox  # Targets the &#39;sandbox&#39; app
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/sandbox  # Targets the &#39;sandbox&#39; app
</span></span></span></code></pre></div>
</div><p>A different approach puts the <strong>Host</strong> header field received from the client
to the same use:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb938920&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb938920">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/$host&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;localhost&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/admin_section/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;www.example.com&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/public_app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/$host&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;localhost&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/admin_section/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;www.example.com&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/path/to/public_app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>You can use multiple variables in a string, repeating and placing them
arbitrarily. This configuration picks an app target (supported for
<a href="/nginx-unit/configuration/#configuration-php-targets">PHP</a>
and <a href="/nginx-unit/configuration/#configuration-python-targets">Python</a>)
based on the requested hostname and URI:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb96add0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb96add0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/app_$host$uri&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/app_$host$uri&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Note that the $uri value doesn&rsquo;t include the request&rsquo;s query part.</p>
<p>At runtime,a request for <strong>example.com/myapp</strong> is passed to
<strong>applications/app_example.com/myapp</strong>.</p>
<p>To select a share directory based on an <strong>app_session</strong> cookie:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb984028&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb984028">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/data/www/$cookie_app_session&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/data/www/$cookie_app_session&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here, if <strong>$uri</strong> in <strong>share</strong> resolves to a directory, the choice of an index
file to be served is dictated by <strong>index</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb9a20a0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb9a20a0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;index&#34;</span><span class="p">:</span> <span class="s2">&#34;index.htm&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;index&#34;</span><span class="p">:</span> <span class="s2">&#34;index.htm&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Note that the $uri variable value always includes a starting slash.</p>
<p>Here, a redirect uses the <strong>$request_uri</strong> variable value to relay the
request, <em>including</em> the query part, to the same website over HTTPS:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffb9bd238&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffb9bd238">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">301</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;location&#34;</span><span class="p">:</span> <span class="s2">&#34;https://$host$request_uri&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">301</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;location&#34;</span><span class="p">:</span> <span class="s2">&#34;https://$host$request_uri&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><hr>
</details>
<h2 
id="configuration-rewrite">URI rewrite  <a class="headerlink float-right" href="#configuration-rewrite" title="URI rewrite"><i class="fas fa-link fa-xs"></i></a>
</h2><p>All route step <a href="/nginx-unit/configuration/#configuration-routes-action">actions</a>
support the <strong>rewrite</strong> option that updates the URI of the incoming request
before the action is applied. It does not affect the <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.4" target="_blank" rel="noopener">query</a>
but changes the <strong>uri</strong> and <strong>$request_uri</strong> <a href="/nginx-unit/configuration/#configuration-variables-native">variables</a>.</p>
<p>This <strong>match</strong>-less action prefixes the request URI with <strong>/v1</strong> and returns
it to routing:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffba03f08&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffba03f08">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;rewrite&#34;</span><span class="p">:</span> <span class="s2">&#34;/v1$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;rewrite&#34;</span><span class="p">:</span> <span class="s2">&#34;/v1$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="warning call-out">
  <div><strong class="call-out-type">Warning</strong><br/> Avoid infinite loops when you <strong>pass</strong> requests back to <strong>routes</strong>.</div>
</blockquote>

<p>This action normalizes the request URI and passes it to an application:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffba64218&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffba64218">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/fancyAppA&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/fancyAppB&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;rewrite&#34;</span><span class="p">:</span> <span class="s2">&#34;/commonBackend&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/backend&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/fancyAppA&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/fancyAppB&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;rewrite&#34;</span><span class="p">:</span> <span class="s2">&#34;/commonBackend&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/backend&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h2 
id="configuration-response-headers">Response headers  <a class="headerlink float-right" href="#configuration-response-headers" title="Response headers"><i class="fas fa-link fa-xs"></i></a>
</h2><p>All route step
<a href="/nginx-unit/configuration/#configuration-routes-action">actions</a>
support the <strong>response_headers</strong> option that updates the header fields of Unit&rsquo;s response
before the action is taken:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbab4740&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbab4740">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static/$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response_headers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="s2">&#34;max-age=60, s-maxage=120&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;CDN-Cache-Control&#34;</span><span class="p">:</span> <span class="s2">&#34;max-age=600&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static/$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response_headers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="s2">&#34;max-age=60, s-maxage=120&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;CDN-Cache-Control&#34;</span><span class="p">:</span> <span class="s2">&#34;max-age=600&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This works only for the <strong>2XX</strong> and <strong>3XX</strong> responses;
also, <strong>Date</strong>, <strong>Server</strong>, and <strong>Content-Length</strong> can&rsquo;t be set.</p>
<p>The option sets given string values for the header fields of the response
that Unit will send for the specific request:</p>
<ul>
<li>If there&rsquo;s no header field associated with the name (regardless of the case),
the value is set.</li>
<li>If a header field with this name is already set, its value is updated.</li>
<li>If <strong>null</strong> is supplied for the value, the header field is <em>deleted</em>.</li>
</ul>
<p>If the action is taken and Unit issues a response, it sends the header
fields <em>this specific</em> action specifies. Only the last action along the
entire routing path of a request affects the resulting response headers.</p>
<p>The values support <a href="/nginx-unit/configuration/#configuration-variables-native">variables</a>
and <a href="/nginx-unit/scripting/">template literals</a>, which enables
arbitrary runtime logic:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbad4ec8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbad4ec8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;response_headers&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Content-Language&#34;</span><span class="p">:</span> <span class="s2">&#34;`${ uri.startsWith(&#39;/uk&#39;) ? &#39;en-GB&#39; : &#39;en-US&#39; }`&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;response_headers&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;Content-Language&#34;</span><span class="p">:</span> <span class="s2">&#34;`${ uri.startsWith(&#39;/uk&#39;) ? &#39;en-GB&#39; : &#39;en-US&#39; }`&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Finally, there are the <strong>response_header_*</strong> variables that evaluate to the
header field values set with the response (by the app, upstream, or Unit
itself; the latter is the case with <strong>$response_header_connection</strong>,
<strong>$response_header_content_length</strong>, and <strong>$response_header_transfer_encoding</strong>).</p>
<p>One use is to update the headers in the final response; this extends the
<strong>Content-Type</strong> issued by the app:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbaefc78&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbaefc78">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;action&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/converter&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response_headers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="s2">&#34;${response_header_content_type};charset=iso-8859-1&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;action&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/converter&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;response_headers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="s2">&#34;${response_header_content_type};charset=iso-8859-1&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div>
</div><p>Alternatively, they will come in handy with
<a href="/nginx-unit/configuration/#configuration-access-log">custom log formatting</a>.</p>
<h2 
id="configuration-return">Instant responses, redirects  <a class="headerlink float-right" href="#configuration-return" title="Instant responses, redirects"><i class="fas fa-link fa-xs"></i></a>
</h2><p>You can use route step
<a href="/nginx-unit/configuration/#configuration-routes-action">actions</a>
to instantly handle certain conditions with arbitrary
<a href="https://datatracker.ietf.org/doc/html/rfc7231#section-6" target="_blank" rel="noopener">HTTP status codes</a>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbb34a08&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbb34a08">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/admin_console/*&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">403</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/admin_console/*&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">403</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The <strong>return</strong> action provides the following options:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>return</strong></td>
          <td style="text-align: left">(required)<br>Integer (000–999); defines the HTTP response status code to be returned.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>location</strong></td>
          <td style="text-align: left">String URI; used if the <strong>return</strong> value implies redirection.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>return</strong></td>
          <td style="text-align: left">(required)<br>Integer (000–999); defines the HTTP response status code to be returned.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>location</strong></td>
          <td style="text-align: left">String URI; used if the <strong>return</strong> value implies redirection.</td>
      </tr>
  </tbody>
</table>

</div>
<p>Use the codes according to their intended <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-6" target="_blank" rel="noopener">semantics</a>;
if you use custom codes, make sure that user agents can understand them.</p>
<p>If you specify a redirect code (3xx), supply the destination using the
<strong>location</strong> option alongside <strong>return</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbb79798&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbb79798">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">301</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;location&#34;</span><span class="p">:</span> <span class="s2">&#34;https://www.example.com&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">301</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;location&#34;</span><span class="p">:</span> <span class="s2">&#34;https://www.example.com&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Besides enriching the response semantics, <strong>return</strong> simplifies
<a href="/nginx-unit/configuration/#allow-deny">allow-deny lists</a>:
instead of guarding each action with a filter, add <a href="/nginx-unit/configuration/#configuration-routes-matching">conditions</a> to deny unwanted
requests as early as possible, for example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbbdbdd0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbbdbdd0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;routes&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;scheme&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">403</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;!192.168.1.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;!10.1.1.0/16&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;192.168.1.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;2001:0db8::/32&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">403</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;routes&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;scheme&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">403</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;!192.168.1.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;!10.1.1.0/16&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;192.168.1.0/24&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;2001:0db8::/32&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;return&#34;</span><span class="p">:</span> <span class="mi">403</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
</div><h2 
id="configuration-static">Static files  <a class="headerlink float-right" href="#configuration-static" title="Static files"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Unit is capable of acting as a standalone web server, efficiently serving
static files from the local file system; to use the feature, list the file
paths in the <strong>share</strong> option of a route step <a href="/nginx-unit/configuration/#configuration-routes-action">action</a>.</p>
<p>A <strong>share</strong>-based action provides the following options:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>share</strong> (required)</td>
          <td style="text-align: left">String or an array of strings; lists file paths that are tried until a file is found. When no file is found, <strong>fallback</strong> is used if set.<br><br> The value is <a href="/nginx-unit/configuration/#configuration-variables">variable</a>-interpolated.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>index</strong></td>
          <td style="text-align: left">Filename; tried if <strong>share</strong> is a directory. When no file is found, <strong>fallback</strong> is used if set.<br><br> The default is <strong>index.html</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>fallback</strong></td>
          <td style="text-align: left">Action-like <a href="/nginx-unit/configuration/#configuration-fallback">object</a>; used if the request can&rsquo;t be served by <strong>share</strong> or <strong>index</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>types</strong></td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-share-mime">Array</a> of <a href="https://www.iana.org/assignments/media-types/media-types.xhtml" target="_blank" rel="noopener">MIME type</a> patterns; used to filter the shared files.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>chroot</strong></td>
          <td style="text-align: left">Directory pathname that <a href="/nginx-unit/configuration/#configuration-share-path">restricts</a> the shareable paths. <br><br> The value is <a href="/nginx-unit/configuration/#configuration-variables">variable</a>-interpolated.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>follow_symlinks</strong>, <strong>traverse_mounts</strong></td>
          <td style="text-align: left">Booleans; turn on and off symbolic link and mount point <a href="/nginx-unit/configuration/#configuration-share-resolution">resolution</a> respectively; if <strong>chroot</strong> is set, they only <a href="/nginx-unit/configuration/#configuration-share-path">affect</a> the insides of <strong>chroot</strong>. <br><br> The default for both options is <strong>true</strong> (resolve links and mounts).</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>share</strong> (required)</td>
          <td style="text-align: left">String or an array of strings; lists file paths that are tried until a file is found. When no file is found, <strong>fallback</strong> is used if set.<br><br> The value is <a href="/nginx-unit/configuration/#configuration-variables">variable</a>-interpolated.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>index</strong></td>
          <td style="text-align: left">Filename; tried if <strong>share</strong> is a directory. When no file is found, <strong>fallback</strong> is used if set.<br><br> The default is <strong>index.html</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>fallback</strong></td>
          <td style="text-align: left">Action-like <a href="/nginx-unit/configuration/#configuration-fallback">object</a>; used if the request can&rsquo;t be served by <strong>share</strong> or <strong>index</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>types</strong></td>
          <td style="text-align: left"><a href="/nginx-unit/configuration/#configuration-share-mime">Array</a> of <a href="https://www.iana.org/assignments/media-types/media-types.xhtml" target="_blank" rel="noopener">MIME type</a> patterns; used to filter the shared files.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>chroot</strong></td>
          <td style="text-align: left">Directory pathname that <a href="/nginx-unit/configuration/#configuration-share-path">restricts</a> the shareable paths. <br><br> The value is <a href="/nginx-unit/configuration/#configuration-variables">variable</a>-interpolated.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>follow_symlinks</strong>, <strong>traverse_mounts</strong></td>
          <td style="text-align: left">Booleans; turn on and off symbolic link and mount point <a href="/nginx-unit/configuration/#configuration-share-resolution">resolution</a> respectively; if <strong>chroot</strong> is set, they only <a href="/nginx-unit/configuration/#configuration-share-path">affect</a> the insides of <strong>chroot</strong>. <br><br> The default for both options is <strong>true</strong> (resolve links and mounts).</td>
      </tr>
  </tbody>
</table>

</div>
<blockquote class="note">
  <div><strong>Note:</strong><br/> To serve the files, Unit&rsquo;s router process must be able to access them;
thus, the account this process runs as must have proper permissions
<a href="/nginx-unit/configuration/#security-apps">assigned</a>. When
Unit is installed from the <a href="/nginx-unit/installation/#installation-precomp-pkgs">official packages</a>, the process runs
as <strong>unit:unit</strong>; for details of other installation methods, see
<a href="/nginx-unit/installation/">installation</a>.</div>
</blockquote>

<p>Consider the following configuration:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbc45168&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbc45168">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static/$uri&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static/$uri&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>It uses
<a href="/nginx-unit/configuration/#configuration-variables-native">variable interpolation</a>:
Unit replaces the <strong>$uri</strong> reference with its current value and tries the
resulting path. If this doesn&rsquo;t yield a servable file, a 404 &ldquo;Not Found&rdquo;
response is returned.</p>
<blockquote class="warning call-out">
  <div><strong class="call-out-type">Warning</strong><br/> <p>Before version 1.26.0, Unit used <strong>share</strong> as the document root. This was
changed for flexibility, so now <strong>share</strong> must resolve to specific files.
A common solution is to append <strong>$uri</strong> to your document root.</p>
<p>Pre-1.26, the snippet above would&rsquo;ve looked like this:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffdfac908&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffdfac908">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;action&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;action&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Mind that URI paths always start with a slash, so there&rsquo;s no need to separate
the directory from <strong>$uri</strong>; even if you do, Unit compacts adjacent slashes
during path resolution, so there won&rsquo;t be an issue.</p>
</div>
</blockquote>

<p>If <strong>share</strong> is an array, its items are searched in order of appearance
until a servable file is found:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbc80a88&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbc80a88">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;share&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;/www/$host$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;/www/error_pages/not_found.html&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;share&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;/www/$host$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;/www/error_pages/not_found.html&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span></span></span></code></pre></div>
</div><p>This snippet tries a <strong>$host</strong>-based directory first; if a suitable file
isn&rsquo;t found there, the <strong>not_found.html</strong> file is tried. If neither is
accessible, a 404 &ldquo;Not Found&rdquo; response is returned.</p>
<p>Finally, if a file path points to a directory, Unit attempts to serve an
<strong>index</strong>-indicated file from it. Suppose we have the following directory
structure and share configuration:</p>



<div class="code-block" data-mf="true" style="display: none;"><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbc98570&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbc98570">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/www/static/
</span></span><span class="line"><span class="cl">├── ...
</span></span><span class="line"><span class="cl">└──default.html</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/www/static/
</span></span><span class="line"><span class="cl">├── ...
</span></span><span class="line"><span class="cl">└──default.html</span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbcadd30&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbcadd30">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;action&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;index&#34;</span><span class="p">:</span> <span class="s2">&#34;default.html&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;action&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;index&#34;</span><span class="p">:</span> <span class="s2">&#34;default.html&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The following request returns <strong>default.html</strong> even though the file isn&rsquo;t named
explicitly:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbcc1d80&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbcc1d80">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/ -v
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   ...
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; HTTP/1.1 200 OK
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; Last-Modified: Fri, 20 Sep 2021 04:14:43 GMT
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; ETag: &#34;5d66459d-d&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; Content-Type: text/html
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; Server: Unit/1.34.1
</span></span></span><span class="line"><span class="cl"><span class="go">   ...
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/ -v
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   ...
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; HTTP/1.1 200 OK
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; Last-Modified: Fri, 20 Sep 2021 04:14:43 GMT
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; ETag: &#34;5d66459d-d&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; Content-Type: text/html
</span></span></span><span class="line"><span class="cl"><span class="go">   &lt; Server: Unit/1.34.1
</span></span></span><span class="line"><span class="cl"><span class="go">   ...
</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> Unit&rsquo;s ETag response header fields use the <strong>MTIME-FILESIZE</strong> format, where
<strong>MTIME</strong> stands for file modification timestamp and <strong>FILESIZE</strong> stands for
file size in bytes, both in hexadecimal.</div>
</blockquote>

<h3 
id="configuration-share-mime">MIME filtering  <a class="headerlink float-right" href="#configuration-share-mime" title="MIME filtering"><i class="fas fa-link fa-xs"></i></a>
</h3><p>To filter the files a <strong>share</strong> serves by their <a href="https://www.iana.org/assignments/media-types/media-types.xhtml" target="_blank" rel="noopener">MIME types</a>,
define a <strong>types</strong> array of string patterns. They work like <a href="/nginx-unit/configuration/#configuration-routes-matching-patterns">route patterns</a>
but are compared to the MIME type of each file; the request is served only if
it&rsquo;s a <a href="/nginx-unit/configuration/#configuration-routes-matching-resolution">match</a>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbd17c80&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbd17c80">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;!text/javascript&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;!text/css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;text/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;~video/3gpp2?&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;!text/javascript&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;!text/css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;text/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;~video/3gpp2?&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This sample configuration blocks JS and CSS files with
<a href="/nginx-unit/configuration/#configuration-routes-matching-resolution">negation</a>
but allows all other text-based MIME types with a
<a href="/nginx-unit/configuration/#configuration-routes-matching-patterns">wildcard pattern</a>.
Additionally, the <strong>.3gpp</strong> and <strong>.3gpp2</strong> file types are allowed by a
<a href="/nginx-unit/configuration/#configuration-routes-matching-patterns">regex pattern</a>.</p>
<p>If no MIME types match the request, a 403 &ldquo;Forbidden&rdquo; response is returned. You
can pair that behavior with a
<a href="/nginx-unit/configuration/#configuration-fallback">fallback</a> option that will be called
when a 40x response would be returned.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbd721d0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbd721d0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;image/*&#34;</span><span class="p">,</span> <span class="s2">&#34;font/*&#34;</span><span class="p">,</span> <span class="s2">&#34;text/*&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;response_headers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="s2">&#34;max-age=1209600&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;image/*&#34;</span><span class="p">,</span> <span class="s2">&#34;font/*&#34;</span><span class="p">,</span> <span class="s2">&#34;text/*&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;response_headers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="s2">&#34;max-age=1209600&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here, all requests to images, fonts, and any text-based files will have a
cache control header added to the response. Any other requests will still
serve the files, but this time without the header. This is useful for
serving common web page resources that do not change; web browsers and
proxies are informed that this content should be cached.</p>
<p>If the MIME type of a requested file isn&rsquo;t recognized, it&rsquo;s considered
empty (<strong>&quot;&quot;</strong>). Thus, the <strong>&quot;!&quot;</strong> pattern (&ldquo;deny empty strings&rdquo;) can be
used to restrict all file types <a href="/nginx-unit/configuration/#configuration-mime">unknown</a>
to Unit:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbda69a8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbda69a8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/known-types-only$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/known-types-only$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>If a share path specifies only the directory name, Unit <em>doesn&rsquo;t</em> apply MIME filtering.</p>
<h3 
id="configuration-share-path">Path restrictions  <a class="headerlink float-right" href="#configuration-share-path" title="Path restrictions"><i class="fas fa-link fa-xs"></i></a>
</h3><blockquote class="note">
  <div><strong>Note:</strong><br/> To have these options, Unit must be built and run on a system with Linux kernel
version 5.6+.</div>
</blockquote>

<p>The <strong>chroot</strong> option confines the path resolution within a share to a
certain directory. First, it affects symbolic links: any attempts to go up
the directory tree with relative symlinks like <strong>../../var/log</strong> stop at
the <strong>chroot</strong> directory, and absolute symlinks are treated as relative
to this directory to avoid breaking out:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbdcee30&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbdcee30">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;Now, any paths accessible via the share are confined to this directory&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;Now, any paths accessible via the share are confined to this directory&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here, a request for <strong>/log</strong> initially resolves to <strong>/www/data/log</strong>; however,
if that&rsquo;s an absolute symlink to <strong>/var/log/app.log</strong>, the resulting path
is <strong>/www/data/var/log/app.log</strong>.</p>
<p>Another effect is that any requests for paths that resolve outside the
<strong>chroot</strong> directory are forbidden:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbdeea00&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbdeea00">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Now, any paths accessible via the share are confined to the <code>/www/data/</code> directory</p>
<p>Here, a request for <strong>/index.xml</strong> elicits a 403 &ldquo;Forbidden&rdquo; response
because it resolves to <strong>/www/index.xml</strong>, which is outside <strong>chroot</strong>.</p>
<p><a name="configuration-share-resolution"></a></p>
<p>The <strong>follow_symlinks</strong> and <strong>traverse_mounts</strong> options disable resolution
of symlinks and traversal of mount points when set to <strong>false</strong> (both default
to <strong>true</strong>):</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbe1c090&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbe1c090">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;follow_symlinks&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_follow_symlinks&#34;</span><span class="p">:</span> <span class="s2">&#34;Disables symlink traversal&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;traverse_mounts&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_traverse_mounts&#34;</span><span class="p">:</span> <span class="s2">&#34;Disables mount point traversal&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;follow_symlinks&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_follow_symlinks&#34;</span><span class="p">:</span> <span class="s2">&#34;Disables symlink traversal&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;traverse_mounts&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;comment_traverse_mounts&#34;</span><span class="p">:</span> <span class="s2">&#34;Disables mount point traversal&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here, any symlink or mount point in the entire <strong>share</strong> path results in a
403 &ldquo;Forbidden&rdquo; response.</p>
<p>With <strong>chroot</strong> set, <strong>follow_symlinks</strong> and <strong>traverse_mounts</strong> only affect
portions of the path <em>after</em> <strong>chroot</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbe3e758&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbe3e758">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;follow_symlinks&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;traverse_mounts&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;follow_symlinks&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;traverse_mounts&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Here, <strong>www/</strong> and interpolated <strong>$host</strong> can be symlinks or mount points,
but any symlinks and mount points beyond them, including the <strong>static/</strong>
portion, won&rsquo;t be resolved.</p>
<details>
<summary>Details</summary>
<p><a name="chroot-details"></a></p>
<p>Suppose you want to serve files from a share  that itself includes a symlink
(let&rsquo;s assume <strong>$host</strong> always resolves to <strong>localhost</strong> and make it a symlink
in our example) but disable any symlinks inside the share.</p>
<p>Initial configuration:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbe88ad8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbe88ad8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;comment_chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;Now, any paths accessible via the share are confined to this directory&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;comment_chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;Now, any paths accessible via the share are confined to this directory&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Create a symlink to <strong>/www/localhost/static/index.html</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbeaf408&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbeaf408">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">mkdir -p /www/localhost/static/ &amp;&amp; cd /www/localhost/static/
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">mkdir -p /www/localhost/static/ &amp;&amp; cd /www/localhost/static/
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbed9fa0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbed9fa0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">cat &gt; index.html &lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="go">   &gt; index.html
</span></span></span><span class="line"><span class="cl"><span class="go">   &gt; EOF
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">cat &gt; index.html &lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="go">   &gt; index.html
</span></span></span><span class="line"><span class="cl"><span class="go">   &gt; EOF
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbeff930&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbeff930">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">ln -s index.html /www/localhost/static/symlink
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">ln -s index.html /www/localhost/static/symlink
</span></span></span></code></pre></div>
</div><p>If symlink resolution is enabled (with or without <strong>chroot</strong>), a request that
targets the symlink works:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbf23f38&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbf23f38">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/index.html
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   index.html
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/index.html
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   index.html
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbf4ac50&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbf4ac50">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/symlink
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   index.html
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/symlink
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   index.html
</span></span></span></code></pre></div>
</div><p>Now set <strong>follow_symlinks</strong> to <strong>false</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbf93c48&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbf93c48">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;comment_chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;Now, any paths accessible via the share are confined to this directory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;follow_symlinks&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;comment_chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;Now, any paths accessible via the share are confined to this directory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;follow_symlinks&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The symlink request is forbidden, which is presumably the desired effect:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbfb47b8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbfb47b8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/index.html
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   index.html
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/index.html
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   index.html
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbfc8038&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbfc8038">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/symlink
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   &lt;!DOCTYPE html&gt;&lt;title&gt;Error 403&lt;/title&gt;&lt;p&gt;Error 403.
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/symlink
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   &lt;!DOCTYPE html&gt;&lt;title&gt;Error 403&lt;/title&gt;&lt;p&gt;Error 403.
</span></span></span></code></pre></div>
</div><p>Finally, what difference does <strong>chroot</strong> make? To see, remove it:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffbff2fb8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffbff2fb8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;follow_symlinks&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/$host/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;follow_symlinks&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Now, <strong>&ldquo;follow_symlinks&rdquo;: false</strong> affects the entire share, and <strong>localhost</strong>
is a symlink, so it&rsquo;s forbidden:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc0179a8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc0179a8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/index.html
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   &lt;!DOCTYPE html&gt;&lt;title&gt;Error 403&lt;/title&gt;&lt;p&gt;Error 403.
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl http://localhost/index.html
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   &lt;!DOCTYPE html&gt;&lt;title&gt;Error 403&lt;/title&gt;&lt;p&gt;Error 403.
</span></span></span></code></pre></div>
</div><hr>
</details>
<h3 
id="configuration-fallback">Fallback action  <a class="headerlink float-right" href="#configuration-fallback" title="Fallback action"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Finally, within an <strong>action</strong>, you can supply a <strong>fallback</strong> option beside
a <strong>share</strong>. It specifies the <a href="/nginx-unit/configuration/#configuration-routes-action">action</a>
to be taken if the requested file can&rsquo;t be served from the <strong>share</strong> path:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc048ad0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc048ad0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Serving a file can be impossible for different reasons, such as:</p>
<ul>
<li>The request&rsquo;s HTTP method isn&rsquo;t <strong>GET</strong> or <strong>HEAD</strong>.</li>
<li>The file&rsquo;s MIME type doesn&rsquo;t match the <strong>types</strong>
<a href="/nginx-unit/configuration/#configuration-share-mime">array</a>.</li>
<li>The file isn&rsquo;t found at the <strong>share</strong> path.</li>
<li>The router process has
<a href="/nginx-unit/configuration/#security-apps">insufficient permissions</a>
to access the file or an underlying directory.</li>
</ul>
<p>In the previous example, an attempt to serve the requested file from the
<strong>/www/data/static/</strong> directory is made first. Only if the file can&rsquo;t be
served, the request is passed to the <strong>php</strong> application.</p>
<p>If the <strong>fallback</strong> itself is a <strong>share</strong>, it can also contain a nested
<strong>fallback</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc0ceb58&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc0ceb58">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/cache$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/data/static$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/cache$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;chroot&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The first <strong>share</strong> tries to serve the request from <strong>/www/data/static/</strong>;
on failure, the second <strong>share</strong> tries the <strong>/www/cache/</strong> path with
<strong>chroot</strong> enabled. If both attempts fail, the request is proxied elsewhere.</p>
<details>
<summary>Examples</summary>
<p><a name="conf-variable-examples"></a></p>
<p>One common use case that this feature enables is the separation of requests
for static and dynamic content into independent routes. The following example
relays all requests that target <strong>.php</strong> files to an application and uses a
catch-all static <strong>share</strong> with a <strong>fallback</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc120408&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc120408">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;*.php&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/assets/files$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;php-app&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/scripts/&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;*.php&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/assets/files$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;php-app&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/scripts/&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>You can reverse this scheme for apps that avoid filenames in dynamic URIs,
listing all types of static content to be served from a <strong>share</strong> in a
<strong>match</strong> condition and adding an unconditional application path:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc172870&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc172870">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.ico&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.png&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.xml&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/assets/files$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;php-app&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/scripts/&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.ico&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.png&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;*.xml&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/assets/files$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;php-app&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/scripts/&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>If image files should be served locally and other proxied, use the <strong>types</strong>
array in the first route step:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc1d98e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc1d98e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.ico&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.png&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.xml&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/assets/files$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;image/*&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.ico&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.png&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;*.xml&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/assets/files$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;image/*&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:9000&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Another way to combine <strong>share</strong>, <strong>types</strong>, and <strong>fallback</strong>
is exemplified by the following compact pattern:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc221550&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc221550">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/assets/files$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;!application/x-httpd-php&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;share&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/php-app/assets/files$uri&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;!application/x-httpd-php&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;fallback&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>It forwards explicit requests for PHP files to the app while serving all
other types of files from the share; note that a <strong>match</strong> object isn&rsquo;t
needed here to achieve this effect.</p>
<hr>
</details>
<h2 
id="configuration-proxy">Proxying  <a class="headerlink float-right" href="#configuration-proxy" title="Proxying"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Unit&rsquo;s routes support HTTP proxying to socket addresses using the <strong>proxy</strong>
option of a route step <a href="/nginx-unit/configuration/#configuration-routes-action">action</a>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc2dc968&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc2dc968">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/ipv4/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:8080&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;comment_proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;Note that the http:// scheme is required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/ipv6/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://[::1]:8080&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;comment_proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;Note that the http:// scheme is required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/unix/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://unix:/path/to/unix.sock&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;comment_proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;Note that the http:// scheme is required, followed by the unix: prefix&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/ipv4/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:8080&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;comment_proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;Note that the http:// scheme is required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/ipv6/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://[::1]:8080&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;comment_proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;Note that the http:// scheme is required&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/unix/*&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;http://unix:/path/to/unix.sock&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;comment_proxy&#34;</span><span class="p">:</span> <span class="s2">&#34;Note that the http:// scheme is required, followed by the unix: prefix&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>As the example suggests, you can use UNIX, IPv4, and IPv6 socket addresses
for proxy destinations.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> The HTTPS scheme is not supported yet.</div>
</blockquote>

<h3 
id="configuration-upstreams">Load balancing  <a class="headerlink float-right" href="#configuration-upstreams" title="Load balancing"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Besides proxying requests to individual servers, Unit can also relay incoming
requests to <em>upstreams</em>. An upstream is a group of servers that comprise a single
logical entityand may be used as a <strong>pass</strong> destination for incoming requests in a
<a href="/nginx-unit/configuration/#configuration-listeners">listener</a>
or a <a href="/nginx-unit/configuration/#configuration-routes">route</a>.</p>
<p>Upstreams are defined in the eponymous <strong>/config/upstreams</strong> section of the API:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc36d5d0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc36d5d0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;upstreams/rr-lb&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;upstreams&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;rr-lb&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;comment_rr-lb&#34;</span><span class="p">:</span> <span class="s2">&#34;Upstream object&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;servers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_servers&#34;</span><span class="p">:</span> <span class="s2">&#34;Lists individual servers as object-valued options&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;192.168.0.100:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;comment_192.168.0.100:8080&#34;</span><span class="p">:</span> <span class="s2">&#34;Empty object needed due to JSON requirements&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;192.168.0.101:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;weight&#34;</span><span class="p">:</span> <span class="mf">0.5</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;*:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;upstreams/rr-lb&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;upstreams&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;rr-lb&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;comment_rr-lb&#34;</span><span class="p">:</span> <span class="s2">&#34;Upstream object&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;servers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_servers&#34;</span><span class="p">:</span> <span class="s2">&#34;Lists individual servers as object-valued options&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;192.168.0.100:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;comment_192.168.0.100:8080&#34;</span><span class="p">:</span> <span class="s2">&#34;Empty object needed due to JSON requirements&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;192.168.0.101:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;weight&#34;</span><span class="p">:</span> <span class="mf">0.5</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>An upstream must define a <strong>servers</strong> object that lists socket addresses as
server object names. Unit dispatches requests between the upstream&rsquo;s servers
in a round-robin fashion, acting as a load balancer. Each server object can
set a numeric <strong>weight</strong> to adjust the share of requests it receives via the
upstream. In the above example, <strong>192.168.0.100:8080</strong> receives twice as many
requests as <strong>192.168.0.101:8080</strong>.</p>
<p>Weights can be specified as integers or fractions in decimal or scientific
notation:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc3c5be0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc3c5be0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;servers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;192.168.0.100:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;weight&#34;</span><span class="p">:</span> <span class="mf">1e1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_weight&#34;</span><span class="p">:</span> <span class="s2">&#34;All three values are equal&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;192.168.0.101:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;weight&#34;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_weight&#34;</span><span class="p">:</span> <span class="s2">&#34;All three values are equal&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;192.168.0.102:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;weight&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_weight&#34;</span><span class="p">:</span> <span class="s2">&#34;All three values are equal&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;servers&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;192.168.0.100:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;weight&#34;</span><span class="p">:</span> <span class="mf">1e1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_weight&#34;</span><span class="p">:</span> <span class="s2">&#34;All three values are equal&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;192.168.0.101:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;weight&#34;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_weight&#34;</span><span class="p">:</span> <span class="s2">&#34;All three values are equal&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;192.168.0.102:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;weight&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_weight&#34;</span><span class="p">:</span> <span class="s2">&#34;All three values are equal&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The maximum weight is <strong>1000000</strong>, the minimum is <strong>0</strong> (such servers receive
no requests); the default is <strong>1</strong>.</p>
<h2 
id="configuration-applications">Applications  <a class="headerlink float-right" href="#configuration-applications" title="Applications"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Each app that Unit runs is defined as an object in the <strong>/config/applications</strong>
section of the control API; it lists the app&rsquo;s language and settings, its
runtime limits, process model, and various language-specific options.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Our official
<a href="/nginx-unit/installation/#installation-precomp-pkgs">language-specific packages</a>
include end-to-end examples of application configuration, available for your
reference at <strong>/usr/share/doc/&lt;module name&gt;/examples/</strong> after package installation.</div>
</blockquote>

<p>Here, Unit runs 20 processes of a PHP app called <strong>blogs</strong>, stored in the
<strong>/www/blogs/scripts/</strong> directory:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc4020b8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc4020b8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;blogs&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/blogs/scripts/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;blogs&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/blogs/scripts/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p><a name="configuration-apps-common"></a>
App objects have a number of options shared between all application languages:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>type</strong> (required)</td>
          <td style="text-align: left">Application type: <strong>external</strong> (Go and Node.js), <strong>java</strong>, <strong>perl</strong>, <strong>php</strong>, <strong>python</strong>, <strong>ruby</strong>, or <strong>wasm</strong> (WebAssembly).<br><br>Except for <strong>external</strong> and <strong>wasm</strong>, you can detail the runtime version: <strong>&ldquo;type&rdquo;: &ldquo;python 3&rdquo;</strong>, <strong>&ldquo;type&rdquo;: &ldquo;python 3.4&rdquo;</strong>, or even <strong>&ldquo;type&rdquo;: &ldquo;python 3.4.9rc1&rdquo;</strong>.<br><br>Unit searches its modules and uses the latest matching one, reporting an error if none match.<br><br>For example, if you have only one PHP module, 7.1.9, it matches <strong>&ldquo;php&rdquo;</strong>, <strong>&ldquo;php 7&rdquo;</strong>, <strong>&ldquo;php 7.1&rdquo;</strong>, and <strong>&ldquo;php 7.1.9&rdquo;</strong>.<br><br>If you have modules for versions 7.0.2 and 7.0.23, set <strong>&ldquo;type&rdquo;: &ldquo;php 7.0.2&rdquo;</strong> to specify the former; otherwise, PHP 7.0.23 will be used.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>environment</strong></td>
          <td style="text-align: left">String-valued object; environment variables to be passed to the app.<br><br>Unit passes the environment variables to the app without modification, even if no environment configuration object is specified.<br><br>Any data specified in the <strong>environment</strong> object gets merged to the existing environment variables.<br><br>If an environment variable already exists in the system and gets declared in this object, the object&rsquo;s value takes precedence and gets passed to the application.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>group</strong></td>
          <td style="text-align: left">String; group name that runs the <a href="/nginx-unit/howto/security/#sec-processes">app process</a>.<br><br>The default is the <strong>user</strong>&rsquo;s primary group.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>isolation</strong></td>
          <td style="text-align: left">Object; manages the isolation of an application process.<br><br>For details, see <a href="/nginx-unit/configuration/#configuration-proc-mgmt-isolation">here</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>limits</strong></td>
          <td style="text-align: left">Object; accepts two integer options, <strong>timeout</strong> and <strong>requests</strong>.<br><br>Their values govern the life cycle of an application process.<br><br>For details, see <a href="/nginx-unit/configuration/#configuration-proc-mgmt-lmts">here</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>processes</strong></td>
          <td style="text-align: left">Integer or object; integer sets a static number of app processes, and object options <strong>max</strong>, <strong>spare</strong>, and <strong>idle_timeout</strong> enable dynamic management.<br><br>For details, see <a href="/nginx-unit/configuration/#configuration-proc-mgmt-prcs">here</a>.<br><br>The default is 1.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>stderr</strong>, <strong>stdout</strong></td>
          <td style="text-align: left">Strings; filenames where Unit redirects the application&rsquo;s output.<br><br>The default when running <em>with</em> <strong>&ndash;no-daemon</strong> is to send <em>stdout</em> to the <em>console</em> and <em>stderr</em> to Unit&rsquo;s <em>log</em>.<br><br>The default when running <em>without</em> <strong>&ndash;no-daemon</strong> is to send <em>stdout</em> to <em>/dev/null</em> and <em>stderr</em> to Unit&rsquo;s <em>log</em>.<br><br>These options have <em>no</em> effect when running with <strong>&ndash;no-daemon</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>user</strong></td>
          <td style="text-align: left">String; username that runs the <a href="/nginx-unit/howto/security/#sec-processes">app process</a>.<br><br>The default is the username configured at <a href="/nginx-unit/howto/source/#source-config-src">build time</a> or at <a href="/nginx-unit/howto/source/#source-startup">startup</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>working_directory</strong></td>
          <td style="text-align: left">String; the app&rsquo;s working directory.<br><br>The default is the working directory of Unit&rsquo;s <a href="/nginx-unit/howto/security/#sec-processes">main process</a>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>type</strong> (required)</td>
          <td style="text-align: left">Application type: <strong>external</strong> (Go and Node.js), <strong>java</strong>, <strong>perl</strong>, <strong>php</strong>, <strong>python</strong>, <strong>ruby</strong>, or <strong>wasm</strong> (WebAssembly).<br><br>Except for <strong>external</strong> and <strong>wasm</strong>, you can detail the runtime version: <strong>&ldquo;type&rdquo;: &ldquo;python 3&rdquo;</strong>, <strong>&ldquo;type&rdquo;: &ldquo;python 3.4&rdquo;</strong>, or even <strong>&ldquo;type&rdquo;: &ldquo;python 3.4.9rc1&rdquo;</strong>.<br><br>Unit searches its modules and uses the latest matching one, reporting an error if none match.<br><br>For example, if you have only one PHP module, 7.1.9, it matches <strong>&ldquo;php&rdquo;</strong>, <strong>&ldquo;php 7&rdquo;</strong>, <strong>&ldquo;php 7.1&rdquo;</strong>, and <strong>&ldquo;php 7.1.9&rdquo;</strong>.<br><br>If you have modules for versions 7.0.2 and 7.0.23, set <strong>&ldquo;type&rdquo;: &ldquo;php 7.0.2&rdquo;</strong> to specify the former; otherwise, PHP 7.0.23 will be used.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>environment</strong></td>
          <td style="text-align: left">String-valued object; environment variables to be passed to the app.<br><br>Unit passes the environment variables to the app without modification, even if no environment configuration object is specified.<br><br>Any data specified in the <strong>environment</strong> object gets merged to the existing environment variables.<br><br>If an environment variable already exists in the system and gets declared in this object, the object&rsquo;s value takes precedence and gets passed to the application.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>group</strong></td>
          <td style="text-align: left">String; group name that runs the <a href="/nginx-unit/howto/security/#sec-processes">app process</a>.<br><br>The default is the <strong>user</strong>&rsquo;s primary group.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>isolation</strong></td>
          <td style="text-align: left">Object; manages the isolation of an application process.<br><br>For details, see <a href="/nginx-unit/configuration/#configuration-proc-mgmt-isolation">here</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>limits</strong></td>
          <td style="text-align: left">Object; accepts two integer options, <strong>timeout</strong> and <strong>requests</strong>.<br><br>Their values govern the life cycle of an application process.<br><br>For details, see <a href="/nginx-unit/configuration/#configuration-proc-mgmt-lmts">here</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>processes</strong></td>
          <td style="text-align: left">Integer or object; integer sets a static number of app processes, and object options <strong>max</strong>, <strong>spare</strong>, and <strong>idle_timeout</strong> enable dynamic management.<br><br>For details, see <a href="/nginx-unit/configuration/#configuration-proc-mgmt-prcs">here</a>.<br><br>The default is 1.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>stderr</strong>, <strong>stdout</strong></td>
          <td style="text-align: left">Strings; filenames where Unit redirects the application&rsquo;s output.<br><br>The default when running <em>with</em> <strong>&ndash;no-daemon</strong> is to send <em>stdout</em> to the <em>console</em> and <em>stderr</em> to Unit&rsquo;s <em>log</em>.<br><br>The default when running <em>without</em> <strong>&ndash;no-daemon</strong> is to send <em>stdout</em> to <em>/dev/null</em> and <em>stderr</em> to Unit&rsquo;s <em>log</em>.<br><br>These options have <em>no</em> effect when running with <strong>&ndash;no-daemon</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>user</strong></td>
          <td style="text-align: left">String; username that runs the <a href="/nginx-unit/howto/security/#sec-processes">app process</a>.<br><br>The default is the username configured at <a href="/nginx-unit/howto/source/#source-config-src">build time</a> or at <a href="/nginx-unit/howto/source/#source-startup">startup</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>working_directory</strong></td>
          <td style="text-align: left">String; the app&rsquo;s working directory.<br><br>The default is the working directory of Unit&rsquo;s <a href="/nginx-unit/howto/security/#sec-processes">main process</a>.</td>
      </tr>
  </tbody>
</table>

</div>
<p>Also, you need to set <strong>type</strong>-specific options
to run the app. This
<a href="/nginx-unit/configuration/#configuration-python">Python app</a>
sets <strong>path</strong> and <strong>module</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc46c008&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc46c008">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python 3.6&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/python-apps&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;blog&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;blog.wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;blog&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;blog&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;environment&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DJANGO_SETTINGS_MODULE&#34;</span><span class="p">:</span> <span class="s2">&#34;blog.settings.prod&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DB_ENGINE&#34;</span><span class="p">:</span> <span class="s2">&#34;django.db.backends.postgresql&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DB_NAME&#34;</span><span class="p">:</span> <span class="s2">&#34;blog&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DB_HOST&#34;</span><span class="p">:</span> <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DB_PORT&#34;</span><span class="p">:</span> <span class="s2">&#34;5432&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python 3.6&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/python-apps&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;blog&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;blog.wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;blog&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;blog&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;environment&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DJANGO_SETTINGS_MODULE&#34;</span><span class="p">:</span> <span class="s2">&#34;blog.settings.prod&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DB_ENGINE&#34;</span><span class="p">:</span> <span class="s2">&#34;django.db.backends.postgresql&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DB_NAME&#34;</span><span class="p">:</span> <span class="s2">&#34;blog&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DB_HOST&#34;</span><span class="p">:</span> <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DB_PORT&#34;</span><span class="p">:</span> <span class="s2">&#34;5432&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h3 
id="configuration-proc-mgmt">Process management  <a class="headerlink float-right" href="#configuration-proc-mgmt" title="Process management"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Unit has three per-app options that control how the app&rsquo;s processes behave:
<strong>isolation</strong>, <strong>limits</strong>, and <strong>processes</strong>. Also, you can <strong>GET</strong> the
<strong>/control/applications/</strong> section of the API to restart an app:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc4b05c8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc4b05c8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> curl -X GET --unix-socket /path/to/control.unit.sock  <span class="se">\ </span><span class="c1"># Path to Unit&#39;s control socket in your installation</span>
</span></span><span class="line"><span class="cl"><span class="go">      http://localhost/control/applications/app_name/restart # Your application&#39;s name as defined in the /config/applications/ section
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> curl -X GET --unix-socket /path/to/control.unit.sock  <span class="se">\ </span><span class="c1"># Path to Unit&#39;s control socket in your installation</span>
</span></span><span class="line"><span class="cl"><span class="go">      http://localhost/control/applications/app_name/restart # Your application&#39;s name as defined in the /config/applications/ section
</span></span></span></code></pre></div>
</div><p>Unit handles the rollover gracefully, allowing the old processes to deal
with existing requests and starting a new set of processes (as defined by
the <strong>processes</strong> <a href="/nginx-unit/configuration/#configuration-proc-mgmt-prcs">option</a>)
to accept new requests.</p>
<h4 
id="configuration-proc-mgmt-isolation">Process isolation  <a class="headerlink float-right" href="#configuration-proc-mgmt-isolation" title="Process isolation"><i class="fas fa-link fa-xs"></i></a>
</h4><p>You can use
<a href="https://man7.org/linux/man-pages/man7/namespaces.7.html" target="_blank" rel="noopener">namespace</a>
and
<a href="https://man7.org/linux/man-pages/man2/chroot.2.html" target="_blank" rel="noopener">file system</a>
isolation for your apps if Unit&rsquo;s underlying OS supports them:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc4ee210&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc4ee210">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">ls /proc/self/ns/
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    cgroup mnt \ # The mount namespace
</span></span></span><span class="line"><span class="cl"><span class="go">    net \ # The network namespace
</span></span></span><span class="line"><span class="cl"><span class="go">    pid ... \
</span></span></span><span class="line"><span class="cl"><span class="go">    user \ # The credential namespace
</span></span></span><span class="line"><span class="cl"><span class="go">    uts \ # The uname namespace
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">ls /proc/self/ns/
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    cgroup mnt \ # The mount namespace
</span></span></span><span class="line"><span class="cl"><span class="go">    net \ # The network namespace
</span></span></span><span class="line"><span class="cl"><span class="go">    pid ... \
</span></span></span><span class="line"><span class="cl"><span class="go">    user \ # The credential namespace
</span></span></span><span class="line"><span class="cl"><span class="go">    uts \ # The uname namespace
</span></span></span></code></pre></div>
</div><p>The <strong>isolation</strong> application option has the following members:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>automount</strong></td>
          <td style="text-align: left">Object; controls mount behavior if <strong>rootfs</strong> is enabled. By default, Unit automatically mounts the <a href="/nginx-unit/configuration/#conf-rootfs">language runtime dependencies</a>, a <a href="https://man7.org/linux/man-pages/man5/procfs.5.html" target="_blank" rel="noopener">procfs</a> at <strong>/proc/</strong>, and a <a href="https://man7.org/linux/man-pages/man5/tmpfs.5.html" target="_blank" rel="noopener">tmpfs</a> at <strong>/tmp/</strong>, but you can <a href="/nginx-unit/configuration/#disable-automounts">disable</a> any of these default mounts.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>cgroup</strong></td>
          <td style="text-align: left">Object; defines the app&rsquo;s <a href="/nginx-unit/configuration/#conf-app-cgroup">cgroup</a>.<br><br>  <strong>Options:</strong><br><br>   - <strong>path</strong> (required): String; configures absolute or relative path of the app in the <a href="https://man7.org/linux/man-pages/man7/cgroups.7.html#CGROUPS_VERSION_2" target="_blank" rel="noopener">cgroups v2 hierarchy</a>. The limits trickle down the hierarchy, so child cgroups can&rsquo;t exceed parental thresholds.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>gidmap</strong></td>
          <td style="text-align: left">Same as <strong>uidmap</strong>, but configures group IDs instead of user IDs.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>namespaces</strong></td>
          <td style="text-align: left">Object; configures <a href="https://man7.org/linux/man-pages/man7/namespaces.7.html" target="_blank" rel="noopener">namespace</a> isolation scheme for the application.<br><br>  <strong>Options (system-dependent; check your OS manual for guidance):</strong><br><br>   - <strong>cgroup</strong>: Creates a new cgroup namespace for the app. <br><br>   - <strong>credential</strong>: Creates a new user namespace for the app. <br><br>   - <strong>mount</strong>: Creates a new mount namespace for the app. <br><br>    - <strong>network</strong>: Creates a new network namespace for the app. <br><br>   - <strong>pid</strong>: Creates a new PID namespace for the app. <br><br>   - <strong>uname</strong>: Creates a new UTS namespace for the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>rootfs</strong></td>
          <td style="text-align: left">String; pathname of the directory to be used as the new <a href="/nginx-unit/configuration/#conf-rootfs">file system root</a> for the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>uidmap</strong></td>
          <td style="text-align: left">Array of user ID <a href="/nginx-unit/configuration/#conf-uidgid-mapping">mapping objects</a>; each array item must define the following:<br><br>- <strong>container</strong>: Integer; starts the user ID mapping range in the app&rsquo;s namespace.<br><br>- <strong>host</strong>: Integer; starts the user ID mapping range in the OS namespace.<br><br>- <strong>size</strong>: Integer; size of the ID range in both namespaces.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>automount</strong></td>
          <td style="text-align: left">Object; controls mount behavior if <strong>rootfs</strong> is enabled. By default, Unit automatically mounts the <a href="/nginx-unit/configuration/#conf-rootfs">language runtime dependencies</a>, a <a href="https://man7.org/linux/man-pages/man5/procfs.5.html" target="_blank" rel="noopener">procfs</a> at <strong>/proc/</strong>, and a <a href="https://man7.org/linux/man-pages/man5/tmpfs.5.html" target="_blank" rel="noopener">tmpfs</a> at <strong>/tmp/</strong>, but you can <a href="/nginx-unit/configuration/#disable-automounts">disable</a> any of these default mounts.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>cgroup</strong></td>
          <td style="text-align: left">Object; defines the app&rsquo;s <a href="/nginx-unit/configuration/#conf-app-cgroup">cgroup</a>.<br><br>  <strong>Options:</strong><br><br>   - <strong>path</strong> (required): String; configures absolute or relative path of the app in the <a href="https://man7.org/linux/man-pages/man7/cgroups.7.html#CGROUPS_VERSION_2" target="_blank" rel="noopener">cgroups v2 hierarchy</a>. The limits trickle down the hierarchy, so child cgroups can&rsquo;t exceed parental thresholds.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>gidmap</strong></td>
          <td style="text-align: left">Same as <strong>uidmap</strong>, but configures group IDs instead of user IDs.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>namespaces</strong></td>
          <td style="text-align: left">Object; configures <a href="https://man7.org/linux/man-pages/man7/namespaces.7.html" target="_blank" rel="noopener">namespace</a> isolation scheme for the application.<br><br>  <strong>Options (system-dependent; check your OS manual for guidance):</strong><br><br>   - <strong>cgroup</strong>: Creates a new cgroup namespace for the app. <br><br>   - <strong>credential</strong>: Creates a new user namespace for the app. <br><br>   - <strong>mount</strong>: Creates a new mount namespace for the app. <br><br>    - <strong>network</strong>: Creates a new network namespace for the app. <br><br>   - <strong>pid</strong>: Creates a new PID namespace for the app. <br><br>   - <strong>uname</strong>: Creates a new UTS namespace for the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>rootfs</strong></td>
          <td style="text-align: left">String; pathname of the directory to be used as the new <a href="/nginx-unit/configuration/#conf-rootfs">file system root</a> for the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>uidmap</strong></td>
          <td style="text-align: left">Array of user ID <a href="/nginx-unit/configuration/#conf-uidgid-mapping">mapping objects</a>; each array item must define the following:<br><br>- <strong>container</strong>: Integer; starts the user ID mapping range in the app&rsquo;s namespace.<br><br>- <strong>host</strong>: Integer; starts the user ID mapping range in the OS namespace.<br><br>- <strong>size</strong>: Integer; size of the ID range in both namespaces.</td>
      </tr>
  </tbody>
</table>

</div>
<p>To disable automounts:
<a name="disable-automounts"></a></p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc50c670&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc50c670">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;automount&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;procfs&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;tmpfs&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;automount&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;procfs&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;tmpfs&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>A sample <strong>isolation</strong> object that enables all namespaces and sets mappings for
user and group IDs:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc5429a0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc5429a0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;namespaces&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cgroup&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;credential&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;mount&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;network&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pid&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uname&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;cgroup&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/unit/appcgroup&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;uidmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;container&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;size&#34;</span><span class="p">:</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;gidmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;container&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;size&#34;</span><span class="p">:</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;namespaces&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cgroup&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;credential&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;mount&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;network&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;pid&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;uname&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;cgroup&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/unit/appcgroup&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;uidmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;container&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;size&#34;</span><span class="p">:</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;gidmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;container&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;size&#34;</span><span class="p">:</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h5 
id="conf-app-cgroup">Using control groups  <a class="headerlink float-right" href="#conf-app-cgroup" title="Using control groups"><i class="fas fa-link fa-xs"></i></a>
</h5><p>A control group (cgroup) commands the use of computational resources by a
group of processes in a unified hierarchy. Cgroups are defined by their
<em>paths</em> in the cgroups file system.</p>
<p>The <strong>cgroup</strong> object defines the cgroup for a Unit app; its <strong>path</strong> option
can set an absolute (starting with <strong>/</strong>) or a relative value. If the path
doesn&rsquo;t exist in the cgroups file system, Unit creates it.</p>
<p>Relative paths are implicitly placed inside the cgroup of Unit&rsquo;s
<a href="/nginx-unit/howto/security/#sec-processes">main process</a>;
this setting effectively puts the app to the <strong>/&lt;main Unit process cgroup&gt;/production/app</strong>
cgroup:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc55fa78&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc55fa78">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cgroup&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;production/app&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cgroup&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;production/app&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>An absolute pathname places the application under a separate cgroup subtree;
this configuration puts the app under <strong>/staging/app</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc575df0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc575df0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cgroup&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/staging/app&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cgroup&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/staging/app&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>A basic use case would be to set a memory limit on a cgroup.
First, find the cgroup mount point:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc586b78&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc586b78">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">mount -l | grep cgroup
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    cgroup2 on /sys/fs/cgroup type cgroup2 (rw,nosuid,nodev,noexec,relatime,nsdelegate,memory_recursiveprot)
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">mount -l | grep cgroup
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    cgroup2 on /sys/fs/cgroup type cgroup2 (rw,nosuid,nodev,noexec,relatime,nsdelegate,memory_recursiveprot)
</span></span></span></code></pre></div>
</div><p>Next, check the available controllers and set the <strong>memory.high</strong> limit:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc597900&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc597900">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">cat /sys/fs/cgroup/staging/app/cgroup.controllers # cgroup&#39;s path set in Unit configuration
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    cpuset cpu io memory pids
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">cat /sys/fs/cgroup/staging/app/cgroup.controllers # cgroup&#39;s path set in Unit configuration
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    cpuset cpu io memory pids
</span></span></span></code></pre></div>
</div><p>As root, run the following command:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc5a7300&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc5a7300">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">echo 1G &gt; /sys/fs/cgroup/staging/app/memory.high # cgroup&#39;s path set in Unit configuration
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">echo 1G &gt; /sys/fs/cgroup/staging/app/memory.high # cgroup&#39;s path set in Unit configuration
</span></span></span></code></pre></div>
</div><p>For more details and possible options,refer to the
<a href="https://docs.kernel.org/admin-guide/cgroup-v2.html" target="_blank" rel="noopener">admin guide</a>.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> To avoid confusion, mind that the <strong>namespaces/cgroups</strong> option
controls the application&rsquo;s cgroup <em>namespace</em>; instead, the <strong>cgroup/path</strong> option
specifies the cgroup where Unit puts the application.</div>
</blockquote>

<h5 
id="conf-rootfs">Changing root directory  <a class="headerlink float-right" href="#conf-rootfs" title="Changing root directory"><i class="fas fa-link fa-xs"></i></a>
</h5><p>The <strong>rootfs</strong> option confines the app to the directory you provide, making
it the new <a href="https://man7.org/linux/man-pages/man2/chroot.2.html" target="_blank" rel="noopener">file system root</a>.
To use it, your app should have the corresponding privilege (effectively, run
as <strong>root</strong> in most cases).</p>
<p>The root directory is changed before the language module starts the app, so
any path options for the app should be relative to the new root. Note the
<strong>path</strong> and <strong>home</strong> settings:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc5d5930&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc5d5930">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python 2.7&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_path&#34;</span><span class="p">:</span> <span class="s2">&#34;Without rootfs, this would be /var/app/sandbox/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;home&#34;</span><span class="p">:</span> <span class="s2">&#34;/venv/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_home&#34;</span><span class="p">:</span> <span class="s2">&#34;Without rootfs, this would be /var/app/sandbox/venv/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;rootfs&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/app/sandbox/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python 2.7&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_path&#34;</span><span class="p">:</span> <span class="s2">&#34;Without rootfs, this would be /var/app/sandbox/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;home&#34;</span><span class="p">:</span> <span class="s2">&#34;/venv/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_home&#34;</span><span class="p">:</span> <span class="s2">&#34;Without rootfs, this would be /var/app/sandbox/venv/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;rootfs&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/app/sandbox/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="warning call-out">
  <div><strong class="call-out-type">Warning</strong><br/> <p>When using <strong>rootfs</strong> with <strong>credential</strong> set to <strong>true</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffe3539f8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffe3539f8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;isolation&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;rootfs&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/app/sandbox/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;namespaces&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;credential&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;isolation&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;rootfs&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/app/sandbox/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;namespaces&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;credential&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Ensure that the user the app <em>runs as</em> can access the <strong>rootfs</strong> directory.</p>
</div>
</blockquote>

<p>Unit mounts language-specific files and directories to the new root
so the app stays operational:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Language</th>
          <th style="text-align: left">Language-Specific Mounts</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>Java</strong></td>
          <td style="text-align: left">- JVM&rsquo;s <strong>libc.so</strong> directory<br><br> - Java module&rsquo;s <a href="/nginx-unit/howto/source/#modules-java">home</a> directory</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Python</strong></td>
          <td style="text-align: left">Python&rsquo;s <strong>sys.path</strong> <a href="https://docs.python.org/3/library/sys.html#sys.path" target="_blank" rel="noopener">directories</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Ruby</strong></td>
          <td style="text-align: left">- Ruby&rsquo;s header, interpreter, and library <a href="https://idiosyncratic-ruby.com/42-ruby-config.html" target="_blank" rel="noopener">directories</a>: <strong>rubyarchhdrdir</strong>, <strong>rubyhdrdir</strong>, <strong>rubylibdir</strong>, <strong>rubylibprefix</strong>, <strong>sitedir</strong>, and <strong>topdir</strong><br><br> - Ruby&rsquo;s gem installation directory (<strong>gem env gemdir</strong>)<br><br> - Ruby&rsquo;s entire gem path list (<strong>gem env gempath</strong>)</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Language</th>
          <th style="text-align: left">Language-Specific Mounts</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>Java</strong></td>
          <td style="text-align: left">- JVM&rsquo;s <strong>libc.so</strong> directory<br><br> - Java module&rsquo;s <a href="/nginx-unit/howto/source/#modules-java">home</a> directory</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Python</strong></td>
          <td style="text-align: left">Python&rsquo;s <strong>sys.path</strong> <a href="https://docs.python.org/3/library/sys.html#sys.path" target="_blank" rel="noopener">directories</a></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Ruby</strong></td>
          <td style="text-align: left">- Ruby&rsquo;s header, interpreter, and library <a href="https://idiosyncratic-ruby.com/42-ruby-config.html" target="_blank" rel="noopener">directories</a>: <strong>rubyarchhdrdir</strong>, <strong>rubyhdrdir</strong>, <strong>rubylibdir</strong>, <strong>rubylibprefix</strong>, <strong>sitedir</strong>, and <strong>topdir</strong><br><br> - Ruby&rsquo;s gem installation directory (<strong>gem env gemdir</strong>)<br><br> - Ruby&rsquo;s entire gem path list (<strong>gem env gempath</strong>)</td>
      </tr>
  </tbody>
</table>

</div>
<details>
<summary>Using "uidmap", "gidmap"</summary>
<a name="conf-uidgid-mapping"></a>
<p>The <strong>uidmap</strong> and <strong>gidmap</strong> options are available only if the underlying OS
supports <a href="https://man7.org/linux/man-pages/man7/user_namespaces.7.html" target="_blank" rel="noopener">user namespaces</a></p>
<p>If <strong>uidmap</strong> is omitted but <strong>credential</strong> isolation is enabled,the effective
UID (EUID) of the application process in the host namespace is mapped to the
same UID in the container namespace; the same applies to <strong>gidmap</strong> and GID,
respectively. This means that the configuration below:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc5f2a08&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc5f2a08">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;some_user&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;namespaces&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;credential&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;some_user&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;namespaces&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;credential&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Is equivalent to the following (assuming <strong>some_user</strong>&rsquo;s EUID and EGID are
both equal to 1000):</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc648908&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc648908">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;some_user&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;namespaces&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;credential&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uidmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;1000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;container&#34;</span><span class="p">:</span> <span class="s2">&#34;1000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;size&#34;</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;gidmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;1000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;container&#34;</span><span class="p">:</span> <span class="s2">&#34;1000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;size&#34;</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;some_user&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;isolation&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;namespaces&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;credential&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;uidmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;1000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;container&#34;</span><span class="p">:</span> <span class="s2">&#34;1000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;size&#34;</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;gidmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;host&#34;</span><span class="p">:</span> <span class="s2">&#34;1000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;container&#34;</span><span class="p">:</span> <span class="s2">&#34;1000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;size&#34;</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><hr>
</details>
<h4 
id="configuration-proc-mgmt-lmts">Request limits  <a class="headerlink float-right" href="#configuration-proc-mgmt-lmts" title="Request limits"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The <strong>limits</strong> object controls request handling by the app process and has two
integer options:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>requests</strong></td>
          <td style="text-align: left">Integer; maximum number of requests an app process can serve. When the limit is reached, the process restarts; this mitigates possible memory leaks or other cumulative issues.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>timeout</strong></td>
          <td style="text-align: left">Integer; request timeout in seconds. If an app process exceeds it while handling a request, Unit cancels the request and returns a 503 &ldquo;Service Unavailable&rdquo; response to the client.<br><br> <i class="fa-solid fa-triangle-exclamation" style="color: orange"></i> Unit doesn&rsquo;t detect freezes, so the hanging process stays on the app&rsquo;s process pool.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>requests</strong></td>
          <td style="text-align: left">Integer; maximum number of requests an app process can serve. When the limit is reached, the process restarts; this mitigates possible memory leaks or other cumulative issues.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>timeout</strong></td>
          <td style="text-align: left">Integer; request timeout in seconds. If an app process exceeds it while handling a request, Unit cancels the request and returns a 503 &ldquo;Service Unavailable&rdquo; response to the client.<br><br> <i class="fa-solid fa-triangle-exclamation" style="color: orange"></i> Unit doesn&rsquo;t detect freezes, so the hanging process stays on the app&rsquo;s process pool.</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example-1">Example:  <a class="headerlink float-right" href="#example-1" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc69a1b8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc69a1b8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/python-apps&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;blog.wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;limits&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;timeout&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;requests&#34;</span><span class="p">:</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/python-apps&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;blog.wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;limits&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;timeout&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;requests&#34;</span><span class="p">:</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="configuration-proc-mgmt-prcs">Application processes  <a class="headerlink float-right" href="#configuration-proc-mgmt-prcs" title="Application processes"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The <strong>processes</strong> option offers a choice between static and dynamic process
management. If you set it to an integer, Unit immediately launches the given
number of app processes and keeps them without scaling.</p>
<p>To enable a dynamic prefork model for your app, supply a <strong>processes</strong> object
with the following options:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>idle_timeout</strong></td>
          <td style="text-align: left">Number of seconds Unit waits for before terminating an idle process that exceeds <strong>spare</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>max</strong></td>
          <td style="text-align: left">Maximum number of application processes that Unit maintains (busy and idle).<br><br> The default is 1.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>spare</strong></td>
          <td style="text-align: left">Minimum number of idle processes that Unit tries to maintain for an app. When the app is started, <strong>spare</strong> idles are launched; Unit passes new requests to existing idles, forking new idles to keep the <strong>spare</strong> level if <strong>max</strong> allows. When busy processes complete their work and turn idle again, Unit terminates extra idles after <strong>idle_timeout</strong>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>idle_timeout</strong></td>
          <td style="text-align: left">Number of seconds Unit waits for before terminating an idle process that exceeds <strong>spare</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>max</strong></td>
          <td style="text-align: left">Maximum number of application processes that Unit maintains (busy and idle).<br><br> The default is 1.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>spare</strong></td>
          <td style="text-align: left">Minimum number of idle processes that Unit tries to maintain for an app. When the app is started, <strong>spare</strong> idles are launched; Unit passes new requests to existing idles, forking new idles to keep the <strong>spare</strong> level if <strong>max</strong> allows. When busy processes complete their work and turn idle again, Unit terminates extra idles after <strong>idle_timeout</strong>.</td>
      </tr>
  </tbody>
</table>

</div>
<p>If <strong>processes</strong> is omitted entirely, Unit creates 1 static process. If an
empty object is provided: <strong>&ldquo;processes&rdquo;: {}</strong>, dynamic behavior with default
option values is assumed.</p>
<p>Here, Unit allows 10 processes maximum, keeps 5 idles, and terminates extra
idles after 20 seconds:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc6dc450&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc6dc450">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;max&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;spare&#34;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;idle_timeout&#34;</span><span class="p">:</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;max&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;spare&#34;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;idle_timeout&#34;</span><span class="p">:</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> For details of manual application process restart, see the
<a href="/nginx-unit/configuration/#configuration-proc-mgmt">process management</a>
documentation.</div>
</blockquote>

<p><a name="configuration-languages"></a></p>
<h3 
id="configuration-go">Go  <a class="headerlink float-right" href="#configuration-go" title="Go"><i class="fas fa-link fa-xs"></i></a>
</h3><p>To run a Go app on Unit, modify its source to make it Unit-aware and rebuild
the app.</p>
<details>
<summary>Updating Go apps to run on Unit</summary>
<p><a name="updating-go-apps"></a></p>
<p>Unit uses <a href="https://pkg.go.dev/cmd/cgo" target="_blank" rel="noopener">cgo</a> to invoke C code from Go,
so check the following prerequisites:</p>
<ul>
<li>
<p>The <code>CGO_ENABLED</code> variable is set to <strong>1</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc713b08&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc713b08">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">go env CGO_ENABLED
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      0
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">go env CGO_ENABLED
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      0
</span></span></span></code></pre></div>
</div>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc7390b0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc7390b0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">go env -w CGO_ENABLED=1
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">go env -w CGO_ENABLED=1
</span></span></span></code></pre></div>
</div></li>
<li>
<p>If you installed Unit from the
<a href="/nginx-unit/installation/#installation-precomp-pkgs">official packages</a>,
install the development package:</p>
<ul>
<li>
<p>Debian, Ubuntu</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc7657a0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc7657a0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">apt install unit-dev
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">apt install unit-dev
</span></span></span></code></pre></div>
</div></li>
<li>
<p>Amazon, Fedora, RHEL</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc795540&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc795540">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">yum install unit-devel
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">yum install unit-devel
</span></span></span></code></pre></div>
</div></li>
</ul>
</li>
<li>
<p>If you installed Unit from
<a href="/nginx-unit/howto/source/">source</a>,
install the include files and libraries:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc7be968&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc7be968">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">make libunit-install
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">make libunit-install
</span></span></span></code></pre></div>
</div></li>
</ul>
<p>In the <strong>import</strong> section, list the <strong>unit.nginx.org/go</strong> package:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">go</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc7f96d0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc7f96d0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;unit.nginx.org/go&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;unit.nginx.org/go&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span></span></span></code></pre></div>
</div><p>Replace the <strong>http.ListenAndServe</strong> call with <strong>unit.ListenAndServe</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">go</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc8612f8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc8612f8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl">      <span class="nx">http</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// http.ListenAndServe(&#34;:8080&#34;, nil)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">unit</span><span class="p">.</span><span class="nf">ListenAndServe</span><span class="p">(</span><span class="s">&#34;:8080&#34;</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl">      <span class="nx">http</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// http.ListenAndServe(&#34;:8080&#34;, nil)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">unit</span><span class="p">.</span><span class="nf">ListenAndServe</span><span class="p">(</span><span class="s">&#34;:8080&#34;</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>If you haven&rsquo;t done so yet, initialize the Go module for your app:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc88c660&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc88c660">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">go mod init example.com/app # Arbitrary module designation
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      go: creating new go.mod: module example.com/app
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">go mod init example.com/app # Arbitrary module designation
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      go: creating new go.mod: module example.com/app
</span></span></span></code></pre></div>
</div><p>Install the newly added dependency and build your application:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc8b8580&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc8b8580">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">go get unit.nginx.org/go@1.34.1
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      go: downloading unit.nginx.org
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">go build -o app app.go # Executable name and Application source code
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">go get unit.nginx.org/go@1.34.1
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      go: downloading unit.nginx.org
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">go build -o app app.go # Executable name and Application source code
</span></span></span></code></pre></div>
</div><p>If you update Unit to a newer version, repeat the two commands above
to rebuild your app.</p>
<p>The resulting executable works as follows:</p>
<ul>
<li>
<p>When you run it standalone, the <strong>unit.ListenAndServe</strong> call
falls back to <strong>http</strong> functionality.</p>
</li>
<li>
<p>When Unit runs it, <strong>unit.ListenAndServe</strong> directly communicates
with Unit&rsquo;s router process, ignoring the address supplied as its first argument
and relying on the
<a href="/nginx-unit/configuration/#configuration-listeners">listener&rsquo;s settings</a>
instead.</p>
</li>
</ul>
<hr>
</details>
<p>Next, configure the app on Unit; besides the
<a href="/nginx-unit/configuration/#configuration-apps-common">common options</a>,
you have:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>executable</strong> (required)</td>
          <td style="text-align: left">String; pathname of the application, absolute or relative to <strong>working_directory</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>arguments</strong></td>
          <td style="text-align: left">Array of strings; command-line arguments to be passed to the application. The example below is equivalent to <strong>/www/chat/bin/chat_app &ndash;tmp-files /tmp/go-cache</strong>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>executable</strong> (required)</td>
          <td style="text-align: left">String; pathname of the application, absolute or relative to <strong>working_directory</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>arguments</strong></td>
          <td style="text-align: left">Array of strings; command-line arguments to be passed to the application. The example below is equivalent to <strong>/www/chat/bin/chat_app &ndash;tmp-files /tmp/go-cache</strong>.</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example-2">Example:  <a class="headerlink float-right" href="#example-2" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc921530&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc921530">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;external&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/chat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;executable&#34;</span><span class="p">:</span> <span class="s2">&#34;bin/chat_app&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www-go&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www-go&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--tmp-files&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/tmp/go-cache&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;external&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/chat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;executable&#34;</span><span class="p">:</span> <span class="s2">&#34;bin/chat_app&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www-go&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www-go&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--tmp-files&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/tmp/go-cache&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> For Go-based examples, see our <a href="/nginx-unit/howto/apps/grafana/">grafana</a>
howto or a basic
<a href="/nginx-unit/howto/samples/#sample-go">sample</a>.</div>
</blockquote>

<h3 
id="configuration-java">Java  <a class="headerlink float-right" href="#configuration-java" title="Java"><i class="fas fa-link fa-xs"></i></a>
</h3><p>First, make sure to install Unit along with the
<a href="/nginx-unit/installation/#installation-precomp-pkgs">Java language module</a>.</p>
<p>Besides the
<a href="/nginx-unit/configuration/#configuration-apps-common">common options</a>,
you have:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>webapp</strong> (required)</td>
          <td style="text-align: left">String; pathname of the application&rsquo;s <strong>.war</strong> file (packaged or unpackaged).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>classpath</strong></td>
          <td style="text-align: left">Array of strings; paths to your app&rsquo;s required libraries (may point to directories or individual <strong>.jar</strong> files).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>options</strong></td>
          <td style="text-align: left">Array of strings; defines JVM runtime options. Unit itself exposes the <strong>-Dnginx.unit.context.path</strong> option that defaults to <strong>/</strong>; use it to customize the <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/ServletContext.html#getContextPath--" target="_blank" rel="noopener">context path</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>thread_stack_size</strong></td>
          <td style="text-align: left">Integer; stack size of a worker thread (in bytes, multiple of memory page size; the minimum value is usually architecture specific). The default is usually system dependent.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>threads</strong></td>
          <td style="text-align: left">Integer; number of worker threads per <a href="/nginx-unit/howto/security/#sec-processes">app process</a>. When started, each app process creates this number of threads to handle requests. The default is <strong>1</strong>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>webapp</strong> (required)</td>
          <td style="text-align: left">String; pathname of the application&rsquo;s <strong>.war</strong> file (packaged or unpackaged).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>classpath</strong></td>
          <td style="text-align: left">Array of strings; paths to your app&rsquo;s required libraries (may point to directories or individual <strong>.jar</strong> files).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>options</strong></td>
          <td style="text-align: left">Array of strings; defines JVM runtime options. Unit itself exposes the <strong>-Dnginx.unit.context.path</strong> option that defaults to <strong>/</strong>; use it to customize the <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/ServletContext.html#getContextPath--" target="_blank" rel="noopener">context path</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>thread_stack_size</strong></td>
          <td style="text-align: left">Integer; stack size of a worker thread (in bytes, multiple of memory page size; the minimum value is usually architecture specific). The default is usually system dependent.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>threads</strong></td>
          <td style="text-align: left">Integer; number of worker threads per <a href="/nginx-unit/howto/security/#sec-processes">app process</a>. When started, each app process creates this number of threads to handle requests. The default is <strong>1</strong>.</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example-3">Example:  <a class="headerlink float-right" href="#example-3" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc978ba0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc978ba0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;java&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;classpath&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/www/qwk2mart/lib/qwk2mart-2.0.0.jar&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;options&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;-Dlog_path=/var/log/qwk2mart.log&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;webapp&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/qwk2mart/qwk2mart.war&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;java&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;classpath&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/www/qwk2mart/lib/qwk2mart-2.0.0.jar&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;options&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;-Dlog_path=/var/log/qwk2mart.log&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;webapp&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/qwk2mart/qwk2mart.war&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> For Java-based examples, see our
<a href="/nginx-unit/howto/apps/jira/">Jira</a>,
<a href="/nginx-unit/howto/apps/opengrok/">OpenGrok</a>,
and
<a href="/nginx-unit/howto/frameworks/springboot/">Springbook</a>
howtos or a basic
<a href="/nginx-unit/configuration/#sample-java">sample</a>.</div>
</blockquote>

<h3 
id="configuration-nodejs">Node.js  <a class="headerlink float-right" href="#configuration-nodejs" title="Node.js"><i class="fas fa-link fa-xs"></i></a>
</h3><p>First, you need to have the <code>unit-http</code> module
<a href="/nginx-unit/installation/#installation-nodejs-package">installed</a>.
If it&rsquo;s global, symlink it in your project directory:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffc9ab820&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffc9ab820">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">npm link unit-http
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">npm link unit-http
</span></span></span></code></pre></div>
</div><p>Do the same if you move a Unit-hosted app to a new system where <code>unit-http</code> is
installed globally. Also, if you update Unit later, update the Node.js module as
well according to your
<a href="/nginx-unit/installation/#installation-nodejs-package">installation method</a>.</p>
<p>Next, to run your Node.js apps on Unit, you need to configure them.
Besides the
<a href="/nginx-unit/configuration/#configuration-apps-common">common options</a>,
you have:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>executable</strong> (required)</td>
          <td style="text-align: left">String; pathname of the app, absolute or relative to <strong>working_directory</strong>.<br><br>Supply your <strong>.js</strong> pathname here and start the file itself with a proper shebang:<br><br><code>#!/usr/bin/env node</code><br><br><strong>Note:</strong> Make sure to <code>chmod +x</code> the file you list here so Unit can start it.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>arguments</strong></td>
          <td style="text-align: left">Array of strings; command-line arguments to be passed to the app. The example below is equivalent to <strong>/www/apps/node-app/app.js &ndash;tmp-files /tmp/node-cache</strong>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>executable</strong> (required)</td>
          <td style="text-align: left">String; pathname of the app, absolute or relative to <strong>working_directory</strong>.<br><br>Supply your <strong>.js</strong> pathname here and start the file itself with a proper shebang:<br><br><code>#!/usr/bin/env node</code><br><br><strong>Note:</strong> Make sure to <code>chmod +x</code> the file you list here so Unit can start it.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>arguments</strong></td>
          <td style="text-align: left">Array of strings; command-line arguments to be passed to the app. The example below is equivalent to <strong>/www/apps/node-app/app.js &ndash;tmp-files /tmp/node-cache</strong>.</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example-4">Example:  <a class="headerlink float-right" href="#example-4" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffca022d8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffca022d8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;external&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/app/node-app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;executable&#34;</span><span class="p">:</span> <span class="s2">&#34;app.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www-node&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www-node&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--tmp-files&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/tmp/node-cache&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;external&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/app/node-app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;executable&#34;</span><span class="p">:</span> <span class="s2">&#34;app.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www-node&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www-node&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--tmp-files&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/tmp/node-cache&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p><a name="configuration-nodejs-loader"></a></p>
<p>You can run Node.js apps without altering their code, using a loader module
we provide with <code>unit-http</code>. Apply the following app configuration,
depending on your version of Node.js:</p>
<div class="tabs-container">
	<ul class="nav nav-tabs" id="nodejs" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#nodejs-0" role="tab" aria-controls="nodejs-0" aria-selected="true">14.16.x and later</a></li>
		
			<li class="nav-item"><a data-toggle="tab" class="nav-link" href="#nodejs-1" role="tab" aria-controls="nodejs-1">14.15.x and earlier</a></li></ul>
</div>
<div class="tab-content" id="nodejs"><div id="nodejs-0" class="tab-pane show active" role="tabpanel" aria-labelledby="nodejs-0">



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffe68d8d0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffe68d8d0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;external&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;executable&#34;</span><span class="p">:</span> <span class="s2">&#34;/usr/bin/env&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_executable&#34;</span><span class="p">:</span> <span class="s2">&#34;The external app type allows to run arbitrary executables, provided they establish communication with Unit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;node&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--loader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;unit-http/loader.mjs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--require&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;unit-http/loader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;app.js&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_arguments_last&#34;</span><span class="p">:</span> <span class="s2">&#34;Application script name&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;external&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;executable&#34;</span><span class="p">:</span> <span class="s2">&#34;/usr/bin/env&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_executable&#34;</span><span class="p">:</span> <span class="s2">&#34;The external app type allows to run arbitrary executables, provided they establish communication with Unit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;node&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--loader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;unit-http/loader.mjs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--require&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;unit-http/loader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;app.js&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_arguments_last&#34;</span><span class="p">:</span> <span class="s2">&#34;Application script name&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div></div>
  <div id="nodejs-1" class="tab-pane" role="tabpanel" aria-labelledby="nodejs-1">



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffe6ed028&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffe6ed028">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;external&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;executable&#34;</span><span class="p">:</span> <span class="s2">&#34;/usr/bin/env&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_executable&#34;</span><span class="p">:</span> <span class="s2">&#34;The external app type allows to run arbitrary executables, provided they establish communication with Unit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;node&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--require&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;unit-http/loader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;app.js&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_arguments_last&#34;</span><span class="p">:</span> <span class="s2">&#34;Application script name&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;external&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;executable&#34;</span><span class="p">:</span> <span class="s2">&#34;/usr/bin/env&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_executable&#34;</span><span class="p">:</span> <span class="s2">&#34;The external app type allows to run arbitrary executables, provided they establish communication with Unit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;arguments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;node&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;--require&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;unit-http/loader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;app.js&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_arguments_last&#34;</span><span class="p">:</span> <span class="s2">&#34;Application script name&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div></div></div>

<p>The loader overrides the <strong>http</strong> and <strong>websocket</strong> modules with their Unit-aware versions
and starts the app.</p>
<p>You can also run your Node.js apps without the loader by updating the application source code.
For that, use <strong>unit-http</strong> instead of <strong>http</strong> in your code:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffca3b4e8&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1ffca3b4e8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;unit-http&#39;</span><span class="p">);</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;unit-http&#39;</span><span class="p">);</span></span></span></code></pre></div>
</div><p>To use the WebSocket protocol, your app only needs to replace the default <strong>websocket</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffca6c228&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1ffca6c228">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">webSocketServer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;unit-http/websocket&#39;</span><span class="p">).</span><span class="nx">server</span><span class="p">;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">webSocketServer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;unit-http/websocket&#39;</span><span class="p">).</span><span class="nx">server</span><span class="p">;</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> For Node.js-based examples, see our
<a href="/nginx-unit/howto/apps/apollo/">apollo</a>,
<a href="/nginx-unit/howto/frameworks/express/">express</a>,
<a href="/nginx-unit/howto/frameworks/koa/">koa</a>,
and
<a href="/nginx-unit/howto/docker/">Docker</a>
howtos or a basic
<a href="/nginx-unit/configuration/#sample-nodejs">sample</a>.</div>
</blockquote>

<h3 
id="configuration-perl">Perl  <a class="headerlink float-right" href="#configuration-perl" title="Perl"><i class="fas fa-link fa-xs"></i></a>
</h3><p>First, make sure to install Unit along with the
<a href="/nginx-unit/installation/#installation-precomp-pkgs">Perl language module</a>.</p>
<p>Besides the
<a href="/nginx-unit/configuration/#configuration-apps-common">common options</a>,
you have:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>script</strong> (required)</td>
          <td style="text-align: left">String; PSGI script path.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>thread_stack_size</strong></td>
          <td style="text-align: left">Integer; stack size of a worker thread (in bytes, multiple of memory page size; the minimum value is usually architecture specific). The default is usually system dependent and can be set with <code>ulimit -s &lt;SIZE_KB&gt;</code>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>threads</strong></td>
          <td style="text-align: left">Integer; number of worker threads per <a href="/nginx-unit/howto/security/#sec-processes">app process</a>. When started, each app process creates this number of threads to handle requests. The default is <strong>1</strong>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>script</strong> (required)</td>
          <td style="text-align: left">String; PSGI script path.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>thread_stack_size</strong></td>
          <td style="text-align: left">Integer; stack size of a worker thread (in bytes, multiple of memory page size; the minimum value is usually architecture specific). The default is usually system dependent and can be set with <code>ulimit -s &lt;SIZE_KB&gt;</code>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>threads</strong></td>
          <td style="text-align: left">Integer; number of worker threads per <a href="/nginx-unit/howto/security/#sec-processes">app process</a>. When started, each app process creates this number of threads to handle requests. The default is <strong>1</strong>.</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example-5">Example:  <a class="headerlink float-right" href="#example-5" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffcac4450&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffcac4450">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;perl&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/bugtracker/app.psgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/bugtracker&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;perl&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/bugtracker/app.psgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/bugtracker&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> For Perl-based examples of Perl,
see our
<a href="/nginx-unit/howto/apps/bugzilla/">Bugzilla</a>
and
<a href="/nginx-unit/howto/frameworks/catalyst/">Catalyst</a>
howtos or a basic
<a href="/nginx-unit/configuration/#sample-perl">sample</a>.</div>
</blockquote>

<h3 
id="configuration-php">PHP  <a class="headerlink float-right" href="#configuration-php" title="PHP"><i class="fas fa-link fa-xs"></i></a>
</h3><p>First, make sure to install Unit along with the
<a href="/nginx-unit/installation/#installation-precomp-pkgs">PHP language module</a>.</p>
<p>Besides the
<a href="/nginx-unit/configuration/#configuration-apps-common">common options</a>, you have:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>root</strong> (required)</td>
          <td style="text-align: left">String; base directory of the app&rsquo;s file structure. All URI paths are relative to it.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>index</strong></td>
          <td style="text-align: left">String; filename added to URI paths that point to directories if no <strong>script</strong> is set.<br><br>The default is <strong>index.php</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>options</strong></td>
          <td style="text-align: left">Object; <a href="/nginx-unit/configuration/#configuration-php-options">defines</a> the <strong>php.ini</strong> location and options.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>script</strong></td>
          <td style="text-align: left">String; filename of a <strong>root</strong>-based PHP script that serves all requests to the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>targets</strong></td>
          <td style="text-align: left">Object; defines application sections with <a href="/nginx-unit/configuration/#configuration-php-targets">custom</a> <strong>root</strong>, <strong>script</strong>, and <strong>index</strong> values.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>root</strong> (required)</td>
          <td style="text-align: left">String; base directory of the app&rsquo;s file structure. All URI paths are relative to it.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>index</strong></td>
          <td style="text-align: left">String; filename added to URI paths that point to directories if no <strong>script</strong> is set.<br><br>The default is <strong>index.php</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>options</strong></td>
          <td style="text-align: left">Object; <a href="/nginx-unit/configuration/#configuration-php-options">defines</a> the <strong>php.ini</strong> location and options.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>script</strong></td>
          <td style="text-align: left">String; filename of a <strong>root</strong>-based PHP script that serves all requests to the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>targets</strong></td>
          <td style="text-align: left">Object; defines application sections with <a href="/nginx-unit/configuration/#configuration-php-targets">custom</a> <strong>root</strong>, <strong>script</strong>, and <strong>index</strong> values.</td>
      </tr>
  </tbody>
</table>

</div>
<p>The <strong>index</strong> and <strong>script</strong> options enable two modes of operation:</p>
<ul>
<li>If <strong>script</strong> is set, all requests to the application are handled
by the script you specify in this option.</li>
<li>Otherwise, the requests are served  according to their URI paths;
if they point to directories, <strong>index</strong> is used.</li>
</ul>
<p><a name="configuration-php-options"></a></p>
<p>You can customize <strong>php.ini</strong> via the <strong>options</strong> object:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>admin</strong>, <strong>user</strong></td>
          <td style="text-align: left">Objects for extra directives. Values in <strong>admin</strong> are set in <strong>PHP_INI_SYSTEM</strong> mode, so the app can&rsquo;t alter them; <strong>user</strong> values are set in <strong>PHP_INI_USER</strong> mode and can be <a href="https://www.php.net/manual/en/function.ini-set.php" target="_blank" rel="noopener">updated</a> at runtime.<br><br>- The objects override the settings from any *<strong>.ini</strong> files<br><br>- The <strong>admin</strong> object can only set what&rsquo;s <a href="https://www.php.net/manual/en/ini.list.php" target="_blank" rel="noopener">listed</a> as <strong>PHP_INI_SYSTEM</strong>; for other modes, set <strong>user</strong><br><br>- Neither <strong>admin</strong> nor <strong>user</strong> can set directives listed as <a href="https://www.php.net/manual/en/ini.list.php" target="_blank" rel="noopener">php.ini only</a> except for <strong>disable_classes</strong> and <strong>disable_functions</strong></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>file</strong></td>
          <td style="text-align: left">String; pathname of the <strong>php.ini</strong> file with <a href="https://www.php.net/manual/en/ini.list.php" target="_blank" rel="noopener">PHP configuration directives</a>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>admin</strong>, <strong>user</strong></td>
          <td style="text-align: left">Objects for extra directives. Values in <strong>admin</strong> are set in <strong>PHP_INI_SYSTEM</strong> mode, so the app can&rsquo;t alter them; <strong>user</strong> values are set in <strong>PHP_INI_USER</strong> mode and can be <a href="https://www.php.net/manual/en/function.ini-set.php" target="_blank" rel="noopener">updated</a> at runtime.<br><br>- The objects override the settings from any *<strong>.ini</strong> files<br><br>- The <strong>admin</strong> object can only set what&rsquo;s <a href="https://www.php.net/manual/en/ini.list.php" target="_blank" rel="noopener">listed</a> as <strong>PHP_INI_SYSTEM</strong>; for other modes, set <strong>user</strong><br><br>- Neither <strong>admin</strong> nor <strong>user</strong> can set directives listed as <a href="https://www.php.net/manual/en/ini.list.php" target="_blank" rel="noopener">php.ini only</a> except for <strong>disable_classes</strong> and <strong>disable_functions</strong></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>file</strong></td>
          <td style="text-align: left">String; pathname of the <strong>php.ini</strong> file with <a href="https://www.php.net/manual/en/ini.list.php" target="_blank" rel="noopener">PHP configuration directives</a>.</td>
      </tr>
  </tbody>
</table>

</div>
<p>To load multiple <strong>.ini</strong> files, use <strong>environment</strong> with <code>PHP_INI_SCAN_DIR</code> to
<a href="https://www.php.net/manual/en/configuration.file.php" target="_blank" rel="noopener">scan a custom directory</a>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffcb22ff0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffcb22ff0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;hello-world&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/public/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;environment&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;PHP_INI_SCAN_DIR&#34;</span><span class="p">:</span> <span class="s2">&#34;:/tmp/php.inis/&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_PHP_INI_SCAN_DIR&#34;</span><span class="p">:</span> <span class="s2">&#34;Path separator&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;hello-world&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/public/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;index.php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;environment&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;PHP_INI_SCAN_DIR&#34;</span><span class="p">:</span> <span class="s2">&#34;:/tmp/php.inis/&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;comment_PHP_INI_SCAN_DIR&#34;</span><span class="p">:</span> <span class="s2">&#34;Path separator&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Mind that the colon that prefixes the value here is a path separator;
it causes PHP to scan the directory preconfigured with the
{option}<code>!--with-config-file-scan-dir</code> option, which is usually <strong>/etc/php.d/</strong>,
and then the directory you set here, which is <strong>/tmp/php.inis/</strong>.
To skip the preconfigured directory, drop the <strong>:</strong> prefix.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> Values in <strong>options</strong> must be strings (for example, <strong>&ldquo;max_file_uploads&rdquo;: &ldquo;4&rdquo;</strong>,
not <strong>&ldquo;max_file_uploads&rdquo;: 4</strong>); for boolean flags, use <strong>&ldquo;0&rdquo;</strong> and <strong>&ldquo;1&rdquo;</strong> only.
For details aof <strong>PHP_INI_*</strong> modes, see the
<a href="https://www.php.net/manual/en/configuration.changes.modes.php" target="_blank" rel="noopener">PHP docs</a>.</div>
</blockquote>

<blockquote class="note">
  <div><strong>Note:</strong><br/> Unit implements the <strong>fastcgi_finish_request()</strong> <a href="https://www.php.net/manual/en/function.fastcgi-finish-request.php" target="_blank" rel="noopener">function</a> in a manner similar to PHP-FPM.</div>
</blockquote>

<h4 
id="example-6">Example:  <a class="headerlink float-right" href="#example-6" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffcb82748&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffcb82748">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/blogs/scripts/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www-blogs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www-blogs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;options&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;file&#34;</span><span class="p">:</span> <span class="s2">&#34;/etc/php.ini&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;admin&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;memory_limit&#34;</span><span class="p">:</span> <span class="s2">&#34;256M&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;variables_order&#34;</span><span class="p">:</span> <span class="s2">&#34;EGPCS&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;display_errors&#34;</span><span class="p">:</span> <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/blogs/scripts/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www-blogs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www-blogs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;options&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;file&#34;</span><span class="p">:</span> <span class="s2">&#34;/etc/php.ini&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;admin&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;memory_limit&#34;</span><span class="p">:</span> <span class="s2">&#34;256M&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;variables_order&#34;</span><span class="p">:</span> <span class="s2">&#34;EGPCS&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;display_errors&#34;</span><span class="p">:</span> <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="configuration-php-targets">Targets  <a class="headerlink float-right" href="#configuration-php-targets" title="Targets"><i class="fas fa-link fa-xs"></i></a>
</h4><p>You can configure up to 254 individual entry points for a single PHP app:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffcbd8e18&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffcbd8e18">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;php-app&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;targets&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;front&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;front.php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/apps/php-app/front/&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;back&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;back.php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/apps/php-app/back/&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;php-app&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;targets&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;front&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;front.php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/apps/php-app/front/&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;back&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;back.php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;root&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/apps/php-app/back/&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Each target is an object that specifies <strong>root</strong> and can define <strong>index</strong> or <strong>script</strong>
just like a regular app does. Targets can be used by the <strong>pass</strong> options
in listeners and routes to serve requests:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffcc27fb8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffcc27fb8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app/front&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/back&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app/back&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app/front&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/back&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/php-app/back&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>App-wide settings (<strong>isolation</strong>, <strong>limits</strong>, <strong>options</strong>, <strong>processes</strong>)
are shared by all targets within the app.</p>
<blockquote class="warning call-out">
  <div><strong class="call-out-type">Warning</strong><br/> If you specify <strong>targets</strong>, there should be no <strong>root</strong>, <strong>index</strong>, or <strong>script</strong>
defined at the app level.</div>
</blockquote>

<blockquote class="note">
  <div><strong>Note:</strong><br/> For PHP-based examples, see our
<a href="/nginx-unit/howto/frameworks/cakephp/">CakePHP</a>,
<a href="/nginx-unit/howto/frameworks/codeigniter/">CodeIgniter</a>,
<a href="/nginx-unit/howto/apps/dokuwiki/">DokuWiki</a>,
<a href="/nginx-unit/howto/apps/drupal/">Drupal</a>,
<a href="/nginx-unit/howto/frameworks/laravel/">Laravel</a>,
<a href="/nginx-unit/howto/frameworks/lumen/">Lumen</a>,
<a href="/nginx-unit/howto/apps/matomo/">Matomo</a>,
<a href="/nginx-unit/howto/apps/mediawiki/">MediaWiki</a>,
<a href="/nginx-unit/howto/apps/modx/">MODX</a>,
<a href="/nginx-unit/howto/apps/nextcloud/">Nextcloud</a>,
<a href="/nginx-unit/howto/apps/phpbb/">phpBB</a>,
<a href="/nginx-unit/howto/apps/phpmyadmin/">phpMyAdmin</a>,
<a href="/nginx-unit/howto/apps/roundcube/">Roundcube</a>,
<a href="/nginx-unit/howto/frameworks/symfony/">Symfony</a>,
<a href="/nginx-unit/howto/apps/wordpress/">WordPress</a>,
and
<a href="/nginx-unit/howto/frameworks/yii/">Yii</a>
howtos or a basic
<a href="/nginx-unit/configuration/#sample-php">sample</a>.</div>
</blockquote>

<h3 
id="configuration-python">Python  <a class="headerlink float-right" href="#configuration-python" title="Python"><i class="fas fa-link fa-xs"></i></a>
</h3><p>First, make sure to install Unit along with the
<a href="/nginx-unit/installation/#installation-precomp-pkgs">Python language module</a>.</p>
<p>Besides the
<a href="/nginx-unit/configuration/#configuration-apps-common">common options</a>,
you have:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>module</strong> (required)</td>
          <td style="text-align: left">String; app&rsquo;s module name. This module is <a href="https://docs.python.org/3/reference/import.html" target="_blank" rel="noopener">imported</a> by Unit the usual Python way.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>callable</strong></td>
          <td style="text-align: left">String; name of the <strong>module</strong>-based callable that Unit runs as the app. The default is <strong>application</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>factory</strong></td>
          <td style="text-align: left">Boolean: when enabled, Unit treats <strong>callable</strong> as a factory. The default is <strong>false</strong>.<br><br><strong>Note:</strong> Unit does <em>not</em> support passing arguments to factories. <em>(since 1.33.0)</em></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>home</strong></td>
          <td style="text-align: left">String; path to the app&rsquo;s <a href="https://packaging.python.org/en/latest/tutorials/installing-packages/#creating-virtual-environments" target="_blank" rel="noopener">virtual environment</a>. Absolute or relative to <strong>working_directory</strong>.<br><br><strong>Note:</strong> The Python version used to run the app is determined by <strong>type</strong>; for performance, Unit doesn&rsquo;t use the command-line interpreter from the virtual environment.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>path</strong></td>
          <td style="text-align: left">String or an array of strings; additional Python module lookup paths. These values are prepended to <strong>sys.path</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>prefix</strong></td>
          <td style="text-align: left">String; <strong>SCRIPT_NAME</strong> context value for WSGI or the <strong>root_path</strong> context value for ASGI. Should start with a slash (<strong>/</strong>).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>protocol</strong></td>
          <td style="text-align: left">String; hints Unit that the app uses a certain interface. Can be <strong>asgi</strong> or <strong>wsgi</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>targets</strong></td>
          <td style="text-align: left">Object; app sections with <a href="/nginx-unit/configuration/#configuration-python-targets">custom</a> <strong>module</strong> and <strong>callable</strong> values.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>thread_stack_size</strong></td>
          <td style="text-align: left">Integer; stack size of a worker thread (in bytes, multiple of memory page size; the minimum value is usually architecture specific). The default is usually system dependent and can be set with <code>ulimit -s &lt;SIZE_KB&gt;</code>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>threads</strong></td>
          <td style="text-align: left">Integer; number of worker threads per <a href="/nginx-unit/howto/security/#sec-processes">app process</a>. When started, each app process creates this number of threads to handle requests. The default is <strong>1</strong>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>module</strong> (required)</td>
          <td style="text-align: left">String; app&rsquo;s module name. This module is <a href="https://docs.python.org/3/reference/import.html" target="_blank" rel="noopener">imported</a> by Unit the usual Python way.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>callable</strong></td>
          <td style="text-align: left">String; name of the <strong>module</strong>-based callable that Unit runs as the app. The default is <strong>application</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>factory</strong></td>
          <td style="text-align: left">Boolean: when enabled, Unit treats <strong>callable</strong> as a factory. The default is <strong>false</strong>.<br><br><strong>Note:</strong> Unit does <em>not</em> support passing arguments to factories. <em>(since 1.33.0)</em></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>home</strong></td>
          <td style="text-align: left">String; path to the app&rsquo;s <a href="https://packaging.python.org/en/latest/tutorials/installing-packages/#creating-virtual-environments" target="_blank" rel="noopener">virtual environment</a>. Absolute or relative to <strong>working_directory</strong>.<br><br><strong>Note:</strong> The Python version used to run the app is determined by <strong>type</strong>; for performance, Unit doesn&rsquo;t use the command-line interpreter from the virtual environment.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>path</strong></td>
          <td style="text-align: left">String or an array of strings; additional Python module lookup paths. These values are prepended to <strong>sys.path</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>prefix</strong></td>
          <td style="text-align: left">String; <strong>SCRIPT_NAME</strong> context value for WSGI or the <strong>root_path</strong> context value for ASGI. Should start with a slash (<strong>/</strong>).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>protocol</strong></td>
          <td style="text-align: left">String; hints Unit that the app uses a certain interface. Can be <strong>asgi</strong> or <strong>wsgi</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>targets</strong></td>
          <td style="text-align: left">Object; app sections with <a href="/nginx-unit/configuration/#configuration-python-targets">custom</a> <strong>module</strong> and <strong>callable</strong> values.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>thread_stack_size</strong></td>
          <td style="text-align: left">Integer; stack size of a worker thread (in bytes, multiple of memory page size; the minimum value is usually architecture specific). The default is usually system dependent and can be set with <code>ulimit -s &lt;SIZE_KB&gt;</code>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>threads</strong></td>
          <td style="text-align: left">Integer; number of worker threads per <a href="/nginx-unit/howto/security/#sec-processes">app process</a>. When started, each app process creates this number of threads to handle requests. The default is <strong>1</strong>.</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example-7">Example:  <a class="headerlink float-right" href="#example-7" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffcc8a208&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffcc8a208">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/store/cart/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/store/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_path&#34;</span><span class="p">:</span> <span class="s2">&#34;Added to sys.path for lookup; store the application module within this directory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;home&#34;</span><span class="p">:</span> <span class="s2">&#34;.virtualenv/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_home&#34;</span><span class="p">:</span> <span class="s2">&#34;Path where the virtual environment is located; here, it&#39;s relative to the working directory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;cart.run&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_module&#34;</span><span class="p">:</span> <span class="s2">&#34;Looks for a &#39;run.py&#39; module in /www/store/cart/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;callable&#34;</span><span class="p">:</span> <span class="s2">&#34;app&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;prefix&#34;</span><span class="p">:</span> <span class="s2">&#34;/cart&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_prefix&#34;</span><span class="p">:</span> <span class="s2">&#34;Sets the SCRIPT_NAME or root_path context value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;working_directory&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/store/cart/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/store/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_path&#34;</span><span class="p">:</span> <span class="s2">&#34;Added to sys.path for lookup; store the application module within this directory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;home&#34;</span><span class="p">:</span> <span class="s2">&#34;.virtualenv/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_home&#34;</span><span class="p">:</span> <span class="s2">&#34;Path where the virtual environment is located; here, it&#39;s relative to the working directory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;cart.run&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_module&#34;</span><span class="p">:</span> <span class="s2">&#34;Looks for a &#39;run.py&#39; module in /www/store/cart/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;callable&#34;</span><span class="p">:</span> <span class="s2">&#34;app&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;prefix&#34;</span><span class="p">:</span> <span class="s2">&#34;/cart&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comment_prefix&#34;</span><span class="p">:</span> <span class="s2">&#34;Sets the SCRIPT_NAME or root_path context value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>This snippet runs the <strong>app</strong> callable from the <strong>/www/store/cart/run.py</strong> module
with <strong>/www/store/cart/</strong> as the working directory and <strong>/www/store/.virtualenv/</strong>
as the virtual environment; the <strong>path</strong> value accommodates for situations
when some modules of the app are imported from outside the <strong>cart/</strong> subdirectory.</p>
<p><a name="configuration-python-asgi"></a></p>
<p>You can provide the callable in two forms. The first one uses WSGI
(<a href="https://peps.python.org/pep-0333/" target="_blank" rel="noopener">PEP 333</a>
or <a href="https://peps.python.org/pep-3333/" target="_blank" rel="noopener">PEP 3333</a>):</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">python</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffcd18378&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffcd18378">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_response</span><span class="p">(</span><span class="s1">&#39;200 OK&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">    <span class="k">yield</span> <span class="sa">b</span><span class="s1">&#39;Hello, WSGI</span><span class="se">\n</span><span class="s1">&#39;</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_response</span><span class="p">(</span><span class="s1">&#39;200 OK&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">    <span class="k">yield</span> <span class="sa">b</span><span class="s1">&#39;Hello, WSGI</span><span class="se">\n</span><span class="s1">&#39;</span></span></span></code></pre></div>
</div><p>The second one, supported with Python 3.5+, uses
<a href="https://asgi.readthedocs.io/en/latest/" target="_blank" rel="noopener">ASGI</a>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">python</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffcdd4730&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffcdd4730">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">,</span> <span class="n">send</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">send</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;http.response.start&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="mi">200</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">send</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;http.response.body&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;Hello, ASGI</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">,</span> <span class="n">send</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">send</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;http.response.start&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="mi">200</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">send</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;http.response.body&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;Hello, ASGI</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> Legacy <a href="https://asgi.readthedocs.io/en/latest/specs/main.html#legacy-applications" target="_blank" rel="noopener">two-callable</a>
ASGI 2.0 applications were not supported prior to Unit 1.21.0.</div>
</blockquote>

<p>Choose either one according to your needs; Unit tries to infer your choice automatically.
If this inference fails, use the <strong>protocol</strong> option to set the interface explicitly.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> The <strong>prefix</strong> option controls the <strong>SCRIPT_NAME</strong>
(<a href="https://wsgi.readthedocs.io/en/latest/definitions.html" target="_blank" rel="noopener">WSGI</a>)
or <strong>root_path</strong>
(<a href="https://asgi.readthedocs.io/en/latest/specs/www.html#http-connection-scope" target="_blank" rel="noopener">ASGI</a>)
setting in Python&rsquo;s context, allowing to route requests regardless of the app&rsquo;s factual path.</div>
</blockquote>

<h4 
id="configuration-python-targets">Targets  <a class="headerlink float-right" href="#configuration-python-targets" title="Targets"><i class="fas fa-link fa-xs"></i></a>
</h4><p>You can configure up to 254 individual entry points for a single Python app:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffce26f80&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffce26f80">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;python-app&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/apps/python-app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;targets&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;front&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;front.wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;callable&#34;</span><span class="p">:</span> <span class="s2">&#34;app&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;back&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;back.wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;callable&#34;</span><span class="p">:</span> <span class="s2">&#34;app&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;python-app&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/apps/python-app/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;targets&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;front&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;front.wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;callable&#34;</span><span class="p">:</span> <span class="s2">&#34;app&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;back&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;back.wsgi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&#34;callable&#34;</span><span class="p">:</span> <span class="s2">&#34;app&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Each target is an object that specifies <strong>module</strong> and can also define <strong>callable</strong> and <strong>prefix</strong>
just like a regular app does. Targets can be used by the <strong>pass</strong> options
in listeners and routes to serve requests:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffce50790&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffce50790">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/python-app/front&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/back&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/python-app/back&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/python-app/front&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;127.0.0.1:80&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;routes&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;routes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;uri&#34;</span><span class="p">:</span> <span class="s2">&#34;/back&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;action&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/python-app/back&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The <strong>home</strong>, <strong>path</strong>, <strong>protocol</strong>, <strong>threads</strong>, and <strong>thread_stack_size</strong> settings
are shared by all targets in the app.</p>
<blockquote class="warning call-out">
  <div><strong class="call-out-type">Warning</strong><br/> If you specify <strong>targets</strong>, there should be no <strong>module</strong> or <strong>callable</strong>
defined at the app level. Moreover, you can&rsquo;t combine WSGI and ASGI targets
within a single app.</div>
</blockquote>

<blockquote class="note">
  <div><strong>Note:</strong><br/> For Python-based examples, see our
<a href="/nginx-unit/howto/frameworks/bottle/">Bottle</a>,
<a href="/nginx-unit/howto/apps/datasette/">Datasette</a>,
<a href="/nginx-unit/howto/frameworks/django/">Django</a>,
<a href="/nginx-unit/howto/frameworks/djangochannels/">DjangoChannels</a>,
<a href="/nginx-unit/howto/frameworks/falcon/">Falcon</a>,
<a href="/nginx-unit/howto/frameworks/fastapi/">FastAPI</a>,
<a href="/nginx-unit/howto/frameworks/flask/">Flask</a>,
<a href="/nginx-unit/howto/frameworks/guillotina/">Guillotina</a>,
<a href="/nginx-unit/howto/apps/mailman/">Mailman</a>,
<a href="/nginx-unit/howto/apps/mercurial/">Mercurial</a>,
<a href="/nginx-unit/howto/apps/moin/">Moin</a>,
<a href="/nginx-unit/howto/apps/plone/">Plone</a>,
<a href="/nginx-unit/howto/frameworks/pyramid/">Pyramid</a>,
<a href="/nginx-unit/howto/frameworks/quart/">Quart</a>,
<a href="/nginx-unit/howto/frameworks/responder/">Responder</a>,
<a href="/nginx-unit/howto/apps/reviewboard/">ReviewBoard</a>,
<a href="/nginx-unit/howto/frameworks/sanic/">Sanic</a>,
<a href="/nginx-unit/howto/frameworks/starlette/">Starlette</a>,
<a href="/nginx-unit/howto/apps/trac/">Trac</a>,
and
<a href="/nginx-unit/howto/frameworks/zope/">Zope</a>
howtos or a basic
<a href="/nginx-unit/configuration/#sample-python">sample</a>.</div>
</blockquote>

<h3 
id="configuration-ruby">Ruby  <a class="headerlink float-right" href="#configuration-ruby" title="Ruby"><i class="fas fa-link fa-xs"></i></a>
</h3><p>First, make sure to install Unit along with the
<a href="/nginx-unit/installation/#installation-precomp-pkgs">Ruby language module</a>.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> <p>Unit uses the <a href="https://rack.github.io" target="_blank" rel="noopener">Rack</a> interface to run Ruby scripts;
you need to have it installed as well:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffeb3b4e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffeb3b4e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> gem install rack
</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> gem install rack
</span></span></code></pre></div>
</div></div>
</blockquote>

<p>Besides the
<a href="/nginx-unit/configuration/#configuration-apps-common">common options</a>,
you have:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>script</strong> (required)</td>
          <td style="text-align: left">String; rack script pathname, including the <strong>.ru</strong> extension, for instance: <strong>/www/rubyapp/script.ru</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>hooks</strong></td>
          <td style="text-align: left">String; pathname of the <strong>.rb</strong> file setting the event hooks invoked during the app&rsquo;s lifecycle.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>threads</strong></td>
          <td style="text-align: left">Integer; number of worker threads per <a href="/nginx-unit/howto/security/#sec-processes">app process</a>. When started, each app process creates this number of threads to handle requests. The default is <strong>1</strong>.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>script</strong> (required)</td>
          <td style="text-align: left">String; rack script pathname, including the <strong>.ru</strong> extension, for instance: <strong>/www/rubyapp/script.ru</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>hooks</strong></td>
          <td style="text-align: left">String; pathname of the <strong>.rb</strong> file setting the event hooks invoked during the app&rsquo;s lifecycle.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>threads</strong></td>
          <td style="text-align: left">Integer; number of worker threads per <a href="/nginx-unit/howto/security/#sec-processes">app process</a>. When started, each app process creates this number of threads to handle requests. The default is <strong>1</strong>.</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example-8">Example:  <a class="headerlink float-right" href="#example-8" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffce75568&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffce75568">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;ruby&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/cms/config.ru&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;hooks&#34;</span><span class="p">:</span> <span class="s2">&#34;hooks.rb&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;ruby&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;processes&#34;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;group&#34;</span><span class="p">:</span> <span class="s2">&#34;www&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;script&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/cms/config.ru&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;hooks&#34;</span><span class="p">:</span> <span class="s2">&#34;hooks.rb&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The <strong>hooks</strong> script is evaluated when the app starts. If set, it can define
blocks of Ruby code named <strong>on_worker_boot</strong>, <strong>on_worker_shutdown</strong>,
<strong>on_thread_boot</strong>, or <strong>on_thread_shutdown</strong>. If provided, these blocks are
called at the respective points of the app&rsquo;s lifecycle, for example:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">ruby</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd2ad2c0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffd2ad2c0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="vi">@mutex</span> <span class="o">=</span> <span class="no">Mutex</span><span class="o">.</span><span class="n">new</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./hooks.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;hooks evaluated&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs once at app load.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">on_worker_boot</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">   <span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./worker_boot.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;worker boot&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs at worker process boot.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">on_thread_boot</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">   <span class="vi">@mutex</span><span class="o">.</span><span class="n">synchronize</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Avoids a race condition that may crash the app.</span>
</span></span><span class="line"><span class="cl">      <span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./thread_boot.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">.</span><span class="si">#{</span><span class="no">Thread</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;thread boot&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs at worker thread boot.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">on_thread_shutdown</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@mutex</span><span class="o">.</span><span class="n">synchronize</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Avoids a race condition that may crash the app.</span>
</span></span><span class="line"><span class="cl">        <span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./thread_shutdown.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">.</span><span class="si">#{</span><span class="no">Thread</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="s2">&#34;thread shutdown&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs at worker thread shutdown.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">on_worker_shutdown</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./worker_shutdown.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;worker shutdown&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs at worker process shutdown.</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="vi">@mutex</span> <span class="o">=</span> <span class="no">Mutex</span><span class="o">.</span><span class="n">new</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./hooks.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;hooks evaluated&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs once at app load.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">on_worker_boot</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">   <span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./worker_boot.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;worker boot&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs at worker process boot.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">on_thread_boot</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">   <span class="vi">@mutex</span><span class="o">.</span><span class="n">synchronize</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Avoids a race condition that may crash the app.</span>
</span></span><span class="line"><span class="cl">      <span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./thread_boot.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">.</span><span class="si">#{</span><span class="no">Thread</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;thread boot&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs at worker thread boot.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">on_thread_shutdown</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@mutex</span><span class="o">.</span><span class="n">synchronize</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Avoids a race condition that may crash the app.</span>
</span></span><span class="line"><span class="cl">        <span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./thread_shutdown.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">.</span><span class="si">#{</span><span class="no">Thread</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="s2">&#34;thread shutdown&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs at worker thread shutdown.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">on_worker_shutdown</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="no">File</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;./worker_shutdown.</span><span class="si">#{</span><span class="no">Process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;worker shutdown&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Runs at worker process shutdown.</span></span></span></code></pre></div>
</div><p>Use these hooks to add custom runtime logic to your app.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> For Ruby-based examples, see our
<a href="/nginx-unit/howto/frameworks/rails/">Rails</a>
and
<a href="/nginx-unit/howto/apps/redmine/">Redmine</a>
howtos or a basic
<a href="/nginx-unit/configuration/#sample-ruby">sample</a>.</div>
</blockquote>

<h3 
id="configuration-wasm">WebAssembly  <a class="headerlink float-right" href="#configuration-wasm" title="WebAssembly"><i class="fas fa-link fa-xs"></i></a>
</h3><div class="tabs-container">
	<ul class="nav nav-tabs" id="unit-wasm" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#unit-wasm-0" role="tab" aria-controls="unit-wasm-0" aria-selected="true">wasm-wasi-component</a></li>
		
			<li class="nav-item"><a data-toggle="tab" class="nav-link" href="#unit-wasm-1" role="tab" aria-controls="unit-wasm-1">unit-wasm</a></li></ul>
</div>
<div class="tab-content" id="unit-wasm"><div id="unit-wasm-0" class="tab-pane show active" role="tabpanel" aria-labelledby="unit-wasm-0">
<p>First, make sure to install Unit along with the
<a href="/nginx-unit/installation/#installation-precomp-pkgs">WebAssembly language module</a>.</p>
<p>Besides the
<a href="/nginx-unit/configuration/#configuration-apps-common">common options</a>,
you have:</p>
<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>component</strong> (required)</td>
          <td style="text-align: left">String; WebAssembly component pathname, including the <strong>.wasm</strong> extension, for instance: &ldquo;/var/www/wasm/component.wasm&rdquo;</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>access</strong></td>
          <td style="text-align: left">Object; its only array member, <strong>filesystem</strong>, lists directories to which the application has access.</td>
      </tr>
  </tbody>
</table>
<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>component</strong> (required)</td>
          <td style="text-align: left">String; WebAssembly component pathname, including the <strong>.wasm</strong> extension, for instance: &ldquo;/var/www/wasm/component.wasm&rdquo;</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>access</strong></td>
          <td style="text-align: left">Object; its only array member, <strong>filesystem</strong>, lists directories to which the application has access.</td>
      </tr>
  </tbody>
</table>
</div>
<p>The <code>access</code> object has the following structure:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffec6e6f0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffec6e6f0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;access&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;filesystem&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;/tmp/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;/var/tmp/&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;access&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;filesystem&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;/tmp/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;/var/tmp/&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h4 
id="example">Example:  <a class="headerlink float-right" href="#example" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffecd0170&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffecd0170">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;127.0.0.1:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/wasm&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;wasm&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wasm-wasi-component&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;component&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/www/app/component.wasm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;access&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;filesystem&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/tmp/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/var/tmp/&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;listeners&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;127.0.0.1:8080&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;pass&#34;</span><span class="p">:</span> <span class="s2">&#34;applications/wasm&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;applications&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;wasm&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wasm-wasi-component&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;component&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/www/app/component.wasm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;access&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;filesystem&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/tmp/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/var/tmp/&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span></span></span></code></pre></div>
</div><blockquote class="note">
  <div><strong>Note:</strong><br/> A good, first Rust-based project is available at
<a href="https://github.com/sunfishcode/hello-wasi-http" target="_blank" rel="noopener">sunfishcode/hello-wasi-http</a>.
It also includes all the important steps to get started with WebAssembly, WASI, and Rust.</div>
</blockquote>
</div>
  <div id="unit-wasm-1" class="tab-pane" role="tabpanel" aria-labelledby="unit-wasm-1">
<blockquote class="warning call-out">
  <div><strong class="call-out-type">Warning</strong><br/> The <code>unit-wasm</code> module is deprecated. We recommend using <code>wasm-wasi-component</code>
instead, which supports WebAssembly Components using standard WASI 0.2 interfaces.
The <code>wasm-wasi-component</code> module is available in Unit 1.32 and later.</div>
</blockquote>
<p>First, make sure to install Unit along with the
<a href="/nginx-unit/installation/#installation-precomp-pkgs">WebAssembly language module</a>.</p>
<p>Besides the
<a href="/nginx-unit/configuration/#configuration-apps-common">common options</a>,
you have:</p>
<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>module</strong> (required)</td>
          <td style="text-align: left">String; WebAssembly module pathname, including the <strong>.wasm</strong> extension, for instance: <strong>applications/wasmapp/module.wasm</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_handler</strong> (required)</td>
          <td style="text-align: left">String; name of the request handler function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. The runtime calls this handler, providing the address of the shared memory block used to pass data in and out the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>malloc_handler</strong> (required)</td>
          <td style="text-align: left">String; name of the memory allocator function. See note above regarding language-specific handlers in the official <code>unit-wasm</code> package. The runtime calls this handler at language module startup to allocate the shared memory block used to pass data in and out the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>free_handler</strong> (required)</td>
          <td style="text-align: left">String; name of the memory deallocator function. See note above regarding language-specific handlers in the official <code>unit-wasm</code> package. The runtime calls this handler at language module shutdown to free the shared memory block used to pass data in and out the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>access</strong></td>
          <td style="text-align: left">Object; its only array member, <strong>filesystem</strong>, lists directories the application can access:</td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left"><code>&quot;access&quot;: {</code><br><br>    <code>&quot;filesystem&quot;: [</code><br><br>        <code>&quot;/tmp/&quot;,</code><br><br>        <code>&quot;/var/tmp/&quot;</code><br><br>    <code>]</code><br><br>  <code>}</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>module_init_handler</strong></td>
          <td style="text-align: left">String; name of the module initialization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at language module startup, after the WebAssembly module was initialized.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>module_end_handler</strong></td>
          <td style="text-align: left">String; name of the module finalization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at language module shutdown.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_init_handler</strong></td>
          <td style="text-align: left">String; name of the request initialization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at the start of each request.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_end_handler</strong></td>
          <td style="text-align: left">String; name of the request finalization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at the end of each request, when the headers and the request body were received.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>response_end_handler</strong></td>
          <td style="text-align: left">String; name of the response finalization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at the end of each response, when the headers and the response body were sent.</td>
      </tr>
  </tbody>
</table>
<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>module</strong> (required)</td>
          <td style="text-align: left">String; WebAssembly module pathname, including the <strong>.wasm</strong> extension, for instance: <strong>applications/wasmapp/module.wasm</strong>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_handler</strong> (required)</td>
          <td style="text-align: left">String; name of the request handler function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. The runtime calls this handler, providing the address of the shared memory block used to pass data in and out the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>malloc_handler</strong> (required)</td>
          <td style="text-align: left">String; name of the memory allocator function. See note above regarding language-specific handlers in the official <code>unit-wasm</code> package. The runtime calls this handler at language module startup to allocate the shared memory block used to pass data in and out the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>free_handler</strong> (required)</td>
          <td style="text-align: left">String; name of the memory deallocator function. See note above regarding language-specific handlers in the official <code>unit-wasm</code> package. The runtime calls this handler at language module shutdown to free the shared memory block used to pass data in and out the app.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>access</strong></td>
          <td style="text-align: left">Object; its only array member, <strong>filesystem</strong>, lists directories the application can access:</td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left"><code>&quot;access&quot;: {</code><br><br>    <code>&quot;filesystem&quot;: [</code><br><br>        <code>&quot;/tmp/&quot;,</code><br><br>        <code>&quot;/var/tmp/&quot;</code><br><br>    <code>]</code><br><br>  <code>}</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>module_init_handler</strong></td>
          <td style="text-align: left">String; name of the module initialization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at language module startup, after the WebAssembly module was initialized.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>module_end_handler</strong></td>
          <td style="text-align: left">String; name of the module finalization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at language module shutdown.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_init_handler</strong></td>
          <td style="text-align: left">String; name of the request initialization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at the start of each request.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>request_end_handler</strong></td>
          <td style="text-align: left">String; name of the request finalization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at the end of each request, when the headers and the request body were received.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>response_end_handler</strong></td>
          <td style="text-align: left">String; name of the response finalization function. If you use Unit with the official <code>unit-wasm</code> <a href="/nginx-unit/installation/#installation-precomp-pkgs">package</a>, the value is language specific; see the <a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> documentation for details. Otherwise, use the name of your custom implementation. It is invoked by the WebAssembly language module at the end of each response, when the headers and the response body were sent.</td>
      </tr>
  </tbody>
</table>
</div>
<h4 
id="example">Example:  <a class="headerlink float-right" href="#example" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffeed5e98&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffeed5e98">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wasm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/webassembly/unitapp.wasm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;request_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_request_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;malloc_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_malloc_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;free_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_free_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;access&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;filesystem&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;/tmp/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;/var/tmp/&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;module_init_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_module_init_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;module_end_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_module_end_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;request_init_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_request_init_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;request_end_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_request_end_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;response_end_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_response_end_handler&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wasm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;/www/webassembly/unitapp.wasm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;request_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_request_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;malloc_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_malloc_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;free_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_free_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;access&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;filesystem&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;/tmp/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;/var/tmp/&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;module_init_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_module_init_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;module_end_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_module_end_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;request_init_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_request_init_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;request_end_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_request_end_handler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;response_end_handler&#34;</span><span class="p">:</span> <span class="s2">&#34;my_custom_response_end_handler&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span></span></span></code></pre></div>
</div><p>Use these handlers to add custom runtime logic to your app; for a detailed
discussion of their usage and requirements, see the
<a href="https://github.com/nginx/unit-wasm/" target="_blank" rel="noopener">SDK</a> source code and documentation.</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> For WASM-based examples, see our <a href="/nginx-unit/configuration/#sample-wasm">Rust and C samples</a>.</div>
</blockquote>
</div></div>

<h2 
id="configuration-stngs">Settings  <a class="headerlink float-right" href="#configuration-stngs" title="Settings"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Unit has a global <strong>settings</strong> configuration object that stores instance-wide preferences.</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>listen_threads</strong></td>
          <td style="text-align: left">Integer; controls the number of router threads created to handle client connections. Each thread includes all the configured listeners. By default, we create as many threads as the number of CPUs that are available to run on. <em>(since 1.33.0)</em></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>http</strong></td>
          <td style="text-align: left">Object; fine-tunes handling of HTTP requests from the clients.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>js_module</strong></td>
          <td style="text-align: left">String or an array of strings; lists enabled <code>njs</code> <a href="/nginx-unit/scripting/">modules</a>, uploaded via the <a href="/nginx-unit/controlapi/">control API</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>telemetry</strong></td>
          <td style="text-align: left">Object: OpenTelemetry configuration <em>(since 1.34.0)</em></td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>listen_threads</strong></td>
          <td style="text-align: left">Integer; controls the number of router threads created to handle client connections. Each thread includes all the configured listeners. By default, we create as many threads as the number of CPUs that are available to run on. <em>(since 1.33.0)</em></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>http</strong></td>
          <td style="text-align: left">Object; fine-tunes handling of HTTP requests from the clients.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>js_module</strong></td>
          <td style="text-align: left">String or an array of strings; lists enabled <code>njs</code> <a href="/nginx-unit/scripting/">modules</a>, uploaded via the <a href="/nginx-unit/controlapi/">control API</a>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>telemetry</strong></td>
          <td style="text-align: left">Object: OpenTelemetry configuration <em>(since 1.34.0)</em></td>
      </tr>
  </tbody>
</table>

</div>
<p>In turn, the <strong>http</strong> option exposes the following settings:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>body_read_timeout</strong></td>
          <td style="text-align: left">Maximum number of seconds to read data from the body of a client&rsquo;s request. This is the interval between consecutive read operations, not the time to read the entire body. If Unit doesn&rsquo;t receive any data from the client within this interval, it returns a 408 &ldquo;Request Timeout&rdquo; response. The default is 30.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>discard_unsafe_fields</strong></td>
          <td style="text-align: left">Boolean; controls header field name parsing. If it&rsquo;s set to <strong>true</strong>, Unit only processes header names made of alphanumeric characters and hyphens (see <a href="https://datatracker.ietf.org/doc/html/rfc9110#section-16.3.1-6" target="_blank" rel="noopener">RFC 9110</a>; otherwise, these characters are also permitted: **.!#$%&amp;&rsquo;*+^_`</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>header_read_timeout</strong></td>
          <td style="text-align: left">Maximum number of seconds to read the header of a client&rsquo;s request. If Unit doesn&rsquo;t receive the entire header from the client within this interval, it returns a 408 &ldquo;Request Timeout&rdquo; response. The default is 30.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>idle_timeout</strong></td>
          <td style="text-align: left">Maximum number of seconds between requests in a keep-alive connection. If no new requests arrive within this interval, Unit returns a 408 &ldquo;Request Timeout&rdquo; response and closes the connection. The default is 180.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>log_route</strong></td>
          <td style="text-align: left">Boolean; enables or disables <a href="/nginx-unit/troubleshooting/#troubleshooting-router-log">router logging</a>. The default is <strong>false</strong> (disabled).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>max_body_size</strong></td>
          <td style="text-align: left">Maximum number of bytes in the body of a client&rsquo;s request. If the body size exceeds this value, Unit returns a 413 &ldquo;Payload Too Large&rdquo; response and closes the connection. The default is 8388608 (8 MB).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>send_timeout</strong></td>
          <td style="text-align: left">Maximum number of seconds to transmit data as a response to the client. This is the interval between consecutive transmissions, not the time for the entire response. If no data is sent to the client within this interval, Unit closes the connection. The default is 30.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>server_version</strong></td>
          <td style="text-align: left">Boolean; if set to <strong>false</strong>, Unit omits version information in its <strong>Server</strong> response <a href="https://datatracker.ietf.org/doc/html/rfc9110.html#section-10.2.4" target="_blank" rel="noopener">header fields</a>. The default is <strong>true</strong>. <em>(since 1.30.0)</em></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>static</strong></td>
          <td style="text-align: left">Object; configures static asset handling. Has a single object option named <strong>mime_types</strong> that defines specific <a href="https://www.iana.org/assignments/media-types/media-types.xhtml" target="_blank" rel="noopener">MIME types</a> as options. Their values can be strings or arrays of strings; each string must specify a filename extension or a specific filename that&rsquo;s included in the MIME type. You can override default MIME types or add new types.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>body_read_timeout</strong></td>
          <td style="text-align: left">Maximum number of seconds to read data from the body of a client&rsquo;s request. This is the interval between consecutive read operations, not the time to read the entire body. If Unit doesn&rsquo;t receive any data from the client within this interval, it returns a 408 &ldquo;Request Timeout&rdquo; response. The default is 30.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>discard_unsafe_fields</strong></td>
          <td style="text-align: left">Boolean; controls header field name parsing. If it&rsquo;s set to <strong>true</strong>, Unit only processes header names made of alphanumeric characters and hyphens (see <a href="https://datatracker.ietf.org/doc/html/rfc9110#section-16.3.1-6" target="_blank" rel="noopener">RFC 9110</a>; otherwise, these characters are also permitted: **.!#$%&amp;&rsquo;*+^_`</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>header_read_timeout</strong></td>
          <td style="text-align: left">Maximum number of seconds to read the header of a client&rsquo;s request. If Unit doesn&rsquo;t receive the entire header from the client within this interval, it returns a 408 &ldquo;Request Timeout&rdquo; response. The default is 30.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>idle_timeout</strong></td>
          <td style="text-align: left">Maximum number of seconds between requests in a keep-alive connection. If no new requests arrive within this interval, Unit returns a 408 &ldquo;Request Timeout&rdquo; response and closes the connection. The default is 180.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>log_route</strong></td>
          <td style="text-align: left">Boolean; enables or disables <a href="/nginx-unit/troubleshooting/#troubleshooting-router-log">router logging</a>. The default is <strong>false</strong> (disabled).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>max_body_size</strong></td>
          <td style="text-align: left">Maximum number of bytes in the body of a client&rsquo;s request. If the body size exceeds this value, Unit returns a 413 &ldquo;Payload Too Large&rdquo; response and closes the connection. The default is 8388608 (8 MB).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>send_timeout</strong></td>
          <td style="text-align: left">Maximum number of seconds to transmit data as a response to the client. This is the interval between consecutive transmissions, not the time for the entire response. If no data is sent to the client within this interval, Unit closes the connection. The default is 30.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>server_version</strong></td>
          <td style="text-align: left">Boolean; if set to <strong>false</strong>, Unit omits version information in its <strong>Server</strong> response <a href="https://datatracker.ietf.org/doc/html/rfc9110.html#section-10.2.4" target="_blank" rel="noopener">header fields</a>. The default is <strong>true</strong>. <em>(since 1.30.0)</em></td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>static</strong></td>
          <td style="text-align: left">Object; configures static asset handling. Has a single object option named <strong>mime_types</strong> that defines specific <a href="https://www.iana.org/assignments/media-types/media-types.xhtml" target="_blank" rel="noopener">MIME types</a> as options. Their values can be strings or arrays of strings; each string must specify a filename extension or a specific filename that&rsquo;s included in the MIME type. You can override default MIME types or add new types.</td>
      </tr>
  </tbody>
</table>

</div>
<p>The <strong>telemetry</strong> option exposes the following settings:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>endpoint</strong></td>
          <td style="text-align: left">The endpoint for the OpenTelemetry (OTEL) Collector. <br><br>It takes a URL to either a gRPC or HTTP(S) endpoint.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>protocol</strong></td>
          <td style="text-align: left">Determines the protocol used to communicate with the endpoint.<br><br> Can be either <em>http(s)</em> or <em>grpc</em>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>batch_size</strong></td>
          <td style="text-align: left">Number of spans to cache before triggering a transaction with the configured endpoint. This is optional.<br><br> This allows the user to cache up to N spans before the OpenTelemetry (OTEL) background thread sends spans over the network to the collector.<br><br> If specified, it must be a positive integer.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>sampling_ratio</strong></td>
          <td style="text-align: left">Percentage of requests to trace.<br><br> This allows the user to only trace anywhere from 0% to 100% of requests that hit Unit. In high throughput environments this percentage should be lower. This allows the user to save space in storing span data, and to collect request metrics like time to decode headers and whatnot without storing massive amounts of duplicate superfluous data.<br><br> If specified, it must be a positive floating point number.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>endpoint</strong></td>
          <td style="text-align: left">The endpoint for the OpenTelemetry (OTEL) Collector. <br><br>It takes a URL to either a gRPC or HTTP(S) endpoint.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>protocol</strong></td>
          <td style="text-align: left">Determines the protocol used to communicate with the endpoint.<br><br> Can be either <em>http(s)</em> or <em>grpc</em>.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>batch_size</strong></td>
          <td style="text-align: left">Number of spans to cache before triggering a transaction with the configured endpoint. This is optional.<br><br> This allows the user to cache up to N spans before the OpenTelemetry (OTEL) background thread sends spans over the network to the collector.<br><br> If specified, it must be a positive integer.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>sampling_ratio</strong></td>
          <td style="text-align: left">Percentage of requests to trace.<br><br> This allows the user to only trace anywhere from 0% to 100% of requests that hit Unit. In high throughput environments this percentage should be lower. This allows the user to save space in storing span data, and to collect request metrics like time to decode headers and whatnot without storing massive amounts of duplicate superfluous data.<br><br> If specified, it must be a positive floating point number.</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example-9">Example:  <a class="headerlink float-right" href="#example-9" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd3123f0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffd3123f0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;settings&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;telemetry&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;batch_size&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;endpoint&#34;</span><span class="p">:</span> <span class="s2">&#34;http://example.com/v1/traces&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;sampling_ratio&#34;</span><span class="p">:</span> <span class="mf">1.0</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="err">,</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;settings&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;telemetry&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;batch_size&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;endpoint&#34;</span><span class="p">:</span> <span class="s2">&#34;http://example.com/v1/traces&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;http&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;sampling_ratio&#34;</span><span class="p">:</span> <span class="mf">1.0</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="err">,</span></span></span></code></pre></div>
</div><h2 
id="configuration-access-log">Access log  <a class="headerlink float-right" href="#configuration-access-log" title="Access log"><i class="fas fa-link fa-xs"></i></a>
</h2><p>To enable basic access logging, specify the log file path in the <strong>access_log</strong> option
of the <strong>config</strong> object.</p>
<p>In the example below, all requests will be logged to <strong>/var/log/access.log</strong>:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">console</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd343900&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffd343900">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -X PUT -d &#39;&#34;/var/log/access.log&#34;&#39; \
</span></span></span><span class="line"><span class="cl"><span class="go">      --unix-socket /path/to/control.unit.sock \
</span></span></span><span class="line"><span class="cl"><span class="go">      http://localhost/config/access_log
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   {
</span></span></span><span class="line"><span class="cl"><span class="go">      &#34;success&#34;: &#34;Reconfiguration done.&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">   }
</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">curl -X PUT -d &#39;&#34;/var/log/access.log&#34;&#39; \
</span></span></span><span class="line"><span class="cl"><span class="go">      --unix-socket /path/to/control.unit.sock \
</span></span></span><span class="line"><span class="cl"><span class="go">      http://localhost/config/access_log
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   {
</span></span></span><span class="line"><span class="cl"><span class="go">      &#34;success&#34;: &#34;Reconfiguration done.&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">   }
</span></span></span></code></pre></div>
</div><p>By default, the log is written in the
<a href="https://httpd.apache.org/docs/2.2/logs.html#combined" target="_blank" rel="noopener">Combined Log Format</a>.
Example of a CLF line:</p>



<div class="code-block" data-mf="true" style="display: none;">
    <div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd37c340&#34;)" class="code-copy-button" type="button">Copy</button>
        <div class="highlight-v2 single-line" id="id-18440f1ffd37c340">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">127.0.0.1 - - [21/Oct/2015:16:29:00 -0700] &#34;GET / HTTP/1.1&#34; 200 6022 &#34;http://example.com/links.html&#34; &#34;Godzilla/5.0 (X11; Minix i286) Firefox/42&#34;</span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">127.0.0.1 - - [21/Oct/2015:16:29:00 -0700] &#34;GET / HTTP/1.1&#34; 200 6022 &#34;http://example.com/links.html&#34; &#34;Godzilla/5.0 (X11; Minix i286) Firefox/42&#34;</span></span></code></pre></div>
</div><h3 
id="custom-log-format">Custom log formatting  <a class="headerlink float-right" href="#custom-log-format" title="Custom log formatting"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The <strong>access_log</strong> option can be also set to an object to customize both the log path
and its format:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>format</strong></td>
          <td style="text-align: left">String; sets the log format. Besides arbitrary text, can contain any <a href="/nginx-unit/configuration/#configuration-variables-native">variables</a> Unit supports.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>path</strong></td>
          <td style="text-align: left">String; pathname of the access log file.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>format</strong></td>
          <td style="text-align: left">String; sets the log format. Besides arbitrary text, can contain any <a href="/nginx-unit/configuration/#configuration-variables-native">variables</a> Unit supports.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>path</strong></td>
          <td style="text-align: left">String; pathname of the access log file.</td>
      </tr>
  </tbody>
</table>

</div>
<h4 
id="example-10">Example:  <a class="headerlink float-right" href="#example-10" title="Example:"><i class="fas fa-link fa-xs"></i></a>
</h4>


<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd3bab40&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffd3bab40">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/log/unit/access.log&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;format&#34;</span><span class="p">:</span> <span class="s2">&#34;$remote_addr - - [$time_local] \&#34;$request_line\&#34; $status $body_bytes_sent \&#34;$header_referer\&#34; \&#34;$header_user_agent\&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/log/unit/access.log&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;format&#34;</span><span class="p">:</span> <span class="s2">&#34;$remote_addr - - [$time_local] \&#34;$request_line\&#34; $status $body_bytes_sent \&#34;$header_referer\&#34; \&#34;$header_user_agent\&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>By a neat coincidence, the above <strong>format</strong> is the default setting.
Also, mind that the log entry is formed <em>after</em> the request has been handled.</p>
<p>Besides
<a href="/nginx-unit/configuration/#configuration-variables-native">built-in variables</a>,
you can use <code>njs</code> <a href="/nginx-unit/scripting/">templates</a>
to define the log format:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd3f7fb8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffd3f7fb8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/log/unit/basic_access.log&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;format&#34;</span><span class="p">:</span> <span class="s2">&#34;`${host + &#39;: &#39; + uri}`&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/log/unit/basic_access.log&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;format&#34;</span><span class="p">:</span> <span class="s2">&#34;`${host + &#39;: &#39; + uri}`&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><h3 
id="json-log-format">JSON log format  <a class="headerlink float-right" href="#json-log-format" title="JSON log format"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Starting with NGINX Unit 1.34.0, <strong>format</strong> can instead be an object
describing JSON field name/value pairs, for example,</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd457710&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffd457710">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/tmp/access.log&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;format&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;remote_addr&#34;</span><span class="p">:</span> <span class="s2">&#34;$remote_addr&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;time_local&#34;</span><span class="p">:</span> <span class="s2">&#34;$time_local&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;request_line&#34;</span><span class="p">:</span> <span class="s2">&#34;$request_line&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;$status&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;body_bytes_sent&#34;</span><span class="p">:</span> <span class="s2">&#34;$body_bytes_sent&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;header_referer&#34;</span><span class="p">:</span> <span class="s2">&#34;$header_referer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;header_user_agent&#34;</span><span class="p">:</span> <span class="s2">&#34;$header_user_agent&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/tmp/access.log&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;format&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;remote_addr&#34;</span><span class="p">:</span> <span class="s2">&#34;$remote_addr&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;time_local&#34;</span><span class="p">:</span> <span class="s2">&#34;$time_local&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;request_line&#34;</span><span class="p">:</span> <span class="s2">&#34;$request_line&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;$status&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;body_bytes_sent&#34;</span><span class="p">:</span> <span class="s2">&#34;$body_bytes_sent&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;header_referer&#34;</span><span class="p">:</span> <span class="s2">&#34;$header_referer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;header_user_agent&#34;</span><span class="p">:</span> <span class="s2">&#34;$header_user_agent&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>The JSON <em>values</em> can be strings, variables and JavaScript.</p>
<h3 
id="conditional-access-log-1">Conditional access log  <a class="headerlink float-right" href="#conditional-access-log-1" title="Conditional access log"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The <strong>access_log</strong> can be dynamically turned on and off by using the <strong>if</strong> option:</p>





<table class="table table-striped table-bordered table-v1">
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>if</strong></td>
          <td style="text-align: left">if the value is empty, 0, false, null, or undefined, the logs will not be recorded.</td>
      </tr>
  </tbody>
</table>






  


<div data-mf="true" style="display: none;" class="table-v2 table table-striped table-bordered narrow">
    <table>
  <thead>
      <tr>
          <th style="text-align: left">Option</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>if</strong></td>
          <td style="text-align: left">if the value is empty, 0, false, null, or undefined, the logs will not be recorded.</td>
      </tr>
  </tbody>
</table>

</div>
<p>This feature lets users set conditions to determine whether access logs are
recorded. The <strong>if</strong> option supports a string and JavaScript code.
If its value is empty, 0, false, null, or undefined, the logs will not be
recorded. And the &lsquo;!&rsquo; as a prefix inverses the condition.</p>
<p>Example without njs:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd493be8&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffd493be8">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;if&#34;</span><span class="p">:</span> <span class="s2">&#34;$cookie_session&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;if&#34;</span><span class="p">:</span> <span class="s2">&#34;$cookie_session&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>All requests using a session cookie named <strong>session</strong> will be logged.</p>
<p>We can add <code>!</code> to inverse the condition.</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd4b7638&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffd4b7638">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;if&#34;</span><span class="p">:</span> <span class="s2">&#34;!$cookie_session&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;if&#34;</span><span class="p">:</span> <span class="s2">&#34;!$cookie_session&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div><p>Now, all requests without a session cookie will be logged.</p>
<p>Example with njs and the use of a template literal:</p>



<div class="code-block" data-mf="true" style="display: none;"><span class="code-type chroma">json</span><div class="code-container chroma">
        <button onclick="copyToClipBoard(this, &#34;id-18440f1ffd4ec5e0&#34;)" class="code-copy-button multi-line" type="button">Copy</button>
        <div class="highlight-v2" id="id-18440f1ffd4ec5e0">
            <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;if&#34;</span><span class="p">:</span> <span class="s2">&#34;`${uri == &#39;/health&#39; ? false : true}`&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
        </div>
    </div>
</div><div id="code-block-v1" data-mf="false">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;access_log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;if&#34;</span><span class="p">:</span> <span class="s2">&#34;`${uri == &#39;/health&#39; ? false : true}`&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
        
        

        <hr>
  
        
        <div class="last-modified">
          
<div>
    <a href="https://github.com/nginx/documentation//tree/main/content/unit/configuration.md" class="" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> View source</a>
  </div>
  <div>
    <a href="https://github.com/nginx/documentation//edit/main/content/unit/configuration.md" class="" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
  </div>
  <div>
    <a href="https://github.com/nginx/documentation//issues/new?title=Configuration&amp;template=2-bug_report.md" class="" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create a new issue</a>
  </div>



        </div>
        

        
         
<script type='text/javascript'> 
    (function(){var g=function(e,h,f,g){ 
        this.get=function(a){
            for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){
                for(var d=c[b];" "==d.charAt(0);)
                    d=d.substring(1,d.length);
                    if(0==d.indexOf(a))
                        return d.substring(a.length,d.length)
            }
            return null
        }; 
        
        this.set=function(a,c){
            var b="",b=new Date;
            b.setTime(b.getTime()+6048E5);
            b="; expires="+b.toGMTString();
            document.cookie=a+"="+c+b+"; path=/; "
        }; 
        
        this.check=function(){
            var a=this.get(f);
            if(a)
                a=a.split(":");
            else if(100!=e)
                "v"==h&&(e=Math.random()>=e/100?0:100),
                a=[h,e,0],
                this.set(f,a.join(":"));
            else 
                return!0;
            var c=a[1];
            if(100==c)
                return!0;
            switch(a[0]){
                case "v":
                    return!1;
                case "r":
                    return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c
            }
            return!0
        }; 

        this.go=function(){
            if(this.check()){
                var a=document.createElement("script");
                a.type="text/javascript";
                a.src=g;
                document.body&&document.body.appendChild(a)
            }
        };

        this.start=function(){
            var t=this;
            "complete"!==document.readyState?window.addEventListener ?
                window.addEventListener("load",function(){t.go()},!1) : 
                window.attachEvent&&window.attachEvent("onload",function(){t.go()}):t.go()};
    }; 

    try{
        const project_id = window.location.hostname.includes("staging") ? "QSI_S_ZN_2YG73ads2zp5bN0" : "QSI_S_ZN_2QSTn2r41YlXrYk";
        const endpoint = window.location.hostname.includes("staging") ? "https://zn2yg73ads2zp5bn0-f5.siteintercept.qualtrics.com/SIE/?Q_ZID=ZN_2YG73ads2zp5bN0" : "https://zn2qstn2r41ylxryk-f5.siteintercept.qualtrics.com/SIE/?Q_ZID=ZN_2QSTn2r41YlXrYk";
        (new g(100,"r", project_id, endpoint)).start()
    }
    catch(i){}})();

    document.addEventListener("DOMContentLoaded", function () {
        document.querySelector(".qualtrics-feedback").id = window.location.hostname.includes("staging") ? "ZN_2YG73ads2zp5bN0" : "ZN_2QSTn2r41YlXrYk"
    });
</script>
<hr>
<div style="height: 60px;"></div>
<div class="qualtrics-feedback" id='ZN_2QSTn2r41YlXrYk'></div>


        

	
<div class="container flex">
	<ul class="next-prev-icon">

		
		
		<li style="flex:1; text-align: left; white-space: nowrap;"><a href="http://localhost:1313/nginx-unit/controlapi/" class="" title="Previous -- Control API "><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M23.378 46.5L1.94 25.06C1.80067 24.9209 1.69014 24.7556 1.61472 24.5738C1.53931 24.3919 1.50049 24.1969 1.50049 24C1.50049 23.8031 1.53931 23.6081 1.61472 23.4262C1.69014 23.2444 1.80067 23.0791 1.94 22.94L23.378 1.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M45.878 46.5L24.44 25.06C24.3007 24.9209 24.1901 24.7556 24.1147 24.5738C24.0393 24.3919 24.0005 24.1969 24.0005 24C24.0005 23.8031 24.0393 23.6081 24.1147 23.4262C24.1901 23.2444 24.3007 23.0791 24.44 22.94L45.878 1.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a></li>
		

		
			<li style="flex:1; text-align: right; white-space: nowrap;"><a href="http://localhost:1313/nginx-unit/scripting/" class="" title="Next -- Scripting"><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M24.622 1.5L46.06 22.94C46.1993 23.0791 46.3099 23.2444 46.3853 23.4262C46.4607 23.6081 46.4995 23.8031 46.4995 24C46.4995 24.1969 46.4607 24.3919 46.3853 24.5738C46.3099 24.7556 46.1993 24.9209 46.06 25.06L24.622 46.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2.122 1.5L23.56 22.94C23.6993 23.0791 23.8099 23.2444 23.8853 23.4262C23.9607 23.6081 23.9995 23.8031 23.9995 24C23.9995 24.1969 23.9607 24.3919 23.8853 24.5738C23.8099 24.7556 23.6993 24.9209 23.56 25.06L2.122 46.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a></li>
		
		</ul>
	</div>

        </main>
        
          
            <div id="toc" class="col-md-3 d-none d-xl-block d-print-none nginx-toc align-top">
            <nav class="bd-links" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <h3 class="bd-toc-link">What's on This Page</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#configuration-listeners">Listeners</a>
      <ul>
        <li><a href="#configuration-listeners-ssl">SSL/TLS configuration</a></li>
      </ul>
    </li>
    <li><a href="#between-individual-unit-instances">This scheme enables safely sharing session ticket keys
between individual Unit instances.</a>
      <ul>
        <li><a href="#configuration-listeners-forwarded">IP, protocol forwarding</a></li>
      </ul>
    </li>
    <li><a href="#configuration-routes">Routes</a>
      <ul>
        <li><a href="#configuration-routes-step">Route steps</a></li>
        <li><a href="#configuration-routes-matching">Matching conditions</a></li>
        <li><a href="#configuration-routes-action">Handling actions</a></li>
      </ul>
    </li>
    <li><a href="#configuration-variables-native">Variables</a></li>
    <li><a href="#configuration-rewrite">URI rewrite</a></li>
    <li><a href="#configuration-response-headers">Response headers</a></li>
    <li><a href="#configuration-return">Instant responses, redirects</a></li>
    <li><a href="#configuration-static">Static files</a>
      <ul>
        <li><a href="#configuration-share-mime">MIME filtering</a></li>
        <li><a href="#configuration-share-path">Path restrictions</a></li>
        <li><a href="#configuration-fallback">Fallback action</a></li>
      </ul>
    </li>
    <li><a href="#configuration-proxy">Proxying</a>
      <ul>
        <li><a href="#configuration-upstreams">Load balancing</a></li>
      </ul>
    </li>
    <li><a href="#configuration-applications">Applications</a>
      <ul>
        <li><a href="#configuration-proc-mgmt">Process management</a></li>
        <li><a href="#configuration-go">Go</a></li>
        <li><a href="#configuration-java">Java</a></li>
        <li><a href="#configuration-nodejs">Node.js</a></li>
        <li><a href="#configuration-perl">Perl</a></li>
        <li><a href="#configuration-php">PHP</a></li>
        <li><a href="#configuration-python">Python</a></li>
        <li><a href="#configuration-ruby">Ruby</a></li>
        <li><a href="#configuration-wasm">WebAssembly</a></li>
      </ul>
    </li>
    <li><a href="#configuration-stngs">Settings</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#configuration-access-log">Access log</a>
      <ul>
        <li><a href="#custom-log-format">Custom log formatting</a></li>
        <li><a href="#json-log-format">JSON log format</a></li>
        <li><a href="#conditional-access-log-1">Conditional access log</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</nav>
            </div>
          
        
        
      </div>
    </section>
  </section>
</div>




      </div>
  </section>

    <footer id="footer">
      
      <footer id="footer">
  <div class="container-fluid">
    <div class="row align-items-center">
      <div class="col-md-6 d-md-flex">
        <img class="nginx-logo-footer" src="http://localhost:1313/images/icons/NGINX-Part-of-F5-horiz-all-white-525x208@2x.png"/>
      </div>
    </div>

    
    <div class="row d-print-none d-none d-md-flex">
      <div class="col-md-3 d-none d-md-block">
        <span class="footer-head">Company</span>
        <ul class="footer-text">
          <li>
            <a
              href="https://www.f5.com/go/product/welcome-to-nginx"
              target="_blank"
              alt="Select to learn about F5 NGINX"
              >About F5 NGINX</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/company/events"
              target="_blank"
              alt="Select to learn about F5 events"
              >Events</a
            >
          </li>
        </ul>
        <br />
        <span class="footer-head">Resources</span>
        <ul class="footer-text">
          <li>
            <a
              href="https://www.f5.com/company/blog/nginx"
              target="_blank"
              alt="Select to visit the F5 NGINX blog"
              >Blog</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/go/faq/nginx-faq"
              target="_blank"
              alt="Select to visit the F5 NGINX frequently asked questions page"
              >FAQ</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/services"
              target="_blank"
              alt="Select to learn about F5 NGINX Support"
              >Professional Services</a
            >
          </li>
          <li>
            <a
              href="https://www.f5.com/learn/training"
              target="_blank"
              alt="Select to learn about F5 training offerings"
              >Training</a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-3 d-none d-md-block">
        <span class="footer-head">Products</span>
        <ul class="footer-text">
          <li>
            <a
              title="F5 NGINX One"
              aria-label="F5 NGINX One"
              href="https://www.f5.com/products/nginx/one"
              >F5 NGINX One</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Plus"
              aria-label="F5 NGINX Plus"
              href="https://www.f5.com/products/nginx/nginx-plus"
              >F5 NGINX Plus</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX App Protect"
              aria-label="F5 NGINX App Protect"
              href="https://www.f5.com/products/nginx/nginx-app-protect"
              >F5 NGINX App Protect</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Instance Manager"
              aria-label="F5 NGINX Instance Manager"
              href="https://www.f5.com/products/nginx/instance-manager"
              >F5 NGINX Instance Manager</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Ingress Controller"
              aria-label="F5 NGINX Ingress Controller"
              href="https://www.f5.com/products/nginx/nginx-ingress-controller"
              >F5 NGINX Ingress Controller</a
            >
          </li>
          <li>
            <a
              title="F5 NGINX Gateway Fabric"
              aria-label="F5 NGINX Gateway Fabric"
              href="https://www.f5.com/products/nginx/nginx-gateway-fabric"
              >F5 NGINX Gateway Fabric</a
            >
          </li>
          <li>
            <a
              title="F5 NGINXaaS for Azure"
              aria-label="F5 NGINXaaS for Azure"
              href="https://www.f5.com/products/nginx/f5-nginxaas-for-azure"
              >F5 NGINXaaS for Azure</a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-3 d-none d-md-block">
        <span class="footer-head">NGINX on GitHub</span>
        <ul class="footer-text">
          <li>
            <a
              title="NGINX Open Source"
              aria-label="NGINX Open Source"
              href="https://github.com/nginx/nginx"
              ><span class="inner">NGINX Open Source</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Unit"
              aria-label="NGINX Unit"
              href="https://github.com/nginx/unit"
              ><span class="inner">NGINX Unit</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Amplify"
              aria-label="NGINX Amplify"
              href="https://github.com/nginxinc/nginx-amplify-agent"
              ><span class="inner">NGINX Amplify</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Agent"
              aria-label="NGINX Agent"
              href="https://github.com/nginx/Agent"
              ><span class="inner">NGINX Agent</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Kubernetes Ingress Controller"
              aria-label="NGINX Kubernetes Ingress Controller"
              href="https://github.com/nginxinc/kubernetes-ingress"
              ><span class="inner">NGINX Kubernetes Ingress Controller</span></a
            >
          </li>
          <li>
            <a
              title="NGINX Gateway Fabric"
              aria-label="NGINX Gateway Fabric"
              href="https://github.com/nginxinc/nginx-gateway-fabric"
              ><span class="inner">NGINX Gateway Fabric</span></a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-2 d-none d-md-block">
        <span class="footer-head">Social</span>
        <ul class="footer-social">
          <li>
            <a
              href="https://www.facebook.com/nginxinc"
              title="facebook"
              aria-label="facebook"
              target="_blank"
              rel="noreferrer"
              ><i class="fa-brands fa-facebook" aria-hidden="true"></i>
            </a>
          </li>
          <li>
            <a
              href="https://twitter.com/nginx"
              title="X"
              aria-label="x"
              target="_blank"
              rel="noreferrer"
              ><i class="fa-brands fa-x-twitter" aria-hidden="true"></i
            ></a>
          </li>
          <li>
            <a
              href="https://www.linkedin.com/company/nginx"
              title="linkedin"
              aria-label="linkedin"
              target="_blank"
              rel="noreferrer"
              ><i class="fa-brands fa-linkedin" aria-hidden="true"></i>
            </a>
          </li>
          <li>
            <a
              href="https://www.youtube.com/user/NginxInc"
              title="youtube"
              aria-label="youtube"
              target="_blank"
              rel="noreferrer"
              alt="NGINX Youtube Channel"
              ><i class="fa-brands fa-square-youtube" aria-hidden="true"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
    
    <div class="site-info footer-text">
      <div class="text-center">
        <p>
          <a href="https://www.f5.com/"
            ><img class="f5-logo-footer" src="http://localhost:1313/images/icons/Logo_F5.svg" alt="F5 logo"></a
          >
          ©2025 F5, Inc. All rights reserved.
        </p>
        <p>
          <a
            href="https://www.f5.com/company/policies/trademarks"
            rel="noopener"
            target="_blank"
            >Trademarks</a
          >
          <a
            href="https://www.f5.com/company/policies"
            rel="noopener"
            target="_blank"
            >Policies</a
          >
          <a href="https://docs.nginx.com/ossc">Open Source Components</a>
          <a
            href="https://www.f5.com/company/policies/privacy-notice"
            rel="noopener"
            target="_blank"
            >Privacy</a
          >
          <a
            href="https://www.f5.com/company/policies/F5-California-privacy-summary"
            rel="noopener"
            target="_blank"
            >California Privacy</a
          >
          <a
            href="https://www.f5.com/company/policies/privacy-notice#no-sell"
            rel="noopener"
            target="_blank"
            >Do Not Sell My Personal Information</a
          >
          <span id="teconsent-v1"></span>
        </p>
      </div>
    </div>
    
  </div>
  
</footer>

      
    </footer>

    <footer data-mf="true" id="footer-v2" style="display:none;">
      
      <div class="footer-layout">
    <div class="footer-f5-trademark">
        <img class="f5-logo-footer" src="http://localhost:1313/images/icons/Logo_F5.svg" alt="F5 logo">
        <p>©2025 F5, Inc. All rights reserved. NGINX is a registered trademark of F5, Inc.</p>
    </div>
    <div class="footer-useful-links">
        <a
            href="https://www.f5.com/company/policies/trademarks"
            rel="noopener"
            target="_blank"
            >Trademarks
        </a>
        <a
            href="https://www.f5.com/company/policies"
            rel="noopener"
            target="_blank"
            >Policies
        </a>
        <a
            href="https://www.f5.com/company/policies/privacy-notice"
            rel="noopener"
            target="_blank"
            >Privacy
        </a>
        <a
            href="https://www.f5.com/company/policies/F5-California-privacy-summary"
            rel="noopener"
            target="_blank"
            >California Privacy
        </a>
        <a
            href="https://www.f5.com/company/policies/privacy-notice#no-sell"
            rel="noopener"
            target="_blank"
            >Do Not Sell My Personal Information
        </a>
        <span id="teconsent-v2"></span>
    </div>
</div>

      
    </footer>
  
<script src="/js/jquery-3-6-4.min.js" type="text/javascript" integrity=""></script>


<script src="/js/kube.min.a3a07cceb64989e2f0bf41653ab4d8346ba4312270eb5cc80d6afad3bf30a0ca9768aaa2559cb582e663332c541edab6a4068ef2e88b739fa425e2e870eb0aff.js" type="text/javascript" integrity="sha512-o6B8zrZJieLwv0FlOrTYNGukMSJw61zIDWr6078woMqXaKqiVZy1guZjMyxUHtq2pAaO8uiLc5&#43;kJeLocOsK/w=="></script>



<script src="/js/bootstrap.bundle.min.c15ed88f56a52190ea645094409cbce5537eaaf108972f777c840037b8aa0c508f12e70b09e345cf8af7e450a8f6ce96ae974340f8bcd316e58d707c063b6f72.js" type="text/javascript"
  integrity="sha512-wV7Yj1alIZDqZFCUQJy85VN&#43;qvEIly93fIQAN7iqDFCPEucLCeNFz4r35FCo9s6WrpdDQPi80xbljXB8Bjtvcg=="></script>



<script src="/js/code-copy.bb21b72280613039f1fabb11acc6a901c07caaee454933031066fbda6b5406fd31077a80ec913ba32261224d138bcbb4a34d27c51efae571c68d59282943b9a4.js" type="text/javascript"></script>



<script src="/js/code-copy-v2.71bcaee23ab00cb45dc944f321264e21d25bc1ec1ae76f9596286cb408ea5654b4ee016e7914cc2554b237114eeb467d39df18735311f2d28480b3ccd2feb4ad.js" type="text/javascript"></script>





<script
  type="module"
  src="https://static.cloud.coveo.com/atomic/v3.19.0/atomic.esm.js"
  integrity="sha512-VA9k6iDWhwxl8bwKUYPD63l93lGX7daV60k3yFxEt9EuEq4iWvsu5COq1mZ8OXKl0KCOFlUSDXS32Cy+YwbufQ=="
  crossorigin="anonymous">
</script>


<script class="coveo-script" src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/CoveoJsSearch.Lazy.min.js"
  integrity="sha512-HxdDBIp5snbqtu1TPkBnXLKEvN9IPz3PeZW8zT9KfsflV9Ck822XDroDlpVbfCfXeiu8C0RDVn0fdu7aGy/H1g=="
  crossorigin="anonymous"></script>

<script src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/templates/templates.js"
  integrity="sha512-CR0Yk/LIwgh1MsKqjecDp/r6F9ipKc6gA+4+E1pplT3N3r1pk+la/HaqyDiKtjOFwrwIIbIYBFrUJgPql93QHw=="
  crossorigin="anonymous"></script>






<script src="/js/coveo.min.4acfd205930e2d31230100f345e0463332eb3e3af1b4aa9a6e3131b0b2bac53566ae4d18b390066fce94c0c75d39b5e121d1291f81e5accc1a82d93da9f11b7f.js" integrity="sha512-Ss/SBZMOLTEjAQDzReBGMzLrPjrxtKqabjExsLK6xTVmrk0Ys5AGb86UwMddObXhIdEpH4HlrMwagtk9qfEbfw=="
  type="text/javascript"></script>


















<script src="/js/sidebar.min.6fed0180a23d01103c68ffb054a183fba5e7ba673de8c56d85857af964dcc0c11623ee09f6185207a373127cb2547ff9247ae3516ed47c67e1b58dbe71e9d576.js" type="text/javascript" integrity="sha512-b&#43;0BgKI9ARA8aP&#43;wVKGD&#43;6Xnumc96MVthYV6&#43;WTcwMEWI&#43;4J9hhSB6NzEnyyVH/5JHrjUW7UfGfhtY2&#43;cenVdg=="></script>
  


<script src="/js/site-dropdown.min.3bb49b6f7d25bcd4a2b008525bb8538d84237348bf618b40970ff6eca87119d68c326ca7ba04854ad102be36495fe1d70f1cb239916555b67dd17683dc283333.js" type="text/javascript" integrity="sha512-O7Sbb30lvNSisAhSW7hTjYQjc0i/YYtAlw/27KhxGdaMMmynugSFStECvjZJX&#43;HXDxyyOZFlVbZ90XaD3CgzMw=="></script>



<script src="/js/product-selector.min.b588249327fb12c7602fa08eb618560171f54e7348d6c1bacfdbf541f5e13023493f64f78fb6d4b9014892e5e4f0aaaee95b859bb37aa53bbe8c0e27e65167d1.js" type="text/javascript" integrity="sha512-tYgkkyf7EsdgL6COthhWAXH1TnNI1sG6z9v1QfXhMCNJP2T3j7bUuQFIkuXk8Kqu6VuFm7N6pTu&#43;jA4n5lFn0Q=="></script>



<script src="/js/sidebar-v2.min.3f906631e696b2c88883bfcfc62371165359130cfd118ceb49893ae0d8760dc38177ee3bb94a61dee45023115de8445f0b9fe48f933618ef7ba7b3180a05adbd.js" type="text/javascript" integrity="sha512-P5BmMeaWssiIg7/PxiNxFlNZEwz9EYzrSYk64Nh2DcOBd&#43;47uUph3uRQIxFd6ERfC5/kj5M2GO97p7MYCgWtvQ=="></script> 
  <div id="consent_blackbar"></div>
</body>
</html>


