{{ block "sidebar" . }}
<!-- sidebar start -->

<div id="sidebar" class="sidebar" aria-label="Sidebar navigation">
    <h3>
        <a class="sidebar-title" href="{{.FirstSection.Permalink}}" alt="{{.FirstSection.Title}}">{{ if .Params.logo }}<img
                class="card-img-top" src="{{ .Site.BaseURL}}/images/icons/{{ .Params.logo }}"
                alt="{{.FirstSection.Title}}">{{end}}
            {{.FirstSection.Title}}</a>
    </h3>
    
    <ul>
    <!-- Use FirstSection here to keep the current product as the top level of the nav -->
    {{ range .FirstSection.Pages.ByWeight }}
        <!-- Create a regular list item for pages -->
        {{if eq .Kind "page"}}
        <li class="nginx-toc-link l1">
            <a data-menu-id="{{.RelPermalink}}" href="{{ .Permalink }}">{{ .Title }}</a>
        </li>
        
        <!-- Create an accordion group for sections -->
        {{else}}

        <div class="accordion" id="accordion1">
            <div class="accordion-group">
                <div class="accordion-heading">
                    <li class="nginx-toc-link l1">
                        {{ $theRealSection := (print "/"   $.Section  "/") }}
                        {{ if eq .RelPermalink $theRealSection }}
                            <a data-menu-id="{{.RelPermalink}}" class="accordion-toggle" aria-expanded="true"
                        {{ else }}
                            <a data-menu-id="{{.RelPermalink}}" class="accordion-toggle" aria-expanded="false"
                        {{ end }}
                            data-toggle="collapse" href="#" data-target="#{{.Section | urlize}}--{{.Title | urlize}}" aria-controls="{{.Section | urlize}}--{{.Title | urlize}}">
                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                class="fa fa-2xs fa-fw fa-chevron-down"></i>{{ .Title }}</a>
                    </li>
                </div>
<!-- This is necessary to expand the current product after clicking on the product cards in docs.nginx.com-->
                {{ if eq .RelPermalink $theRealSection }}
                <div id="{{.Section | urlize}}--{{.Title | urlize}}" class="accordion-body collapse show">
                {{ else }}
                <div id="{{.Section | urlize}}--{{.Title | urlize}}" class="accordion-body collapse">
                {{ end }}
                    <div class="accordion-inner">
                        {{ range .Sections }}
                        <div class="accordion" id="Accordion2">
                            <div class="sidebar-l1-padding">
                                <div class="accordion-group sidebar-il-border">
                                    <div class="accordion-heading">
                                        <ul>
                                            <li class="nginx-toc-link l2">
                                                <a data-menu-id="{{.RelPermalink}}" class="accordion-toggle"
                                                    aria-expanded="false" data-toggle="collapse"
                                                    href="#{{.Section | urlize}}--{{.Parent.File.ContentBaseName}}--{{.Title | urlize}}">
                                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>{{ .Title }}</a>
                                            </li>
                                        <ul>
                                    </div>
                                    <div id="{{.Section | urlize}}--{{.Parent.File.ContentBaseName}}--{{.Title | urlize}}" class="accordion-body collapse leaf">
                                        <div class="accordion-inner">
                                            {{ range .Sections }}
                                            <div class="accordion" id="Accordion3">
                                                <div class="sidebar-l2-padding">
                                                    <div class="accordion-group sidebar-il-border">
                                                        <div class="accordion-heading">
                                                            <ul>
                                                                <li class="nginx-toc-link l2">
                                                                    <a data-menu-id="{{.RelPermalink}}" class="accordion-toggle"
                                                                        aria-expanded="false" data-toggle="collapse"
                                                                        href="#{{.Section | urlize}}--{{.Parent.File.ContentBaseName}}--{{.Title | urlize}}">
                                                                        <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                            class="fa fa-2xs fa-fw fa-chevron-down"></i>{{ .Title }}</a>
                                                                </li>
                                                            <ul>
                                                        </div>

                                                        <div id="{{.Section | urlize}}--{{.Parent.File.ContentBaseName}}--{{.Title | urlize}}" class="accordion-body collapse leaf">
                                                            <div class="accordion-inner">
                                                                {{ range .Sections }}
                                                                <div class="accordion" id="Accordion4">
                                                                    <div class="sidebar-l2-padding">
                                                                        <div class="accordion-group sidebar-il-border">
                                                                            <div class="accordion-heading">
                                                                                <ul>
                                                                                    <li class="nginx-toc-link l2">
                                                                                        <a data-menu-id="{{.RelPermalink}}" class="accordion-toggle"
                                                                                            aria-expanded="false" data-toggle="collapse"
                                                                                            href="#{{.Section | urlize}}--{{.Parent.File.ContentBaseName}}--{{.Title | urlize}}">
                                                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>{{ .Title }}</a>
                                                                                    </li>
                                                                                <ul>
                                                                            </div>

                                                                            <div id="{{.Section | urlize}}--{{.Parent.Parent.File.ContentBaseName}}--{{.Parent.File.ContentBaseName}}--{{.Title | urlize}}" class="accordion-body collapse leaf">
                                                                                <div class="accordion-inner">
                                                                                {{ range .Pages }}
                                                                                <ul class="sidebar-l2-padding">
                                                                                    <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                        <a data-menu-id="{{.RelPermalink}}"
                                                                                            href="{{ .Permalink }}">{{ .Title }}</a>
                                                                                    </li>
                                                                                </ul>
                                                                                {{ end }}
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                {{ end }}
                                                                {{ range .RegularPages }}
                                                                <ul class="sidebar-l2-padding">
                                                                    <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                        <a data-menu-id="{{.RelPermalink}}"
                                                                            href="{{ .Permalink }}">{{ .Title }}</a>
                                                                    </li>
                                                                </ul>
                                                                {{ end }}  
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            {{ end }}
                                            {{ range .RegularPages }}
                                            <ul class="sidebar-l2-padding">
                                                <li class="nginx-toc-link l3 sidebar-il-border ">
                                                    <a data-menu-id="{{.RelPermalink}}"
                                                        href="{{ .Permalink }}">{{ .Title }}</a>
                                                </li>
                                            </ul>
                                            {{ end }}                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {{ end }}
                        {{ range .RegularPages }}
                        <ul class="sidebar-reg-padding">
                            <div class="accordion" id="accordion2">
                                <div class="accordion-group sidebar-il-border">
                                    <div class="accordion-heading">
                                        <ul>
                                            <li class="nginx-toc-link l2">
                                                <a data-menu-id="{{.RelPermalink}}"
                                                    href="{{ .Permalink }}">{{ .Title }}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </ul>
                        {{ end }}
                    </div>
                </div>
            </div>
        </div>

        {{end}}

    {{ end }}

    </ul>

<!-- close sidebar div-->
</div>
{{ end }}